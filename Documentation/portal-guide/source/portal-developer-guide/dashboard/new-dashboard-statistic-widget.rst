.. _configure-new-dashboard-task-widget:

Configure Statistic widget
==========================

Define Statistic widget
-----------------------

Statistic widget of Portal dashboard is is consume statistics and charts.

Below is a sample JSON definition of the Statistic widget in the Portal dashboard

.. code-block:: html

   {
      "type": "statistic",
      "id": "statistic_1",
      "name": "Tasks by Priority",
      "layout": {
         "styleClass": "new-widget",
         "w": 5,
         "h": 5,
         "x": 0,
         "y": 0
      },
      "chart": {
         "id": "0",
         "names": [{
               "locale": "de",
               "value": "Aufgaben nach Priorität"
            }, {
               "locale": "en",
               "value": "Tasks by Priority"
            }, {
               "locale": "fr",
               "value": "Tãches par priorité"
            }, {
               "locale": "es",
               "value": "Tareas por prioridad"
            }
         ],
         "type": "TASK_BY_PRIORITY",
         "filter": {
            "timePeriodSelection": "CUSTOM"
         }
      }
   }
..

The basic structure of JSON of Statistic widget

   ``type``: type of widget. Use ``statistic`` to mark that this widget is a statistic widget

   ``id``: ID of the widget

   ``name``: Name of the widget on UI

   ``layout``: layout definition of task widget

      ``x``: HTML DOM Style ``left`` will be calculated by formula ``x / 12 * 100%``

      ``y``: HTML DOM Style ``top`` will be calculated by formula ``y / 12 * 100%``

      ``w``: HTML DOM Style ``width`` will be calculated by formula ``60 * w + 20 * (w - 1)``

      ``h``: HTML DOM Style ``height`` will be calculated by formula ``60 * h + 20 * (h - 1)``

      ``styleClass`` (optional): add CSS Classes to HTML DOM of widget

      ``style`` (optional): add inline style to HTML DOM of widget

   ``chart``: the chart data model of statistic widget

      ``id``: the identification of chart, auto-generated by UUID

      ``names``: the display name of the chart, support multi-language by defined locale and value

      ``type``: type of chart such as ``TASK_BY_PRIORITY``, ``CASES_BY_STATE``, ``CASES_BY_FINISHED_TASK``, ``CASES_BY_FINISHED_TIME``, ``TASK_BY_EXPIRY`` and ``ELAPSED_TIME_BY_CASE_CATEGORY``

      ``filter``: list filters apply for each chart. Please refer to :ref:`Portal.StatisticCharts <portal-statistic-charts>` setting for more information.


Custom columns
--------------

Axon Ivy supports custom fields for the task.
You can show them on the Task widget in form of a column.

More, you can predefine which column to show, and other attributes such as header,
filter, format. Below is a standard JSON of a custom column.

.. code-block:: html

   {
      ...
      
      "columns": [
         {
            "format": "string",
            "header": "cms:columns/custom/supplier",
            "field": "supplier",
            "style": "width: 110px"
         }
      ]
   }

..

Besides attributes explained in the previous section, a custom column has two differences:

   - ``format``: Type of custom column. There are four formats ``string``, ``text``, ``number``, and ``timestamp``.

   - ``field``: this attribute is the name of the task's custom field which will be used to get data for the column.

Filter conditions
-----------------

You can predefined filter conditions for most columns of the task widget.
Each column has different conditions, some columns only accept a list, some only accept
a string, and some only accept a string in a special format such as date-time.

Below is the list of filterable columns and their corresponding filter conditions.

   - ``activator``

      .. code-block:: html

         {
            ...
      
            "columns": [
               {
                  "field": "activator",
                  "filterList": ["PO","#peter"]
               }
            ]
         }

      ..

      This column only accepts a list of role names or usernames
      (if you want to filter by username, put a hashtag before the name)
      as filter conditions for the task's responsible username.
      If you define a string such as "#peter", the task widget will show tasks which
      responsible's username is "peter".

   - ``name``

      .. code-block:: html

         {
            ...
      
            "columns": [
               {
                  "field": "name",
                  "filter": "request"
               }
            ]
         }
      ..

      This column only accepts a string as the filter condition for the task name.
      If you define a string such as "request", the task widget will show tasks that
      contain the "request" word in its name.

   - ``description``

      .. code-block:: html

         {
            ...
      
            "columns": [
               {
                  "field": "description",
                  "filter": "request"
               }
            ]
         }

      ..

      This column only accepts a string as the filter condition for the task description.
      If you define a string such as "request", the task widget will show tasks that
      contain the "request" word in its description.

   - ``priority``

      .. code-block:: html

         {
            ...
      
            "columns": [
               {
                  "field": "priority",
                  "filterList": ["LOW","NORMAL"]
               }
            ]
         }

      ..

      This column only accepts a list of priorities' names as the filter condition.
      If you define a list of priorities in ``filterList``, the task widget will show
      tasks that have priority listed in ``filterList``.

      Refer to :dev-url:`Task Priority </doc/nightly/public-api/ch/ivyteam/ivy/workflow/WorkflowPriority.html>` for
      available task priorities.

   - ``state``

      .. code-block:: html

         {
            ...
      
            "columns": [
               {
                  "field": "state",
                  "filterList": ["CREATED","DONE"]
               },
            ]
         }
      ..

      This column  only accepts a list of task states' names as the filter condition.
      If you define a list of states in ``filterList``, the task widget will show
      tasks that have states listed in ``filterList``. 

      Refer to :dev-url:`Task States </doc/nightly/public-api/ch/ivyteam/ivy/workflow/TaskState.html>` for
      available task states.


   - ``startTimestamp``

      .. code-block:: html

         {
            ...
      
            "columns": [
               {
                  "field": "startTimestamp",
                  "filterFrom": "04/11/2021",
                  "filterTo": "05/28/2021"
               },
            ]
         }

      ..

      This column accepts 2 filter conditions ``filterFrom`` and ``filterTo`` as boundaries
      of a range of dates. If you define dates for ``filterFrom`` and ``filterTo``,
      the task widget will show tasks have created dates between the dates defined.

      Acceptable date formats: ``dd.MM.yyyy`` and ``MM/dd/yyyy``.

   - ``expiryTimestamp``

      .. code-block:: html

         {
            ...
      
            "columns": [
               {
                  "field": "expiryTimestamp",
                  "filterFrom": "04/11/2021",
                  "filterTo": "05/28/2021"
               },
            ]
         }

      ..

      This column accepts 2 filter conditions ``filterFrom`` and ``filterTo`` as boundaries
      of a range of dates. If you define dates for ``filterFrom`` and ``filterTo``,
      the task widget will show tasks have expiry dates between the dates defined.

      Acceptable date formats: ``dd.MM.yyyy`` and ``MM/dd/yyyy``.
