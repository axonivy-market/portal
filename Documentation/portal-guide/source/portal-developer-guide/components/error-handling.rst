.. _components-error-handling:

Error Handling
==============

In this section, we introduce some kinds of errors, and describe when and how to
handle them in Portal.

-  Ajax error: this kind of error occurs during a JSF ajax request,
   for example when the user clicks on the show full mode button to tell
   the task widget to switch to full mode. Without error handling, the end user
   would not get any form of feedback if the action has been performed successfully or not.

-  Non-ajax error: this kind of errors occurs when the user accesses the Portal
   from a URL that could not be handled successfully by the server side, or
   being navigated by a corrupt URL. For example, when the user clicks
   on a link to start a task that does not exist.

-  View expire error: this kind of errors occurs when a user submits a request for a page 
   that no longer has an active view in the session or user session has expired.

.. _components-error-handling-ajax-error-handling:

Ajax Error Handling
-------------------

.. _components-error-handling-ajax-error-handling-introduction:

Introduction
^^^^^^^^^^^^

By default, Portal handles all exceptions generated by ajax requests.

When an exception occurs, the Portal shows an error notification with the
exception type and message to the end user. The exception details are available
when the user clicks on the ``More`` link in the red error message.

The display of Stacktraces is controlled by the Ivy system property
``Errors.ShowDetailsToEndUser``.

.. note:: 

      This feature is only available if using the Portal default template
      (``BasicTemplate``) or a version extended from it.

.. _components-error-handling-ajax-error-handling-result:

Result
^^^^^^

|portal-ajax-error-handler|

.. _components-error-handling-nonajax-error-handling:

Non-Ajax Error Handling
-----------------------

.. _components-error-handling-nonajax-error-handling-introduction:

Introduction
^^^^^^^^^^^^

By default, when the server encounters an error such as ``HTTP 404``,
``HTTP 500`` or an exception while loading a page, the |ivy-engine| will show
a default error page. E.g.:

|default-ivy-error|

You can find the contents of this page in the file located at
``${AxonIvyEngineFolder}/webapp/ivy/ivy-error-page.xhtml``, but the error page
is not user friendly. Thus, the |ivy| Portal provides an alternative solution
to make this page more understandable for end users.

.. _components-error-handling-nonajax-error-handling-howtoconfigure:

How to Configure
^^^^^^^^^^^^^^^^

Download the zip file below to configure on your engine (or designer).

.. important:: Read README.txt

:download:`PortalErrorPageConfiguration.zip <documents/error-handling/portal-error-page-configuration.zip>` 

.. _components-error-handling-nonajax-error-handling-result:

Result
^^^^^^

HTTP 404 Page Not Found

Example testing URL: 404

|404|

HTTP 500 Error

Example testing URL: 500

|500|


Customize View Expired Dialog
-----------------------------

.. _components-error-handling-customize-view-expired-dialog:

When a ``ViewExpiredException`` occurs, a warning will appear. By default, Ivy already has a handler for this exception, and you can customize the dialog in ``webContent\layouts\includes\exception.xhtml``.

If you're using the Portal, the Portal also provides a customized dialog for this exception. To use it, please change the ``onexception`` callback to:

.. code-block:: javascript

    parent.PF('view-expired-exception-dialog').show()

If your application uses both with and without the Portal, and your default dialog is ``viewExpiredExceptionDialog``, here is an example code snippet:

.. code-block:: xml

    <p:ajaxExceptionHandler
        type="javax.faces.application.ViewExpiredException"
        update="viewExpiredExceptionDialog"
        onexception="parent.PF &amp;&amp; parent.PF('view-expired-exception-dialog') ? 
            parent.PF('view-expired-exception-dialog').show() : 
            PF('viewExpiredExceptionDialog').show()" 
    />


.. |portal-ajax-error-handler| image:: ../../screenshots/error-handling/portal-ajax-error-handler.png
.. |default-ivy-error| image:: ../../screenshots/error-handling/default-ivy-error.png
.. |404| image:: ../../screenshots/error-handling/404.png
.. |500| image:: ../../screenshots/error-handling/500.png

