[Ivy]
164211FF9482BB44 9.2.0 #module
>Proto >Proto Collection #zClass
Pt0 InternalSupportPortalStart Big #zClass
Pt0 B #cInfo
Pt0 #process
Bk1 BpmnUserTask Big #zClass
Bk1 B #cInfo
Bk2 BpmnUserTask Big #zClass
Bk2 B #cInfo
Bk3 BpmnUserTask Big #zClass
Bk3 B #cInfo
Bk4 BpmnUserTask Big #zClass
Bk4 B #cInfo
Bk5 BpmnUserTask Big #zClass
Bk5 B #cInfo
Bk10 BpmnServiceTask Big #zClass
Bk10 B #cInfo
Pt0 @TextInP .type .type #zField
Pt0 @TextInP .processKind .processKind #zField
Pt0 @AnnotationInP-0n ai ai #zField
Pt0 @MessageFlowInP-0n messageIn messageIn #zField
Pt0 @MessageFlowOutP-0n messageOut messageOut #zField
Pt0 @TextInP .xml .xml #zField
Pt0 @TextInP .responsibility .responsibility #zField
Pt0 @UserDialog f53 '' #zField
Pt0 @StartRequest f10 '' #zField
Pt0 Bk1 S41 'Sub 4' #zField
Pt0 @InfoButton f85 '' #zField
Pt0 @Alternative f47 '' #zField
Pt0 @StartRequest f70 '' #zField
Pt0 Bk2 S11 'Sub 1' #zField
Pt0 @GridStep f83 '' #zField
Pt0 @UserDialog f71 '' #zField
Pt0 Bk3 S21 'Sub 2' #zField
Pt0 @StartRequest f73 '' #zField
Pt0 @CallSub f4 '' #zField
Pt0 Bk4 S61 'Sub 6' #zField
Pt0 @StartRequest f76 '' #zField
Pt0 @StartRequest f14 '' #zField
Pt0 Bk5 S31 'Sub 3' #zField
Pt0 @UserDialog f74 '' #zField
Pt0 @InfoButton f3 '' #zField
Pt0 @StartRequest f63 '' #zField
Pt0 @GridStep f7 '' #zField
Pt0 @StartRequest f103 '' #zField
Pt0 @StartRequest f60 '' #zField
Pt0 @EndTask f57 '' #zField
Pt0 @StartRequest f72 '' #zField
Pt0 @StartRequest f28 '' #zField
Pt0 @EndTask f34 '' #zField
Pt0 @UserDialog f75 '' #zField
Pt0 @StartRequest f38 '' #zField
Pt0 @UserDialog f32 '' #zField
Pt0 @UserDialog f12 '' #zField
Pt0 @Alternative f5 '' #zField
Pt0 @EndTask f45 '' #zField
Pt0 @UserDialog f44 '' #zField
Pt0 @GridStep f37 '' #zField
Pt0 @CallSub f9 '' #zField
Pt0 @EndTask f105 '' #zField
Pt0 @Alternative f1 '' #zField
Pt0 @GridStep f86 '' #zField
Pt0 @StartRequest f82 '' #zField
Pt0 @GridStep f51 '' #zField
Pt0 @StartRequest f58 '' #zField
Pt0 @StartRequest f68 '' #zField
Pt0 @GridStep f11 '' #zField
Pt0 @GridStep f80 '' #zField
Pt0 @UserDialog f84 '' #zField
Pt0 @Alternative f0 '' #zField
Pt0 @StartRequest f39 '' #zField
Pt0 @CallSub f59 '' #zField
Pt0 @StartRequest f62 '' #zField
Pt0 @CallSub f67 '' #zField
Pt0 @CallSub f65 '' #zField
Pt0 Bk10 S51 'Sub 5' #zField
Pt0 @Alternative f81 '' #zField
Pt0 @EndTask f64 '' #zField
Pt0 @PushWFArc f24 '' #zField
Pt0 @PushWFArc f42 '' #zField
Pt0 @PushWFArc f88 '' #zField
Pt0 @PushWFArc f48 '' #zField
Pt0 @PushWFArc f29 '' #zField
Pt0 @PushWFArc f20 '' #zField
Pt0 @PushWFArc f46 '' #zField
Pt0 @PushWFArc f23 '' #zField
Pt0 @PushWFArc f50 '' #zField
Pt0 @PushWFArc f77 '' #zField
Pt0 @PushWFArc f66 '' #zField
Pt0 @PushWFArc f18 '' #zField
Pt0 @PushWFArc f90 '' #zField
Pt0 @PushWFArc f33 '' #zField
Pt0 @PushWFArc f21 '' #zField
Pt0 @PushWFArc f2 '' #zField
Pt0 @PushWFArc f52 '' #zField
Pt0 @PushWFArc f27 '' #zField
Pt0 @PushWFArc f61 '' #zField
Pt0 @PushWFArc f26 '' #zField
Pt0 @PushWFArc f69 '' #zField
Pt0 @PushWFArc f16 '' #zField
Pt0 @PushWFArc f40 '' #zField
Pt0 @PushWFArc f19 '' #zField
Pt0 @PushWFArc f41 '' #zField
Pt0 @PushWFArc f91 '' #zField
Pt0 @PushWFArc f30 '' #zField
Pt0 @PushWFArc f25 '' #zField
Pt0 @PushWFArc f79 '' #zField
Pt0 @PushWFArc f93 '' #zField
Pt0 @PushWFArc f92 '' #zField
Pt0 @PushWFArc f15 '' #zField
Pt0 @PushWFArc f49 '' #zField
Pt0 @PushWFArc f55 '' #zField
Pt0 @PushWFArc f31 '' #zField
Pt0 @PushWFArc f87 '' #zField
Pt0 @PushWFArc f13 '' #zField
Pt0 @PushWFArc f17 '' #zField
Pt0 @PushWFArc f35 '' #zField
Pt0 @PushWFArc f78 '' #zField
Pt0 @PushWFArc f89 '' #zField
>Proto Pt0 Pt0 InternalSupportPortalStart #zField
Bk1 @TextInP .type .type #zField
Bk1 @TextInP .processKind .processKind #zField
Bk1 @TextInP .xml .xml #zField
Bk1 @TextInP .responsibility .responsibility #zField
Bk1 @GridStep f106 '' #zField
Bk1 @CallSub f104 '' #zField
Bk1 @PushWFArc f107 '' #zField
Bk1 @PushTrueWFInG-01 g0 '' #zField
Bk1 @PushWFArc f0 '' #zField
Bk1 @PushTrueWFOutG-01 g1 '' #zField
Bk1 @PushWFArc f1 '' #zField
>Proto Bk1 Bk0 BpmnUserTask #zField
Bk2 @TextInP .type .type #zField
Bk2 @TextInP .processKind .processKind #zField
Bk2 @TextInP .xml .xml #zField
Bk2 @TextInP .responsibility .responsibility #zField
Bk2 @GridStep f17 '' #zField
Bk2 @GridStep f68 '' #zField
Bk2 @GridStep f52 '' #zField
Bk2 @GridStep f19 '' #zField
Bk2 @CallSub f37 '' #zField
Bk2 @Alternative f0 '' #zField
Bk2 @PushTrueWFInG-01 g0 '' #zField
Bk2 @CallSub f23 '' #zField
Bk2 @CallSub f6 '' #zField
Bk2 @CallSub f12 '' #zField
Bk2 @PushWFArc f42 '' #zField
Bk2 @PushWFArc f49 '' #zField
Bk2 @PushWFArc f26 '' #zField
Bk2 @PushWFArc f39 '' #zField
Bk2 @UserDialog f7 '' #zField
Bk2 @PushWFArc f8 '' #zField
Bk2 @PushWFArc f2 '' #zField
Bk2 @PushWFArc f3 '' #zField
Bk2 @PushWFArc f4 '' #zField
Bk2 @PushWFArc f5 '' #zField
Bk2 @PushWFArc f1 '' #zField
>Proto Bk2 Bk1 BpmnUserTask #zField
Bk3 @TextInP .type .type #zField
Bk3 @TextInP .processKind .processKind #zField
Bk3 @TextInP .xml .xml #zField
Bk3 @TextInP .responsibility .responsibility #zField
Bk3 @GridStep f69 '' #zField
Bk3 @PushWFArc f67 '' #zField
Bk3 @PushWFArc f118 '' #zField
Bk3 @CallSub f84 '' #zField
Bk3 @CallSub f73 '' #zField
Bk3 @PushTrueWFInG-01 g0 '' #zField
Bk3 @PushWFArc f0 '' #zField
Bk3 @PushTrueWFOutG-01 g1 '' #zField
Bk3 @PushWFArc f1 '' #zField
>Proto Bk3 Bk2 BpmnUserTask #zField
Bk4 @TextInP .type .type #zField
Bk4 @TextInP .processKind .processKind #zField
Bk4 @TextInP .xml .xml #zField
Bk4 @TextInP .responsibility .responsibility #zField
Bk4 @AnnotationArc f8 '' #zField
Bk4 @UserDialog f36 '' #zField
Bk4 @GridStep f22 '' #zField
Bk4 @Alternative f54 '' #zField
Bk4 @PushWFArc f43 '' #zField
Bk4 @PushWFArc f6 '' #zField
Bk4 @InfoButton f3 '' #zField
Bk4 @PushTrueWFInG-01 g0 '' #zField
Bk4 @GridStep f1 '' #zField
Bk4 @PushWFArc f2 '' #zField
Bk4 @PushWFArc f0 '' #zField
Bk4 @GridStep f4 '' #zField
Bk4 @PushWFArc f5 '' #zField
>Proto Bk4 Bk3 BpmnUserTask #zField
Bk5 @TextInP .type .type #zField
Bk5 @TextInP .processKind .processKind #zField
Bk5 @TextInP .xml .xml #zField
Bk5 @TextInP .responsibility .responsibility #zField
Bk5 @PushWFArc f60 '' #zField
Bk5 @PushWFArc f61 '' #zField
Bk5 @CallSub f62 '' #zField
Bk5 @GridStep f59 '' #zField
Bk5 @CallSub f55 '' #zField
Bk5 @PushTrueWFInG-01 g0 '' #zField
Bk5 @PushWFArc f0 '' #zField
Bk5 @PushTrueWFOutG-01 g1 '' #zField
Bk5 @PushWFArc f1 '' #zField
>Proto Bk5 Bk4 BpmnUserTask #zField
Bk10 @TextInP .type .type #zField
Bk10 @TextInP .processKind .processKind #zField
Bk10 @TextInP .xml .xml #zField
Bk10 @TextInP .responsibility .responsibility #zField
Bk10 @GridStep f51 '' #zField
Bk10 @GridStep f20 '' #zField
Bk10 @PushWFArc f14 '' #zField
Bk10 @PushTrueWFInG-01 g0 '' #zField
Bk10 @PushWFArc f0 '' #zField
Bk10 @PushTrueWFOutG-01 g1 '' #zField
Bk10 @PushWFArc f1 '' #zField
>Proto Bk10 Bk5 BpmnServiceTask #zField
Pt0 f53 dialogId ch.ivy.addon.portal.generic.PortalUrlCallback #txt
Pt0 f53 startMethod start(String) #txt
Pt0 f53 requestActionDecl '<String callbackUrl> param;' #txt
Pt0 f53 requestMappingAction 'param.callbackUrl=in.callbackUrl;
' #txt
Pt0 f53 responseMappingAction 'out=in;
' #txt
Pt0 f53 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Redirect to&#13;
callbackUrl</name>
    </language>
</elementInfo>
' #txt
Pt0 f53 552 746 112 44 -30 -16 #rect
Pt0 f53 @|UserDialogIcon #fIcon
Pt0 f10 outLink DefaultEndPage.ivp #txt
Pt0 f10 inParamDecl '<Number endedTaskId> param;' #txt
Pt0 f10 inParamTable 'out.endedTaskId=param.endedTaskId;
' #txt
Pt0 f10 requestEnabled true #txt
Pt0 f10 triggerEnabled false #txt
Pt0 f10 callSignature DefaultEndPage(Number) #txt
Pt0 f10 persist false #txt
Pt0 f10 taskData 'TaskTriggered.EXPRI=2
TaskTriggered.EXROL=Everybody
TaskTriggered.EXTYPE=0
TaskTriggered.PRI=2
TaskTriggered.ROL=Everybody
TaskTriggered.TYPE=0' #txt
Pt0 f10 caseData businessCase.attach=true #txt
Pt0 f10 showInStartList 0 #txt
Pt0 f10 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>DefaultEndPage.ivp</name>
    </language>
</elementInfo>
' #txt
Pt0 f10 @C|.responsibility Everybody #txt
Pt0 f10 83 180 26 26 -46 17 #rect
Pt0 f10 @|StartRequestIcon #fIcon
Pt0 S41 .xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language lang="en">
        <name>Case Details Page</name>
    </language>
</elementInfo>
' #txt
Pt0 S41 192 554 112 44 -49 -8 #rect
Pt0 S41 @|BpmnUserTaskIcon #fIcon
Pt0 f85 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>If open a process/start in "embedInFrame" mode (add to url embedInFrame parameter), &#13;
DefaultFramePage process will run</name>
    </language>
</elementInfo>
' #txt
Pt0 f85 64 1498 464 44 -228 -16 #rect
Pt0 f85 @|IBIcon #fIcon
Pt0 f47 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Is first task?</name>
    </language>
</elementInfo>
' #txt
Pt0 f47 472 176 32 32 -25 -43 #rect
Pt0 f47 @|AlternativeIcon #fIcon
Pt0 f70 outLink StatisticPage.ivp #txt
Pt0 f70 inParamDecl '<> param;' #txt
Pt0 f70 requestEnabled true #txt
Pt0 f70 triggerEnabled false #txt
Pt0 f70 callSignature StatisticPage() #txt
Pt0 f70 persist false #txt
Pt0 f70 taskData 'TaskTriggered.EXPRI=2
TaskTriggered.EXROL=Everybody
TaskTriggered.EXTYPE=0
TaskTriggered.PRI=2
TaskTriggered.ROL=Everybody
TaskTriggered.TYPE=0' #txt
Pt0 f70 caseData businessCase.attach=true #txt
Pt0 f70 showInStartList 0 #txt
Pt0 f70 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>StatisticPage.ivp</name>
    </language>
</elementInfo>
' #txt
Pt0 f70 @C|.responsibility Everybody #txt
Pt0 f70 81 658 30 30 -46 17 #rect
Pt0 f70 @|StartRequestIcon #fIcon
Pt0 S11 .xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language lang="en">
        <name>Open previous&#13;
page before finish task</name>
    </language>
</elementInfo>
' #txt
Pt0 S11 1192 168 160 48 -58 -20 #rect
Pt0 S11 @|BpmnUserTaskIcon #fIcon
Pt0 f83 actionTable 'out=in;
' #txt
Pt0 f83 actionCode 'import ch.ivyteam.ivy.workflow.ITask;
import ch.ivyteam.ivy.bpm.error.BpmError;

ITask task = ivy.wf.findTask(in.endedTaskId);
if (!in.callbackUrl.startsWith("/" + task.getApplication().getName() + "/")) {
  BpmError.create("frame:unsupported:url").withMessage("only relative urls are supported (security reasons)").throwError();
}' #txt
Pt0 f83 security system #txt
Pt0 f83 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Check if url is valid</name>
    </language>
</elementInfo>
' #txt
Pt0 f83 168 1418 112 44 -51 -8 #rect
Pt0 f83 @|StepIcon #fIcon
Pt0 f71 dialogId ch.ivy.addon.portal.generic.Processes #txt
Pt0 f71 startMethod start() #txt
Pt0 f71 requestActionDecl '<> param;' #txt
Pt0 f71 responseMappingAction 'out=in;
' #txt
Pt0 f71 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>processes</name>
    </language>
</elementInfo>
' #txt
Pt0 f71 192 1130 112 44 -29 -8 #rect
Pt0 f71 @|UserDialogIcon #fIcon
Pt0 S21 .xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language lang="en">
        <name>Task List Page</name>
    </language>
</elementInfo>
' #txt
Pt0 S21 192 458 112 44 -39 -8 #rect
Pt0 S21 @|BpmnUserTaskIcon #fIcon
Pt0 f73 outLink Error404Page.ivp #txt
Pt0 f73 inParamDecl '<> param;' #txt
Pt0 f73 requestEnabled true #txt
Pt0 f73 triggerEnabled false #txt
Pt0 f73 callSignature Error404Page() #txt
Pt0 f73 caseData businessCase.attach=true #txt
Pt0 f73 showInStartList 0 #txt
Pt0 f73 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Error404Page.ivp</name>
    </language>
</elementInfo>
' #txt
Pt0 f73 @C|.responsibility Everybody #txt
Pt0 f73 81 1329 30 30 -39 17 #rect
Pt0 f73 @|StartRequestIcon #fIcon
Pt0 f4 processCall 'Functional Processes/InitializeTaskDataModel:call()' #txt
Pt0 f4 requestActionDecl '<> param;' #txt
Pt0 f4 responseActionDecl 'ch.ivy.addon.portal.generic.PortalStartData out;
' #txt
Pt0 f4 responseMappingAction 'out=in;
out.dataModel=result.dataModel;
' #txt
Pt0 f4 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>InitializeTaskDataModel</name>
        <nameStyle>23,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Pt0 f4 576 170 144 44 -65 -8 #rect
Pt0 f4 @|CallSubIcon #fIcon
Pt0 S61 .xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language lang="en">
        <name>Open selected &#13;
homepage</name>
    </language>
</elementInfo>
' #txt
Pt0 S61 1192 74 112 44 -39 -20 #rect
Pt0 S61 @|BpmnUserTaskIcon #fIcon
Pt0 f76 outLink DefaultProcessStartListPage.ivp #txt
Pt0 f76 inParamDecl '<> param;' #txt
Pt0 f76 requestEnabled true #txt
Pt0 f76 triggerEnabled false #txt
Pt0 f76 callSignature DefaultProcessStartListPage() #txt
Pt0 f76 persist false #txt
Pt0 f76 taskData 'TaskTriggered.EXPRI=2
TaskTriggered.EXROL=Everybody
TaskTriggered.EXTYPE=0
TaskTriggered.PRI=2
TaskTriggered.ROL=Everybody
TaskTriggered.TYPE=0' #txt
Pt0 f76 caseData businessCase.attach=true #txt
Pt0 f76 showInStartList 0 #txt
Pt0 f76 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>DefaultProcessStartListPage.ivp</name>
    </language>
</elementInfo>
' #txt
Pt0 f76 @C|.responsibility Everybody #txt
Pt0 f76 81 1137 30 30 -60 17 #rect
Pt0 f76 @|StartRequestIcon #fIcon
Pt0 f14 outLink BackFromTaskDetails.ivp #txt
Pt0 f14 inParamDecl '<Number endedTaskId> param;' #txt
Pt0 f14 inParamTable 'out.backFromTaskDetails=true;
out.endedTaskId=param.endedTaskId;
' #txt
Pt0 f14 requestEnabled true #txt
Pt0 f14 triggerEnabled false #txt
Pt0 f14 callSignature BackFromTaskDetails(Number) #txt
Pt0 f14 caseData businessCase.attach=true #txt
Pt0 f14 showInStartList 0 #txt
Pt0 f14 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>BackFromTaskDetails.ivp</name>
    </language>
</elementInfo>
' #txt
Pt0 f14 @C|.responsibility Everybody #txt
Pt0 f14 81 273 30 30 -44 16 #rect
Pt0 f14 @|StartRequestIcon #fIcon
Pt0 S31 .xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language lang="en">
        <name>Case List Page</name>
    </language>
</elementInfo>
' #txt
Pt0 S31 192 362 112 44 -40 -8 #rect
Pt0 S31 @|BpmnUserTaskIcon #fIcon
Pt0 f74 dialogId ch.ivy.addon.portal.error.ErrorPage #txt
Pt0 f74 startMethod start(String) #txt
Pt0 f74 requestActionDecl '<String errorCode> param;' #txt
Pt0 f74 requestMappingAction 'param.errorCode="500";
' #txt
Pt0 f74 responseMappingAction 'out=in;
' #txt
Pt0 f74 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>ErrorPage</name>
    </language>
</elementInfo>
' #txt
Pt0 f74 192 1226 112 44 -27 -8 #rect
Pt0 f74 @|UserDialogIcon #fIcon
Pt0 f3 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Replace by customized &#13;
homepage if you have</name>
    </language>
</elementInfo>
' #txt
Pt0 f3 1352 74 144 44 -63 -16 #rect
Pt0 f3 @|IBIcon #fIcon
Pt0 f63 outLink DefaultTaskListPage.ivp #txt
Pt0 f63 inParamDecl '<> param;' #txt
Pt0 f63 requestEnabled true #txt
Pt0 f63 triggerEnabled false #txt
Pt0 f63 callSignature DefaultTaskListPage() #txt
Pt0 f63 persist false #txt
Pt0 f63 taskData 'TaskTriggered.EXPRI=2
TaskTriggered.EXROL=Everybody
TaskTriggered.EXTYPE=0
TaskTriggered.PRI=2
TaskTriggered.ROL=Everybody
TaskTriggered.TYPE=0' #txt
Pt0 f63 caseData businessCase.attach=true #txt
Pt0 f63 showInStartList 0 #txt
Pt0 f63 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>DefaultTaskListPage.ivp</name>
    </language>
</elementInfo>
' #txt
Pt0 f63 @C|.responsibility Everybody #txt
Pt0 f63 81 465 30 30 -50 17 #rect
Pt0 f63 @|StartRequestIcon #fIcon
Pt0 f7 actionTable 'out=in;
' #txt
Pt0 f7 actionCode 'import ch.ivy.addon.portalkit.enums.PortalPage;
import ch.ivy.addon.portalkit.datamodel.TaskLazyDataModel;

if(in.#portalPage == PortalPage.HOME_PAGE) {
	in.dataModel.compactMode = true;
}' #txt
Pt0 f7 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Set compactMode&#13;
DataModel</name>
    </language>
</elementInfo>
' #txt
Pt0 f7 776 170 128 44 -44 -16 #rect
Pt0 f7 @|StepIcon #fIcon
Pt0 f103 outLink CaseDetailsPage.ivp #txt
Pt0 f103 inParamDecl '<Long caseId> param;' #txt
Pt0 f103 inParamTable 'out.caseId=param.caseId;
' #txt
Pt0 f103 requestEnabled true #txt
Pt0 f103 triggerEnabled false #txt
Pt0 f103 callSignature CaseDetailsPage(Long) #txt
Pt0 f103 persist false #txt
Pt0 f103 caseData businessCase.attach=true #txt
Pt0 f103 showInStartList 0 #txt
Pt0 f103 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>CaseDetailsPage.ivp</name>
    </language>
</elementInfo>
' #txt
Pt0 f103 @C|.responsibility Everybody #txt
Pt0 f103 81 561 30 30 -58 19 #rect
Pt0 f103 @|StartRequestIcon #fIcon
Pt0 f60 outLink RelatedTasksOfCasePage.ivp #txt
Pt0 f60 inParamDecl '<Long caseId,Boolean isBusinessCase,String caseName> param;' #txt
Pt0 f60 inParamTable 'out.caseId=param.caseId;
out.caseName=param.caseName;
out.isBusinessCase=param.isBusinessCase;
' #txt
Pt0 f60 requestEnabled true #txt
Pt0 f60 triggerEnabled false #txt
Pt0 f60 callSignature RelatedTasksOfCasePage(Long,Boolean,String) #txt
Pt0 f60 caseData businessCase.attach=true #txt
Pt0 f60 showInStartList 0 #txt
Pt0 f60 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>RelatedTasksOfCasePage.ivp</name>
    </language>
</elementInfo>
' #txt
Pt0 f60 @C|.responsibility Everybody #txt
Pt0 f60 81 849 30 30 -57 17 #rect
Pt0 f60 @|StartRequestIcon #fIcon
Pt0 f57 369 370 30 30 0 15 #rect
Pt0 f57 @|EndIcon #fIcon
Pt0 f72 outLink Error500Page.ivp #txt
Pt0 f72 inParamDecl '<> param;' #txt
Pt0 f72 requestEnabled true #txt
Pt0 f72 triggerEnabled false #txt
Pt0 f72 callSignature Error500Page() #txt
Pt0 f72 caseData businessCase.attach=true #txt
Pt0 f72 showInStartList 0 #txt
Pt0 f72 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Error500Page.ivp</name>
    </language>
</elementInfo>
' #txt
Pt0 f72 @C|.responsibility Everybody #txt
Pt0 f72 81 1233 30 30 -44 17 #rect
Pt0 f72 @|StartRequestIcon #fIcon
Pt0 f28 outLink DefaultApplicationHomePage.ivp #txt
Pt0 f28 inParamDecl '<> param;' #txt
Pt0 f28 requestEnabled true #txt
Pt0 f28 triggerEnabled false #txt
Pt0 f28 callSignature DefaultApplicationHomePage() #txt
Pt0 f28 persist false #txt
Pt0 f28 startName <%=ivy.cms.co("/Processes/portalHome")%> #txt
Pt0 f28 taskData 'TaskTriggered.CATEGORY=<%\=ivy.cms.co("/Processes/Cases/PortalCategory")%>
TaskTriggered.DESC=<%\=ivy.cms.co("/Processes/Cases/PortalInternalProcess/PortalInternalProcessDescription")%>
TaskTriggered.EXPRI=2
TaskTriggered.EXROL=Everybody
TaskTriggered.EXTYPE=0
TaskTriggered.NAM=<%\=ivy.cms.co("/Processes/Cases/PortalCategory")%>\: <%\=ivy.cms.co("/Processes/portalSettingSaved")%>
TaskTriggered.PRI=2
TaskTriggered.ROL=Everybody
TaskTriggered.TYPE=0' #txt
Pt0 f28 caseData 'businessCase.attach=true
case.category=<%\=ivy.cms.co("/Processes/Cases/PortalCategory")%>
case.description=<%\=ivy.cms.co("/Processes/Cases/PortalInternalProcess/PortalInternalProcessDescription")%>
case.name=<%\=ivy.cms.co("/Processes/Cases/PortalCategory")%>\: <%\=ivy.cms.co("/Processes/portalSettingSaved")%>' #txt
Pt0 f28 showInStartList 1 #txt
Pt0 f28 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>DefaultApplicationHomePage.ivp</name>
    </language>
</elementInfo>
' #txt
Pt0 f28 @C|.responsibility Everybody #txt
Pt0 f28 81 81 30 30 -81 19 #rect
Pt0 f28 @|StartRequestIcon #fIcon
Pt0 f34 369 657 30 30 0 15 #rect
Pt0 f34 @|EndIcon #fIcon
Pt0 f75 dialogId ch.ivy.addon.portal.error.ErrorPage #txt
Pt0 f75 startMethod start(String) #txt
Pt0 f75 requestActionDecl '<String errorCode> param;' #txt
Pt0 f75 requestMappingAction 'param.errorCode="404";
' #txt
Pt0 f75 responseMappingAction 'out=in;
' #txt
Pt0 f75 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>ErrorPage</name>
    </language>
</elementInfo>
' #txt
Pt0 f75 192 1322 112 44 -27 -8 #rect
Pt0 f75 @|UserDialogIcon #fIcon
Pt0 f38 outLink UserProfile.ivp #txt
Pt0 f38 inParamDecl '<> param;' #txt
Pt0 f38 requestEnabled true #txt
Pt0 f38 triggerEnabled false #txt
Pt0 f38 callSignature UserProfile() #txt
Pt0 f38 caseData 'businessCase.attach=true
customFields.STRING.embedInFrame="false"' #txt
Pt0 f38 wfuser 1 #txt
Pt0 f38 showInStartList 0 #txt
Pt0 f38 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>UserProfile.ivp</name>
    </language>
</elementInfo>
' #txt
Pt0 f38 @C|.responsibility Everybody #txt
Pt0 f38 81 1617 30 30 -21 17 #rect
Pt0 f38 @|StartRequestIcon #fIcon
Pt0 f32 dialogId ch.ivy.addon.portal.generic.admin.PortalDashBoard #txt
Pt0 f32 startMethod start() #txt
Pt0 f32 requestActionDecl '<> param;' #txt
Pt0 f32 responseMappingAction 'out=in;
' #txt
Pt0 f32 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>statistic</name>
    </language>
</elementInfo>
' #txt
Pt0 f32 192 651 112 44 -21 -8 #rect
Pt0 f32 @|UserDialogIcon #fIcon
Pt0 f12 dialogId ch.ivy.addon.portal.generic.PortalFinishTaskHandle #txt
Pt0 f12 startMethod start(Boolean) #txt
Pt0 f12 requestActionDecl '<Boolean isTaskFinished> param;' #txt
Pt0 f12 requestMappingAction 'param.isTaskFinished=in.isTaskFinished;
' #txt
Pt0 f12 responseMappingAction 'out=in;
' #txt
Pt0 f12 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Display growl message&#13;
after finish task</name>
    </language>
</elementInfo>
' #txt
Pt0 f12 936 170 144 44 -54 -16 #rect
Pt0 f12 @|UserDialogIcon #fIcon
Pt0 f5 1104 176 32 32 0 16 #rect
Pt0 f5 @|AlternativeIcon #fIcon
Pt0 f45 321 1617 30 30 0 15 #rect
Pt0 f45 @|EndIcon #fIcon
Pt0 f44 dialogId ch.ivy.addon.portalkit.settings.UserProfile #txt
Pt0 f44 startMethod start() #txt
Pt0 f44 requestActionDecl '<> param;' #txt
Pt0 f44 responseMappingAction 'out=in;
' #txt
Pt0 f44 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>UserProfile</name>
    </language>
</elementInfo>
' #txt
Pt0 f44 160 1610 112 44 -31 -8 #rect
Pt0 f44 @|UserDialogIcon #fIcon
Pt0 f37 actionTable 'out=in;
' #txt
Pt0 f37 actionCode 'import ch.ivy.addon.portalkit.enums.PortalLibrary;
import org.apache.commons.lang3.StringUtils;
import ch.ivyteam.ivy.workflow.StandardProcessType;

String library = PortalLibrary.PORTAL_TEMPLATE.getValue();

String defaultEndPage = ivy.wf.getStandardProcessImplementationLibrary(StandardProcessType.DEFAULT_PAGES_PROCESS_TYPES);
if (StringUtils.isBlank(defaultEndPage)) {
	ivy.wf.setStandardProcessImplementationLibrary(StandardProcessType.DEFAULT_PAGES_PROCESS_TYPES, library);
}' #txt
Pt0 f37 security system #txt
Pt0 f37 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Set default end page 
to Portal</name>
        <nameStyle>31,5
</nameStyle>
    </language>
</elementInfo>
' #txt
Pt0 f37 352 746 144 44 -53 -16 #rect
Pt0 f37 @|StepIcon #fIcon
Pt0 f9 processCall 'Functional Processes/InitializeTaskDataModel:call()' #txt
Pt0 f9 requestActionDecl '<> param;' #txt
Pt0 f9 responseActionDecl 'ch.ivy.addon.portal.generic.PortalStartData out;
' #txt
Pt0 f9 responseMappingAction 'out=in;
out.dataModel=result.dataModel;
out.dataModel.compactMode=true;
' #txt
Pt0 f9 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>InitializeTaskDataModel</name>
        <nameStyle>23,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Pt0 f9 320 74 144 44 -65 -8 #rect
Pt0 f9 @|CallSubIcon #fIcon
Pt0 f105 369 561 30 30 0 15 #rect
Pt0 f105 @|EndIcon #fIcon
Pt0 f1 376 176 32 32 0 16 #rect
Pt0 f1 @|AlternativeIcon #fIcon
Pt0 f86 actionTable 'out=in;
' #txt
Pt0 f86 actionCode 'import ch.ivy.addon.portalkit.service.IFrameService;
out.embedInIFrame = IFrameService.embedInFrame(in.endedTaskId);' #txt
Pt0 f86 security system #txt
Pt0 f86 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>get embedInIFrame setting</name>
    </language>
</elementInfo>
' #txt
Pt0 f86 344 1418 144 44 -69 -8 #rect
Pt0 f86 @|StepIcon #fIcon
Pt0 f82 outLink DefaultFramePage.ivp #txt
Pt0 f82 inParamDecl '<String relativeUrl,Number runningTaskId> param;' #txt
Pt0 f82 inParamTable 'out.callbackUrl=param.relativeUrl;
out.endedTaskId=param.runningTaskId;
' #txt
Pt0 f82 requestEnabled true #txt
Pt0 f82 triggerEnabled false #txt
Pt0 f82 callSignature DefaultFramePage(String,Number) #txt
Pt0 f82 caseData businessCase.attach=true #txt
Pt0 f82 showInStartList 0 #txt
Pt0 f82 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>DefaultFramePage.ivp</name>
    </language>
</elementInfo>
' #txt
Pt0 f82 @C|.responsibility Everybody #txt
Pt0 f82 81 1425 30 30 -48 16 #rect
Pt0 f82 @|StartRequestIcon #fIcon
Pt0 f51 actionTable 'out=in;
' #txt
Pt0 f51 actionCode 'import ch.ivy.addon.portalkit.enums.SessionAttribute;
import ch.ivy.addon.portalkit.util.SecurityServiceUtils;
SecurityServiceUtils.setSessionAttribute(SessionAttribute.PORTAL_START_PMV_ID.toString(), ivy.task.getProcessModelVersion().getId());
' #txt
Pt0 f51 security system #txt
Pt0 f51 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>store portal start &#xD;
pmv </name>
    </language>
</elementInfo>
' #txt
Pt0 f51 192 746 128 44 -43 -16 #rect
Pt0 f51 @|StepIcon #fIcon
Pt0 f58 outLink CaseListPage.ivp #txt
Pt0 f58 inParamDecl '<> param;' #txt
Pt0 f58 requestEnabled true #txt
Pt0 f58 triggerEnabled false #txt
Pt0 f58 callSignature CaseListPage() #txt
Pt0 f58 persist false #txt
Pt0 f58 taskData 'TaskTriggered.EXPRI=2
TaskTriggered.EXROL=Everybody
TaskTriggered.EXTYPE=0
TaskTriggered.PRI=2
TaskTriggered.ROL=Everybody
TaskTriggered.TYPE=0' #txt
Pt0 f58 caseData businessCase.attach=true #txt
Pt0 f58 showInStartList 0 #txt
Pt0 f58 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>CaseListPage.ivp</name>
    </language>
</elementInfo>
' #txt
Pt0 f58 @C|.responsibility Everybody #txt
Pt0 f58 81 370 30 30 -44 16 #rect
Pt0 f58 @|StartRequestIcon #fIcon
Pt0 f68 outLink GlobalSearchPage.ivp #txt
Pt0 f68 inParamDecl '<String keyword> param;' #txt
Pt0 f68 inParamTable 'out.keyword=param.keyword;
' #txt
Pt0 f68 requestEnabled true #txt
Pt0 f68 triggerEnabled false #txt
Pt0 f68 callSignature GlobalSearchPage(String) #txt
Pt0 f68 caseData businessCase.attach=true #txt
Pt0 f68 showInStartList 0 #txt
Pt0 f68 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>GlobalSearchPage.ivp</name>
    </language>
</elementInfo>
' #txt
Pt0 f68 @C|.responsibility Everybody #txt
Pt0 f68 81 1041 30 30 -57 17 #rect
Pt0 f68 @|StartRequestIcon #fIcon
Pt0 f11 actionTable 'out=in;
' #txt
Pt0 f11 actionCode 'import ch.ivy.addon.portalkit.constant.CustomFields;
import ch.ivy.addon.portalkit.dto.TaskEndInfo;
import ch.ivy.addon.portalkit.service.StickyTaskListService;
import ch.ivy.addon.portalkit.enums.SessionAttribute;
import ch.ivy.addon.portalkit.util.SecurityServiceUtils;
import ch.ivy.addon.portalkit.enums.PortalPage;
import org.apache.commons.lang3.StringUtils;
import ch.ivyteam.ivy.workflow.ITask;

ITask task = ivy.wf.findTask(in.endedTaskId);
in.isFirstTask = true;
in.portalPage = PortalPage.HOME_PAGE;

if (#task is initialized) {
	in.isTaskFinished = task.getEndTimestamp() is initialized;
	
	ITask taskWithTaskEndInfo = null;
	if (task.getStartSwitchEvent() is initialized) {
		taskWithTaskEndInfo = StickyTaskListService.service().getPreviousTaskWithTaskEndInfo(task);
	}

	if (#taskWithTaskEndInfo is initialized) {
		in.isFirstTask = false;
		String taskEndInfoSessionAttributeKey = StickyTaskListService.service().getTaskEndInfoSessionAttributeKey(taskWithTaskEndInfo.getId());
		TaskEndInfo taskEndInfo = SecurityServiceUtils.getSessionAttribute(taskEndInfoSessionAttributeKey) as TaskEndInfo;
			
		in.dataModel = taskEndInfo.dataModel;
		in.isTaskStartedInDetails = taskEndInfo.isStartedInTaskDetails;
		in.portalPage = taskEndInfo.portalPage;
		if (!in.isTaskStartedInDetails || in.backFromTaskDetails) {
			SecurityServiceUtils.removeSessionAttribute(taskEndInfoSessionAttributeKey);
		}
		
		if (in.isTaskFinished) {
			in.callbackUrl = taskWithTaskEndInfo.customFields().stringField(CustomFields.EXPRESS_END_PAGE_URL.toString()).getOrDefault("");
		}
	} 
} else {
	Boolean isTaskFinished = SecurityServiceUtils.getSessionAttribute(SessionAttribute.IS_TASK_FINISHED.toString()).toBoolean();
	in.isTaskFinished = #isTaskFinished is initialized ? isTaskFinished : true;
}

SecurityServiceUtils.removeSessionAttribute(SessionAttribute.IS_TASK_FINISHED.toString());
ivy.session.setAttribute(SessionAttribute.IS_TASK_STARTED_IN_DETAILS.toString(), in.isTaskStartedInDetails);' #txt
Pt0 f11 security system #txt
Pt0 f11 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Handle end page</name>
        <nameStyle>15
</nameStyle>
    </language>
</elementInfo>
' #txt
Pt0 f11 184 171 112 44 -47 -8 #rect
Pt0 f11 @|StepIcon #fIcon
Pt0 f80 actionTable 'out=in;
' #txt
Pt0 f80 actionCode 'import ch.ivy.addon.portalkit.util.RequestUtil;
RequestUtil.redirect(in.callbackUrl);' #txt
Pt0 f80 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Redirect to task start</name>
    </language>
</elementInfo>
' #txt
Pt0 f80 616 1514 112 44 -53 -8 #rect
Pt0 f80 @|StepIcon #fIcon
Pt0 f84 dialogId ch.ivy.addon.portal.generic.iframe.TaskTemplateIFrame #txt
Pt0 f84 startMethod start(String,Number) #txt
Pt0 f84 requestActionDecl '<String url,Number taskId> param;' #txt
Pt0 f84 requestMappingAction 'param.url=in.callbackUrl;
param.taskId=in.endedTaskId;
' #txt
Pt0 f84 responseMappingAction 'out=in;
' #txt
Pt0 f84 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>TaskTemplateIFrame</name>
    </language>
</elementInfo>
' #txt
Pt0 f84 616 1418 128 44 -55 -8 #rect
Pt0 f84 @|UserDialogIcon #fIcon
Pt0 f0 1104 80 32 32 0 16 #rect
Pt0 f0 @|AlternativeIcon #fIcon
Pt0 f39 outLink DefaultLoginPage.ivp #txt
Pt0 f39 inParamDecl '<String originalUrl> param;' #txt
Pt0 f39 inParamTable 'out.callbackUrl=param.#originalUrl is initialized ? param.originalUrl : null;
' #txt
Pt0 f39 requestEnabled true #txt
Pt0 f39 triggerEnabled false #txt
Pt0 f39 callSignature DefaultLoginPage(String) #txt
Pt0 f39 persist false #txt
Pt0 f39 taskData 'TaskTriggered.EXPRI=2
TaskTriggered.EXROL=Everybody
TaskTriggered.EXTYPE=0
TaskTriggered.PRI=2
TaskTriggered.ROL=Everybody
TaskTriggered.TYPE=0' #txt
Pt0 f39 caseData businessCase.attach=true #txt
Pt0 f39 showInStartList 0 #txt
Pt0 f39 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>DefaultLoginPage.ivp</name>
        <nameStyle>20,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Pt0 f39 @C|.responsibility Everybody #txt
Pt0 f39 81 753 30 30 -45 18 #rect
Pt0 f39 @|StartRequestIcon #fIcon
Pt0 f59 processCall 'Functional Processes/Navigator:viewTask(Long,ch.ivy.addon.portalkit.dto.GlobalCaseId,String)' #txt
Pt0 f59 requestActionDecl '<Long taskId,ch.ivy.addon.portalkit.dto.GlobalCaseId caseId,String caseName> param;' #txt
Pt0 f59 requestMappingAction 'param.caseId=ch.ivy.addon.portalkit.dto.GlobalCaseId.caseId(in.caseId).isBusinessCase(in.isBusinessCase).build();
param.caseName=in.caseName;
' #txt
Pt0 f59 responseMappingAction 'out=in;
' #txt
Pt0 f59 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Functional Processes/Navigator</name>
    </language>
</elementInfo>
' #txt
Pt0 f59 168 842 176 44 -83 -8 #rect
Pt0 f59 @|CallSubIcon #fIcon
Pt0 f62 outLink TaskDetailsPage.ivp #txt
Pt0 f62 inParamDecl '<Long selectedTaskId> param;' #txt
Pt0 f62 inParamTable 'out.selectedTaskId=param.selectedTaskId;
' #txt
Pt0 f62 requestEnabled true #txt
Pt0 f62 triggerEnabled false #txt
Pt0 f62 callSignature TaskDetailsPage(Long) #txt
Pt0 f62 caseData businessCase.attach=true #txt
Pt0 f62 showInStartList 0 #txt
Pt0 f62 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>TaskDetailsPage.ivp</name>
    </language>
</elementInfo>
' #txt
Pt0 f62 @C|.responsibility Everybody #txt
Pt0 f62 81 945 30 30 -57 17 #rect
Pt0 f62 @|StartRequestIcon #fIcon
Pt0 f67 processCall 'Functional Processes/OpenPortalSearch:call(String)' #txt
Pt0 f67 requestActionDecl '<String keyword> param;' #txt
Pt0 f67 requestMappingAction 'param.keyword=in.keyword;
' #txt
Pt0 f67 responseMappingAction 'out=in;
' #txt
Pt0 f67 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Functional Processes/OpenPortalSearch</name>
    </language>
</elementInfo>
' #txt
Pt0 f67 176 1034 224 44 -107 -8 #rect
Pt0 f67 @|CallSubIcon #fIcon
Pt0 f65 processCall 'Functional Processes/Navigator:viewRelatedTask(Long)' #txt
Pt0 f65 requestActionDecl '<Long taskId> param;' #txt
Pt0 f65 requestMappingAction 'param.taskId=in.selectedTaskId;
' #txt
Pt0 f65 responseMappingAction 'out=in;
' #txt
Pt0 f65 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Functional Processes/Navigator</name>
    </language>
</elementInfo>
' #txt
Pt0 f65 168 938 176 44 -83 -8 #rect
Pt0 f65 @|CallSubIcon #fIcon
Pt0 S51 .xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language lang="en">
        <name>Handle some settings</name>
    </language>
</elementInfo>
' #txt
Pt0 S51 160 74 128 44 -56 -8 #rect
Pt0 S51 @|BpmnServiceTaskIcon #fIcon
Pt0 f81 528 1424 32 32 0 16 #rect
Pt0 f81 @|AlternativeIcon #fIcon
Pt0 f64 369 465 30 30 0 15 #rect
Pt0 f64 @|EndIcon #fIcon
Pt0 f24 expr out #txt
Pt0 f24 110 384 192 384 #arcP
Pt0 f42 111 768 192 768 #arcP
Pt0 f88 280 1440 344 1440 #arcP
Pt0 f48 expr out #txt
Pt0 f48 109 193 184 193 #arcP
Pt0 f29 expr out #txt
Pt0 f29 111 96 160 96 #arcP
Pt0 f20 expr in #txt
Pt0 f20 outCond 'java.util.Objects.equals(ch.ivy.addon.portalkit.enums.PortalPage.HOME_PAGE, in.#portalPage) && org.apache.commons.lang3.StringUtils.isBlank(in.#callbackUrl)' #txt
Pt0 f20 1120 176 1120 112 #arcP
Pt0 f46 272 1632 321 1632 #arcP
Pt0 f23 111 288 240 215 #arcP
Pt0 f23 1 240 288 #addKink
Pt0 f23 0 0.7758746574460319 0 0 #arcLabel
Pt0 f50 expr in #txt
Pt0 f50 outCond 'in.#portalPage == null' #txt
Pt0 f50 .xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Start process/task&#13;
not in Portal</name>
    </language>
</elementInfo>
' #txt
Pt0 f50 392 176 392 118 #arcP
Pt0 f50 0 0.43103448275862066 13 0 #arcLabel
Pt0 f77 111 1248 192 1248 #arcP
Pt0 f66 111 960 168 960 #arcP
Pt0 f18 expr in #txt
Pt0 f18 1136 192 1192 192 #arcP
Pt0 f90 544 1456 616 1536 #arcP
Pt0 f90 1 544 1536 #addKink
Pt0 f90 1 0.1556203489120305 0 0 #arcLabel
Pt0 f33 111 673 192 673 #arcP
Pt0 f21 1080 192 1104 192 #arcP
Pt0 f2 296 193 376 192 #arcP
Pt0 f52 expr in #txt
Pt0 f52 outCond !in.backFromTaskDetails #txt
Pt0 f52 408 192 472 192 #arcP
Pt0 f27 304 576 369 576 #arcP
Pt0 f61 111 864 168 864 #arcP
Pt0 f26 expr out #txt
Pt0 f26 111 576 192 576 #arcP
Pt0 f69 111 1056 176 1056 #arcP
Pt0 f16 464 96 1104 96 #arcP
Pt0 f40 496 768 552 768 #arcP
Pt0 f19 expr in #txt
Pt0 f19 392 208 1120 208 #arcP
Pt0 f19 1 392 288 #addKink
Pt0 f19 2 1120 288 #addKink
Pt0 f41 expr out #txt
Pt0 f41 320 768 352 768 #arcP
Pt0 f91 488 1440 528 1440 #arcP
Pt0 f30 288 96 320 96 #arcP
Pt0 f25 304 384 369 384 #arcP
Pt0 f79 111 1152 192 1152 #arcP
Pt0 f93 111 1632 160 1632 #arcP
Pt0 f92 1136 96 1192 96 #arcP
Pt0 f15 expr out #txt
Pt0 f15 111 480 192 480 #arcP
Pt0 f49 expr in #txt
Pt0 f49 outCond in.isFirstTask #txt
Pt0 f49 .xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Yes</name>
    </language>
</elementInfo>
' #txt
Pt0 f49 504 192 576 192 #arcP
Pt0 f49 0 0.4861111111111111 0 -13 #arcLabel
Pt0 f55 expr in #txt
Pt0 f55 .xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>No</name>
    </language>
</elementInfo>
' #txt
Pt0 f55 488 208 840 214 #arcP
Pt0 f55 1 488 240 #addKink
Pt0 f55 2 840 240 #addKink
Pt0 f55 1 0.45170454545454547 0 10 #arcLabel
Pt0 f31 720 192 776 192 #arcP
Pt0 f87 expr in #txt
Pt0 f87 outCond in.embedInIFrame #txt
Pt0 f87 560 1440 616 1440 #arcP
Pt0 f13 904 192 936 192 #arcP
Pt0 f17 304 480 369 480 #arcP
Pt0 f35 304 673 369 672 #arcP
Pt0 f78 111 1344 192 1344 #arcP
Pt0 f89 111 1440 168 1440 #arcP
>Proto Pt0 .type ch.ivy.addon.portal.generic.PortalStartData #txt
>Proto Pt0 .processKind NORMAL #txt
>Proto Pt0 0 0 32 24 18 0 #rect
>Proto Pt0 @|BIcon #fIcon
Bk1 f106 actionTable 'out=in;
' #txt
Bk1 f106 actionCode 'import ch.ivyteam.ivy.workflow.ICase;
import ch.ivyteam.ivy.workflow.query.CaseQuery;

out.caseSelected = ivy.wf.getGlobalContext().getCaseQueryExecutor().getFirstResult(CaseQuery.create().where().caseId().isEqual(in.caseId)) as ICase;' #txt
Bk1 f106 security system #txt
Bk1 f106 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Find Case</name>
    </language>
</elementInfo>
' #txt
Bk1 f106 136 138 112 44 -28 -8 #rect
Bk1 f106 @|StepIcon #fIcon
Bk1 f104 processCall 'Functional Processes/OpenPortalCaseDetailsHook:call(ch.ivyteam.ivy.workflow.ICase,Boolean)' #txt
Bk1 f104 requestActionDecl '<ch.ivyteam.ivy.workflow.ICase caseData,Boolean isShowBackButton> param;' #txt
Bk1 f104 requestMappingAction 'param.caseData=in.caseSelected;
param.isShowBackButton=true;
' #txt
Bk1 f104 responseActionDecl 'ch.ivy.addon.portal.generic.PortalStartData out;
' #txt
Bk1 f104 responseMappingAction 'out=in;
' #txt
Bk1 f104 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>OpenPortalCaseDetails</name>
    </language>
</elementInfo>
' #txt
Bk1 f104 288 138 144 44 -65 -8 #rect
Bk1 f104 @|CallSubIcon #fIcon
Bk1 f107 expr out #txt
Bk1 f107 248 160 288 160 #arcP
Bk1 g0 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language lang="en">
        <name>in 1</name>
    </language>
</elementInfo>
' #txt
Bk1 g0 51 147 26 26 0 5 #rect
Bk1 g0 @|MIGIcon #fIcon
Bk1 f0 77 160 136 160 #arcP
Bk1 g1 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language lang="en">
        <name>out 1</name>
    </language>
</elementInfo>
' #txt
Bk1 g1 499 147 26 26 0 5 #rect
Bk1 g1 @|MOGIcon #fIcon
Bk1 f1 expr out #txt
Bk1 f1 432 160 499 160 #arcP
>Proto Bk0 0 0 32 24 18 0 #rect
>Proto Bk0 @|BIcon #fIcon
Bk2 f17 actionTable 'out=in;
' #txt
Bk2 f17 actionCode 'import ch.ivyteam.ivy.workflow.ITask;
import ch.ivyteam.ivy.workflow.ICase;
import ch.ivyteam.ivy.workflow.query.CaseQuery;

long caseId = -1;
if (in.endedTaskId is initialized) {
	ITask task = ivy.wf.findTask(in.endedTaskId);
	caseId = task.getCase().getId();
}
out.caseSelected = ivy.wf.getGlobalContext().getCaseQueryExecutor().getFirstResult(CaseQuery.create().where().caseId().isEqual(caseId)) as ICase;' #txt
Bk2 f17 security system #txt
Bk2 f17 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Find case</name>
    </language>
</elementInfo>
' #txt
Bk2 f17 352 266 112 44 -27 -8 #rect
Bk2 f17 @|StepIcon #fIcon
Bk2 f68 actionTable 'out=in;
' #txt
Bk2 f68 actionCode 'out.taskSelected = ivy.wf.findTask(in.endedTaskId);' #txt
Bk2 f68 security system #txt
Bk2 f68 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>find task by id</name>
    </language>
</elementInfo>
' #txt
Bk2 f68 352 170 112 44 -35 -8 #rect
Bk2 f68 @|StepIcon #fIcon
Bk2 f52 actionTable 'out=in;
' #txt
Bk2 f52 actionCode 'import ch.ivy.addon.portalkit.datamodel.CaseLazyDataModel;
import ch.ivy.addon.portalkit.datamodel.SearchResultsDataModel;

in.searchResultsDataModel = new SearchResultsDataModel();
in.searchResultsDataModel.taskDataModel = in.dataModel;
in.searchResultsDataModel.keyword = in.searchResultsDataModel.taskDataModel.criteria.keyword;
in.searchResultsDataModel.caseDataModel.notKeepFilter = true;
in.searchResultsDataModel.caseDataModel.getCriteria().keyword = in.searchResultsDataModel.taskDataModel.criteria.keyword;

' #txt
Bk2 f52 security system #txt
Bk2 f52 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>build data model</name>
        <nameStyle>16,5
</nameStyle>
    </language>
</elementInfo>
' #txt
Bk2 f52 352 458 112 44 -46 -8 #rect
Bk2 f52 @|StepIcon #fIcon
Bk2 f19 actionTable 'out=in;
' #txt
Bk2 f19 actionCode 'import ch.ivy.addon.portal.generic.view.TaskView;

boolean canLinkBackToCaseDetail = in.#dataModel.#criteria.#caseId is initialized; 
in.taskView = TaskView.create().dataModel(in.dataModel).canLinkBackCaseDetail(canLinkBackToCaseDetail).showHeaderToolbar(false).createNewTaskView();' #txt
Bk2 f19 security system #txt
Bk2 f19 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>build data model,
 task </name>
        <nameStyle>24,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Bk2 f19 352 356 128 56 -43 -16 #rect
Bk2 f19 @|StepIcon #fIcon
Bk2 f37 processCall 'Functional Processes/OpenPortalSearch:call(ch.ivy.addon.portalkit.datamodel.SearchResultsDataModel,Number)' #txt
Bk2 f37 requestActionDecl '<ch.ivy.addon.portalkit.datamodel.SearchResultsDataModel searchResultsDataModel,Number activeTabIndex> param;' #txt
Bk2 f37 requestMappingAction 'param.searchResultsDataModel=in.searchResultsDataModel;
param.activeTabIndex=1;
' #txt
Bk2 f37 responseActionDecl 'ch.ivy.addon.portal.generic.PortalStartData out;
' #txt
Bk2 f37 responseMappingAction 'out=in;
' #txt
Bk2 f37 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>OpenPortalSearch</name>
    </language>
</elementInfo>
' #txt
Bk2 f37 560 458 112 44 -50 -8 #rect
Bk2 f37 @|CallSubIcon #fIcon
Bk2 f0 208 80 32 32 0 16 #rect
Bk2 f0 @|AlternativeIcon #fIcon
Bk2 g0 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language lang="en">
        <name>in 1</name>
    </language>
</elementInfo>
' #txt
Bk2 g0 83 83 26 26 0 5 #rect
Bk2 g0 @|MIGIcon #fIcon
Bk2 f23 processCall 'Functional Processes/OpenPortalCaseDetailsHook:call(ch.ivyteam.ivy.workflow.ICase,Boolean)' #txt
Bk2 f23 requestActionDecl '<ch.ivyteam.ivy.workflow.ICase caseData,Boolean isShowBackButton> param;' #txt
Bk2 f23 requestMappingAction 'param.caseData=in.caseSelected;
param.isShowBackButton=true;
' #txt
Bk2 f23 responseActionDecl 'ch.ivy.addon.portal.generic.PortalStartData out;
' #txt
Bk2 f23 responseMappingAction 'out=in;
' #txt
Bk2 f23 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>OpenPortalCaseDetailHook</name>
        <nameStyle>24,5
</nameStyle>
    </language>
</elementInfo>
' #txt
Bk2 f23 544 266 160 44 -76 -8 #rect
Bk2 f23 @|CallSubIcon #fIcon
Bk2 f6 processCall 'Functional Processes/OpenPortalTaskDetailsHook:call(ch.ivyteam.ivy.workflow.ITask,ch.ivy.addon.portalkit.datamodel.TaskLazyDataModel,ch.ivy.addon.portalkit.enums.PortalPage,Boolean)' #txt
Bk2 f6 requestActionDecl '<ch.ivyteam.ivy.workflow.ITask task,ch.ivy.addon.portalkit.datamodel.TaskLazyDataModel dataModel,ch.ivy.addon.portalkit.enums.PortalPage portalPage,Boolean isFromTaskList> param;' #txt
Bk2 f6 requestMappingAction 'param.task=in.taskSelected;
param.dataModel=in.dataModel;
param.portalPage=in.portalPage;
param.isFromTaskList=false;
' #txt
Bk2 f6 responseActionDecl 'ch.ivy.addon.portal.generic.PortalStartData out;
' #txt
Bk2 f6 responseMappingAction 'out=in;
' #txt
Bk2 f6 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>OpenPortalTaskDetailsHook</name>
    </language>
</elementInfo>
' #txt
Bk2 f6 512 170 176 44 -78 -8 #rect
Bk2 f6 @|CallSubIcon #fIcon
Bk2 f12 processCall 'Functional Processes/OpenPortalTasks:useView(ch.ivy.addon.portal.generic.view.TaskView)' #txt
Bk2 f12 requestActionDecl '<ch.ivy.addon.portal.generic.view.TaskView taskView> param;' #txt
Bk2 f12 requestMappingAction 'param.taskView=in.taskView;
' #txt
Bk2 f12 responseActionDecl 'ch.ivy.addon.portal.generic.PortalStartData out;
' #txt
Bk2 f12 responseMappingAction 'out=in;
' #txt
Bk2 f12 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>OpenPortalTasks</name>
    </language>
</elementInfo>
' #txt
Bk2 f12 572 360 104 48 -46 -6 #rect
Bk2 f12 @|CallSubIcon #fIcon
Bk2 f42 expr out #txt
Bk2 f42 464 192 512 192 #arcP
Bk2 f42 0 0.075 -1 -9 #arcLabel
Bk2 f49 expr out #txt
Bk2 f49 464 480 560 480 #arcP
Bk2 f26 expr out #txt
Bk2 f26 464 288 544 288 #arcP
Bk2 f39 expr out #txt
Bk2 f39 480 384 572 384 #arcP
Bk2 f39 0 0.7418894103244236 0 0 #arcLabel
Bk2 f7 dialogId ch.ivy.addon.portal.generic.PortalUrlCallback #txt
Bk2 f7 startMethod start(String) #txt
Bk2 f7 requestActionDecl '<String callbackUrl> param;' #txt
Bk2 f7 requestMappingAction 'param.callbackUrl=in.callbackUrl;
' #txt
Bk2 f7 responseMappingAction 'out=in;
' #txt
Bk2 f7 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>PortalUrlCallback</name>
    </language>
</elementInfo>
' #txt
Bk2 f7 448 74 112 44 -45 -8 #rect
Bk2 f7 @|UserDialogIcon #fIcon
Bk2 f8 expr in #txt
Bk2 f8 outCond 'org.apache.commons.lang3.StringUtils.isNotBlank(in.#callbackUrl)' #txt
Bk2 f8 .xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Express end page</name>
    </language>
</elementInfo>
' #txt
Bk2 f8 240 96 448 96 #arcP
Bk2 f8 0 0.47115384615384615 0 -11 #arcLabel
Bk2 f2 expr in #txt
Bk2 f2 outCond 'in.isTaskStartedInDetails && !in.isTaskFinished && !in.backFromTaskDetails' #txt
Bk2 f2 230 106 352 192 #arcP
Bk2 f2 1 288 192 #addKink
Bk2 f2 0 0.770003174626784 0 0 #arcLabel
Bk2 f3 expr in #txt
Bk2 f3 outCond 'java.util.Objects.equals(ch.ivy.addon.portalkit.enums.PortalPage.CASE_DETAIL_FROM_TASK, in.#portalPage)' #txt
Bk2 f3 228 108 352 288 #arcP
Bk2 f3 1 288 288 #addKink
Bk2 f3 0 0.7110060291341136 0 0 #arcLabel
Bk2 f4 expr in #txt
Bk2 f4 outCond 'java.util.Objects.equals(ch.ivy.addon.portalkit.enums.PortalPage.TASK_LIST, in.#portalPage)' #txt
Bk2 f4 226 110 352 384 #arcP
Bk2 f4 1 256 384 #addKink
Bk2 f4 1 0.32297169520409286 0 0 #arcLabel
Bk2 f5 expr in #txt
Bk2 f5 224 112 352 480 #arcP
Bk2 f5 1 224 480 #addKink
Bk2 f5 1 0.32297169520409286 0 0 #arcLabel
Bk2 f1 109 96 208 96 #arcP
>Proto Bk1 0 0 32 24 18 0 #rect
>Proto Bk1 @|BIcon #fIcon
Bk3 f69 actionTable 'out=in;
' #txt
Bk3 f69 actionCode 'import ch.ivy.addon.portalkit.enums.TaskAssigneeType;
import ch.ivy.addon.portal.generic.view.TaskView;
import ch.ivy.addon.portalkit.util.PermissionUtils;

boolean hasReadAllTasksPermisson = PermissionUtils.checkReadAllTasksPermission();
in.dataModel.setAdminQuery(hasReadAllTasksPermisson);
in.dataModel.setTaskAssigneeType(TaskAssigneeType.ALL);

in.taskView = TaskView.create().dataModel(in.dataModel).noTaskFoundMessage("").showHeaderToolbar(false).createNewTaskView();
' #txt
Bk3 f69 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>build data model &#xD;
and task view</name>
        <nameStyle>32,5
</nameStyle>
    </language>
</elementInfo>
' #txt
Bk3 f69 296 136 112 48 -39 -16 #rect
Bk3 f69 @|StepIcon #fIcon
Bk3 f67 expr out #txt
Bk3 f67 408 160 492 160 #arcP
Bk3 f118 expr out #txt
Bk3 f118 248 160 296 160 #arcP
Bk3 f84 processCall 'Functional Processes/OpenPortalTasks:useView(ch.ivy.addon.portal.generic.view.TaskView)' #txt
Bk3 f84 requestActionDecl '<ch.ivy.addon.portal.generic.view.TaskView taskView> param;' #txt
Bk3 f84 requestMappingAction 'param.taskView=in.taskView;
' #txt
Bk3 f84 responseActionDecl 'ch.ivy.addon.portal.generic.PortalStartData out;
' #txt
Bk3 f84 responseMappingAction 'out=in;
' #txt
Bk3 f84 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>OpenPortalTasks</name>
        <nameStyle>15,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Bk3 f84 492 140 104 40 -48 -12 #rect
Bk3 f84 @|CallSubIcon #fIcon
Bk3 f73 processCall 'Functional Processes/InitializeTaskDataModel:call()' #txt
Bk3 f73 requestActionDecl '<> param;' #txt
Bk3 f73 responseActionDecl 'ch.ivy.addon.portal.generic.PortalStartData out;
' #txt
Bk3 f73 responseMappingAction 'out=in;
out.dataModel=result.dataModel;
' #txt
Bk3 f73 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Init data model</name>
        <nameStyle>15
</nameStyle>
    </language>
</elementInfo>
' #txt
Bk3 f73 136 138 112 44 -40 -8 #rect
Bk3 f73 @|CallSubIcon #fIcon
Bk3 g0 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language lang="en">
        <name>in 1</name>
    </language>
</elementInfo>
' #txt
Bk3 g0 51 147 26 26 0 5 #rect
Bk3 g0 @|MIGIcon #fIcon
Bk3 f0 77 160 136 160 #arcP
Bk3 g1 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language lang="en">
        <name>out 1</name>
    </language>
</elementInfo>
' #txt
Bk3 g1 659 147 26 26 0 5 #rect
Bk3 g1 @|MOGIcon #fIcon
Bk3 f1 expr out #txt
Bk3 f1 596 160 659 160 #arcP
>Proto Bk2 0 0 32 24 18 0 #rect
>Proto Bk2 @|BIcon #fIcon
Bk4 f8 696 160 664 160 #arcP
Bk4 f36 dialogId internalPortal.PortalHome #txt
Bk4 f36 startMethod start(ch.ivy.addon.portal.generic.view.TaskView) #txt
Bk4 f36 requestActionDecl '<ch.ivy.addon.portal.generic.view.TaskView taskView> param;' #txt
Bk4 f36 requestMappingAction 'param.taskView=in.taskView;
' #txt
Bk4 f36 responseMappingAction 'out=in;
' #txt
Bk4 f36 responseActionCode '
' #txt
Bk4 f36 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Portal Homepage</name>
    </language>
</elementInfo>
' #txt
Bk4 f36 552 138 112 44 -45 -8 #rect
Bk4 f36 @|UserDialogIcon #fIcon
Bk4 f22 actionTable 'out=in;
' #txt
Bk4 f22 actionCode 'import ch.ivy.addon.portal.generic.view.TaskView;

in.taskView = TaskView.create().dataModel(in.dataModel).showHeaderToolbar(true).noTaskFoundMessage("").createNewTaskView();
' #txt
Bk4 f22 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Build task view</name>
    </language>
</elementInfo>
' #txt
Bk4 f22 400 138 112 44 -38 -8 #rect
Bk4 f22 @|StepIcon #fIcon
Bk4 f54 272 144 32 32 0 16 #rect
Bk4 f54 @|AlternativeIcon #fIcon
Bk4 f43 512 160 552 160 #arcP
Bk4 f6 expr in #txt
Bk4 f6 outCond '!(in.#homepage is initialized) || in.homepage.#type == ch.addon.portal.generic.userprofile.homepage.HomepageType.DASHBOARD' #txt
Bk4 f6 .xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>dashboard</name>
    </language>
</elementInfo>
' #txt
Bk4 f6 304 160 400 160 #arcP
Bk4 f6 0 0.40625 0 -12 #arcLabel
Bk4 f3 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Replace by customized &#13;
homepage if you have</name>
    </language>
</elementInfo>
' #txt
Bk4 f3 696 138 144 44 -63 -16 #rect
Bk4 f3 @|IBIcon #fIcon
Bk4 g0 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language lang="en">
        <name>in 1</name>
    </language>
</elementInfo>
' #txt
Bk4 g0 51 147 26 26 0 5 #rect
Bk4 g0 @|MIGIcon #fIcon
Bk4 f1 actionTable 'out=in;
' #txt
Bk4 f1 actionCode 'import ch.addon.portal.generic.userprofile.homepage.HomepageUtils;
out.homepage = HomepageUtils.getHomepage();' #txt
Bk4 f1 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Get selected&#13;
homepage</name>
    </language>
</elementInfo>
' #txt
Bk4 f1 136 138 112 44 -33 -16 #rect
Bk4 f1 @|StepIcon #fIcon
Bk4 f2 77 160 136 160 #arcP
Bk4 f0 248 160 272 160 #arcP
Bk4 f4 actionTable 'out=in;
' #txt
Bk4 f4 actionCode 'import ch.ivy.addon.portalkit.util.RequestUtil;
RequestUtil.redirect(in.homepage.link);' #txt
Bk4 f4 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Redirect to &#13;
selected homepage</name>
    </language>
</elementInfo>
' #txt
Bk4 f4 344 234 128 44 -45 -16 #rect
Bk4 f4 @|StepIcon #fIcon
Bk4 f5 expr in #txt
Bk4 f5 .xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>others</name>
    </language>
</elementInfo>
' #txt
Bk4 f5 288 176 344 256 #arcP
Bk4 f5 1 288 256 #addKink
Bk4 f5 1 0.42857142857142855 0 -10 #arcLabel
>Proto Bk3 0 0 32 24 18 0 #rect
>Proto Bk3 @|BIcon #fIcon
Bk5 f60 expr out #txt
Bk5 f60 416 160 488 160 #arcP
Bk5 f61 expr out #txt
Bk5 f61 248 160 288 160 #arcP
Bk5 f62 processCall 'Functional Processes/InitializeCaseDataModel:call()' #txt
Bk5 f62 requestActionDecl '<> param;' #txt
Bk5 f62 responseActionDecl 'ch.ivy.addon.portal.generic.PortalStartData out;
' #txt
Bk5 f62 responseMappingAction 'out=in;
out.caseDataModel=result.caseDataModel;
' #txt
Bk5 f62 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Initialize case 
data model</name>
        <nameStyle>27,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Bk5 f62 136 138 112 44 -38 -20 #rect
Bk5 f62 @|CallSubIcon #fIcon
Bk5 f59 actionTable 'out=in;
' #txt
Bk5 f59 actionCode 'import ch.ivy.addon.portalkit.util.PermissionUtils;
import ch.ivy.addon.portalkit.util.SecurityServiceUtils;
import ch.ivy.addon.portal.generic.view.CaseView;

boolean hasReadAllCasesPermission = PermissionUtils.checkReadAllCasesPermission();
in.caseDataModel.setAdminQuery(hasReadAllCasesPermission);

in.caseView = CaseView.create().dataModel(in.caseDataModel).buildNewView();' #txt
Bk5 f59 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>build data model&#xD;
and case view</name>
        <nameStyle>31,5
</nameStyle>
    </language>
</elementInfo>
' #txt
Bk5 f59 288 138 128 44 -43 -16 #rect
Bk5 f59 @|StepIcon #fIcon
Bk5 f55 processCall 'Functional Processes/OpenPortalCases:useView(ch.ivy.addon.portal.generic.view.CaseView)' #txt
Bk5 f55 requestActionDecl '<ch.ivy.addon.portal.generic.view.CaseView view> param;' #txt
Bk5 f55 requestMappingAction 'param.view=in.caseView;
' #txt
Bk5 f55 responseActionDecl 'ch.ivy.addon.portal.generic.PortalStartData out;
' #txt
Bk5 f55 responseMappingAction 'out=in;
' #txt
Bk5 f55 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>OpenPortalCases</name>
        <nameStyle>15,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Bk5 f55 488 136 112 48 -49 -12 #rect
Bk5 f55 @|CallSubIcon #fIcon
Bk5 g0 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language lang="en">
        <name>in 1</name>
    </language>
</elementInfo>
' #txt
Bk5 g0 51 147 26 26 0 5 #rect
Bk5 g0 @|MIGIcon #fIcon
Bk5 f0 77 160 136 160 #arcP
Bk5 g1 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language lang="en">
        <name>out 1</name>
    </language>
</elementInfo>
' #txt
Bk5 g1 659 147 26 26 0 5 #rect
Bk5 g1 @|MOGIcon #fIcon
Bk5 f1 expr out #txt
Bk5 f1 600 160 659 160 #arcP
>Proto Bk4 0 0 32 24 18 0 #rect
>Proto Bk4 @|BIcon #fIcon
Bk10 f51 actionTable 'out=in;
' #txt
Bk10 f51 actionCode 'import ch.ivy.addon.portalkit.enums.SessionAttribute;
import ch.ivy.addon.portalkit.util.SecurityServiceUtils;
SecurityServiceUtils.setSessionAttribute(SessionAttribute.PORTAL_START_PMV_ID.toString(), ivy.task.getProcessModelVersion().getId());
' #txt
Bk10 f51 security system #txt
Bk10 f51 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>store portal start &#xD;
pmv </name>
    </language>
</elementInfo>
' #txt
Bk10 f51 136 138 128 44 -43 -16 #rect
Bk10 f51 @|StepIcon #fIcon
Bk10 f20 actionTable 'out=in;
' #txt
Bk10 f20 actionCode 'import ch.ivy.addon.portalkit.enums.PortalLibrary;
import org.apache.commons.lang3.StringUtils;
import ch.ivyteam.ivy.workflow.StandardProcessType;

String library = PortalLibrary.PORTAL_TEMPLATE.getValue();

String defaultEndPage = ivy.wf.getStandardProcessImplementationLibrary(StandardProcessType.DEFAULT_PAGES_PROCESS_TYPES);
if (StringUtils.isBlank(defaultEndPage)) {
	ivy.wf.setStandardProcessImplementationLibrary(StandardProcessType.DEFAULT_PAGES_PROCESS_TYPES, library);
}' #txt
Bk10 f20 security system #txt
Bk10 f20 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Set default end page 
to Portal</name>
        <nameStyle>31,5
</nameStyle>
    </language>
</elementInfo>
' #txt
Bk10 f20 296 138 144 44 -53 -16 #rect
Bk10 f20 @|StepIcon #fIcon
Bk10 f14 expr out #txt
Bk10 f14 264 160 296 160 #arcP
Bk10 g0 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language lang="en">
        <name>in 1</name>
    </language>
</elementInfo>
' #txt
Bk10 g0 51 147 26 26 0 5 #rect
Bk10 g0 @|MIGIcon #fIcon
Bk10 f0 77 160 136 160 #arcP
Bk10 g1 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language lang="en">
        <name>out 1</name>
    </language>
</elementInfo>
' #txt
Bk10 g1 531 147 26 26 0 5 #rect
Bk10 g1 @|MOGIcon #fIcon
Bk10 f1 440 160 531 160 #arcP
>Proto Bk5 0 0 32 24 18 0 #rect
>Proto Bk5 @|BIcon #fIcon
Pt0 f10 mainOut f48 tail #connect
Pt0 f48 head f11 mainIn #connect
Pt0 f11 mainOut f2 tail #connect
Pt0 f2 head f1 in #connect
Pt0 f9 mainOut f16 tail #connect
Pt0 f16 head f0 in #connect
Pt0 f12 mainOut f21 tail #connect
Pt0 f21 head f5 in #connect
Pt0 f17 head f64 mainIn #connect
Pt0 f63 mainOut f15 tail #connect
Pt0 f15 head S21 g0 #connect
Pt0 S21 g1 f17 tail #connect
Pt0 f25 head f57 mainIn #connect
Pt0 f58 mainOut f24 tail #connect
Pt0 f24 head S31 g0 #connect
Pt0 S31 g1 f25 tail #connect
Pt0 f27 head f105 mainIn #connect
Pt0 f103 mainOut f26 tail #connect
Pt0 f26 head S41 g0 #connect
Pt0 S41 g1 f27 tail #connect
Pt0 f30 head f9 mainIn #connect
Pt0 f28 mainOut f29 tail #connect
Pt0 f29 head S51 g0 #connect
Pt0 S51 g1 f30 tail #connect
Pt0 f5 out f20 tail #connect
Pt0 f20 head f0 in #connect
Pt0 f5 out f18 tail #connect
Pt0 f18 head S11 g0 #connect
Pt0 f14 mainOut f23 tail #connect
Pt0 f23 head f11 mainIn #connect
Pt0 f70 mainOut f33 tail #connect
Pt0 f33 head f32 mainIn #connect
Pt0 f32 mainOut f35 tail #connect
Pt0 f35 head f34 mainIn #connect
Pt0 f51 mainOut f41 tail #connect
Pt0 f41 head f37 mainIn #connect
Pt0 f39 mainOut f42 tail #connect
Pt0 f42 head f51 mainIn #connect
Pt0 f37 mainOut f40 tail #connect
Pt0 f40 head f53 mainIn #connect
Pt0 f7 mainOut f13 tail #connect
Pt0 f13 head f12 mainIn #connect
Pt0 f4 mainOut f31 tail #connect
Pt0 f31 head f7 mainIn #connect
Pt0 f1 out f50 tail #connect
Pt0 f50 head f9 mainIn #connect
Pt0 f19 head f5 in #connect
Pt0 f1 out f52 tail #connect
Pt0 f52 head f47 in #connect
Pt0 f1 out f19 tail #connect
Pt0 f47 out f49 tail #connect
Pt0 f49 head f4 mainIn #connect
Pt0 f47 out f55 tail #connect
Pt0 f55 head f7 mainIn #connect
Pt0 f60 mainOut f61 tail #connect
Pt0 f61 head f59 mainIn #connect
Pt0 f62 mainOut f66 tail #connect
Pt0 f66 head f65 mainIn #connect
Pt0 f68 mainOut f69 tail #connect
Pt0 f69 head f67 mainIn #connect
Pt0 f76 mainOut f79 tail #connect
Pt0 f79 head f71 mainIn #connect
Pt0 f72 mainOut f77 tail #connect
Pt0 f77 head f74 mainIn #connect
Pt0 f73 mainOut f78 tail #connect
Pt0 f78 head f75 mainIn #connect
Pt0 f86 mainOut f91 tail #connect
Pt0 f91 head f81 in #connect
Pt0 f90 head f80 mainIn #connect
Pt0 f81 out f87 tail #connect
Pt0 f87 head f84 mainIn #connect
Pt0 f81 out f90 tail #connect
Pt0 f82 mainOut f89 tail #connect
Pt0 f89 head f83 mainIn #connect
Pt0 f83 mainOut f88 tail #connect
Pt0 f88 head f86 mainIn #connect
Pt0 f44 mainOut f46 tail #connect
Pt0 f46 head f45 mainIn #connect
Pt0 f38 mainOut f93 tail #connect
Pt0 f93 head f44 mainIn #connect
Pt0 f0 out f92 tail #connect
Pt0 f92 head S61 g0 #connect
Bk1 f106 mainOut f107 tail #connect
Bk1 f107 head f104 mainIn #connect
Bk1 g0 m f0 tail #connect
Bk1 f0 head f106 mainIn #connect
Bk1 f1 head g1 m #connect
Bk1 f104 mainOut f1 tail #connect
Bk1 0 0 576 320 0 #ivRect
Bk2 f17 mainOut f26 tail #connect
Bk2 f26 head f23 mainIn #connect
Bk2 f19 mainOut f39 tail #connect
Bk2 f39 head f12 mainIn #connect
Bk2 f52 mainOut f49 tail #connect
Bk2 f49 head f37 mainIn #connect
Bk2 f68 mainOut f42 tail #connect
Bk2 f42 head f6 mainIn #connect
Bk2 g0 m f1 tail #connect
Bk2 f1 head f0 in #connect
Bk2 f0 out f8 tail #connect
Bk2 f8 head f7 mainIn #connect
Bk2 f0 out f2 tail #connect
Bk2 f2 head f68 mainIn #connect
Bk2 f0 out f3 tail #connect
Bk2 f3 head f17 mainIn #connect
Bk2 f0 out f4 tail #connect
Bk2 f4 head f19 mainIn #connect
Bk2 f0 out f5 tail #connect
Bk2 f5 head f52 mainIn #connect
Bk2 0 0 736 560 0 #ivRect
Bk3 f73 mainOut f118 tail #connect
Bk3 f118 head f69 mainIn #connect
Bk3 f69 mainOut f67 tail #connect
Bk3 f67 head f84 mainIn #connect
Bk3 g0 m f0 tail #connect
Bk3 f0 head f73 mainIn #connect
Bk3 f1 head g1 m #connect
Bk3 f84 mainOut f1 tail #connect
Bk3 0 0 736 320 0 #ivRect
Bk4 f3 ao f8 tail #connect
Bk4 f8 head f36 @CG|ai #connect
Bk4 f22 mainOut f43 tail #connect
Bk4 f43 head f36 mainIn #connect
Bk4 f54 out f6 tail #connect
Bk4 f6 head f22 mainIn #connect
Bk4 g0 m f2 tail #connect
Bk4 f2 head f1 mainIn #connect
Bk4 f1 mainOut f0 tail #connect
Bk4 f0 head f54 in #connect
Bk4 f54 out f5 tail #connect
Bk4 f5 head f4 mainIn #connect
Bk4 0 0 896 320 0 #ivRect
Bk5 f62 mainOut f61 tail #connect
Bk5 f61 head f59 mainIn #connect
Bk5 f59 mainOut f60 tail #connect
Bk5 f60 head f55 mainIn #connect
Bk5 g0 m f0 tail #connect
Bk5 f0 head f62 mainIn #connect
Bk5 f1 head g1 m #connect
Bk5 f55 mainOut f1 tail #connect
Bk5 0 0 736 320 0 #ivRect
Bk10 f51 mainOut f14 tail #connect
Bk10 f14 head f20 mainIn #connect
Bk10 g0 m f0 tail #connect
Bk10 f0 head f51 mainIn #connect
Bk10 f20 mainOut f1 tail #connect
Bk10 f1 head g1 m #connect
Bk10 0 0 704 288 0 #ivRect
