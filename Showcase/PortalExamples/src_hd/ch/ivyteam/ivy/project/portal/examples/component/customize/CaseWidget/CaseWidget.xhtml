<html xmlns="http://www.w3.org/1999/xhtml" xmlns:f="http://xmlns.jcp.org/jsf/core" xmlns:h="http://xmlns.jcp.org/jsf/html" xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:ic="http://ivyteam.ch/jsf/component" xmlns:p="http://primefaces.org/ui" xmlns:pe="http://primefaces.org/ui/extensions" xmlns:pm="http://primefaces.org/mobile"
	xmlns:c="http://xmlns.jcp.org/jsp/jstl/core">
<h:body>

	<!-- In this HTML dialog, we override task list header, task header, task filter, and task body -->

	<ui:composition template="/layouts/PortalCasesTemplate.xhtml">
		<ui:param name="menuState" value="#{data.menuState}" />
		<ui:param name="filterGroupId" value="#{ivy.request.processModel.id}" />
		<ui:param name="isNotRequiredLogin" value="false" />

		<ui:param name="useOverrideListHeader" value="true" />
		<ui:param name="useOverrideHeader" value="true" />
		<ui:param name="useOverrideBody" value="true" />
		<ui:param name="useOverrideFilter" value="true" />

		<ui:define name="caseListHeader">
			<ic:ch.ivy.addon.portalkit.component.cases.column.CaseColumnHeader id="name-desc-column-header" styleClass="case-list-header-cell case-list-name-desc-header-cell" componentToBeUpdated=""
				sortedField="NAME" sortable="true" value="#{ivy.cms.co('/ch.ivy.addon.portalkit.ui.jsf/caseList/defaultColumns/NAME')}" dataModel="#{caseView.dataModel}" />

			<ic:ch.ivy.addon.portalkit.component.cases.column.CaseColumnHeader id="id-column-header" styleClass="TexAlCenter case-list-header-cell #{caseView.dataModel.isAutoHideColumns()?'js-id-column-header':''}" 
				componentToBeUpdated="" sortedField="ID" sortable="true" value="#{ivy.cms.co('/ch.ivy.addon.portalkit.ui.jsf/caseList/defaultColumns/ID')}" dataModel="#{caseView.dataModel}" />

			<ic:ch.ivy.addon.portalkit.component.cases.column.CaseColumnHeader id="creator-column-header" componentToBeUpdated="" sortedField="CREATOR" sortable="true"
			    styleClass="case-list-header-cell #{caseView.dataModel.isAutoHideColumns()?'js-creator-column-header':''}"
				value="#{ivy.cms.co('/ch.ivy.addon.portalkit.ui.jsf/caseList/defaultColumns/CREATOR')}" dataModel="#{caseView.dataModel}" />

			<ic:ch.ivy.addon.portalkit.component.cases.column.CaseColumnHeader id="created-date-column-header" componentToBeUpdated="" sortedField="CREATION_TIME"
			    styleClass="TexAlCenter case-list-header-cell #{caseView.dataModel.isAutoHideColumns()?'js-create-column-header':''}" 
				sortable="true" value="#{ivy.cms.co('/ch.ivy.addon.portalkit.ui.jsf/caseList/defaultColumns/CREATION_TIME')}" dataModel="#{caseView.dataModel}" />

			<ic:ch.ivy.addon.portalkit.component.cases.column.CaseColumnHeader id="mofified-date-column-header" componentToBeUpdated="" sortedField="FINISHED_TIME"
				styleClass="TexAlCenter case-list-header-cell #{caseView.dataModel.isAutoHideColumns()?'js-expiry-column-header':''}" 
				sortable="true" value="#{ivy.cms.co('/ch.ivy.addon.portalkit.ui.jsf/caseList/defaultColumns/FINISHED_TIME')}" dataModel="#{caseView.dataModel}" />

			<ic:ch.ivy.addon.portalkit.component.cases.column.CaseColumnHeader id="state-column-header" styleClass="case-list-header-cell TexAlCenter" componentToBeUpdated="" sortedField="STATE"
				sortable="true" value="#{ivy.cms.co('/ch.ivy.addon.portalkit.ui.jsf/caseList/defaultColumns/STATE')}" dataModel="#{caseView.dataModel}" />

			<!-- New field -->
			<ic:ch.ivy.addon.portalkit.component.cases.column.CaseColumnHeader id="customVarCharField1-column-case-list-header" styleClass="case-list-header-cell TexAlCenter customized-case-header-column"
				componentToBeUpdated="" sortedField="customVarCharField1" sortable="true" value="#{ivy.cms.co('/DefaultColumns/caseList/customVarcharField1')}" dataModel="#{caseView.dataModel}" />
			<ic:ch.ivy.addon.portalkit.component.cases.column.CaseColumnHeader id="customTimestampField1-column-case-list-header" styleClass="case-list-header-cell TexAlCenter customized-case-header-column"
				componentToBeUpdated="" sortedField="customTimestampField1" sortable="true" value="#{ivy.cms.co('/DefaultColumns/caseList/customTimestampField1')}" dataModel="#{caseView.dataModel}" />
		</ui:define>

		<ui:define name="caseHeader">
            <div class="case-header-name-desc-cell">
				<ic:ch.ivy.addon.portalkit.component.cases.column.CaseName case="#{case}" caseNameId="case-header-name-cell" caseDescriptionId="description-cell"
				  initialActive="#{case.id eq caseView.getAutoSelectCaseId().id()}" 
				  dataModel="#{caseView.getDataModel()}" />
			</div>
			<ic:ch.ivy.addon.portalkit.component.cases.column.CaseId componentId="case-id-cell" case="#{case}" dataModel="#{caseView.getDataModel()}" />
			<ic:ch.ivy.addon.portalkit.component.cases.column.CaseCreator componentId="case-creator-cell" case="#{case}" dataModel="#{caseView.getDataModel()}" 
			    styleClass="#{caseView.dataModel.isAutoHideColumns()?'hidden-sm':''}" />
			<ic:ch.ivy.addon.portalkit.component.cases.column.CaseDate componentId="case-creation-date-cell" rendered="#{caseView.dataModel.isSelectedColumn('CREATION_TIME')}" 
				value="#{case.startTimestamp}" styleClass="#{caseView.dataModel.isAutoHideColumns()?'js-create-cell':''}" />
			<ic:ch.ivy.addon.portalkit.component.cases.column.CaseDate componentId="case-expiry-date-cell" rendered="#{caseView.dataModel.isSelectedColumn('FINISHED_TIME')}" 
				value="#{case.endTimestamp}" styleClass="#{caseView.dataModel.isAutoHideColumns()?'js-finish-cell':''}" />
			<ic:ch.ivy.addon.portalkit.component.cases.column.CaseState componentId="case-state-cell" case="#{case}" dataModel="#{caseView.getDataModel()}" />

			<!-- New field -->
			<ic:ch.ivy.addon.portalkit.component.cases.column.CaseCustomField id="case-customer-name-component" panelGroupId="customVarCharField1-column-case-header-panel" 
				componentId="customVarCharField1-column-case-header-text" column="customVarCharField1" dataModel="#{caseView.dataModel}" labelValue="#{case.customFields().stringField('CustomVarCharField1').getOrNull()}" />
			<h:outputText value="#{case.customFields().timestampField('CustomTimestampField1').getOrNull()}" styleClass="TexAlCenter case-header-end-time-cell customized-case-header-column"
				rendered="#{caseView.dataModel.isSelectedColumn('customTimestampField1')}" >
				<f:convertDateTime pattern="#{dateTimePatternBean.configuredPattern}" />
			</h:outputText>
		</ui:define>

		<ui:define name="caseBody">
			<ic:ch.ivy.addon.portalkit.component.CaseItemGeneralInformation id="general-information" case="#{case}" />
			<ic:ch.ivy.addon.portalkit.component.CaseItemRelatedTask id="related-tasks" case="#{case}" />
			<ic:ch.ivy.addon.portalkit.component.CaseItemHistory id="history" case="#{case}" />
			<ic:ch.ivy.addon.portalkit.component.CaseItemDocument id="document" case="#{case}" componentToUpdate="#{p:component('history')}" />
			<ic:ch.ivy.addon.portalkit.component.CaseItemDescription id="description" case="#{case}" descriptionComponentToUpdate="#{p:component('description-cell')}" />
			<ic:ch.ivy.addon.portalkit.component.ResponsivenessHandleContainer styleClass="hidden-lg">
				<ic:ch.ivy.addon.portalkit.component.ResponsivenessHandleButton icon="fa fa-share-alt js-related-task-column-responsive-button" displayedSelectors="['.js-related-task-column']"
					hiddenSelectorsInSmallScreen="['.case-details .replaced']" />
				<ic:ch.ivy.addon.portalkit.component.ResponsivenessHandleButton icon="fa fa-align-left js-history-column-responsive-button" displayedSelectors="['.js-history-column']"
					hiddenSelectorsInMediumScreen="['.case-details .replaced']" hiddenSelectorsInSmallScreen="['.case-details .replaced']" />
				<ic:ch.ivy.addon.portalkit.component.ResponsivenessHandleButton icon="fa fa-file js-document-column-responsive-button" displayedSelectors="['.js-document-column']"
					hiddenSelectorsInLargeScreen="['.case-details .replaced']" hiddenSelectorsInMediumScreen="['.case-details .replaced']" hiddenSelectorsInSmallScreen="['.case-details .replaced']" />
				<ic:ch.ivy.addon.portalkit.component.ResponsivenessHandleButton icon="fa fa-clipboard js-description-column-responsive-button" displayedSelectors="['.js-description-column']"
					hiddenSelectorsInMediumScreen="['.case-details .replaced']" hiddenSelectorsInSmallScreen="['.case-details .replaced']" />
				<h:outputScript library="js" name="case-detail-default-responsiveness.js" />
			</ic:ch.ivy.addon.portalkit.component.ResponsivenessHandleContainer>

			<!-- Add new panel -->
			<div class="task-details-item custom-task-details-panel">
				<p>Custom panel</p>
			</div>
		</ui:define>

		<ui:define name="caseFilter">
			<c:set var="filterContainer" value="#{caseView.dataModel.filterContainer}" />
			<ic:ch.ivy.addon.portalkit.component.cases.filter.CaseCreationDateFilter filter="#{filterContainer.caseCreationDateFilter}" dataModel="#{caseView.dataModel}" />
			<ic:ch.ivy.addon.portalkit.component.cases.filter.CaseFinishedDateFilter filter="#{filterContainer.caseFinishedDateFilter}" dataModel="#{caseView.dataModel}" />
			<ic:ch.ivy.addon.portalkit.component.cases.filter.CaseDescriptionFilter filter="#{filterContainer.caseDescriptionFilter}" dataModel="#{caseView.dataModel}" />
			<ic:ch.ivy.addon.portalkit.component.cases.filter.CaseStateFilter filter="#{filterContainer.stateFilter}" dataModel="#{caseView.dataModel}" />
			<ic:ch.ivy.addon.portalkit.component.cases.filter.CaseCreatorFilter filter="#{filterContainer.caseCreatorFilter}" dataModel="#{caseView.dataModel}" />

			<!-- Add new filter -->
			<ic:ch.ivy.addon.portalkit.component.cases.filter.AdvancedFilter id="customerNameField-case-filter" caseFilter="#{filterContainer.customerNameFieldFilter}" dataModel="#{caseView.dataModel}">
				<p:inputText id="customVarCharField1" value="#{filterContainer.customerNameFieldFilter.customerNameField}" />
			</ic:ch.ivy.addon.portalkit.component.cases.filter.AdvancedFilter>
			<ic:ch.ivy.addon.portalkit.component.cases.filter.AdvancedFilter id="shipment-date-case-filter" caseFilter="#{filterContainer.shipmentDateFieldFilter}" dismissableOverlayPanel="false"
				dataModel="#{caseView.dataModel}">
				<h:panelGrid columns="3">
					<h:outputLabel value="#{ivy.cms.co('/ch.ivy.addon.portalkit.ui.jsf/common/filter/from')}" for="from-created-calendar" />
					<p:spacer width="5" />
					<p:calendar id="from-created-calendar" value="#{filterContainer.shipmentDateFieldFilter.fromFinishedDate}" locale="#{localeBean.locale}" pattern="#{dateTimePatternBean.configuredPattern}"
						showOn="button" converterMessage="#{ivy.cms.co('/ch.ivy.addon.portalkit.ui.jsf/common/wrongDateFormat')}" />

					<h:outputLabel value="#{ivy.cms.co('/ch.ivy.addon.portalkit.ui.jsf/common/filter/to')}" for="to-created-calendar" />
					<p:spacer width="5" />
					<p:calendar id="to-created-calendar" value="#{filterContainer.shipmentDateFieldFilter.toFinishedDate}" locale="#{localeBean.locale}" pattern="#{dateTimePatternBean.configuredPattern}"
						showOn="button" converterMessage="#{ivy.cms.co('/ch.ivy.addon.portalkit.ui.jsf/common/wrongDateFormat')}" />
				</h:panelGrid>
			</ic:ch.ivy.addon.portalkit.component.cases.filter.AdvancedFilter>
		</ui:define>

		<ui:define name="css">
			<h:outputStylesheet library="css" name="examples.css" />
		</ui:define>
	</ui:composition>
</h:body>
</html>