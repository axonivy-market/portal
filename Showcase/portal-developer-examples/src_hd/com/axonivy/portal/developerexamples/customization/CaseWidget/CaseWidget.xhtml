<html xmlns="http://www.w3.org/1999/xhtml" xmlns:f="http://xmlns.jcp.org/jsf/core"
  xmlns:h="http://xmlns.jcp.org/jsf/html" xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
  xmlns:ic="http://ivyteam.ch/jsf/component" xmlns:p="http://primefaces.org/ui"
  xmlns:pe="http://primefaces.org/ui/extensions" xmlns:c="http://xmlns.jcp.org/jsp/jstl/core">
<h:body>

  <!-- In this HTML dialog, we override case list header, case header, case filter, and case body -->

  <ui:composition template="/layouts/PortalCasesTemplate.xhtml">
    <ui:param name="filterGroupId" value="#{ivy.request.processModel.id}" />

    <ui:param name="useOverrideListHeader" value="true" />
    <ui:param name="useOverrideHeader" value="true" />
    <ui:param name="useOverrideFilter" value="true" />

    <ui:define name="caseListHeader">

      <ic:ch.ivy.addon.portalkit.component.cases.column.CaseColumnHeader id="name-desc-column-header"
        styleClass="case-list-name-desc-header-cell"
        value="#{ivy.cms.co('/ch.ivy.addon.portalkit.ui.jsf/caseList/defaultColumns/NAME')}"
        dataModel="#{caseView.dataModel}" sortable="true" sortedField="NAME" />

      <ic:ch.ivy.addon.portalkit.component.cases.column.CaseColumnHeader id="id-column-header" styleClass="TexAlCenter"
        responsiveStyleClass="u-hidden-sm-down"
        value="#{ivy.cms.co('/ch.ivy.addon.portalkit.ui.jsf/caseList/defaultColumns/ID')}"
        dataModel="#{caseView.dataModel}" sortable="true" sortedField="ID" />

      <ic:ch.ivy.addon.portalkit.component.cases.column.CaseColumnHeader id="creator-column-header"
        responsiveStyleClass="js-hidden-when-expand-menu u-hidden-md-down"
        value="#{ivy.cms.co('/ch.ivy.addon.portalkit.ui.jsf/caseList/defaultColumns/CREATOR')}"
        dataModel="#{caseView.dataModel}" sortable="true" sortedField="CREATOR" />
        
      <ic:ch.ivy.addon.portalkit.component.cases.column.CaseColumnHeader id="owner-column-header" 
        responsiveStyleClass="js-hidden-when-expand-menu u-hidden-md-down"
        value="#{ivy.cms.co('/ch.ivy.addon.portalkit.ui.jsf/caseList/defaultColumns/OWNER')}" 
        dataModel="#{caseView.dataModel}" sortable="true" sortedField="OWNER" rendered="#{caseBean.isCaseOwnerEnabled()}" />

      <ic:ch.ivy.addon.portalkit.component.cases.column.CaseColumnHeader id="created-date-column-header"
        styleClass="TexAlCenter" responsiveStyleClass="u-hidden-sm-down"
        value="#{ivy.cms.co('/ch.ivy.addon.portalkit.ui.jsf/caseList/defaultColumns/CREATION_TIME')}"
        dataModel="#{caseView.dataModel}" sortable="true" sortedField="CREATION_TIME" />

      <ic:ch.ivy.addon.portalkit.component.cases.column.CaseColumnHeader id="finished-date-column-header"
        styleClass="TexAlCenter" responsiveStyleClass="js-hidden-when-expand-menu u-hidden-md-down"
        value="#{ivy.cms.co('/ch.ivy.addon.portalkit.ui.jsf/caseList/defaultColumns/FINISHED_TIME')}"
        dataModel="#{caseView.dataModel}" sortable="true" sortedField="FINISHED_TIME" />

      <ic:ch.ivy.addon.portalkit.component.cases.column.CaseColumnHeader id="state-column-header"
        styleClass="TexAlCenter" responsiveStyleClass="u-hidden-sm-down"
        value="#{ivy.cms.co('/ch.ivy.addon.portalkit.ui.jsf/caseList/defaultColumns/STATE')}"
        dataModel="#{caseView.dataModel}" sortable="true" sortedField="STATE" />
        
      <ic:ch.ivy.addon.portalkit.component.cases.column.CaseColumnHeader id="application-column-header"
        styleClass="TexAlCenter" responsiveStyleClass="u-hidden-sm-down"
        value="#{ivy.cms.co('/ch.ivy.addon.portalkit.ui.jsf/caseList/defaultColumns/APPLICATION')}"
        dataModel="#{caseView.dataModel}" sortable="false" sortedField="APPLICATION" />

      <!-- New field -->
      <ic:ch.ivy.addon.portalkit.component.cases.column.CaseColumnHeader id="customer-name-column-header"
        styleClass="TexAlCenter customized-case-header-column"
        responsiveStyleClass="js-hidden-when-expand-menu u-hidden-lg-down"
        value="#{ivy.cms.co('/DefaultColumns/caseList/CustomerName')}" sortedField="CustomerName"
        sortable="true" dataModel="#{caseView.dataModel}" />
      <ic:ch.ivy.addon.portalkit.component.cases.column.CaseColumnHeader id="ShipmentDate-column-header"
        styleClass="TexAlCenter customized-case-header-column"
        responsiveStyleClass="js-hidden-when-expand-menu u-hidden-lg-down"
        value="#{ivy.cms.co('/DefaultColumns/caseList/ShipmentDate')}" sortedField="ShipmentDate"
        sortable="true" dataModel="#{caseView.dataModel}" />
    </ui:define>

    <ui:define name="caseHeader">
      <div class="case-header-name-desc-cell u-truncate-text">
        <ic:ch.ivy.addon.portalkit.component.cases.column.CaseName caseNameId="case-header-name-cell"
          caseDescriptionId="description-cell" case="#{case}" dataModel="#{caseView.getDataModel()}" />
      </div>
      <ic:ch.ivy.addon.portalkit.component.cases.column.CaseId componentId="case-id-cell" case="#{case}"
        dataModel="#{caseView.getDataModel()}" />
      <ic:ch.ivy.addon.portalkit.component.cases.column.CaseCreator componentId="case-creator-cell" case="#{case}"
        dataModel="#{caseView.getDataModel()}" />
      <ic:ch.ivy.addon.portalkit.component.cases.column.CaseOwner componentId="case-owner-cell"
        case="#{case}" dataModel="#{caseView.getDataModel()}" rendered="#{caseBean.isCaseOwnerEnabled()}" />
      <ic:ch.ivy.addon.portalkit.component.cases.column.CaseDate componentId="case-creation-date-cell"
        rendered="#{caseView.dataModel.isSelectedColumn('CREATION_TIME')}" value="#{case.startTimestamp}" />
      <ic:ch.ivy.addon.portalkit.component.cases.column.CaseDate componentId="case-expiry-date-cell"
        rendered="#{caseView.dataModel.isSelectedColumn('FINISHED_TIME')}" value="#{case.endTimestamp}"
        responsiveStyleClass="js-hidden-when-expand-menu u-hidden-md-down" />
      <ic:ch.ivy.addon.portalkit.component.cases.column.CaseState componentId="case-state-cell" case="#{case}"
        dataModel="#{caseView.getDataModel()}" />
      <ic:ch.ivy.addon.portalkit.component.cases.column.CaseApplication componentId="case-application-cell" case="#{case}"
        dataModel="#{caseView.getDataModel()}" />

      <!-- New field -->
      <h:panelGroup styleClass="customized-case-header-column js-hidden-when-expand-menu u-hidden-lg-down" rendered="#{caseView.dataModel.isSelectedColumn('CustomerName')}">
        <h:outputText value="#{case.customFields().stringField('CustomerName').getOrNull()}"
          styleClass="case-header-default-cell customized-case-header-column" />
      </h:panelGroup>
      <h:panelGroup styleClass="customized-case-header-column js-hidden-when-expand-menu u-hidden-lg-down" rendered="#{caseView.dataModel.isSelectedColumn('ShipmentDate')}">
        <h:outputText value="#{case.customFields().timestampField('ShipmentDate').getOrNull()}"
          styleClass="case-header-default-cell">
          <f:convertDateTime pattern="#{dateTimePatternBean.configuredPattern}" locale="#{localeBean.locale}"/>
        </h:outputText>
      </h:panelGroup>
    </ui:define>

    <ui:define name="caseFilter">
      <c:set var="filterContainer" value="#{caseView.dataModel.filterContainer}" />
      <ic:ch.ivy.addon.portalkit.component.cases.filter.CaseCreationDateFilter
        filter="#{filterContainer.caseCreationDateFilter}" dataModel="#{caseView.dataModel}" />
      <ic:ch.ivy.addon.portalkit.component.cases.filter.CaseFinishedDateFilter
        filter="#{filterContainer.caseFinishedDateFilter}" dataModel="#{caseView.dataModel}" />
      <ic:ch.ivy.addon.portalkit.component.cases.filter.CaseDescriptionFilter
        filter="#{filterContainer.caseDescriptionFilter}" dataModel="#{caseView.dataModel}" />
      <ic:ch.ivy.addon.portalkit.component.cases.filter.CaseStateFilter filter="#{filterContainer.stateFilter}"
        dataModel="#{caseView.dataModel}" />
      <ic:ch.ivy.addon.portalkit.component.cases.filter.CaseCreatorFilter filter="#{filterContainer.caseCreatorFilter}"
        dataModel="#{caseView.dataModel}" />
      <ic:ch.ivy.addon.portalkit.component.cases.filter.CaseOwnerFilter filter="#{filterContainer.caseOwnerFilter}"
        dataModel="#{caseView.dataModel}" rendered="#{caseBean.isCaseOwnerEnabled()}" />
      <ic:ch.ivy.addon.portalkit.component.cases.filter.CaseApplicationFilter filter="#{filterContainer.applicationFilter}"
        dataModel="#{caseView.dataModel}" />

      <!-- Add new filter -->
      <ic:ch.ivy.addon.portalkit.component.cases.filter.AdvancedFilter id="customerNameField-case-filter"
        caseFilter="#{filterContainer.customerNameFieldFilter}" dataModel="#{caseView.dataModel}">
        <p:inputText id="customer-name" value="#{filterContainer.customerNameFieldFilter.customerNameField}" />
      </ic:ch.ivy.addon.portalkit.component.cases.filter.AdvancedFilter>
      <ic:ch.ivy.addon.portalkit.component.cases.filter.AdvancedFilter id="shipment-date-case-filter"
        caseFilter="#{filterContainer.shipmentDateFieldFilter}" dismissableOverlayPanel="false"
        dataModel="#{caseView.dataModel}">
        <p:messages for="from-created-calendar" />
        <p:messages for="to-created-calendar" />
        <h:panelGrid columns="3">
          <h:outputLabel value="#{ivy.cms.co('/ch.ivy.addon.portalkit.ui.jsf/common/filter/from')}"
            for="from-created-calendar" />
          <p:spacer width="5" />
          <p:datePicker id="from-created-calendar" value="#{filterContainer.shipmentDateFieldFilter.fromFinishedDate}"
            locale="#{localeBean.locale}" pattern="#{dateTimePatternBean.configuredDateFilterPattern}" showIcon="true" showTime="#{dateTimePatternBean.isDateFilterWithTime}"
            converterMessage="#{ivy.cms.co('/ch.ivy.addon.portalkit.ui.jsf/common/filter/wrongFromDateFormat', [dateTimePatternBean.configuredDateFilterPattern])}" />

          <h:outputLabel value="#{ivy.cms.co('/ch.ivy.addon.portalkit.ui.jsf/common/filter/to')}"
            for="to-created-calendar" />
          <p:spacer width="5" />
          <p:datePicker id="to-created-calendar" value="#{filterContainer.shipmentDateFieldFilter.toFinishedDate}"
            locale="#{localeBean.locale}" pattern="#{dateTimePatternBean.configuredDateFilterPattern}" showIcon="true" showTime="#{dateTimePatternBean.isDateFilterWithTime}"
            converterMessage="#{ivy.cms.co('/ch.ivy.addon.portalkit.ui.jsf/common/filter/wrongToDateFormat', [dateTimePatternBean.configuredDateFilterPattern])}" />
        </h:panelGrid>
      </ic:ch.ivy.addon.portalkit.component.cases.filter.AdvancedFilter>
    </ui:define>

    <ui:define name="css">
      <h:outputStylesheet library="css" name="examples.css" />
    </ui:define>
  </ui:composition>
</h:body>
</html>