{
  "$schema" : "https://json-schema.axonivy.com/process/11.1.22/schema.json",
  "id" : "1624D1F5CBEA5332",
  "config" : {
    "data" : "com.axonivy.portal.developerexamples.customization.AdditionalCaseDetailPage"
  },
  "elements" : [ {
      "id" : "f0",
      "type" : "RequestStart",
      "name" : "createInvestmentRequest.ivp",
      "config" : {
        "signature" : "createInvestmentRequest",
        "request" : {
          "name" : "<%=ivy.cms.co(\"/Processes/CreateInvestment/description\")%>",
          "description" : "<%=ivy.cms.co(\"/Processes/CreateInvestment/description\")%>",
          "category" : "Investment"
        },
        "case" : {
          "name" : "<%=ivy.cms.co(\"/Processes/CreateInvestment/name\")%>",
          "description" : "<%=ivy.cms.co(\"/Processes/CreateInvestment/description\")%>",
          "customFields" : [
            { "name" : "AccountNumber", "type" : "NUMBER", "value" : "100" },
            { "name" : "CustomerName", "type" : "STRING", "value" : "\"Apartment A\"" },
            { "name" : "InvoiceDate", "type" : "TIMESTAMP", "value" : "new DateTime(2018, 2, 2, 2, 2, 2)" },
            { "name" : "InvoiceNumber", "type" : "NUMBER", "value" : "2000" },
            { "name" : "ShipmentDate", "type" : "TIMESTAMP", "value" : "new DateTime(2018, 1, 1, 1, 1, 1)" },
            { "name" : "SupportData", "type" : "STRING", "value" : "\"Request for new computer\"" }
          ]
        }
      },
      "visual" : {
        "at" : { "x" : 136, "y" : 184 },
        "description" : "Investment Request for Customized Case Detail Page example"
      },
      "connect" : [
        { "id" : "f6", "to" : "f5" }
      ]
    }, {
      "id" : "f1",
      "type" : "TaskEnd",
      "visual" : {
        "at" : { "x" : 552, "y" : 184 }
      }
    }, {
      "id" : "f3",
      "type" : "TaskSwitchEvent",
      "config" : {
        "task" : {
          "name" : "<%=ivy.cms.co(\"/Processes/CreateInvestment/Tasks/Request/name\")%>"
        }
      },
      "visual" : {
        "at" : { "x" : 456, "y" : 184 }
      },
      "connect" : [
        { "id" : "f2", "to" : "f1", "condition" : "ivp==\"TaskA.ivp\"" }
      ]
    }, {
      "id" : "f5",
      "type" : "SubProcessCall",
      "name" : "SetAdditonalCaseDetailPage",
      "config" : {
        "processCall" : "Functional Processes/SetAdditonalCaseDetailPage:call(String)",
        "call" : {
          "map" : {
            "param.linkToAddtionalCaseDetailPage" : "\"Start Processes/AdditionalCaseDetailPage/showInvestmentRequestCustomFields.ivp\""
          }
        }
      },
      "visual" : {
        "at" : { "x" : 320, "y" : 184 },
        "size" : { "width" : 176, "height" : 60 }
      },
      "connect" : [
        { "id" : "f4", "to" : "f3", "var" : "in1" }
      ]
    }, {
      "id" : "f7",
      "type" : "RequestStart",
      "name" : "showInvestmentRequestCustomFields.ivp",
      "config" : {
        "signature" : "showInvestmentRequestCustomFields",
        "input" : {
          "params" : [
            { "name" : "caseId", "type" : "Long", "desc" : "" }
          ],
          "map" : {
            "out.caseId" : "param.caseId"
          }
        },
        "request" : {
          "isVisibleOnStartList" : false
        },
        "case" : {
          "customFields" : [
            { "name" : "embedInFrame", "type" : "STRING", "value" : "\"false\"" }
          ]
        }
      },
      "visual" : {
        "at" : { "x" : 144, "y" : 64 }
      },
      "connect" : [
        { "id" : "f12", "to" : "f10" }
      ]
    }, {
      "id" : "f8",
      "type" : "TaskEnd",
      "visual" : {
        "at" : { "x" : 716, "y" : 64 }
      }
    }, {
      "id" : "f9",
      "type" : "DialogCall",
      "name" : [
        "Customization",
        "Additional Case Details Page"
      ],
      "config" : {
        "dialog" : "com.axonivy.portal.developerexamples.customization.InvestmentRequestCaseDetailPage:start(ch.ivyteam.ivy.workflow.ICase)",
        "call" : {
          "map" : {
            "param.iCase" : "in.iCase"
          }
        }
      },
      "visual" : {
        "at" : { "x" : 572, "y" : 64 },
        "size" : { "width" : 192, "height" : 60 }
      },
      "connect" : [
        { "id" : "f11", "to" : "f8" }
      ]
    }, {
      "id" : "f13",
      "type" : "ProcessAnnotation",
      "name" : [
        "HOW TO CUSTOMIZE CASE DETAIL PAGE:",
        "We need to do 2 steps:",
        "",
        "1. Create the process for the customize case detail page. In this example, it is showInvestmentRequestCustomFields.ivp",
        "",
        "2. If you want to have customized case detail page, store the URL of custom page to \"CUSTOMIZATION_ADDITIONAL_CASE_DETAILS_PAGE\" additonal property.",
        "We also provide  the callable process \"SetAdditionalCaseDetailPage\", you could use this if you need information from case only.",
        "Input for this process is the friendly URL of your customized case detail page. Example: Start Processes/CustomizedCaseDetail/example.ivp",
        "",
        "HOW TO RUN THIS EXAMPLE:",
        "1. Run createInvestmentRequest.ivp process",
        "",
        "2. Enter Portal case list, expand Investment Request case, then click to \"Show business details\" button. New tab will open, showing customized case detail page."
      ],
      "visual" : {
        "at" : { "x" : 1232, "y" : 136 },
        "size" : { "width" : 896, "height" : 268 }
      }
    }, {
      "id" : "f10",
      "type" : "Script",
      "name" : "Find case by id",
      "config" : {
        "output" : {
          "code" : [
            "import ch.ivy.addon.portalkit.util.CaseUtils;",
            "out.iCase = CaseUtils.findCase(in.caseId);"
          ]
        }
      },
      "visual" : {
        "at" : { "x" : 352, "y" : 64 }
      },
      "connect" : [
        { "id" : "f14", "to" : "f9" }
      ]
    } ]
}