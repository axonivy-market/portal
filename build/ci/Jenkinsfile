pipeline {
  agent {
    label 'linux'
    dockerfile {
      dir '.'
      filename 'build/Dockerfile'
    }
  }

 options {
    buildDiscarder(logRotator(numToKeepStr: '60', artifactNumToKeepStr: '2'))
  }

  stages {
    stage('test') {
      steps {
        script {
          maven cmd: '--threads 4 ' +
                     'clean install ' +
                     '-f AxonIvyPortal/portal-components/pom.xml'
        }
        archiveArtifacts artifacts: "*/*/target/*.iar", allowEmptyArchive: true
      }
    }
  }
}