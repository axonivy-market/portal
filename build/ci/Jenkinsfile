pipeline {
  agent any

  stages {
    stage("build") {
      steps {
        script { 
          docker.withRegistry('', 'docker.io') {
            docker.build("portal", "-f build/Dockerfile .").inside() {
              maven cmd: "clean install -f AxonIvyPortal/portal-components/pom.xml"
            }
          }
          archiveArtifacts artifacts: "*/*/target/*.iar", allowEmptyArchive: true
        }
      }
    }
  }
}