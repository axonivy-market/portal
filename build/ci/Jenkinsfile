pipeline {
  agent {
    dockerfile {
      filename 'build/Dockerfile'
    }
  }

  stages {
    stage('build') {
      steps {
        script { 
          docker.withRegistry('', 'docker.io') {
            docker.image('maven:3.8.6-eclipse-temurin-17').inside() {
              maven cmd: "clean install -f AxonIvyPortal/portal-components/pom.xml"
            }
          }
        }
        archiveArtifacts artifacts: "*/*/target/*.iar", allowEmptyArchive: true
      }
    }
  }
}