<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:cc="http://java.sun.com/jsf/composite"
	xmlns:ic="http://ivyteam.ch/jsf/component"
	xmlns:p="http://primefaces.org/ui"
	xmlns:pe="http://primefaces.org/ui/extensions"
	xmlns:pm="http://primefaces.org/mobile">
<cc:interface componentType="IvyComponent">
	<cc:attribute name="fileLimit" type="Integer"/>
	<cc:attribute name="uploadPossible" />
	<cc:attribute name="allowFiletypes" />
</cc:interface>

<cc:implementation>
	<div id="document-table-div">

		<p:dataTable id="document-table" value="#{data.caseDocuments}"
			var="document"
			emptyMessage="#{ivy.cms.co('/Dialogs/components/CaseDocument/NoFiles')}"
			styleClass="MarTop5" widgetVar="fileTableVar">
			<p:column
				headerText="#{ivy.cms.co('/ch.ivy.addon.portalkit.ui.jsf/documentFiles/name')}">
				<h:outputText value="#{document.fileName}"
					title="#{document.fileName}" />
			</p:column>
			<p:column
				headerText="#{ivy.cms.co('/ch.ivy.addon.portalkit.ui.jsf/documentFiles/size')}">
				<h:outputText value="#{document.fileSize}"
					title="#{document.fileSize}" />
			</p:column>
			<p:column
				headerText="#{ivy.cms.co('/Dialogs/components/CaseDocument/FileDate')}">
				<h:outputText value="#{dateFormats.format(document.modifiedDate)}"
					title="#{document.modifiedDate}">
					<!-- 	         <f:convertDateTime pattern="#{dateTimePatternBean.configuredPattern}" /> -->
				</h:outputText>
			</p:column>

			<p:column styleClass="u-text-align-center"
				headerText="#{ivy.cms.co('/Dialogs/components/CaseDocument/FileFunctions')}">

				<p:commandLink id="download" styleClass="fa fa-download MarRight10"
					immediate="true" ajax="false" process="@widgetVar(fileTableVar)"
					actionListener="#{logic.downloadFile(document.downloadPath, document.fileName)}"
					title="#{ivy.cms.co('/ch.ivy.addon.portalkit.ui.jsf/documentFiles/download')}"
					value="#{ivy.cms.co('/ch.ivy.addon.portalkit.ui.jsf/documentFiles/download')}">
					<p:fileDownload value="#{data.downloadFile}" />
				</p:commandLink>

				<p:spacer width="20px"></p:spacer>
				<p:commandLink id="document-delete" styleClass="fa fa-trash-o"
					actionListener="#{logic.deleteFile(document.downloadPath)}"
					rendered="#{cc.attrs.uploadPossible}"
					update="document-table"
					title="#{ivy.cms.co('/ch.ivy.addon.portalkit.ui.jsf/common/delete')}"
					value="#{ivy.cms.co('/ch.ivy.addon.portalkit.ui.jsf/common/delete')}">
				</p:commandLink>
			</p:column>



		</p:dataTable>
		<div class="MarTop10 TexAlRight">


		<p:fileUpload id="choose-uploading-file" value="#{data.selectedFile}"
					mode="advanced" auto="true" dragDropSupport="true"
					fileUploadListener="#{logic.submitUpload}" update="document-table"
					label="#{ivy.cms.co('/ch.ivy.addon.portalkit.ui.jsf/documentFiles/upload')}"
					rendered="#{cc.attrs.uploadPossible}"
					invalidSizeMessage="#{ivy.cms.co('/Dialogs/components/CaseDocument/invalidSizeMessage')}"
					cancelLabel="Abbrechen" onstart="#{logic.setFileLimit(cc.attrs.fileLimit)}"
					>
		</p:fileUpload>
		</div>
	</div>
</cc:implementation>
</html>