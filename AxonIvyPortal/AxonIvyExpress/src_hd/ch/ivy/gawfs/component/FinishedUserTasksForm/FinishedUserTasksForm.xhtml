<html xmlns="http://www.w3.org/1999/xhtml"
  xmlns:f="http://java.sun.com/jsf/core"
  xmlns:h="http://java.sun.com/jsf/html"
  xmlns:ui="http://java.sun.com/jsf/facelets"
  xmlns:cc="http://java.sun.com/jsf/composite"
  xmlns:ic="http://ivyteam.ch/jsf/component"
  xmlns:p="http://primefaces.org/ui"
  xmlns:pe="http://primefaces.org/ui/extensions">
<cc:interface componentType="IvyComponent">
  <cc:attribute name="finishedTasks" required="true" />
</cc:interface>
<cc:implementation>
  <h:outputLabel id="finished-task-label" styleClass="finished-task-label" for="approval-result" value="#{ivy.cms.co('/Dialogs/WorkflowExecution/FinishedTasksForm/FinishedTasks')}" />
  <ui:repeat id="approval-result" var="wfTask" value="#{cc.attrs.finishedTasks}" varStatus="status">
    <p:fieldset id="finished-task-fieldset" styleClass="finished-task-fieldset" toggleable="true"
      collapsed="#{status.index  == cc.attrs.finishedTasks.size() -1 ? 'false' : 'true'}">
      <f:facet name="legend">
        <h:outputText id="finished-task-fieldset-legend" value="#{wfTask.subject}" />
      </f:facet>
      <!-- APPLICANT INFO -->
      <p:outputLabel id="applicant-label" value="#{ivy.cms.co('/Dialogs/WorkflowExecution/FinishedTasksForm/Applicant')}" styleClass="review-content-title" />
      <p:panelGrid id="applicant-field-container" styleClass="applicant-field-container">
        <p:row>
          <p:column styleClass="applicant-label-field-col">
            <p:outputLabel value="#{ivy.cms.co('/Dialogs/WorkflowExecution/ApprovalForm/Fullname')}:" for="applicant-fullname" />
          </p:column>
          <p:column styleClass="applicant-field-col">
            <h:outputText id="applicant-fullname" value="#{wfTask.actualApplicant.displayName} (#{wfTask.actualApplicant.name})" />
          </p:column>
        </p:row>
        <p:row>
          <p:column styleClass="applicant-label-field-col">
            <p:outputLabel value="#{ivy.cms.co('/ch.ivy.addon.portalkit.ui.jsf/emailSetting/eMail')}:" for="applicant-mail" />
          </p:column>
          <p:column styleClass="applicant-field-col">
            <h:outputText id="applicant-mail" value="#{wfTask.actualApplicant.EMailAddress}" />
          </p:column>
        </p:row>
      </p:panelGrid>

      <!-- USER TASKS -->
      <p:outputLabel id="form-details-label" value="#{ivy.cms.co('/Dialogs/WorkflowExecution/FinishedTasksForm/FormDetails')}" styleClass="review-content-title" />
      <pe:dynaForm id="dynaForm"
        value="#{wfTask.dynaFormController.model}"
        var="dynaData" columnClasses="label-container, field-container"
        styleClass="Wid100 margin-left-minus-2px">

        <pe:dynaFormControl type="InputFieldText" for="inputFieldText">
          <p:inputText id="inputFieldText" value="#{dynaData.value}"
            required="#{dynaData.required}" readonly="true" />
        </pe:dynaFormControl>

        <pe:dynaFormControl type="InputFieldNumber" for="inputFieldNumber">
          <p:spinner id="inputFieldNumber" value="#{dynaData.value}"
            required="#{dynaData.required}" min="0" readonly="true" />
        </pe:dynaFormControl>

        <pe:dynaFormControl type="InputFieldDate" for="inputFieldDate"
          styleClass="calendar">
          <p:calendar
            locale="#{localeBean.locale}" pattern="#{dateTimePatternBean.datePattern}" 
            id="inputFieldDate" value="#{dynaData.value}"
            required="#{dynaData.required}" showOn="false" readonly="true" />
        </pe:dynaFormControl>

        <pe:dynaFormControl type="InputTextArea" for="inputTextArea">
          <p:inputTextarea id="inputTextArea" value="#{dynaData.value}"
            required="#{dynaData.required}" rows="#{dynaData.intSetting}"
            autoResize="false" disabled="true" readonly="true" />
        </pe:dynaFormControl>

        <pe:dynaFormControl type="ManyCheckbox" for="manyCheckbox">
          <p:dataList value="#{dynaData.value}" var="checkItem" type="definition" >
            <i class="fa fa-check-square-o" aria-hidden="true"></i> #{checkItem}
          </p:dataList>

        </pe:dynaFormControl>

        <pe:dynaFormControl type="OneRadio" for="oneRadio">
          <p:dataList value="#{dynaData.value}" var="checkItem" type="definition" emptyMessage="#{ivy.cms.co('/ch.ivy.addon.portalkit.ui.jsf/common/NoSelection')}">
            <i class="fa fa-dot-circle-o" aria-hidden="true"></i> #{checkItem}
          </p:dataList>
        </pe:dynaFormControl>
        
        <pe:dynaFormControl type="FileUpload" for="fileUpload">
          <ic:ch.ivy.addon.portalkit.component.document.DocumentTable uploadRendered="false" deleteRendered="false" typeColumnRendered="false"
            fileLimit="#{dynaData.intSetting}" />
        </pe:dynaFormControl>

        <pe:dynaFormControl type="Spacer" for="spacer">
          <p:spacer width="50" height="16" id="spacer" />
        </pe:dynaFormControl>
      </pe:dynaForm>

    </p:fieldset>
    
    <ic:ch.ivy.gawfs.component.ApprovalResult id="approval-result-component" approvalResults="#{wfTask.approvalResultList}" 
    rendered="#{not empty wfTask.approvalResultList}" lastApprovalCollapsed="#{!status.last}" />
    
    <p:tooltip id="finished-task-fieldset-tooltip" value="#{wfTask.subject}" for="finished-task-fieldset-legend" trackMouse="true" />
  </ui:repeat>
</cc:implementation>
</html>