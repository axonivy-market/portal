<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:ic="http://ivyteam.ch/jsf/component"
	xmlns:p="http://primefaces.org/ui"
	xmlns:pe="http://primefaces.org/ui/extensions"
	xmlns:pm="http://primefaces.org/mobile">
<h:body>

		<ui:composition template="/layouts/TaskTemplate.xhtml">
		<ui:param name="caseId" value="#{ivy.case.id}" />
		<ui:param name="task" value="#{ivy.task}" />
		<ui:param name="steps" value="#{data.data.steps}" />
		<ui:param name="actualStepIndex" value="2" />
		<ui:param name="isShowStartAdhocButton" value="false" />
		<ui:param name="isNotRequiredLogin" value="false" />


		<ui:define name="title">#{ivy.cms.co('/Dialogs/workflowCreation/FormDefinition/PageTitle')} #{ivy.case.name}</ui:define>
		<ui:define name="taskForm">

			<!-- BREADCRUMB SECTION -->
			<h:panelGroup id="defined-task-container" layout="block" styleClass="defined-task-container">
				<ui:repeat value="#{data.data.definedTasks}" var="definedTask" varStatus="status">
					<p:commandButton id="defined-task-button" value="#{definedTask.subject}"
						styleClass="defined-task-button #{status.index == data.activeTaskIndex ? 'active' : ''}"
						actionListener="#{logic.moveToTask(status.index)}" update="form defined-task-container" process="form" resetValues="true">
					</p:commandButton>
				</ui:repeat>
			</h:panelGroup>

			<h:form id="form">
				<ui:include src="FormElementFieldset.xhtml" />
				<ui:include src="DragAndDropFieldset.xhtml" />
				<ui:include src="PreviewFieldset.xhtml" />

			</h:form>

				<!-- BUTTONS SECTION -->
				<p:outputPanel id="buttons-container" styleClass="TexAlRight">
					<p:commandButton value="#{ivy.cms.co('/ch.ivy.addon.portalkit.ui.jsf/common/back')}" icon="fa fa-arrow-left"
						update="form:selectedFormelementsField" styleClass="buttonDelegate floatLeft" process="form:selectedFormelementsField" actionListener="#{logic.back}"/>
					<p:spacer width="5" />

					<p:commandButton  value="#{ivy.cms.co('/Dialogs/workflowCreation/FormDefinition/SaveWorkflow')}" icon="fa fa-save"
						styleClass="buttonDelegate" update="form:selectedFormelementsField" process="form:selectedFormelementsField" actionListener="#{logic.save}"/>
					<p:spacer width="5" rendered="#{data.data.processType eq 'REPEAT'}" />

					<p:commandButton id="execute-button" icon="fa fa-check" styleClass="buttonDelegate"
						value="#{ivy.cms.co('/Dialogs/workflowCreation/FormDefinition/ExecuteWorkflow')}"
						rendered="#{(data.data.processType eq 'AD_HOC')}"
						disabled="#{!formDefinitionBean.canFinishFormDefinition(data.data.definedTasks)}"
						update="form:selectedFormelementsField" process="form:selectedFormelementsField" actionListener="#{logic.directExecution}"/>
					<p:spacer width="5" />

					<p:commandButton id="next-button" icon="fa fa-arrow-right" styleClass="buttonDelegate"
						value="#{ivy.cms.co('/ch.ivy.addon.portalkit.ui.jsf/common/next')}"
						rendered="#{data.activeTaskIndex ne (data.data.definedTasks.size() -1)}"
						update="form defined-task-container buttons-container" process="form" actionListener="#{logic.moveNextTask}" resetValues="true" />
					<p:spacer width="5" />

					<p:commandButton value="#{ivy.cms.co('/ch.ivy.addon.portalkit.ui.jsf/common/cancel')}" icon="fa fa-times"
						actionListener="#{logic.cancel}" styleClass="buttonDelegate portal-cancel-button" update="form:selectedFormelementsField" process="form:selectedFormelementsField"/>

				</p:outputPanel>
		</ui:define>

    <ui:define name="css">
      <h:outputStylesheet library="css" name="portal_express.css" />
    </ui:define>
  </ui:composition>
</h:body>
</html>