<html xmlns="http://www.w3.org/1999/xhtml" xmlns:f="http://java.sun.com/jsf/core" xmlns:h="http://java.sun.com/jsf/html"
  xmlns:ui="http://java.sun.com/jsf/facelets" xmlns:ic="http://ivyteam.ch/jsf/component"
  xmlns:p="http://primefaces.org/ui" xmlns:pe="http://primefaces.org/ui/extensions"
  xmlns:c="http://java.sun.com/jsp/jstl/core">
<h:body>
  <p:panelGrid id="form-elements-container" styleClass="form-elements-container" layout="grid" columns="2"
    columnClasses="ui-g-3, ui-g-9">
    <p:fieldset id="available-formelements-field" styleClass="available-formelements-field"
      legend="#{ivy.cms.co('/Dialogs/workflowCreation/FormDefinition/FieldSetAvailableFormelements')}">
      <p:messages id="DnDmessage" showDetail="false" closable="true" for="availableFormelements">
       <p:autoUpdate />
      </p:messages>

      <p:dataGrid id="availableFormelements" var="formelement" styleClass="no-border"
        emptyMessage="#{ivy.cms.co('/Dialogs/workflowCreation/FormDefinition/NoFormelementsAvailable')}"
        value="#{data.dragAndDropController.availableFormelements}" columns="1">
        <p:panel id="pnl" styleClass="TexAlCenter vertical-align-middle">
          <p:panelGrid styleClass="no-border TexAlLeft">
            <p:row>
              <p:column styleClass="no-border">
                <p:graphicImage library="ivy-cms" name="/Layouts/Icons/#{formelement.type.value}" width="100" />
              </p:column>
              <p:column styleClass="no-border Wid100">
                <p:outputLabel value="#{formelement.label}" styleClass="Fs18" />
              </p:column>
              <p:column styleClass="create-input-field-panel-grid-action-btn">
                <p:commandButton icon="fa fa-trash fa-3x" title=""
                  styleClass="buttonDelegate placement-form-element-remove-btn"
                  actionListener="#{data.dragAndDropController.deleteFormelement(formelement)}"
                  process="form:availableFormelements" update="form:availableFormelements">
                </p:commandButton>
              </p:column>
            </p:row>
          </p:panelGrid>
        </p:panel>
        <p:draggable for="pnl" revert="true" stack=".ui-panel" />
      </p:dataGrid>
    </p:fieldset>

    <p:fieldset id="selected-formelements-field" styleClass="selected-formelements-field"
      legend="#{ivy.cms.co('/Dialogs/workflowCreation/FormDefinition/FieldSetFormelementsPlacing')}">
      <p:commandButton id="show-preview-button"
        value="#{ivy.cms.co('/Dialogs/workflowCreation/FormDefinition/Preview')}"
        styleClass="Fright show-preview-button" icon="fa fa-search" oncomplete="PF('preview-dialog').show();"
        actionListener="#{data.dragAndDropController.updateForm}" process="@this" />

      <p:panelGrid styleClass="Wid100 form-definition-table">
        <p:row id="selectedFormelementsHeaderFieldSet" styleClass="TexAlCenter form-definition-border-color">
          <p:column colspan="2">

            <p:outputPanel id="selectedFormelementsHeaderPanel" styleClass="selected-formelements-panel header-section">
              <p:outputPanel rendered="#{empty data.dragAndDropController.selectedFormelementsHeader}">
                <br />
                <h:outputText value="#{ivy.cms.co('/Dialogs/workflowCreation/FormDefinition/BroadHeaderArea')}"
                  styleClass="Fs24" />
                <br />
                <br />
              </p:outputPanel>
              <h:outputText value="#{ivy.cms.co('/Dialogs/workflowCreation/FormDefinition/BroadHeaderArea')}"
                rendered="#{not empty data.dragAndDropController.selectedFormelementsHeader}" />
              <p:dataGrid id="selectedFormelementsHeader" var="formelement" styleClass="no-border"
                value="#{data.dragAndDropController.selectedFormelementsHeader}"
                rendered="#{not empty data.dragAndDropController.selectedFormelementsHeader}" columns="1">
                <p:panel id="pnl">
                  <p:panelGrid styleClass="no-border TexAlLeft Wid100">
                    <p:row>
                      <p:column styleClass="no-border">
                        <p:graphicImage library="ivy-cms" name="/Layouts/Icons/#{formelement.type.value}" width="80" />
                      </p:column>
                      <p:column styleClass="no-border Wid100">
                        <p:outputLabel value="#{formelement.label}" styleClass="Fs18" />
                      </p:column>
                      <p:column styleClass="create-input-field-panel-grid-action-btn">
                        <p:commandButton icon="fa fa-trash fa-3x" title=""
                          styleClass="buttonDelegate placement-form-element-remove-btn"
                          actionListener="#{data.dragAndDropController.resetFormelementHeader(formelement)}"
                          process="form:selectedFormelementsHeader" update="form">
                        </p:commandButton>
                      </p:column>
                    </p:row>
                  </p:panelGrid>
                </p:panel>
              </p:dataGrid>

              <p:droppable for="selectedFormelementsHeaderPanel" tolerance="pointer"
                activeStyleClass="ui-state-highlight" datasource="form:availableFormelements" onDrop="handleDrop"
                hoverStyleClass="hover-drop-section">
                <p:ajax listener="#{data.dragAndDropController.onFieldDropHeader}"
                  update="form:selectedFormelementsHeaderPanel form:availableFormelements form:dynaForm" />
              </p:droppable>
            </p:outputPanel>
          </p:column>
        </p:row>
        <p:row styleClass="TexAlCenter form-definition-border-color">
          <p:column colspan="1" id="selectedFormelementsLeftPanelFieldSet"
            styleClass="Wid50 TexAlCenter form-definition-border-color">

            <p:outputPanel id="selectedFormelementsLeftPanelPanel" styleClass="selected-formelements-panel left-section">

              <p:outputPanel rendered="#{empty data.dragAndDropController.selectedFormelementsLeftPanel}">
                <br />
                <h:outputText value="#{ivy.cms.co('/Dialogs/workflowCreation/FormDefinition/LeftColumn')}"
                  styleClass="Fs24" />
                <br />
                <br />
              </p:outputPanel>
              <h:outputText value="#{ivy.cms.co('/Dialogs/workflowCreation/FormDefinition/LeftColumn')}"
                rendered="#{not empty data.dragAndDropController.selectedFormelementsLeftPanel}" />

              <p:dataGrid id="selectedFormelementsLeftPanel" var="formelement" styleClass="no-border" columns="1"
                value="#{data.dragAndDropController.selectedFormelementsLeftPanel}"
                rendered="#{not empty data.dragAndDropController.selectedFormelementsLeftPanel}">

                <p:panel id="pnl" styleClass="TexAlCenter vertical-align-middle">
                  <p:panelGrid styleClass="no-border TexAlLeft">
                    <p:row>
                      <p:column styleClass="no-border">
                        <p:graphicImage library="ivy-cms" name="/Layouts/Icons/#{formelement.type.value}" width="80" />
                      </p:column>
                      <p:column styleClass="no-border Wid100">
                        <p:outputLabel value="#{formelement.label}" styleClass="Fs18" />
                      </p:column>
                      <p:column styleClass="create-input-field-panel-grid-action-btn">
                        <p:commandButton icon="fa fa-trash fa-3x" title=""
                          styleClass="buttonDelegate placement-form-element-remove-btn"
                          actionListener="#{data.dragAndDropController.resetFormelementLeftPanel(formelement)}"
                          process="form:selectedFormelementsLeftPanel" update="form">
                        </p:commandButton>
                      </p:column>
                    </p:row>
                  </p:panelGrid>
                </p:panel>
              </p:dataGrid>

              <p:droppable for="selectedFormelementsLeftPanelPanel" tolerance="pointer"
                activeStyleClass="ui-state-highlight" hoverStyleClass="hover-drop-section"
                datasource="form:availableFormelements" onDrop="handleDrop">
                <p:ajax listener="#{data.dragAndDropController.onFieldDropLeftPanel}"
                  update="form:selectedFormelementsLeftPanelPanel form:availableFormelements form:dynaForm" />
              </p:droppable>
            </p:outputPanel>
          </p:column>

          <p:column colspan="1" id="selectedFormelementsRightPanelFieldSet" styleClass="TexAlCenter Wid50">
            <p:outputPanel id="selectedFormelementsRightPanelPanel"
              styleClass="selected-formelements-panel right-section">
              <p:outputPanel rendered="#{empty data.dragAndDropController.selectedFormelementsRightPanel}">
                <br />
                <h:outputText value="#{ivy.cms.co('/Dialogs/workflowCreation/FormDefinition/RightColumn')}"
                  styleClass="Fs24" />
                <br />
                <br />
              </p:outputPanel>
              <h:outputText value="#{ivy.cms.co('/Dialogs/workflowCreation/FormDefinition/RightColumn')}"
                rendered="#{not empty data.dragAndDropController.selectedFormelementsRightPanel}" />

              <p:dataGrid id="selectedFormelementsRightPanel" var="formelement" styleClass="no-border TexAlCenter"
                columns="1" value="#{data.dragAndDropController.selectedFormelementsRightPanel}"
                rendered="#{not empty data.dragAndDropController.selectedFormelementsRightPanel}">
                <p:panel id="pnl" styleClass="TexAlCenter vertical-align-middle">
                  <p:panelGrid styleClass="no-border TexAlLeft">
                    <p:row>
                      <p:column styleClass="no-border">
                        <p:graphicImage library="ivy-cms" name="/Layouts/Icons/#{formelement.type.value}" width="80" />
                      </p:column>
                      <p:column styleClass="no-border Wid100">
                        <p:outputLabel value="#{formelement.label}" styleClass="Fs18" />
                      </p:column>
                      <p:column styleClass="create-input-field-panel-grid-action-btn">
                        <p:commandButton icon="fa fa-trash fa-3x" title=""
                          styleClass="buttonDelegate placement-form-element-remove-btn"
                          actionListener="#{data.dragAndDropController.resetFormelementRightPanel(formelement)}"
                          process="form:selectedFormelementsRightPanel" update="form">
                        </p:commandButton>
                      </p:column>
                    </p:row>
                  </p:panelGrid>

                </p:panel>

              </p:dataGrid>

              <p:droppable for="selectedFormelementsRightPanelPanel" tolerance="pointer"
                activeStyleClass="ui-state-highlight" hoverStyleClass="hover-drop-section"
                datasource="form:availableFormelements" onDrop="handleDrop">

                <p:ajax listener="#{data.dragAndDropController.onFieldDropRightPanel}"
                  update="form:selectedFormelementsRightPanelPanel form:availableFormelements form:dynaForm" />
              </p:droppable>
            </p:outputPanel>
          </p:column>
        </p:row>

        <p:row id="selectedFormelementsFooterFieldSet" styleClass="TexAlCenter form-definition-border-color">
          <p:column colspan="2">
            <p:outputPanel id="selectedFormelementsFooterPanel" styleClass="selected-formelements-panel footer-section">

              <p:outputPanel rendered="#{empty data.dragAndDropController.selectedFormelementsFooter}">
                <br />
                <h:outputText value="#{ivy.cms.co('/Dialogs/workflowCreation/FormDefinition/BroadFooterArea')}"
                  styleClass="Fs24" />
                <br />
                <br />
              </p:outputPanel>
              <h:outputText value="#{ivy.cms.co('/Dialogs/workflowCreation/FormDefinition/BroadFooterArea')}"
                rendered="#{not empty data.dragAndDropController.selectedFormelementsFooter}" />

              <p:dataGrid id="selectedFormelementsFooter" var="formelement"
                value="#{data.dragAndDropController.selectedFormelementsFooter}"
                rendered="#{not empty data.dragAndDropController.selectedFormelementsFooter}"
                styleClass="no-border TexAlCenter" columns="1">

                <p:panel id="pnl" styleClass="TexAlCenter vertical-align-middle">
                  <p:panelGrid styleClass="no-border TexAlLeft Wid100">
                    <p:row>
                      <p:column styleClass="no-border">
                        <p:graphicImage library="ivy-cms" name="/Layouts/Icons/#{formelement.type.value}" width="80" />
                      </p:column>
                      <p:column styleClass="no-border Wid100">
                        <p:outputLabel value="#{formelement.label}" styleClass="Fs18" />

                      </p:column>
                      <p:column styleClass="create-input-field-panel-grid-action-btn">
                        <p:commandButton icon="fa fa-trash fa-3x"
                          styleClass="buttonDelegate placement-form-element-remove-btn"
                          actionListener="#{data.dragAndDropController.resetFormelementFooter(formelement)}"
                          process="form:selectedFormelementsFooter" update="form">
                        </p:commandButton>
                      </p:column>
                    </p:row>
                  </p:panelGrid>
                </p:panel>
              </p:dataGrid>

              <p:droppable for="selectedFormelementsFooterPanel" tolerance="pointer"
                activeStyleClass="ui-state-highlight" hoverStyleClass="hover-drop-section"
                datasource="form:availableFormelements" onDrop="handleDrop">

                <p:ajax listener="#{data.dragAndDropController.onFieldDropFooter}"
                  update="form:selectedFormelementsFooterPanel form:availableFormelements form:dynaForm" />
              </p:droppable>

            </p:outputPanel>
          </p:column>
        </p:row>
      </p:panelGrid>
    </p:fieldset>
  </p:panelGrid>

  <p:dialog id="preview-dialog" widgetVar="preview-dialog" styleClass="preview-dialog" width="70%" closable="true"
    modal="true" draggable="true" resizable="false" dynamic="true" fitViewport="true"
    header="#{ivy.cms.co('/Dialogs/workflowCreation/FormDefinition/FieldSetPreviewArea')}">
      <ui:include src="PreviewFieldset.xhtml" />
    <h:panelGroup layout="block" class="u-dialog-footer ui-dialog-footer">
      <p:commandButton type="button" value="#{ivy.cms.co('/ch.ivy.addon.portalkit.ui.jsf/common/close')}"
        onclick="PF('preview-dialog').hide();" />
    </h:panelGroup>
  </p:dialog>

</h:body>
</html>