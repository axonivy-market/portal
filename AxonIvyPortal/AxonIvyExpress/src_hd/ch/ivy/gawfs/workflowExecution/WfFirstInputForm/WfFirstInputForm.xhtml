<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:ic="http://ivyteam.ch/jsf/component"
	xmlns:p="http://primefaces.org/ui"
	xmlns:pe="http://primefaces.org/ui/extensions"
	xmlns:pm="http://primefaces.org/mobile">
<h:body>

		<ui:composition template="/layouts/TaskTemplate.xhtml">
		<ui:param name="caseId" value="#{ivy.case.id}" />
		<ui:param name="task" value="#{ivy.task}" />
		<ui:param name="steps"
			value="#{data.executePredefinedWorkflowData.steps}" />
		<ui:param name="actualStepIndex"
			value="#{data.executePredefinedWorkflowData.actualStepIndex}" />
		<ui:param name="isNotRequiredLogin" value="false" />
		<ui:define name="title"></ui:define>
		<ui:define name="taskForm">

			<h:form id="form">
				<p:fieldset id="applicantFieldSet" toggleable="true" legend="#{ivy.cms.co('/Dialogs/WorkflowExecution/WfFirstInputForm/FieldSetApplicant')}">

					<p:panelGrid id="prozessSettingsGrid" styleClass="applicant-field-container">
						<p:row styleClass="applicant-selection-container">

							<p:column styleClass="applicant-field-col">
								<p:outputLabel value="#{ivy.cms.co('/Dialogs/WorkflowExecution/WfFirstInputForm/StartProcess')}:" for="processApplicant" />
							</p:column>

							<p:column styleClass="applicant-field-col">
								<p:selectOneRadio id="processApplicant" 
									value="#{data.assignementType}" layout="custom">
									<f:selectItem itemLabel="#{ivy.cms.co('/Dialogs/WorkflowExecution/WfFirstInputForm/inOwnName')}" itemValue="0" />
									<f:selectItem itemLabel="#{ivy.cms.co('/Dialogs/WorkflowExecution/WfFirstInputForm/as3rdPerson')}"
										itemValue="1" />
									<p:ajax listener="#{logic.setApplicant}"
										process="form:applicantFieldSet"
										update="form:applicantFieldSet form:applicantField" />
								</p:selectOneRadio>

								<h:panelGrid columns="2" cellpadding="5">
									<p:radioButton id="opt1" for="processApplicant" itemIndex="0" />
									<h:outputLabel for="opt1" value="#{ivy.cms.co('/Dialogs/WorkflowExecution/WfFirstInputForm/inOwnName')}" />
								</h:panelGrid>

							</p:column>
							<p:column styleClass="u-no-border" colspan="2">


								<h:panelGrid columns="3" cellpadding="5">
									<p:radioButton id="opt2" for="processApplicant" itemIndex="1" />
									<h:outputLabel for="opt2" value="#{ivy.cms.co('/Dialogs/WorkflowExecution/WfFirstInputForm/as3rdPerson')} " />
									<!-- Must be "readonly" with AD, otherwise error! -->
									<p:inputText
										value="#{data.executePredefinedWorkflowData.applicant.user.name}"
										id="applicantField" disabled="#{data.assignementType eq 0}"
										required="#{param['form:save']!=null}">
										<p:ajax event="mousedown" listener="#{logic.setApplicant}"
											oncomplete="PF('chooseApplicant').show();"
											process="form:applicantFieldSet"
											update="form:applicantFieldSet" />
									</p:inputText>
								</h:panelGrid>

							</p:column>

						</p:row>
						<p:row>
							<p:column styleClass="applicant-field-col padding-top-15">
								<p:outputLabel value="#{ivy.cms.co('/ch.ivy.addon.portalkit.ui.jsf/login/username')}:" for="applicantName" />
							</p:column>
							<p:column styleClass="applicant-field-col padding-top-15">
								<p:inputText id="applicantName" styleClass="applicant-field-input"
									value="#{data.executePredefinedWorkflowData.applicant.username}"
									disabled="true" />
							</p:column>
							<p:column styleClass="applicant-field-col padding-top-15">
								<p:outputLabel value="#{ivy.cms.co('/Dialogs/WorkflowExecution/WfFirstInputForm/fullName')}:" for="applicantLastname" />
							</p:column>
							<p:column styleClass="applicant-field-col padding-top-15">
								<p:inputText id="applicantLastname" styleClass="applicant-field-input"
									value="#{data.executePredefinedWorkflowData.applicant.fullname}"
									disabled="true" />
							</p:column>
						</p:row>

						<p:row>
							<p:column styleClass="applicant-field-col">
								<p:outputLabel value="#{ivy.cms.co('/ch.ivy.addon.portalkit.ui.jsf/emailSetting/eMail')}:" for="applicantMail" />
							</p:column>
							<p:column styleClass="applicant-field-col">
								<p:inputText id="applicantMail" styleClass="applicant-field-input"
									value="#{data.executePredefinedWorkflowData.applicant.email}"
									disabled="true" />
							</p:column>
						</p:row>
					</p:panelGrid>


				</p:fieldset>
				<br />

				<p:fieldset id="dynaFormFieldSet" toggleable="true" legend="Formular">
					<p:messages id="messagesDynaForm" showDetail="false"
						autoUpdate="true" closable="true" />



					<pe:dynaForm id="dynaForm"
						value="#{data.executePredefinedWorkflowData.dynaFormController.model}"
						var="dynaData" columnClasses="label-container, field-container"
						styleClass="dynaFormGrid Wid100">

						<pe:dynaFormControl type="InputFieldText" for="inputFieldText">
							<p:inputText id="inputFieldText" value="#{dynaData.value}"
								required="#{dynaData.required}" requiredMessage="#{dynaData.label} #{ivy.cms.co('/ch.ivy.addon.portalkit.ui.jsf/common/requiredFieldMessage')}"/>
						</pe:dynaFormControl>

						<pe:dynaFormControl type="InputFieldNumber" for="inputFieldNumber">
							<p:spinner id="inputFieldNumber" value="#{dynaData.value}" styleClass="inputFieldNrSpinner"
								required="#{dynaData.required}" min="0" requiredMessage="#{dynaData.label} #{ivy.cms.co('/ch.ivy.addon.portalkit.ui.jsf/common/requiredFieldMessage')}"/>
						</pe:dynaFormControl>

						<pe:dynaFormControl type="InputFieldDate" for="inputFieldDate"
							styleClass="calendar">
							<p:calendar 
								locale="#{localeBean.locale}" pattern="#{dateTimePatternBean.datePattern}" 
								id="inputFieldDate" value="#{dynaData.value}"
								required="#{dynaData.required}" showOn="button" requiredMessage="#{dynaData.label} #{ivy.cms.co('/ch.ivy.addon.portalkit.ui.jsf/common/requiredFieldMessage')}"/>
						</pe:dynaFormControl>

						<pe:dynaFormControl type="InputTextArea" for="inputTextArea">
							<p:inputTextarea id="inputTextArea" value="#{dynaData.value}"
								required="#{dynaData.required}" rows="#{dynaData.intSetting}"
								autoResize="false" requiredMessage="#{dynaData.label} #{ivy.cms.co('/ch.ivy.addon.portalkit.ui.jsf/common/requiredFieldMessage')}"/>
						</pe:dynaFormControl>

						<pe:dynaFormControl type="ManyCheckbox" for="manyCheckbox">
							<p:selectManyCheckbox id="manyCheckbox" value="#{dynaData.value}"
								required="#{dynaData.required}" layout="pageDirection" requiredMessage="#{dynaData.label} #{ivy.cms.co('/ch.ivy.addon.portalkit.ui.jsf/common/requiredFieldMessage')}">
								<f:selectItems value="#{dynaData.optionsStr}" />
							</p:selectManyCheckbox>
						</pe:dynaFormControl>

						<pe:dynaFormControl type="OneRadio" for="oneRadio">
							<p:selectOneRadio id="oneRadio" value="#{dynaData.value}"
								required="#{dynaData.required}" layout="pageDirection">
								<f:selectItems value="#{dynaData.optionsStr}" requiredMessage="#{dynaData.label} #{ivy.cms.co('/ch.ivy.addon.portalkit.ui.jsf/common/requiredFieldMessage')}"/>
							</p:selectOneRadio>
						</pe:dynaFormControl>


						<pe:dynaFormControl type="FileUpload" for="fileUpload">
						
							<ic:component.CaseDocument uploadPossible="true"
								noOfFiles="#{dynaData.intSetting}" fileLimit="#{dynaData.intSetting}"
								allowFiletypes="#{dynaData.options}" requiredMessage="#{dynaData.label} #{ivy.cms.co('/ch.ivy.addon.portalkit.ui.jsf/common/requiredFieldMessage')}"/>
								
						</pe:dynaFormControl>

						<pe:dynaFormControl type="Spacer" for="spacer">
							<p:spacer width="50" height="16" id="spacer" />
						</pe:dynaFormControl>



					</pe:dynaForm>


				</p:fieldset>
				<br/>
				<p:outputPanel styleClass="TexAlRight">
					<p:commandButton value="#{ivy.cms.co('/Dialogs/agileBPM/define_WF/StartWF')}" update="form"
						actionListener="#{logic.close}" styleClass="buttonDelegate" icon="fa fa-check"/>
					<p:spacer width="5" />
					<p:commandButton value="#{ivy.cms.co('/ch.ivy.addon.portalkit.ui.jsf/common/cancel')}" immediate="true" update="form"
						actionListener="#{logic.cancel}" styleClass="buttonDelegate portal-cancel-button" icon="fa fa-times"/>
				</p:outputPanel>




			</h:form>


			<p:dialog id="chooseApplicant" header="#{ivy.cms.co('/Dialogs/WorkflowExecution/WfFirstInputForm/chooseApplicant/chooseApplicant')}:"
				widgetVar="chooseApplicant" modal="true" appendTo="@(body)">
				<ui:include src="ChooseApplicant.xhtml"></ui:include>
			</p:dialog>

		</ui:define>





    <ui:define name="css">
      <h:outputStylesheet library="css" name="portal_express.css" />
    </ui:define>
  </ui:composition>
</h:body>
</html>