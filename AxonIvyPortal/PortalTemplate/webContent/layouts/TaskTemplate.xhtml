<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:f="http://java.sun.com/jsf/core" xmlns:h="http://java.sun.com/jsf/html"
  xmlns:ui="http://java.sun.com/jsf/facelets" xmlns:ic="http://ivyteam.ch/jsf/component"
  xmlns:p="http://primefaces.org/ui" xmlns:c="http://java.sun.com/jsp/jstl/core"
  xmlns:pe="http://primefaces.org/ui/extensions" xmlns:pm="http://primefaces.org/mobile">
<h:body>
  <ui:composition template="/layouts/BasicTemplate.xhtml">
    <ui:param name="isWorkingOnATask" value="true" />
    <ui:define name="pageContent">
      <h:outputScript target="head" name="layouts/js/zero_clipboard/ZeroClipboard.js" />
      <script>
              var flashFileDirectory = '#{resource["ivy-webcontent:layouts/js/zero_clipboard/ZeroClipboard.swf"]}';
              var copyHintMessage = "#{ivy.cms.co('/ch.ivy.addon.portal.generic/OpenTaskTemplate/copyHintMessage')}";
              var copiedToClipboardMessage = "#{ivy.cms.co('/ch.ivy.addon.portal.generic/OpenTaskTemplate/copiedToClipboard')}";
            </script>
      <h:outputScript target="head" name="layouts/js/copy-clipboard.js" />

      <ui:insert name="breadCrumb" />

      <div>
        <div class="Fleft Wid30 Fs20 foreground-text-color MarTop10">
          <ui:insert name="taskName">
            <span class=" fa fa-check-square-o task-template-title-icon"></span>
            <h:outputText id="title" title="#{task.name} (##{task.id})" value="#{task.name} (##{task.id})" />
          </ui:insert>
        </div>
        <div class="Fright Wid70">
          <ui:insert name="process_chain_area">
            <ic:ch.ivy.addon.portalkit.singleapp.process.ProcessChain startMethod="start"
              actualStepIndex="#{actualStepIndex}" steps="#{steps}" />
          </ui:insert>
        </div>
      </div>

      <div class="ClearBoth" />

      <div class="task-template-content">
        <ui:insert name="errorsZone" />
        <ui:insert name="infoZone" />

        <p:panelGrid columns="2" styleClass="task-template-tasks-command">
          <p:link id="copy-clipboard" href="#"
            title="#{ivy.cms.co('/ch.ivy.addon.portal.generic/OpenTaskTemplate/copyTooltip')}">
            <i class="fa fa-share-alt fa-2x" />
          </p:link>
          <p:link id="add-case-note" onclick="PF('addCaseNoteDialog').show()" href="#"
            title="#{ivy.cms.co('/ch.ivy.addon.portalkit.ui.jsf/taskInformation/addNote')}">
            <i class="fa fa-pencil-square-o fa-2x" />
          </p:link>
        </p:panelGrid>

        <p:growl id="clipboard-growl" widgetVar="clipboard-growl" for="copy-clipboard" />

        <p:overlayPanel id="copy-clipboard-panel" widgetVar="copy-clipboard-panel" for="copy-clipboard" my="left top"
          at="left bottom" showEvent="none">
          <h:form prependId="false">
            <p:remoteCommand actionListener="#{taskBean.getUrlOfTaskDetails(ivy.task.id)}" autoRun="true"
              update="#{p:component('task-details-url')}" />
            <p:panelGrid columns="1">
              <p:outputLabel id="task-details-url-label"
                value="#{ivy.cms.co('/ch.ivy.addon.portal.generic/OpenTaskTemplate/copiedToClipboard')}" />
              <p:inputText id="task-details-url" readonly="true" size="#{taskBean.taskDetailsUrl.length()}"
                value="#{taskBean.taskDetailsUrl}" />
            </p:panelGrid>
          </h:form>
        </p:overlayPanel>

        <p:tabView prependId="false">
          <ui:insert name="dynamicTabs">
            <!--              You can add one or many tabs here -->
          </ui:insert>

          <p:tab id="request-tab"
            title="#{ivy.cms.co('/ch.ivy.addon.portal.generic/CaseDetailsTemplate/requestTabTitle')}"
            rendered="#{showTaskFormTab == null ? true : showTaskFormTab}">
            <ui:insert name="taskForm">
              <!--                Task Form -->
            </ui:insert>
          </p:tab>

          <p:tab id="document-tab"
            title="#{ivy.cms.co('/ch.ivy.addon.portal.generic/CaseDetailsTemplate/documentTabTitle')}"
            rendered="#{showDocumentTab == null ? true : showDocumentTab}">
            <ui:insert name="documentTab">
              <c:choose>
                <c:when test="#{caseId == null}">
                  <h:outputText value="#{ivy.cms.co('/ch.ivy.addon.portal.generic/CaseDetailsTemplate/noCaseId')}" />
                </c:when>
                <c:otherwise>
                  <ic:ch.ivy.addon.portalkit.singleapp.cases.CaseDocument id="case-documents" caseId="#{caseId}"
                    startMethod="start" />
                </c:otherwise>
              </c:choose>
            </ui:insert>
          </p:tab>

          <p:tab id="note-tab" title="#{ivy.cms.co('/ch.ivy.addon.portal.generic/CaseDetailsTemplate/noteTabTitle')}"
            rendered="#{showNoteTab == null ? true : showNoteTab}">
            <ui:insert name="noteTab">
              <c:choose>
                <c:when test="#{caseId == null}">
                  <h:outputText value="#{ivy.cms.co('/ch.ivy.addon.portal.generic/CaseDetailsTemplate/noCaseId')}" />
                </c:when>
                <c:otherwise>
                  <ic:ch.ivy.addon.portalkit.singleapp.cases.CaseNote id="case-notes" startMethod="start"
                    caseId="#{caseId}" />
                </c:otherwise>
              </c:choose>
            </ui:insert>
          </p:tab>

          <p:tab id="status-tab"
            title="#{ivy.cms.co('/ch.ivy.addon.portal.generic/CaseDetailsTemplate/statusTabTitle')}"
            rendered="#{showCaseStatusInfoTab == null ? true : showCaseStatusInfoTab}">
            <ui:insert name="caseStatusTab">
              <c:choose>
                <c:when test="#{caseId == null}">
                  <h:outputText value="#{ivy.cms.co('/ch.ivy.addon.portal.generic/CaseDetailsTemplate/noCaseId')}" />
                </c:when>
                <c:otherwise>
                  <ic:ch.ivy.addon.portalkit.singleapp.cases.CaseStatusInformation id="case-status-container"
                    homeLink="#{homeLink}" caseId="#{caseId}" />
                </c:otherwise>
              </c:choose>
            </ui:insert>
          </p:tab>

          <p:tab id="history-tab"
            title="#{ivy.cms.co('/ch.ivy.addon.portal.generic/CaseDetailsTemplate/historyTabTitle')}"
            rendered="#{showHistoryTab == null ? true : showHistoryTab}">
            <ui:insert name="caseHistoryTab">
              <c:choose>
                <c:when test="#{caseId == null}">
                  <h:outputText value="#{ivy.cms.co('/ch.ivy.addon.portal.generic/CaseDetailsTemplate/noCaseId')}" />
                </c:when>
                <c:otherwise>
                  <ic:ch.ivy.addon.portalkit.singleapp.cases.CaseHistory id="case-history-container" caseId="#{caseId}" />
                </c:otherwise>
              </c:choose>
            </ui:insert>
          </p:tab>
        </p:tabView>
      </div>

      <div>
        <div class="Fleft">
          <ui:insert name="leftButtons">
          </ui:insert>
        </div>

        <div class="Fright">
          <ui:insert name="rightButtons">
          </ui:insert>
        </div>
      </div>

      <ic:ch.ivy.addon.portalkit.feature.WarnOnClosingBrowserTab
        confirmMessage="#{ivy.cms.co('/ch.ivy.addon.portal.generic/OpenTaskTemplate/browserTabClosingWarning')}" />

    </ui:define>
  </ui:composition>
</h:body>
</html>