<html xmlns="http://www.w3.org/1999/xhtml" xmlns:f="http://xmlns.jcp.org/jsf/core"
  xmlns:h="http://xmlns.jcp.org/jsf/html" xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
  xmlns:p="http://primefaces.org/ui" xmlns:pe="http://primefaces.org/ui/extensions"
  xmlns:c="http://xmlns.jcp.org/jsp/jstl/core" xmlns:ic="http://ivyteam.ch/jsf/component">

<p:remoteCommand name="loadSaveFilters#{index}"
  actionListener="#{widget.updateSavedFiltersSelection()}"
  process="@this" partialSubmit="true" immediate="true"
  update="saved-filters-container"/>

<div class="ui-g-12 filter-overlay-panel__header">
  <strong class="ui-g-12 u-no-padding-left">#{ivy.cms.co('/ch.ivy.addon.portalkit.ui.jsf/dashboard/SavedFilterHeader')}</strong>
  <p:commandLink value="#{ivy.cms.co('/ch.ivy.addon.portalkit.ui.jsf/dashboard/ManageFilter')}"
    styleClass="ui-sm-hidden saved-filter__manage-filter" global="false"
    onclick="PF('filter-overlay-panel-#{index}').hide(); PF('manage-filter-dialog').show(); return false;" />
</div>
<div class="ui-g-12 ui-fluid">
  <div class="ui-g-12 saved-filter--search-container">
    <p:inputText id="search-saved-filter-input"
      placeholder="#{ivy.cms.co('/ch.ivy.addon.portalkit.ui.jsf/dashboard/SearchForFilter')}"
      styleClass="saved-filter__search" value="#{widget.searchSavedFilterKeyword}"
      valueChangeListener="#{widget.searchSavedFilters()}">
      <i class="saved-filter__search-icon si si-search ui-sm-hidden" />
      <p:ajax event="keyup" listener="#{widget.searchSavedFilters()}" delay="50" partialSubmit="true" global="false"
        process="@this search-saved-filter-input" update="@(.saved-filter__content) widget-saved-filters-items" />
      <p:ajax event="change" listener="#{widget.searchSavedFilters()}" delay="50" partialSubmit="true" global="false"
        process="@this search-saved-filter-input" update="@(.saved-filter__content) widget-saved-filters-items" />
    </p:inputText>
  </div>
  <h:outputText rendered="#{empty widget.savedFilters}" styleClass="ui-g-12 saved-filter--not-found"
    value="#{ivy.cms.co('/ch.ivy.addon.portalkit.ui.jsf/dashboard/NoSavedFilterMessage')}">
  </h:outputText>
</div>

<h:panelGroup id="widget-saved-filters-items" layout="block"
  styleClass="ui-g-12 saved-filter__content ui-fluid u-padding-0">
  <h:panelGroup styleClass="saved-filter__items" layout="block" rendered="#{not empty widget.savedFilters}">
    <ui:repeat id="saved-filter-#{index}" value="#{widget.savedFilters}" var="filter" varStatus="filterStatus">
      <h:panelGroup id="saved-filter-node" layout="block"
        styleClass="saved-filter-node #{widget.isSavedFilterSelected(filter) ? 'selected' : ''}">
        <h:outputText value="#{filter.name}" styleClass="saved-filter-node__text" />
        <p:ajax event="click" partialSubmit="true" process="@this" immediate="true"
          update="saved-filter-node #{widgetFilterContentId}"
          listener="#{dashboardBean.onClickSavedFilterItem(filter, widget)}" />
      </h:panelGroup>
    </ui:repeat>
  </h:panelGroup>
  <div class="ui-g-12">
    <h:outputText rendered="#{empty widget.savedFilters and not empty widget.userFilterCollection.widgetFilterSelections}"
      styleClass="ui-g-12 saved-filter--not-found" value="#{ivy.cms.co('/ch.ivy.addon.portalkit.ui.jsf/dashboard/Filter/NotFound')}">
    </h:outputText>
  </div>
</h:panelGroup>

</html>