<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:f="http://xmlns.jcp.org/jsf/core"
  xmlns:h="http://xmlns.jcp.org/jsf/html" xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
  xmlns:ic="http://ivyteam.ch/jsf/component" xmlns:p="http://primefaces.org/ui"
  xmlns:c="http://java.sun.com/jsp/jstl/core" xmlns:pe="http://primefaces.org/ui/extensions">
<h:body>
  <ui:composition template="/layouts/AbstractTaskTemplate.xhtml">
    <!-- AVAILABLE PARAMS in this template: -->
    <!-- taskId (required): working task id -->
    <!-- currentProcessStep: current process step -->
    <!-- processSteps: list of process steps -->
    <!-- processChainDirection: VERTICAL or HORIZONTAL (default) -->
    <!-- processChainShape: LINE or CIRCLE (default) -->
    <!-- announcementInvisible: display announcement written by administrator, default: true -->
    <!-- PASS PARAMS TO THIS TEMPLATE VIA JAVASCRIPT: -->
    <!-- <script> -->
    <!--   window.taskId = #{ivy.task.id}; -->
    <!--   window.processSteps = ["Create Investment Request", "Approve Investment Request"]; -->
    <!--   window.currentProcessStep = 0; -->
    <!--   window.processChainDirection = "VERTICAL"; -->
    <!--   window.processChainShape = "LINE"; -->
    <!--   window.announcementInvisible = false; -->
    <!-- </script> -->

    <ui:param name="task" value="#{iFrameTaskTemplateBean.task}" />
    <ui:param name="contentContainerStyleClass" value="task-frame-container" />
    <ui:param name="abstractTaskTemplateBean" value="#{iFrameTaskTemplateBean}" />
    <ui:param name="actualStepIndex" value="#{iFrameTaskTemplateBean.currentProcessStep}" />
    <ui:param name="steps" value="#{iFrameTaskTemplateBean.processSteps}" />
    <ui:param name="processChainDirection" value="#{iFrameTaskTemplateBean.processChainDirection}" />
    <ui:param name="processChainShape" value="#{iFrameTaskTemplateBean.processChainShape}" />
    <ui:param name="announcementInvisible" value="#{iFrameTaskTemplateBean.announcementInvisible}" />

    <ui:define name="taskForm">
      <h:form>
        <p:remoteCommand name="redirectToEndPageCommand" actionListener="#{iFrameTaskTemplateBean.navigateToEndPage()}" />
        <p:remoteCommand name="buildHeader" actionListener="#{iFrameTaskTemplateBean.buildHeader()}"
          update="@([id$='header-container'])" oncomplete="resizeIFrame();updateContentContainerClass()" global="false" />
      </h:form>

      <iframe id="iFrame" src="#{url}" class="task-frame" onload="checkUrl(this)" />
    </ui:define>

    <ui:define name="javascript">
      <h:outputScript name="iframe-task-template.js" library="js" />
    </ui:define>
  </ui:composition>
</h:body>
</html>