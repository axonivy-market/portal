[Ivy]
17FDDF99EEBE452E 9.4.1 #module
>Proto >Proto Collection #zClass
Pt0 PortalStart Big #zClass
Pt0 B #cInfo
Pt0 #process
Bk7 BpmnUserTask Big #zClass
Bk7 BpmnUserTask #cInfo
Bk8 BpmnUserTask Big #zClass
Bk8 BpmnUserTask #cInfo
Bk9 BpmnUserTask Big #zClass
Bk9 BpmnUserTask #cInfo
Bk10 BpmnUserTask Big #zClass
Bk10 BpmnUserTask #cInfo
Bk11 BpmnUserTask Big #zClass
Bk11 BpmnUserTask #cInfo
Bk13 BpmnServiceTask Big #zClass
Bk13 BpmnServiceTask #cInfo
Pt0 @TextInP .colors .colors #zField
Pt0 @TextInP color color #zField
Pt0 @TextInP .resExport .resExport #zField
Pt0 @TextInP .type .type #zField
Pt0 @TextInP .processKind .processKind #zField
Pt0 @AnnotationInP-0n ai ai #zField
Pt0 @MessageFlowInP-0n messageIn messageIn #zField
Pt0 @MessageFlowOutP-0n messageOut messageOut #zField
Pt0 @TextInP .xml .xml #zField
Pt0 @TextInP .responsibility .responsibility #zField
Pt0 @StartRequest f10 '' #zField
Pt0 @GridStep f11 '' #zField
Pt0 @StartRequest f28 '' #zField
Pt0 @EndTask f57 '' #zField
Pt0 @StartRequest f58 '' #zField
Pt0 @StartRequest f103 '' #zField
Pt0 @StartRequest f63 '' #zField
Pt0 @EndTask f105 '' #zField
Pt0 @EndTask f64 '' #zField
Pt0 @CallSub f9 '' #zField
Pt0 @Alternative f1 '' #zField
Pt0 @PushWFArc f2 '' #zField
Pt0 @Alternative f0 '' #zField
Pt0 @PushWFArc f16 '' #zField
Pt0 @Alternative f5 '' #zField
Pt0 @PushWFArc f17 '' #zField
Pt0 @PushWFArc f25 '' #zField
Pt0 @PushWFArc f26 '' #zField
Pt0 @PushWFArc f27 '' #zField
Pt0 @PushWFArc f20 '' #zField
Pt0 @PushWFArc f18 '' #zField
Pt0 @StartRequest f14 '' #zField
Pt0 @UserDialog f32 '' #zField
Pt0 @StartRequest f70 '' #zField
Pt0 @PushWFArc f33 '' #zField
Pt0 @EndTask f34 '' #zField
Pt0 @PushWFArc f35 '' #zField
Pt0 @GridStep f37 '' #zField
Pt0 @StartRequest f39 '' #zField
Pt0 @GridStep f51 '' #zField
Pt0 @PushWFArc f41 '' #zField
Pt0 @PushWFArc f42 '' #zField
Pt0 @PushWFArc f19 '' #zField
Pt0 @CallSub f59 '' #zField
Pt0 @StartRequest f60 '' #zField
Pt0 @PushWFArc f61 '' #zField
Pt0 @StartRequest f62 '' #zField
Pt0 @CallSub f65 '' #zField
Pt0 @PushWFArc f66 '' #zField
Pt0 @CallSub f67 '' #zField
Pt0 @StartRequest f68 '' #zField
Pt0 @PushWFArc f69 '' #zField
Pt0 @UserDialog f71 '' #zField
Pt0 @StartRequest f72 '' #zField
Pt0 @StartRequest f73 '' #zField
Pt0 @StartRequest f76 '' #zField
Pt0 @UserDialog f74 '' #zField
Pt0 @UserDialog f75 '' #zField
Pt0 @PushWFArc f77 '' #zField
Pt0 @PushWFArc f78 '' #zField
Pt0 @GridStep f80 '' #zField
Pt0 @Alternative f81 '' #zField
Pt0 @StartRequest f82 '' #zField
Pt0 @GridStep f83 '' #zField
Pt0 @UserDialog f84 '' #zField
Pt0 @InfoButton f85 '' #zField
Pt0 @GridStep f86 '' #zField
Pt0 @PushWFArc f87 '' #zField
Pt0 @PushWFArc f88 '' #zField
Pt0 @PushWFArc f89 '' #zField
Pt0 @PushWFArc f90 '' #zField
Pt0 @PushWFArc f91 '' #zField
Pt0 @StartRequest f38 '' #zField
Pt0 @UserDialog f44 '' #zField
Pt0 @EndTask f45 '' #zField
Pt0 @PushWFArc f46 '' #zField
Pt0 @PushWFArc f93 '' #zField
Pt0 @PushWFArc f92 '' #zField
Pt0 @InfoButton f3 '' #zField
Pt0 @UserDialog f6 '' #zField
Pt0 @PushWFArc f8 '' #zField
Pt0 @Alternative f22 '' #zField
Pt0 @PushWFArc f30 '' #zField
Pt0 @PushWFArc f50 '' #zField
Pt0 @PushWFArc f36 '' #zField
Pt0 @PushWFArc f40 '' #zField
Pt0 @Alternative f4 '' #zField
Pt0 @PushWFArc f7 '' #zField
Pt0 @PushWFArc f13 '' #zField
Pt0 @Alternative f21 '' #zField
Pt0 @GridStep f31 '' #zField
Pt0 @PushWFArc f49 '' #zField
Pt0 @PushWFArc f29 '' #zField
Pt0 @PushWFArc f48 '' #zField
Pt0 @StartRequest f12 '' #zField
Pt0 @UserDialog f52 '' #zField
Pt0 @PushWFArc f53 '' #zField
Pt0 @EndTask f54 '' #zField
Pt0 @PushWFArc f55 '' #zField
Pt0 @StartRequest f94 '' #zField
Pt0 @CallSub f56 '' #zField
Pt0 @PushWFArc f96 '' #zField
Pt0 @CallSub f95 '' #zField
Pt0 @StartRequest f97 '' #zField
Pt0 @PushWFArc f98 '' #zField
Pt0 @StartRequest f99 '' #zField
Pt0 @EndTask f100 '' #zField
Pt0 @UserDialog f101 '' #zField
Pt0 @PushWFArc f102 '' #zField
Pt0 @PushWFArc f104 '' #zField
Pt0 @StartRequest f106 '' #zField
Pt0 @StartRequest f107 '' #zField
Pt0 @UserDialog f108 '' #zField
Pt0 @GridStep f109 '' #zField
Pt0 @UserDialog f110 '' #zField
Pt0 @PushWFArc f111 '' #zField
Pt0 @GridStep f118 '' #zField
Pt0 @Alternative f115 '' #zField
Pt0 @Alternative f121 '' #zField
Pt0 @PushWFArc f113 '' #zField
Pt0 @PushWFArc f124 '' #zField
Pt0 @PushWFArc f123 '' #zField
Pt0 @PushWFArc f117 '' #zField
Pt0 @Alternative f125 '' #zField
Pt0 @PushWFArc f126 '' #zField
Pt0 @Alternative f127 '' #zField
Pt0 @PushWFArc f128 '' #zField
Pt0 @PushWFArc f116 '' #zField
Pt0 @PushWFArc f112 '' #zField
Pt0 @PushWFArc f119 '' #zField
Pt0 @PushWFArc f114 '' #zField
Pt0 @StartRequest f120 '' #zField
Pt0 @CallSub f122 '' #zField
Pt0 @StartRequest f130 '' #zField
Pt0 @PushWFArc f131 '' #zField
Pt0 @StartRequest f132 '' #zField
Pt0 @EndTask f133 '' #zField
Pt0 @UserDialog f134 '' #zField
Pt0 @PushWFArc f135 '' #zField
Pt0 @PushWFArc f136 '' #zField
Pt0 @GridStep f137 '' #zField
Pt0 @GridStep f139 '' #zField
Pt0 @PushWFArc f140 '' #zField
Pt0 @PushWFArc f43 '' #zField
Pt0 @PushWFArc f23 '' #zField
Pt0 @PushWFArc f129 '' #zField
Pt0 Bk7 S60 'Sub 6' #zField
Pt0 Bk8 S10 'Sub 1' #zField
Pt0 Bk9 S30 'Sub 3' #zField
Pt0 Bk10 S20 'Sub 2' #zField
Pt0 Bk11 S40 'Sub 4' #zField
Pt0 Bk13 S70 'Sub 7' #zField
Pt0 @EndTask f138 '' #zField
Pt0 @UserDialog f142 '' #zField
Pt0 @GridStep f143 '' #zField
Pt0 @StartRequest f144 '' #zField
Pt0 @PushWFArc f145 '' #zField
Pt0 @PushWFArc f146 '' #zField
Pt0 @PushWFArc f147 '' #zField
Pt0 @EndTask f148 '' #zField
Pt0 @StartRequest f149 '' #zField
Pt0 @UserDialog f151 '' #zField
Pt0 @GridStep f152 '' #zField
Pt0 @PushWFArc f153 '' #zField
Pt0 @PushWFArc f154 '' #zField
Pt0 @PushWFArc f155 '' #zField
Pt0 @UserDialog f156 '' #zField
Pt0 @EndTask f157 '' #zField
Pt0 @GridStep f158 '' #zField
Pt0 @StartRequest f159 '' #zField
Pt0 @PushWFArc f160 '' #zField
Pt0 @PushWFArc f161 '' #zField
Pt0 @PushWFArc f162 '' #zField
Pt0 @StartRequest f163 '' #zField
Pt0 @EndTask f164 '' #zField
Pt0 @Alternative f165 '' #zField
Pt0 @UserDialog f166 '' #zField
Pt0 @GridStep f167 '' #zField
Pt0 @PushWFArc f168 '' #zField
Pt0 @PushWFArc f169 '' #zField
Pt0 @PushWFArc f170 '' #zField
Pt0 @PushWFArc f171 '' #zField
Pt0 @PushWFArc f172 '' #zField
Pt0 @EndTask f174 '' #zField
Pt0 @PushWFArc f175 '' #zField
Pt0 @PushWFArc f176 '' #zField
Pt0 @StartRequest f177 '' #zField
Pt0 @UserDialog f178 '' #zField
Pt0 @PushWFArc f141 '' #zField
Pt0 @StartRequest f150 '' #zField
Pt0 @UserDialog f173 '' #zField
Pt0 @EndTask f179 '' #zField
Pt0 @PushWFArc f181 '' #zField
Pt0 @UserDialog f182 '' #zField
Pt0 @EndTask f184 '' #zField
Pt0 @PushWFArc f186 '' #zField
Pt0 @Alternative f187 '' #zField
Pt0 @PushWFArc f185 '' #zField
Pt0 @EndTask f189 '' #zField
Pt0 @PushWFArc f190 '' #zField
Pt0 @Alternative f191 '' #zField
Pt0 @PushWFArc f180 '' #zField
Pt0 @Alternative f192 '' #zField
Pt0 @PushWFArc f194 '' #zField
Pt0 @PushWFArc f197 '' #zField
Pt0 @PushWFArc f196 '' #zField
Pt0 @PushWFArc f183 '' #zField
Pt0 @StartRequest f188 '' #zField
Pt0 @UserDialog f193 '' #zField
Pt0 @EndTask f195 '' #zField
Pt0 @PushWFArc f198 '' #zField
Pt0 @PushWFArc f199 '' #zField
Pt0 @StartRequest f200 '' #zField
Pt0 @GridStep f201 '' #zField
Pt0 @PushWFArc f202 '' #zField
Pt0 @Alternative f203 '' #zField
Pt0 @PushWFArc f204 '' #zField
Pt0 @PushWFArc f47 '' #zField
Pt0 @PushWFArc f205 '' #zField
Pt0 @StartRequest f206 '' #zField
Pt0 @GridStep f207 '' #zField
Pt0 @PushWFArc f208 '' #zField
Pt0 @Alternative f209 '' #zField
Pt0 @PushWFArc f210 '' #zField
Pt0 @PushWFArc f24 '' #zField
Pt0 @PushWFArc f211 '' #zField
Pt0 @Alternative f212 '' #zField
Pt0 @PushWFArc f213 '' #zField
Pt0 @PushWFArc f15 '' #zField
Pt0 @GridStep f214 '' #zField
Pt0 @StartRequest f215 '' #zField
Pt0 @PushWFArc f216 '' #zField
Pt0 @PushWFArc f217 '' #zField
Pt0 @Alternative f218 '' #zField
Pt0 @PushWFArc f219 '' #zField
Pt0 @PushWFArc f79 '' #zField
Pt0 @StartRequest f220 '' #zField
Pt0 @GridStep f221 '' #zField
Pt0 @PushWFArc f222 '' #zField
Pt0 @PushWFArc f223 '' #zField
Pt0 @EndTask f224 '' #zField
Pt0 @UserDialog f225 '' #zField
Pt0 @StartRequest f226 '' #zField
Pt0 @PushWFArc f227 '' #zField
Pt0 @PushWFArc f228 '' #zField
>Proto Pt0 Pt0 PortalStart #zField
Bk7 @TextInP .colors .colors #zField
Bk7 @TextInP color color #zField
Bk7 @TextInP .type .type #zField
Bk7 @TextInP .processKind .processKind #zField
Bk7 @TextInP .xml .xml #zField
Bk7 @TextInP .responsibility .responsibility #zField
Bk7 @AnnotationArc f8 '' #zField
Bk7 @UserDialog f36 '' #zField
Bk7 @GridStep f22 '' #zField
Bk7 @Alternative f54 '' #zField
Bk7 @PushWFArc f43 '' #zField
Bk7 @InfoButton f3 '' #zField
Bk7 @PushTrueWFInG-01 g0 '' #zField
Bk7 @GridStep f1 '' #zField
Bk7 @PushWFArc f0 '' #zField
Bk7 @GridStep f4 '' #zField
Bk7 @PushWFArc f5 '' #zField
Bk7 @PushWFArc f11 '' #zField
Bk7 @Alternative f2 '' #zField
Bk7 @PushWFArc f7 '' #zField
Bk7 @PushWFArc f6 '' #zField
Bk7 @UserDialog f9 '' #zField
Bk7 @PushWFArc f10 '' #zField
>Proto Bk7 Bk7 BpmnUserTask #zField
Bk8 @TextInP .colors .colors #zField
Bk8 @TextInP color color #zField
Bk8 @TextInP .type .type #zField
Bk8 @TextInP .processKind .processKind #zField
Bk8 @TextInP .xml .xml #zField
Bk8 @TextInP .responsibility .responsibility #zField
Bk8 @GridStep f17 '' #zField
Bk8 @GridStep f68 '' #zField
Bk8 @GridStep f52 '' #zField
Bk8 @GridStep f19 '' #zField
Bk8 @CallSub f37 '' #zField
Bk8 @Alternative f0 '' #zField
Bk8 @PushTrueWFInG-01 g0 '' #zField
Bk8 @CallSub f23 '' #zField
Bk8 @CallSub f6 '' #zField
Bk8 @CallSub f12 '' #zField
Bk8 @PushWFArc f42 '' #zField
Bk8 @PushWFArc f49 '' #zField
Bk8 @PushWFArc f26 '' #zField
Bk8 @PushWFArc f39 '' #zField
Bk8 @UserDialog f7 '' #zField
Bk8 @PushWFArc f8 '' #zField
Bk8 @PushWFArc f2 '' #zField
Bk8 @PushWFArc f3 '' #zField
Bk8 @PushWFArc f4 '' #zField
Bk8 @PushWFArc f5 '' #zField
Bk8 @PushWFArc f1 '' #zField
>Proto Bk8 Bk0 BpmnUserTask #zField
Bk9 @TextInP .colors .colors #zField
Bk9 @TextInP color color #zField
Bk9 @TextInP .type .type #zField
Bk9 @TextInP .processKind .processKind #zField
Bk9 @TextInP .xml .xml #zField
Bk9 @TextInP .responsibility .responsibility #zField
Bk9 @PushWFArc f60 '' #zField
Bk9 @PushWFArc f61 '' #zField
Bk9 @CallSub f62 '' #zField
Bk9 @GridStep f59 '' #zField
Bk9 @CallSub f55 '' #zField
Bk9 @PushTrueWFInG-01 g0 '' #zField
Bk9 @PushWFArc f0 '' #zField
Bk9 @PushTrueWFOutG-01 g1 '' #zField
Bk9 @PushWFArc f1 '' #zField
>Proto Bk9 Bk1 BpmnUserTask #zField
Bk10 @TextInP .colors .colors #zField
Bk10 @TextInP color color #zField
Bk10 @TextInP .type .type #zField
Bk10 @TextInP .processKind .processKind #zField
Bk10 @TextInP .xml .xml #zField
Bk10 @TextInP .responsibility .responsibility #zField
Bk10 @GridStep f69 '' #zField
Bk10 @PushWFArc f67 '' #zField
Bk10 @PushWFArc f118 '' #zField
Bk10 @CallSub f84 '' #zField
Bk10 @CallSub f73 '' #zField
Bk10 @PushTrueWFInG-01 g0 '' #zField
Bk10 @PushWFArc f0 '' #zField
Bk10 @PushTrueWFOutG-01 g1 '' #zField
Bk10 @PushWFArc f1 '' #zField
>Proto Bk10 Bk2 BpmnUserTask #zField
Bk11 @TextInP .colors .colors #zField
Bk11 @TextInP color color #zField
Bk11 @TextInP .type .type #zField
Bk11 @TextInP .processKind .processKind #zField
Bk11 @TextInP .xml .xml #zField
Bk11 @TextInP .responsibility .responsibility #zField
Bk11 @GridStep f106 '' #zField
Bk11 @CallSub f104 '' #zField
Bk11 @PushWFArc f107 '' #zField
Bk11 @PushTrueWFInG-01 g0 '' #zField
Bk11 @PushWFArc f0 '' #zField
Bk11 @PushTrueWFOutG-01 g1 '' #zField
Bk11 @PushWFArc f1 '' #zField
>Proto Bk11 Bk3 BpmnUserTask #zField
Bk13 @TextInP .colors .colors #zField
Bk13 @TextInP color color #zField
Bk13 @TextInP .type .type #zField
Bk13 @TextInP .processKind .processKind #zField
Bk13 @TextInP .xml .xml #zField
Bk13 @TextInP .responsibility .responsibility #zField
Bk13 @Alternative f47 '' #zField
Bk13 @PushWFArc f55 '' #zField
Bk13 @PushWFArc f49 '' #zField
Bk13 @CallSub f4 '' #zField
Bk13 @PushWFArc f31 '' #zField
Bk13 @UserDialog f12 '' #zField
Bk13 @GridStep f7 '' #zField
Bk13 @PushTrueWFInG-01 g0 '' #zField
Bk13 @PushWFArc f0 '' #zField
Bk13 @PushTrueWFOutG-01 g1 '' #zField
Bk13 @PushWFArc f1 '' #zField
Bk13 @PushWFArc f2 '' #zField
>Proto Bk13 Bk6 BpmnServiceTask #zField
Pt0 f10 outLink DefaultEndPage.ivp #txt
Pt0 f10 inParamDecl '<Number endedTaskId> param;' #txt
Pt0 f10 inParamTable 'out.endedTaskId=param.endedTaskId;
' #txt
Pt0 f10 requestEnabled true #txt
Pt0 f10 triggerEnabled false #txt
Pt0 f10 callSignature DefaultEndPage(Number) #txt
Pt0 f10 persist false #txt
Pt0 f10 taskData 'TaskTriggered.EXPRI=2
TaskTriggered.EXROL=Everybody
TaskTriggered.EXTYPE=0
TaskTriggered.PRI=2
TaskTriggered.ROL=Everybody
TaskTriggered.TYPE=0' #txt
Pt0 f10 caseData businessCase.attach=true #txt
Pt0 f10 showInStartList 0 #txt
Pt0 f10 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>DefaultEndPage.ivp</name>
    </language>
</elementInfo>
' #txt
Pt0 f10 @C|.responsibility Everybody #txt
Pt0 f10 83 292 26 26 -46 17 #rect
Pt0 f11 actionTable 'out=in;
' #txt
Pt0 f11 actionCode 'import ch.ivy.addon.portalkit.constant.CustomFields;
import ch.ivy.addon.portalkit.dto.TaskEndInfo;
import ch.ivy.addon.portalkit.service.StickyTaskListService;
import ch.ivy.addon.portalkit.enums.SessionAttribute;
import ch.ivy.addon.portalkit.util.SecurityServiceUtils;
import ch.ivy.addon.portalkit.enums.PortalPage;
import org.apache.commons.lang3.StringUtils;
import ch.ivyteam.ivy.workflow.ITask;

ITask task = ivy.wf.findTask(Long.valueOf(in.endedTaskId));
in.isFirstTask = true;
in.portalPage = PortalPage.HOME_PAGE;

if (#task is initialized) {
	in.isTaskFinished = task.getEndTimestamp() is initialized;
	
	ITask taskWithTaskEndInfo = null;
	if (task.getStartSwitchEvent() is initialized) {
		taskWithTaskEndInfo = StickyTaskListService.service().getPreviousTaskWithTaskEndInfo(task);
	}

	if (#taskWithTaskEndInfo is initialized) {
		in.isFirstTask = false;
		String taskEndInfoSessionAttributeKey = StickyTaskListService.service().getTaskEndInfoSessionAttributeKey(taskWithTaskEndInfo.getId());
		TaskEndInfo taskEndInfo = SecurityServiceUtils.getSessionAttribute(taskEndInfoSessionAttributeKey) as TaskEndInfo;
			
		in.dataModel = taskEndInfo.dataModel;
		in.isTaskStartedInDetails = taskEndInfo.isStartedInTaskDetails;
		in.portalPage = taskEndInfo.portalPage;
		if (!in.isTaskStartedInDetails || in.backFromTaskDetails) {
			SecurityServiceUtils.removeSessionAttribute(taskEndInfoSessionAttributeKey);
		}
		
		if (in.isTaskFinished) {
			in.callbackUrl = taskWithTaskEndInfo.customFields().stringField(CustomFields.EXPRESS_END_PAGE_URL.toString()).getOrDefault("");
		}
	}
	in.caseSelected = task.getCase();
} else {
	Boolean isTaskFinished = SecurityServiceUtils.getSessionAttribute(SessionAttribute.IS_TASK_FINISHED.toString()).toBoolean();
	in.isTaskFinished = #isTaskFinished is initialized ? isTaskFinished : true;
}

SecurityServiceUtils.removeSessionAttribute(SessionAttribute.IS_TASK_FINISHED.toString());
ivy.session.setAttribute(SessionAttribute.IS_TASK_STARTED_IN_DETAILS.toString(), in.isTaskStartedInDetails);' #txt
Pt0 f11 security system #txt
Pt0 f11 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Handle end page</name>
    </language>
</elementInfo>
' #txt
Pt0 f11 584 282 112 44 -47 -8 #rect
Pt0 f28 outLink DefaultApplicationHomePage.ivp #txt
Pt0 f28 inParamDecl '<> param;' #txt
Pt0 f28 requestEnabled true #txt
Pt0 f28 triggerEnabled false #txt
Pt0 f28 callSignature DefaultApplicationHomePage() #txt
Pt0 f28 persist false #txt
Pt0 f28 startName <%=ivy.cms.co("/Processes/portalHome")%> #txt
Pt0 f28 startCustomFields 'cssIcon=si si-layout-dashboard
embedInFrame=false' #txt
Pt0 f28 taskData 'TaskTriggered.CATEGORY=<%\=ivy.cms.co("/Processes/Cases/PortalCategory")%>
TaskTriggered.DESC=<%\=ivy.cms.co("/Processes/Cases/PortalInternalProcess/PortalInternalProcessDescription")%>
TaskTriggered.EXPRI=2
TaskTriggered.EXROL=Everybody
TaskTriggered.EXTYPE=0
TaskTriggered.NAM=<%\=ivy.cms.co("/Processes/Cases/PortalCategory")%>\: <%\=ivy.cms.co("/Processes/portalSettingSaved")%>
TaskTriggered.PRI=2
TaskTriggered.ROL=Everybody
TaskTriggered.TYPE=0' #txt
Pt0 f28 caseData 'businessCase.attach=true
case.category=<%\=ivy.cms.co("/Processes/Cases/PortalCategory")%>
case.description=<%\=ivy.cms.co("/Processes/Cases/PortalInternalProcess/PortalInternalProcessDescription")%>
case.name=<%\=ivy.cms.co("/Processes/Cases/PortalCategory")%>\: <%\=ivy.cms.co("/Processes/portalSettingSaved")%>' #txt
Pt0 f28 showInStartList 1 #txt
Pt0 f28 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>DefaultApplicationHomePage.ivp</name>
    </language>
</elementInfo>
' #txt
Pt0 f28 @C|.responsibility Everybody #txt
Pt0 f28 81 129 30 30 -81 19 #rect
Pt0 f57 473 498 30 30 0 15 #rect
Pt0 f58 outLink CaseListPage.ivp #txt
Pt0 f58 inParamDecl '<> param;' #txt
Pt0 f58 requestEnabled true #txt
Pt0 f58 triggerEnabled false #txt
Pt0 f58 callSignature CaseListPage() #txt
Pt0 f58 persist false #txt
Pt0 f58 taskData 'TaskTriggered.EXPRI=2
TaskTriggered.EXROL=Everybody
TaskTriggered.EXTYPE=0
TaskTriggered.PRI=2
TaskTriggered.ROL=Everybody
TaskTriggered.TYPE=0' #txt
Pt0 f58 caseData businessCase.attach=true #txt
Pt0 f58 showInStartList 0 #txt
Pt0 f58 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>CaseListPage.ivp</name>
    </language>
</elementInfo>
' #txt
Pt0 f58 @C|.responsibility Everybody #txt
Pt0 f58 81 498 30 30 -44 16 #rect
Pt0 f103 outLink CaseDetailsPage.ivp #txt
Pt0 f103 inParamDecl '<Long caseId> param;' #txt
Pt0 f103 inParamTable 'out.caseId=param.caseId;
' #txt
Pt0 f103 requestEnabled true #txt
Pt0 f103 triggerEnabled false #txt
Pt0 f103 callSignature CaseDetailsPage(Long) #txt
Pt0 f103 persist false #txt
Pt0 f103 caseData businessCase.attach=true #txt
Pt0 f103 showInStartList 0 #txt
Pt0 f103 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>CaseDetailsPage.ivp</name>
    </language>
</elementInfo>
' #txt
Pt0 f103 @C|.responsibility Everybody #txt
Pt0 f103 81 689 30 30 -58 19 #rect
Pt0 f63 outLink DefaultTaskListPage.ivp #txt
Pt0 f63 inParamDecl '<> param;' #txt
Pt0 f63 requestEnabled true #txt
Pt0 f63 triggerEnabled false #txt
Pt0 f63 callSignature DefaultTaskListPage() #txt
Pt0 f63 persist false #txt
Pt0 f63 taskData 'TaskTriggered.EXPRI=2
TaskTriggered.EXROL=Everybody
TaskTriggered.EXTYPE=0
TaskTriggered.PRI=2
TaskTriggered.ROL=Everybody
TaskTriggered.TYPE=0' #txt
Pt0 f63 caseData businessCase.attach=true #txt
Pt0 f63 showInStartList 0 #txt
Pt0 f63 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>DefaultTaskListPage.ivp</name>
    </language>
</elementInfo>
' #txt
Pt0 f63 @C|.responsibility Everybody #txt
Pt0 f63 81 625 30 30 -50 17 #rect
Pt0 f105 369 689 30 30 0 15 #rect
Pt0 f64 473 625 30 30 0 15 #rect
Pt0 f9 processCall 'Functional Processes/InitializeTaskDataModel:call()' #txt
Pt0 f9 requestActionDecl '<> param;' #txt
Pt0 f9 responseActionDecl 'ch.ivy.addon.portal.generic.PortalStartData out;
' #txt
Pt0 f9 responseMappingAction 'out=in;
out.dataModel=result.dataModel;
out.dataModel.compactMode=true;
' #txt
Pt0 f9 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>InitializeTaskDataModel</name>
    </language>
</elementInfo>
' #txt
Pt0 f9 864 122 144 44 -65 -8 #rect
Pt0 f1 768 288 32 32 0 16 #rect
Pt0 f2 696 304 768 304 #arcP
Pt0 f0 1056 128 32 32 0 16 #rect
Pt0 f16 1008 144 1056 144 #arcP
Pt0 f5 1056 288 32 32 0 16 #rect
Pt0 f17 408 640 473 640 #arcP
Pt0 f25 408 513 473 513 #arcP
Pt0 f26 expr out #txt
Pt0 f26 111 704 192 704 #arcP
Pt0 f27 304 704 369 704 #arcP
Pt0 f20 expr in #txt
Pt0 f20 outCond 'java.util.Objects.equals(ch.ivy.addon.portalkit.enums.PortalPage.HOME_PAGE, in.#portalPage) && org.apache.commons.lang3.StringUtils.isBlank(in.#callbackUrl)' #txt
Pt0 f20 1072 288 1072 160 #arcP
Pt0 f18 expr in #txt
Pt0 f18 1088 304 1128 304 #arcP
Pt0 f14 outLink BackFromTaskDetails.ivp #txt
Pt0 f14 inParamDecl '<Number endedTaskId> param;' #txt
Pt0 f14 inParamTable 'out.backFromTaskDetails=true;
out.endedTaskId=param.endedTaskId;
' #txt
Pt0 f14 requestEnabled true #txt
Pt0 f14 triggerEnabled false #txt
Pt0 f14 callSignature BackFromTaskDetails(Number) #txt
Pt0 f14 caseData businessCase.attach=true #txt
Pt0 f14 showInStartList 0 #txt
Pt0 f14 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>BackFromTaskDetails.ivp</name>
    </language>
</elementInfo>
' #txt
Pt0 f14 @C|.responsibility Everybody #txt
Pt0 f14 81 369 30 30 -44 16 #rect
Pt0 f32 dialogId ch.ivy.addon.portal.generic.admin.PortalDashBoard #txt
Pt0 f32 startMethod start() #txt
Pt0 f32 requestActionDecl '<> param;' #txt
Pt0 f32 responseMappingAction 'out=in;
' #txt
Pt0 f32 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Statistic</name>
    </language>
</elementInfo>
' #txt
Pt0 f32 192 747 112 44 -21 -8 #rect
Pt0 f70 outLink StatisticPage.ivp #txt
Pt0 f70 inParamDecl '<> param;' #txt
Pt0 f70 requestEnabled true #txt
Pt0 f70 triggerEnabled false #txt
Pt0 f70 callSignature StatisticPage() #txt
Pt0 f70 persist false #txt
Pt0 f70 taskData 'TaskTriggered.EXPRI=2
TaskTriggered.EXROL=Everybody
TaskTriggered.EXTYPE=0
TaskTriggered.PRI=2
TaskTriggered.ROL=Everybody
TaskTriggered.TYPE=0' #txt
Pt0 f70 caseData businessCase.attach=true #txt
Pt0 f70 showInStartList 0 #txt
Pt0 f70 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>StatisticPage.ivp</name>
    </language>
</elementInfo>
' #txt
Pt0 f70 @C|.responsibility Everybody #txt
Pt0 f70 81 754 30 30 -46 17 #rect
Pt0 f33 111 769 192 769 #arcP
Pt0 f34 369 754 30 30 0 15 #rect
Pt0 f35 304 769 369 769 #arcP
Pt0 f37 actionTable 'out=in;
' #txt
Pt0 f37 actionCode 'import ch.ivy.addon.portalkit.enums.PortalLibrary;
import org.apache.commons.lang3.StringUtils;
import ch.ivyteam.ivy.workflow.StandardProcessType;

String library = PortalLibrary.PORTAL_TEMPLATE.getValue();

String defaultEndPage = ivy.wf.getStandardProcessImplementationLibrary(StandardProcessType.DEFAULT_PAGES_PROCESS_TYPES);

// if default endpage is null or is portal template but has different group ID
if (StringUtils.isBlank(defaultEndPage) || (defaultEndPage.endsWith(PortalLibrary.PORTAL_TEMPLATE.getProjectId()) && !library.equals(defaultEndPage))) {
	ivy.wf.setStandardProcessImplementationLibrary(StandardProcessType.DEFAULT_PAGES_PROCESS_TYPES, library);
}' #txt
Pt0 f37 security system #txt
Pt0 f37 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Set default end page 
to Portal</name>
    </language>
</elementInfo>
' #txt
Pt0 f37 352 842 144 44 -53 -16 #rect
Pt0 f39 outLink DefaultLoginPage.ivp #txt
Pt0 f39 inParamDecl '<String originalUrl> param;' #txt
Pt0 f39 inParamTable 'out.callbackUrl=param.#originalUrl is initialized ? param.originalUrl : null;
' #txt
Pt0 f39 requestEnabled true #txt
Pt0 f39 triggerEnabled false #txt
Pt0 f39 callSignature DefaultLoginPage(String) #txt
Pt0 f39 persist false #txt
Pt0 f39 taskData 'TaskTriggered.EXPRI=2
TaskTriggered.EXROL=Everybody
TaskTriggered.EXTYPE=0
TaskTriggered.PRI=2
TaskTriggered.ROL=Everybody
TaskTriggered.TYPE=0' #txt
Pt0 f39 caseData businessCase.attach=true #txt
Pt0 f39 showInStartList 0 #txt
Pt0 f39 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>DefaultLoginPage.ivp</name>
    </language>
</elementInfo>
' #txt
Pt0 f39 @C|.responsibility Everybody #txt
Pt0 f39 81 849 30 30 -45 18 #rect
Pt0 f51 actionTable 'out=in;
' #txt
Pt0 f51 actionCode 'import ch.ivy.addon.portalkit.enums.SessionAttribute;
import ch.ivy.addon.portalkit.util.SecurityServiceUtils;

SecurityServiceUtils.setSessionAttribute(SessionAttribute.PORTAL_START_PMV_ID.toString(), ivy.task.getProcessModelVersion().getId());
' #txt
Pt0 f51 security system #txt
Pt0 f51 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Store portal start &#13;
pmv </name>
    </language>
</elementInfo>
' #txt
Pt0 f51 192 842 128 44 -43 -16 #rect
Pt0 f41 expr out #txt
Pt0 f41 320 864 352 864 #arcP
Pt0 f42 111 864 192 864 #arcP
Pt0 f19 expr in #txt
Pt0 f19 784 320 1072 320 #arcP
Pt0 f19 1 784 384 #addKink
Pt0 f19 2 1072 384 #addKink
Pt0 f59 processCall 'Functional Processes/Navigator:viewTask(Long,ch.ivy.addon.portalkit.dto.GlobalCaseId,String)' #txt
Pt0 f59 requestActionDecl '<Long taskId,ch.ivy.addon.portalkit.dto.GlobalCaseId caseId,String caseName> param;' #txt
Pt0 f59 requestMappingAction 'param.caseId=ch.ivy.addon.portalkit.dto.GlobalCaseId.caseId(in.caseId).isBusinessCase(in.isBusinessCase).build();
param.caseName=in.caseName;
' #txt
Pt0 f59 responseMappingAction 'out=in;
' #txt
Pt0 f59 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Functional Processes/Navigator</name>
    </language>
</elementInfo>
' #txt
Pt0 f59 192 938 176 44 -83 -8 #rect
Pt0 f60 outLink RelatedTasksOfCasePage.ivp #txt
Pt0 f60 inParamDecl '<Long caseId,Boolean isBusinessCase,String caseName> param;' #txt
Pt0 f60 inParamTable 'out.caseId=param.caseId;
out.caseName=param.caseName;
out.isBusinessCase=param.isBusinessCase;
' #txt
Pt0 f60 requestEnabled true #txt
Pt0 f60 triggerEnabled false #txt
Pt0 f60 callSignature RelatedTasksOfCasePage(Long,Boolean,String) #txt
Pt0 f60 caseData businessCase.attach=true #txt
Pt0 f60 showInStartList 0 #txt
Pt0 f60 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>RelatedTasksOfCasePage.ivp</name>
    </language>
</elementInfo>
' #txt
Pt0 f60 @C|.responsibility Everybody #txt
Pt0 f60 81 945 30 30 -57 17 #rect
Pt0 f61 111 960 192 960 #arcP
Pt0 f62 outLink TaskDetailsPage.ivp #txt
Pt0 f62 inParamDecl '<Long selectedTaskId> param;' #txt
Pt0 f62 inParamTable 'out.selectedTaskId=param.selectedTaskId;
' #txt
Pt0 f62 requestEnabled true #txt
Pt0 f62 triggerEnabled false #txt
Pt0 f62 callSignature TaskDetailsPage(Long) #txt
Pt0 f62 caseData businessCase.attach=true #txt
Pt0 f62 showInStartList 0 #txt
Pt0 f62 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>TaskDetailsPage.ivp</name>
    </language>
</elementInfo>
' #txt
Pt0 f62 @C|.responsibility Everybody #txt
Pt0 f62 81 1041 30 30 -57 17 #rect
Pt0 f65 processCall 'Functional Processes/Navigator:viewRelatedTask(Long)' #txt
Pt0 f65 requestActionDecl '<Long taskId> param;' #txt
Pt0 f65 requestMappingAction 'param.taskId=in.selectedTaskId;
' #txt
Pt0 f65 responseMappingAction 'out=in;
' #txt
Pt0 f65 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Functional Processes/Navigator</name>
    </language>
</elementInfo>
' #txt
Pt0 f65 192 1034 176 44 -83 -8 #rect
Pt0 f66 111 1056 192 1056 #arcP
Pt0 f67 processCall 'Functional Processes/OpenPortalSearch:call(String)' #txt
Pt0 f67 requestActionDecl '<String keyword> param;' #txt
Pt0 f67 requestMappingAction 'param.keyword=in.keyword;
' #txt
Pt0 f67 responseMappingAction 'out=in;
' #txt
Pt0 f67 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Functional Processes/OpenPortalSearch</name>
    </language>
</elementInfo>
' #txt
Pt0 f67 192 1130 224 44 -107 -8 #rect
Pt0 f68 outLink GlobalSearchPage.ivp #txt
Pt0 f68 inParamDecl '<String keyword> param;' #txt
Pt0 f68 inParamTable 'out.keyword=param.keyword;
' #txt
Pt0 f68 requestEnabled true #txt
Pt0 f68 triggerEnabled false #txt
Pt0 f68 callSignature GlobalSearchPage(String) #txt
Pt0 f68 caseData businessCase.attach=true #txt
Pt0 f68 showInStartList 0 #txt
Pt0 f68 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>GlobalSearchPage.ivp</name>
    </language>
</elementInfo>
' #txt
Pt0 f68 @C|.responsibility Everybody #txt
Pt0 f68 81 1137 30 30 -57 17 #rect
Pt0 f69 111 1152 192 1152 #arcP
Pt0 f71 dialogId ch.ivy.addon.portal.generic.Processes #txt
Pt0 f71 startMethod start() #txt
Pt0 f71 requestActionDecl '<> param;' #txt
Pt0 f71 responseMappingAction 'out=in;
' #txt
Pt0 f71 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Processes</name>
    </language>
</elementInfo>
' #txt
Pt0 f71 296 1258 112 44 -30 -8 #rect
Pt0 f72 outLink Error500Page.ivp #txt
Pt0 f72 inParamDecl '<> param;' #txt
Pt0 f72 requestEnabled true #txt
Pt0 f72 triggerEnabled false #txt
Pt0 f72 callSignature Error500Page() #txt
Pt0 f72 caseData businessCase.attach=true #txt
Pt0 f72 showInStartList 0 #txt
Pt0 f72 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Error500Page.ivp</name>
    </language>
</elementInfo>
' #txt
Pt0 f72 @C|.responsibility Everybody #txt
Pt0 f72 81 1329 30 30 -44 17 #rect
Pt0 f73 outLink Error404Page.ivp #txt
Pt0 f73 inParamDecl '<> param;' #txt
Pt0 f73 requestEnabled true #txt
Pt0 f73 triggerEnabled false #txt
Pt0 f73 callSignature Error404Page() #txt
Pt0 f73 caseData businessCase.attach=true #txt
Pt0 f73 showInStartList 0 #txt
Pt0 f73 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Error404Page.ivp</name>
    </language>
</elementInfo>
' #txt
Pt0 f73 @C|.responsibility Everybody #txt
Pt0 f73 81 1425 30 30 -39 17 #rect
Pt0 f76 outLink DefaultProcessStartListPage.ivp #txt
Pt0 f76 inParamDecl '<> param;' #txt
Pt0 f76 requestEnabled true #txt
Pt0 f76 triggerEnabled false #txt
Pt0 f76 callSignature DefaultProcessStartListPage() #txt
Pt0 f76 persist false #txt
Pt0 f76 taskData 'TaskTriggered.EXPRI=2
TaskTriggered.EXROL=Everybody
TaskTriggered.EXTYPE=0
TaskTriggered.PRI=2
TaskTriggered.ROL=Everybody
TaskTriggered.TYPE=0' #txt
Pt0 f76 caseData businessCase.attach=true #txt
Pt0 f76 showInStartList 0 #txt
Pt0 f76 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>DefaultProcessStartListPage.ivp</name>
    </language>
</elementInfo>
' #txt
Pt0 f76 @C|.responsibility Everybody #txt
Pt0 f76 81 1265 30 30 -60 17 #rect
Pt0 f74 dialogId ch.ivy.addon.portal.error.ErrorPage #txt
Pt0 f74 startMethod start(String) #txt
Pt0 f74 requestActionDecl '<String errorCode> param;' #txt
Pt0 f74 requestMappingAction 'param.errorCode="500";
' #txt
Pt0 f74 responseMappingAction 'out=in;
' #txt
Pt0 f74 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>ErrorPage</name>
    </language>
</elementInfo>
' #txt
Pt0 f74 192 1322 112 44 -27 -8 #rect
Pt0 f75 dialogId ch.ivy.addon.portal.error.ErrorPage #txt
Pt0 f75 startMethod start(String) #txt
Pt0 f75 requestActionDecl '<String errorCode> param;' #txt
Pt0 f75 requestMappingAction 'param.errorCode="404";
' #txt
Pt0 f75 responseMappingAction 'out=in;
' #txt
Pt0 f75 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>ErrorPage</name>
    </language>
</elementInfo>
' #txt
Pt0 f75 192 1418 112 44 -27 -8 #rect
Pt0 f77 111 1344 192 1344 #arcP
Pt0 f78 111 1440 192 1440 #arcP
Pt0 f80 actionTable 'out=in;
' #txt
Pt0 f80 actionCode 'import ch.ivy.addon.portalkit.util.RequestUtil;
RequestUtil.redirect(in.callbackUrl);' #txt
Pt0 f80 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name> Redirect to task start </name>
    </language>
</elementInfo>
' #txt
Pt0 f80 616 1610 128 44 -59 -8 #rect
Pt0 f81 544 1520 32 32 0 16 #rect
Pt0 f82 outLink DefaultFramePage.ivp #txt
Pt0 f82 inParamDecl '<String relativeUrl,Number runningTaskId> param;' #txt
Pt0 f82 inParamTable 'out.callbackUrl=param.relativeUrl;
out.endedTaskId=param.runningTaskId;
' #txt
Pt0 f82 requestEnabled true #txt
Pt0 f82 triggerEnabled false #txt
Pt0 f82 callSignature DefaultFramePage(String,Number) #txt
Pt0 f82 caseData businessCase.attach=true #txt
Pt0 f82 showInStartList 0 #txt
Pt0 f82 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>DefaultFramePage.ivp</name>
    </language>
</elementInfo>
' #txt
Pt0 f82 @C|.responsibility Everybody #txt
Pt0 f82 81 1521 30 30 -48 16 #rect
Pt0 f83 actionTable 'out=in;
' #txt
Pt0 f83 actionCode 'import ch.ivyteam.ivy.workflow.ITask;
import ch.ivyteam.ivy.bpm.error.BpmError;

ITask task = ivy.wf.findTask(in.endedTaskId);
if (!in.callbackUrl.startsWith(task.getApplication().getContextPath())) {
  BpmError.create("frame:unsupported:url").withMessage("only relative urls are supported (security reasons)").throwError();
}' #txt
Pt0 f83 security system #txt
Pt0 f83 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Check if url is valid</name>
    </language>
</elementInfo>
' #txt
Pt0 f83 192 1514 112 44 -51 -8 #rect
Pt0 f84 dialogId ch.ivy.addon.portal.generic.iframe.TaskTemplateIFrame #txt
Pt0 f84 startMethod start(String,Number) #txt
Pt0 f84 requestActionDecl '<String url,Number taskId> param;' #txt
Pt0 f84 requestMappingAction 'param.url=in.callbackUrl;
param.taskId=in.endedTaskId;
' #txt
Pt0 f84 responseMappingAction 'out=in;
' #txt
Pt0 f84 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>TaskTemplateIFrame</name>
    </language>
</elementInfo>
' #txt
Pt0 f84 616 1514 128 44 -55 -8 #rect
Pt0 f85 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>If open a process/start in "embedInFrame" mode (add to url embedInFrame parameter), &#13;
DefaultFramePage process will run</name>
    </language>
</elementInfo>
' #txt
Pt0 f85 64 1594 464 44 -228 -16 #rect
Pt0 f86 actionTable 'out=in;
' #txt
Pt0 f86 actionCode 'import ch.ivy.addon.portalkit.service.IFrameService;
out.embedInIFrame = IFrameService.embedInFrame(in.endedTaskId);' #txt
Pt0 f86 security system #txt
Pt0 f86 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Get embedInIFrame setting</name>
    </language>
</elementInfo>
' #txt
Pt0 f86 344 1514 160 44 -75 -8 #rect
Pt0 f87 expr in #txt
Pt0 f87 outCond in.embedInIFrame #txt
Pt0 f87 576 1536 616 1536 #arcP
Pt0 f88 304 1536 344 1536 #arcP
Pt0 f89 111 1536 192 1536 #arcP
Pt0 f90 560 1552 616 1632 #arcP
Pt0 f90 1 560 1632 #addKink
Pt0 f90 1 0.1556203489120305 0 0 #arcLabel
Pt0 f91 504 1536 544 1536 #arcP
Pt0 f38 outLink UserProfile.ivp #txt
Pt0 f38 inParamDecl '<> param;' #txt
Pt0 f38 requestEnabled true #txt
Pt0 f38 triggerEnabled false #txt
Pt0 f38 callSignature UserProfile() #txt
Pt0 f38 caseData 'businessCase.attach=true
customFields.STRING.embedInFrame="false"' #txt
Pt0 f38 wfuser 1 #txt
Pt0 f38 showInStartList 0 #txt
Pt0 f38 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>UserProfile.ivp</name>
    </language>
</elementInfo>
' #txt
Pt0 f38 @C|.responsibility Everybody #txt
Pt0 f38 81 1713 30 30 -21 17 #rect
Pt0 f44 dialogId ch.ivy.addon.portal.setting.UserProfile #txt
Pt0 f44 startMethod start() #txt
Pt0 f44 requestActionDecl '<> param;' #txt
Pt0 f44 responseMappingAction 'out=in;
' #txt
Pt0 f44 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>UserProfile</name>
    </language>
</elementInfo>
' #txt
Pt0 f44 192 1706 112 44 -31 -8 #rect
Pt0 f45 433 1713 30 30 0 15 #rect
Pt0 f46 304 1728 433 1728 #arcP
Pt0 f93 111 1728 192 1728 #arcP
Pt0 f92 1088 144 1128 144 #arcP
Pt0 f3 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Replace by customized &#13;
homepage if you have</name>
    </language>
</elementInfo>
' #txt
Pt0 f3 1256 122 144 44 -63 -16 #rect
Pt0 f6 dialogId ch.ivy.addon.portal.generic.Login #txt
Pt0 f6 startMethod start(String) #txt
Pt0 f6 requestActionDecl '<String callbackUrl> param;' #txt
Pt0 f6 requestMappingAction 'param.callbackUrl=in.callbackUrl;
' #txt
Pt0 f6 responseMappingAction 'out=in;
' #txt
Pt0 f6 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Login</name>
    </language>
</elementInfo>
' #txt
Pt0 f6 544 842 112 44 -14 -8 #rect
Pt0 f8 496 864 544 864 #arcP
Pt0 f22 768 128 32 32 0 16 #rect
Pt0 f30 expr in #txt
Pt0 f30 outCond 'in.#portalPage == null' #txt
Pt0 f30 .xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Start process/task&#13;
not in Portal</name>
    </language>
</elementInfo>
' #txt
Pt0 f30 784 288 784 160 #arcP
Pt0 f30 0 0.46875 5 3 #arcLabel
Pt0 f50 expr in #txt
Pt0 f50 outCond ch.addon.portal.generic.userprofile.homepage.HomepageUtils.isShowLegacyUI() #txt
Pt0 f50 .xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name></name>
    </language>
</elementInfo>
' #txt
Pt0 f50 800 144 864 144 #arcP
Pt0 f50 0 0.36666666666666664 0 -12 #arcLabel
Pt0 f36 expr in #txt
Pt0 f36 outCond !in.backFromTaskDetails #txt
Pt0 f36 800 304 864 304 #arcP
Pt0 f40 1008 304 1056 304 #arcP
Pt0 f4 472 288 32 32 0 16 #rect
Pt0 f7 expr out #txt
Pt0 f7 109 305 472 304 #arcP
Pt0 f13 111 384 488 320 #arcP
Pt0 f13 1 488 384 #addKink
Pt0 f13 0 0.7758746574460319 0 0 #arcLabel
Pt0 f21 472 128 32 32 0 16 #rect
Pt0 f31 actionTable 'out=in;
' #txt
Pt0 f31 actionCode 'import ch.ivy.addon.portal.generic.navigation.PortalNavigator;
PortalNavigator.navigateToPortalLoginPage();' #txt
Pt0 f31 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Redirect to&#13;
login page</name>
    </language>
</elementInfo>
' #txt
Pt0 f31 432 202 112 44 -28 -16 #rect
Pt0 f49 expr in #txt
Pt0 f49 outCond ivy.session.isSessionUserUnknown() #txt
Pt0 f49 488 160 488 202 #arcP
Pt0 f29 expr in #txt
Pt0 f29 outCond ivy.session.isSessionUserUnknown() #txt
Pt0 f29 488 288 488 246 #arcP
Pt0 f48 expr in #txt
Pt0 f48 .xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>logged in</name>
    </language>
</elementInfo>
' #txt
Pt0 f48 504 304 584 304 #arcP
Pt0 f48 0 0.4642857142857143 0 -10 #arcLabel
Pt0 f12 outLink CaseDetailsInIFrame.ivp #txt
Pt0 f12 inParamDecl '<Long caseId> param;' #txt
Pt0 f12 inParamTable 'out.caseId=param.caseId;
' #txt
Pt0 f12 requestEnabled true #txt
Pt0 f12 triggerEnabled false #txt
Pt0 f12 callSignature CaseDetailsInIFrame(Long) #txt
Pt0 f12 caseData businessCase.attach=true #txt
Pt0 f12 showInStartList 0 #txt
Pt0 f12 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>CaseDetailsInIFrame.ivp</name>
    </language>
</elementInfo>
' #txt
Pt0 f12 @C|.responsibility Everybody #txt
Pt0 f12 81 1809 30 30 -40 18 #rect
Pt0 f52 dialogId ch.ivy.addon.portal.component.iframe.CaseInformationInIFrame #txt
Pt0 f52 startMethod start(Long,Boolean) #txt
Pt0 f52 requestActionDecl '<Long caseId,Boolean showBackButton> param;' #txt
Pt0 f52 requestMappingAction 'param.caseId=in.caseId;
param.showBackButton=false;
' #txt
Pt0 f52 responseMappingAction 'out=in;
' #txt
Pt0 f52 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>CaseInformationInIFrame</name>
    </language>
</elementInfo>
' #txt
Pt0 f52 192 1802 160 44 -70 -8 #rect
Pt0 f53 111 1824 192 1824 #arcP
Pt0 f54 433 1809 30 30 0 15 #rect
Pt0 f55 352 1824 433 1824 #arcP
Pt0 f94 outLink RelatedTasksOfCasePageInFrame.ivp #txt
Pt0 f94 inParamDecl '<Long caseId,Boolean isBusinessCase,String caseName> param;' #txt
Pt0 f94 inParamTable 'out.caseId=param.caseId;
out.caseName=param.caseName;
out.isBusinessCase=param.isBusinessCase;
' #txt
Pt0 f94 requestEnabled true #txt
Pt0 f94 triggerEnabled false #txt
Pt0 f94 callSignature RelatedTasksOfCasePageInFrame(Long,Boolean,String) #txt
Pt0 f94 caseData businessCase.attach=true #txt
Pt0 f94 showInStartList 0 #txt
Pt0 f94 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>RelatedTasksOfCasePageInFrame.ivp</name>
    </language>
</elementInfo>
' #txt
Pt0 f94 @C|.responsibility Everybody #txt
Pt0 f94 81 1905 30 30 -77 17 #rect
Pt0 f56 processCall 'Functional Processes/Navigator:viewTaskInFrame(Long,ch.ivy.addon.portalkit.dto.GlobalCaseId,String)' #txt
Pt0 f56 requestActionDecl '<Long taskId,ch.ivy.addon.portalkit.dto.GlobalCaseId caseId,String caseName> param;' #txt
Pt0 f56 requestMappingAction 'param.caseId=ch.ivy.addon.portalkit.dto.GlobalCaseId.caseId(in.caseId).isBusinessCase(in.isBusinessCase).build();
param.caseName=in.caseName;
' #txt
Pt0 f56 responseMappingAction 'out=in;
' #txt
Pt0 f56 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Functional Processes/Navigator</name>
    </language>
</elementInfo>
' #txt
Pt0 f56 192 1898 192 44 -87 -8 #rect
Pt0 f96 111 1920 192 1920 #arcP
Pt0 f95 processCall 'Functional Processes/Navigator:viewRelatedTaskInFrame(Long)' #txt
Pt0 f95 requestActionDecl '<Long taskId> param;' #txt
Pt0 f95 requestMappingAction 'param.taskId=in.selectedTaskId;
' #txt
Pt0 f95 responseMappingAction 'out=in;
' #txt
Pt0 f95 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Functional Processes/Navigator</name>
    </language>
</elementInfo>
' #txt
Pt0 f95 192 1994 176 44 -83 -8 #rect
Pt0 f97 outLink TaskDetailsPageInFrame.ivp #txt
Pt0 f97 inParamDecl '<Long selectedTaskId> param;' #txt
Pt0 f97 inParamTable 'out.selectedTaskId=param.selectedTaskId;
' #txt
Pt0 f97 requestEnabled true #txt
Pt0 f97 triggerEnabled false #txt
Pt0 f97 callSignature TaskDetailsPageInFrame(Long) #txt
Pt0 f97 caseData businessCase.attach=true #txt
Pt0 f97 showInStartList 0 #txt
Pt0 f97 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>TaskDetailsPageInFrame.ivp</name>
    </language>
</elementInfo>
' #txt
Pt0 f97 @C|.responsibility Everybody #txt
Pt0 f97 81 2001 30 30 -68 21 #rect
Pt0 f98 111 2016 192 2016 #arcP
Pt0 f99 outLink AbsenceManagement.ivp #txt
Pt0 f99 inParamDecl '<> param;' #txt
Pt0 f99 requestEnabled true #txt
Pt0 f99 triggerEnabled false #txt
Pt0 f99 callSignature AbsenceManagement() #txt
Pt0 f99 caseData businessCase.attach=true #txt
Pt0 f99 showInStartList 0 #txt
Pt0 f99 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>AbsenceManagement.ivp</name>
    </language>
</elementInfo>
' #txt
Pt0 f99 @C|.responsibility Everybody #txt
Pt0 f99 81 2097 30 30 -61 25 #rect
Pt0 f100 433 2097 30 30 0 15 #rect
Pt0 f101 dialogId ch.ivy.addon.portal.setting.AbsenceManagement #txt
Pt0 f101 startMethod start() #txt
Pt0 f101 requestActionDecl '<> param;' #txt
Pt0 f101 responseMappingAction 'out=in;
' #txt
Pt0 f101 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>AbsenceManagement</name>
    </language>
</elementInfo>
' #txt
Pt0 f101 192 2090 128 44 -60 -8 #rect
Pt0 f102 320 2112 433 2112 #arcP
Pt0 f104 111 2112 192 2112 #arcP
Pt0 f106 outLink PasswordResetPage.ivp #txt
Pt0 f106 inParamDecl '<String token,String username> param;' #txt
Pt0 f106 inParamTable 'out.passwordResetToken=param.token;
out.passwordResetUsername=param.username;
' #txt
Pt0 f106 requestEnabled true #txt
Pt0 f106 triggerEnabled false #txt
Pt0 f106 callSignature PasswordResetPage(String,String) #txt
Pt0 f106 caseData businessCase.attach=true #txt
Pt0 f106 showInStartList 0 #txt
Pt0 f106 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>PasswordResetPage.ivp</name>
    </language>
</elementInfo>
' #txt
Pt0 f106 @C|.responsibility Everybody #txt
Pt0 f106 753 977 30 30 -21 17 #rect
Pt0 f107 outLink ForgotPasswordPage.ivp #txt
Pt0 f107 inParamDecl '<> param;' #txt
Pt0 f107 requestEnabled true #txt
Pt0 f107 triggerEnabled false #txt
Pt0 f107 callSignature ForgotPasswordPage() #txt
Pt0 f107 caseData businessCase.attach=true #txt
Pt0 f107 showInStartList 0 #txt
Pt0 f107 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>ForgotPasswordPage.ivp</name>
    </language>
</elementInfo>
' #txt
Pt0 f107 @C|.responsibility Everybody #txt
Pt0 f107 753 849 30 30 -21 17 #rect
Pt0 f108 dialogId ch.ivy.addon.portal.generic.ForgotPassword #txt
Pt0 f108 startMethod start() #txt
Pt0 f108 requestActionDecl '<> param;' #txt
Pt0 f108 responseMappingAction 'out=in;
' #txt
Pt0 f108 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>ForgotPassword</name>
    </language>
</elementInfo>
' #txt
Pt0 f108 1144 794 112 44 -45 -8 #rect
Pt0 f109 actionTable 'out=in;
' #txt
Pt0 f109 actionCode 'import java.util.Calendar;
import javax.faces.application.FacesMessage;
import javax.faces.context.FacesContext;
import ch.ivy.addon.portalkit.constant.UserProperty;
import ch.ivy.addon.portalkit.util.UserUtils;
import ch.ivyteam.ivy.environment.Ivy;
import org.apache.commons.lang.StringUtils;
import ch.ivyteam.ivy.security.IUser;
in.isValidResetUrl = false;
// TODO check if the ivy Security System is used
// find user by username
IUser user = StringUtils.isNotBlank(in.passwordResetUsername) ? UserUtils.findUserByUsername(in.passwordResetUsername) : null;
in.isValidResetUrl = UserUtils.isValidPasswordResetToken(in.passwordResetToken, user);
if (!in.isValidResetUrl) {
	in.passwordResetMessage = ivy.cms.co("/ch.ivy.addon.portalkit.ui.jsf/forgotPassword/invalidResetUrl");
} else {
	in.passwordResetMessage = "";
}' #txt
Pt0 f109 security system #txt
Pt0 f109 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Load URL</name>
    </language>
</elementInfo>
' #txt
Pt0 f109 1144 1018 112 44 -28 -8 #rect
Pt0 f110 dialogId ch.ivy.addon.portal.generic.PasswordReset #txt
Pt0 f110 startMethod start(String,String,Boolean,String) #txt
Pt0 f110 requestActionDecl '<String token,String username,Boolean isValidResetUrl,String message> param;' #txt
Pt0 f110 requestMappingAction 'param.token=in.passwordResetToken;
param.username=in.passwordResetUsername;
param.isValidResetUrl=in.isValidResetUrl;
param.message=in.passwordResetMessage;
' #txt
Pt0 f110 responseMappingAction 'out=in;
' #txt
Pt0 f110 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>PasswordReset</name>
    </language>
</elementInfo>
' #txt
Pt0 f110 1312 1018 112 44 -44 -8 #rect
Pt0 f111 1256 1040 1312 1040 #arcP
Pt0 f118 actionTable 'out=in;
' #txt
Pt0 f118 actionCode 'import ch.ivy.addon.portalkit.publicapi.PortalNavigatorAPI;

PortalNavigatorAPI.navigateToPortalHome();' #txt
Pt0 f118 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Redirect to homepage</name>
    </language>
</elementInfo>
' #txt
Pt0 f118 976 906 128 44 -61 -8 #rect
Pt0 f115 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>isIvySecuritySystem?</name>
    </language>
</elementInfo>
' #txt
Pt0 f115 1024 1024 32 32 -45 14 #rect
Pt0 f121 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>isIvySecuritySystem?</name>
    </language>
</elementInfo>
' #txt
Pt0 f121 1024 800 32 32 -41 -35 #rect
Pt0 f113 expr in #txt
Pt0 f113 outCond ch.ivy.addon.portalkit.util.SecuritySystemUtils.isIvySecuritySystem() #txt
Pt0 f113 1056 816 1144 816 #arcP
Pt0 f124 expr in #txt
Pt0 f124 outCond ch.ivy.addon.portalkit.util.SecuritySystemUtils.isIvySecuritySystem() #txt
Pt0 f124 1056 1040 1144 1040 #arcP
Pt0 f123 expr in #txt
Pt0 f123 1040 1024 1040 950 #arcP
Pt0 f123 0 0.7083368923999287 0 0 #arcLabel
Pt0 f117 expr in #txt
Pt0 f117 1040 832 1040 906 #arcP
Pt0 f117 0 0.8830405899713851 0 0 #arcLabel
Pt0 f125 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>logged in?</name>
    </language>
</elementInfo>
' #txt
Pt0 f125 880 848 32 32 27 -3 #rect
Pt0 f126 783 864 880 864 #arcP
Pt0 f127 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>logged in?</name>
    </language>
</elementInfo>
' #txt
Pt0 f127 880 976 32 32 22 -2 #rect
Pt0 f128 783 992 880 992 #arcP
Pt0 f116 expr in #txt
Pt0 f116 outCond ivy.session.isSessionUserUnknown() #txt
Pt0 f116 896 848 1024 816 #arcP
Pt0 f116 1 896 816 #addKink
Pt0 f116 1 0.3035347999724818 0 0 #arcLabel
Pt0 f112 expr in #txt
Pt0 f112 896 880 976 928 #arcP
Pt0 f112 1 896 928 #addKink
Pt0 f112 0 0.21116033553811278 0 0 #arcLabel
Pt0 f119 expr in #txt
Pt0 f119 outCond ivy.session.isSessionUserUnknown() #txt
Pt0 f119 896 1008 1024 1040 #arcP
Pt0 f119 1 896 1040 #addKink
Pt0 f119 1 0.27119234895556793 0 0 #arcLabel
Pt0 f114 expr in #txt
Pt0 f114 896 976 976 928 #arcP
Pt0 f114 1 896 928 #addKink
Pt0 f114 0 0.3341498422116857 0 0 #arcLabel
Pt0 f120 outLink DefaultDashboardPage.ivp #txt
Pt0 f120 inParamDecl '<Boolean isShowDashboard> param;' #txt
Pt0 f120 inParamTable 'out.isShowDashboard=param.isShowDashboard;
' #txt
Pt0 f120 requestEnabled true #txt
Pt0 f120 triggerEnabled false #txt
Pt0 f120 callSignature DefaultDashboardPage(Boolean) #txt
Pt0 f120 caseData businessCase.attach=true #txt
Pt0 f120 showInStartList 0 #txt
Pt0 f120 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>DefaultDashboardPage.ivp</name>
    </language>
</elementInfo>
' #txt
Pt0 f120 @C|.responsibility Everybody #txt
Pt0 f120 81 49 30 30 -65 17 #rect
Pt0 f122 processCall 'Functional Processes/Navigator:viewCaseItemDetailsInIFrame(ch.ivy.addon.portalkit.dto.GlobalCaseId)' #txt
Pt0 f122 requestActionDecl '<ch.ivy.addon.portalkit.dto.GlobalCaseId caseId> param;' #txt
Pt0 f122 requestMappingAction 'param.caseId=ch.ivy.addon.portalkit.dto.GlobalCaseId.caseId(in.caseId).isBusinessCase(in.isBusinessCase).build();
' #txt
Pt0 f122 responseMappingAction 'out=in;
' #txt
Pt0 f122 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Functional Processes/Navigator</name>
    </language>
</elementInfo>
' #txt
Pt0 f122 192 2186 176 44 -83 -8 #rect
Pt0 f130 outLink CaseDetailsPageInFrame.ivp #txt
Pt0 f130 inParamDecl '<Long caseId,Boolean isBusinessCase> param;' #txt
Pt0 f130 inParamTable 'out.caseId=param.caseId;
out.isBusinessCase=param.isBusinessCase;
' #txt
Pt0 f130 requestEnabled true #txt
Pt0 f130 triggerEnabled false #txt
Pt0 f130 callSignature CaseDetailsPageInFrame(Long,Boolean) #txt
Pt0 f130 caseData businessCase.attach=true #txt
Pt0 f130 showInStartList 0 #txt
Pt0 f130 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>CaseDetailsPageInFrame.ivp</name>
    </language>
</elementInfo>
' #txt
Pt0 f130 @C|.responsibility Everybody #txt
Pt0 f130 81 2193 30 30 -68 21 #rect
Pt0 f131 111 2208 192 2208 #arcP
Pt0 f132 outLink ProcessInformation.ivp #txt
Pt0 f132 inParamDecl '<String processKey> param;' #txt
Pt0 f132 inParamTable 'out.processId=param.processKey;
' #txt
Pt0 f132 requestEnabled true #txt
Pt0 f132 triggerEnabled false #txt
Pt0 f132 callSignature ProcessInformation(String) #txt
Pt0 f132 caseData businessCase.attach=true #txt
Pt0 f132 showInStartList 0 #txt
Pt0 f132 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>ProcessInformation.ivp</name>
    </language>
</elementInfo>
' #txt
Pt0 f132 @C|.responsibility Everybody #txt
Pt0 f132 81 2289 30 30 -57 16 #rect
Pt0 f133 433 2289 30 30 0 15 #rect
Pt0 f134 dialogId ch.ivy.addon.portal.component.ProcessInformation #txt
Pt0 f134 startMethod start(String) #txt
Pt0 f134 requestActionDecl '<String processId> param;' #txt
Pt0 f134 requestMappingAction 'param.processId=in.processId;
' #txt
Pt0 f134 responseMappingAction 'out=in;
' #txt
Pt0 f134 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>ProcessInformation</name>
    </language>
</elementInfo>
' #txt
Pt0 f134 192 2282 112 44 -53 -8 #rect
Pt0 f135 111 2304 192 2304 #arcP
Pt0 f136 304 2304 433 2304 #arcP
Pt0 f137 actionTable 'out=in;
' #txt
Pt0 f137 actionCode 'import ch.ivy.addon.portalkit.enums.PortalLibrary;
import org.apache.commons.lang3.StringUtils;
import ch.ivyteam.ivy.workflow.StandardProcessType;

String library = PortalLibrary.PORTAL_TEMPLATE.getValue();

String defaultEndPage = ivy.wf.getStandardProcessImplementationLibrary(StandardProcessType.DEFAULT_PAGES_PROCESS_TYPES);

// if default endpage is null or is portal template but has different group ID
if (StringUtils.isBlank(defaultEndPage) || (defaultEndPage.endsWith(PortalLibrary.PORTAL_TEMPLATE.getProjectId()) && !library.equals(defaultEndPage))) {
	ivy.wf.setStandardProcessImplementationLibrary(StandardProcessType.DEFAULT_PAGES_PROCESS_TYPES, library);
}' #txt
Pt0 f137 security system #txt
Pt0 f137 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Set default end page 
to Portal</name>
    </language>
</elementInfo>
' #txt
Pt0 f137 280 122 144 44 -53 -16 #rect
Pt0 f139 actionTable 'out=in;
' #txt
Pt0 f139 actionCode 'import ch.ivy.addon.portalkit.enums.SessionAttribute;
import ch.ivy.addon.portalkit.util.SecurityServiceUtils;
SecurityServiceUtils.setSessionAttribute(SessionAttribute.PORTAL_START_PMV_ID.toString(), ivy.task.getProcessModelVersion().getId());' #txt
Pt0 f139 security system #txt
Pt0 f139 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Store portal start &#13;
pmv </name>
    </language>
</elementInfo>
' #txt
Pt0 f139 584 122 128 44 -43 -16 #rect
Pt0 f140 expr in #txt
Pt0 f140 .xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>logged in</name>
    </language>
</elementInfo>
' #txt
Pt0 f140 504 144 584 144 #arcP
Pt0 f140 0 0.5 0 -10 #arcLabel
Pt0 f43 111 64 352 122 #arcP
Pt0 f43 1 352 64 #addKink
Pt0 f43 0 0.7536234472447718 0 0 #arcLabel
Pt0 f23 expr out #txt
Pt0 f23 712 144 768 144 #arcP
Pt0 f129 424 144 472 144 #arcP
Pt0 S60 .xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language lang="en">
        <name>Open selected &#13;
homepage</name>
    </language>
</elementInfo>
' #txt
Pt0 S60 1128 122 112 44 -39 -20 #rect
Pt0 S10 .xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language lang="en">
        <name>Open previous&#13;
page before finish task</name>
    </language>
</elementInfo>
' #txt
Pt0 S10 1128 280 160 48 -58 -20 #rect
Pt0 S30 .xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language lang="en">
        <name>Case List Page</name>
    </language>
</elementInfo>
' #txt
Pt0 S30 296 491 112 44 -40 -8 #rect
Pt0 S20 .xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language lang="en">
        <name>Task List Page</name>
    </language>
</elementInfo>
' #txt
Pt0 S20 296 618 112 44 -39 -8 #rect
Pt0 S40 .xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language lang="en">
        <name>Case Details Page</name>
    </language>
</elementInfo>
' #txt
Pt0 S40 192 682 112 44 -49 -8 #rect
Pt0 S70 .xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language lang="en">
        <name>Init data and&#13;
display growl msg&#13;
after finish task</name>
    </language>
</elementInfo>
' #txt
Pt0 S70 864 272 144 64 -47 -28 #rect
Pt0 f138 1537 1713 30 30 0 15 #rect
Pt0 f142 dialogId ch.ivy.addon.portal.generic.CaseNoteHistory #txt
Pt0 f142 startMethod start(java.util.List<ch.ivy.addon.portalkit.bo.History>,String,ch.ivyteam.ivy.workflow.ICase) #txt
Pt0 f142 requestActionDecl '<java.util.List<ch.ivy.addon.portalkit.bo.History> histories,String exportedFileName,ch.ivyteam.ivy.workflow.ICase ivyCase> param;' #txt
Pt0 f142 requestMappingAction 'param.histories=in.histories;
param.exportedFileName=ivy.cms.co("/ch.ivy.addon.portalkit.ui.jsf/noteHistory/caseExportedFileNamePrefix", java.util.Arrays.asList(ch.ivy.addon.portalkit.util.PermissionUtils.getCaseName(in.caseSelected)));
param.ivyCase=in.caseSelected;
' #txt
Pt0 f142 responseActionDecl 'ch.ivy.addon.portal.generic.CaseNoteHistoryData out;
' #txt
Pt0 f142 responseMappingAction 'out=in;
' #txt
Pt0 f142 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Case note history</name>
    </language>
</elementInfo>
' #txt
Pt0 f142 1360 1706 112 44 -48 -8 #rect
Pt0 f143 actionTable 'out=in;
' #txt
Pt0 f143 actionCode 'import ch.ivyteam.ivy.workflow.ICase;
import ch.ivyteam.ivy.workflow.query.CaseQuery;
import ch.ivy.addon.portalkit.service.GlobalSettingService;
import java.util.ArrayList;
import ch.ivyteam.ivy.workflow.TaskState;
import ch.ivyteam.ivy.workflow.ITask;
import ch.ivy.addon.portalkit.service.HistoryService;

List<ITask> finishedTasks = new ArrayList();
in.caseSelected = ivy.wf.getCaseQueryExecutor().getFirstResult(CaseQuery.create().where().caseId().isEqual(in.caseId)) as ICase;
for(ITask task : in.caseSelected.tasks().all()) {
	if(task.getState() == TaskState.DONE
	|| task.getState() == TaskState.CREATED 
	|| task.getState() == TaskState.DESTROYED 
	|| task.getState() == TaskState.ZOMBIE) {
		finishedTasks.add(task);
	}
}

HistoryService historyService = new HistoryService();
GlobalSettingService globalSettingService = new GlobalSettingService();
boolean excludeSystemTasks = globalSettingService.findHideSystemTasksFromHistorySettingValue();
boolean excludeSystemNotes = globalSettingService.findHideSystemNotesFromHistorySettingValue();
in.histories = historyService.getHistories(finishedTasks, in.caseSelected.getNotes(), excludeSystemTasks, excludeSystemNotes);' #txt
Pt0 f143 security system #txt
Pt0 f143 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>get case
create histories 
from tasks and notes</name>
    </language>
</elementInfo>
' #txt
Pt0 f143 1032 1698 144 60 -53 -24 #rect
Pt0 f144 outLink showCaseNoteHistory.ivp #txt
Pt0 f144 inParamDecl '<Long caseId> param;' #txt
Pt0 f144 inParamTable 'out.caseId=param.caseId;
' #txt
Pt0 f144 requestEnabled true #txt
Pt0 f144 triggerEnabled false #txt
Pt0 f144 callSignature showCaseNoteHistory(Long) #txt
Pt0 f144 persist false #txt
Pt0 f144 caseData businessCase.attach=true #txt
Pt0 f144 showInStartList 0 #txt
Pt0 f144 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>showCaseNoteHistory.ivp</name>
    </language>
</elementInfo>
' #txt
Pt0 f144 @C|.responsibility Everybody #txt
Pt0 f144 897 1713 30 30 -71 17 #rect
Pt0 f145 expr out #txt
Pt0 f145 927 1728 1032 1728 #arcP
Pt0 f146 expr out #txt
Pt0 f146 1472 1728 1537 1728 #arcP
Pt0 f147 expr out #txt
Pt0 f147 1176 1728 1360 1728 #arcP
Pt0 f148 1537 1809 30 30 0 15 #rect
Pt0 f149 outLink showTaskNoteHistory.ivp #txt
Pt0 f149 inParamDecl '<Long selectedTaskId> param;' #txt
Pt0 f149 inParamTable 'out.taskId=param.selectedTaskId;
' #txt
Pt0 f149 requestEnabled true #txt
Pt0 f149 triggerEnabled false #txt
Pt0 f149 callSignature showTaskNoteHistory(Long) #txt
Pt0 f149 persist false #txt
Pt0 f149 taskData 'TaskTriggered.EXPRI=2
TaskTriggered.EXROL=Everybody
TaskTriggered.EXTYPE=0
TaskTriggered.PRI=2
TaskTriggered.ROL=Everybody
TaskTriggered.TYPE=0' #txt
Pt0 f149 caseData businessCase.attach=true #txt
Pt0 f149 showInStartList 0 #txt
Pt0 f149 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>showTaskNoteHistory.ivp</name>
    </language>
</elementInfo>
' #txt
Pt0 f149 @C|.responsibility Everybody #txt
Pt0 f149 897 1809 30 30 -69 17 #rect
Pt0 f151 dialogId ch.ivy.addon.portal.generic.TaskNoteHistory #txt
Pt0 f151 startMethod start(java.util.List<ch.ivyteam.ivy.workflow.INote>,String,ch.ivyteam.ivy.workflow.ITask) #txt
Pt0 f151 requestActionDecl '<java.util.List<ch.ivyteam.ivy.workflow.INote> notes,String exportedFileName,ch.ivyteam.ivy.workflow.ITask task> param;' #txt
Pt0 f151 requestMappingAction 'param.notes=in.notes;
param.exportedFileName=ivy.cms.co("/ch.ivy.addon.portalkit.ui.jsf/noteHistory/taskExportedFileNamePrefix", java.util.Arrays.asList(ch.ivy.addon.portalkit.util.PermissionUtils.getTaskName(in.taskSelected)));
param.task=in.taskSelected;
' #txt
Pt0 f151 responseActionDecl 'ch.ivy.addon.portal.generic.TaskNoteHistoryData out;
' #txt
Pt0 f151 responseMappingAction 'out=in;
' #txt
Pt0 f151 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Task Note History</name>
    </language>
</elementInfo>
' #txt
Pt0 f151 1360 1802 112 44 -48 -8 #rect
Pt0 f152 actionTable 'out=in;
' #txt
Pt0 f152 actionCode 'import ch.ivyteam.ivy.workflow.INote;
import ch.ivyteam.ivy.workflow.query.TaskQuery;
import ch.ivyteam.ivy.workflow.ITask;
import ch.ivy.addon.portalkit.util.CaseUtils;
import ch.ivyteam.ivy.workflow.ICase;
import ch.ivy.addon.portalkit.service.GlobalSettingService;
import ch.ivy.addon.portalkit.comparator.NoteComparator;

in.taskSelected = ivy.wf.getGlobalContext().getTaskQueryExecutor().getFirstResult(TaskQuery.create().where().taskId().isEqual(in.taskId)) as ITask;
ICase iCase = in.taskSelected.getCase().getBusinessCase();
GlobalSettingService globalSettingService = new GlobalSettingService();
boolean excludeSystemNotes = globalSettingService.findHideSystemNotesFromHistorySettingValue();
in.notes = CaseUtils.findNotes(iCase, excludeSystemNotes);
in.notes.sort(new NoteComparator());
' #txt
Pt0 f152 security system #txt
Pt0 f152 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>find notes</name>
    </language>
</elementInfo>
' #txt
Pt0 f152 1048 1802 112 44 -27 -8 #rect
Pt0 f153 expr out #txt
Pt0 f153 1472 1824 1537 1824 #arcP
Pt0 f154 1160 1824 1360 1824 #arcP
Pt0 f155 expr out #txt
Pt0 f155 927 1824 1048 1824 #arcP
Pt0 f156 dialogId ch.ivy.addon.portal.generic.AdditionalCaseDetails #txt
Pt0 f156 startMethod start(ch.ivyteam.ivy.workflow.ICase) #txt
Pt0 f156 requestActionDecl '<ch.ivyteam.ivy.workflow.ICase iCase> param;' #txt
Pt0 f156 requestMappingAction 'param.iCase=in.caseSelected;
' #txt
Pt0 f156 responseActionDecl 'ch.ivy.addon.portal.generic.CaseWidgetData out;
' #txt
Pt0 f156 responseMappingAction 'out=in;
' #txt
Pt0 f156 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Show Additional
Case Details</name>
    </language>
</elementInfo>
' #txt
Pt0 f156 1352 1898 128 44 -42 -16 #rect
Pt0 f157 1537 1905 30 30 0 15 #rect
Pt0 f158 actionTable 'out=in;
' #txt
Pt0 f158 actionCode 'out.caseSelected = ivy.wf.findCase(in.caseId);' #txt
Pt0 f158 security system #txt
Pt0 f158 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Find case by id</name>
    </language>
</elementInfo>
' #txt
Pt0 f158 1048 1898 112 44 -41 -8 #rect
Pt0 f159 outLink showAdditionalCaseDetails.ivp #txt
Pt0 f159 inParamDecl '<Long caseId> param;' #txt
Pt0 f159 inParamTable 'out.caseId=param.caseId;
' #txt
Pt0 f159 requestEnabled true #txt
Pt0 f159 triggerEnabled false #txt
Pt0 f159 callSignature showAdditionalCaseDetails(Long) #txt
Pt0 f159 persist false #txt
Pt0 f159 taskData 'TaskTriggered.EXPRI=2
TaskTriggered.EXROL=Everybody
TaskTriggered.EXTYPE=0
TaskTriggered.PRI=2
TaskTriggered.ROL=Everybody
TaskTriggered.TYPE=0' #txt
Pt0 f159 caseData businessCase.attach=true #txt
Pt0 f159 showInStartList 0 #txt
Pt0 f159 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>showAdditionalCaseDetails.ivp</name>
    </language>
</elementInfo>
' #txt
Pt0 f159 @C|.responsibility Everybody #txt
Pt0 f159 897 1905 30 30 -85 17 #rect
Pt0 f160 expr out #txt
Pt0 f160 927 1920 1048 1920 #arcP
Pt0 f161 expr out #txt
Pt0 f161 1160 1920 1352 1920 #arcP
Pt0 f162 expr out #txt
Pt0 f162 1480 1920 1537 1920 #arcP
Pt0 f163 outLink showTaskAnalysis.ivp #txt
Pt0 f163 inParamDecl '<> param;' #txt
Pt0 f163 requestEnabled true #txt
Pt0 f163 triggerEnabled false #txt
Pt0 f163 callSignature showTaskAnalysis() #txt
Pt0 f163 persist false #txt
Pt0 f163 taskData 'TaskTriggered.EXPRI=2
TaskTriggered.EXROL=Everybody
TaskTriggered.EXTYPE=0
TaskTriggered.PRI=2
TaskTriggered.ROL=Everybody
TaskTriggered.TYPE=0' #txt
Pt0 f163 caseData businessCase.attach=true #txt
Pt0 f163 showInStartList 0 #txt
Pt0 f163 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>showTaskAnalysis.ivp</name>
    </language>
</elementInfo>
' #txt
Pt0 f163 @C|.responsibility Everybody #txt
Pt0 f163 897 2001 30 30 -21 17 #rect
Pt0 f164 1537 2001 30 30 0 15 #rect
Pt0 f165 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>has permission?</name>
    </language>
</elementInfo>
' #txt
Pt0 f165 1248 2000 32 32 -47 18 #rect
Pt0 f166 dialogId ch.ivy.addon.portal.generic.TaskAnalysis #txt
Pt0 f166 startMethod start() #txt
Pt0 f166 requestActionDecl '<> param;' #txt
Pt0 f166 responseActionDecl 'ch.ivy.addon.portal.generic.TaskAnalysisData out;
' #txt
Pt0 f166 responseMappingAction 'out=in;
' #txt
Pt0 f166 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Task Analysis dialog</name>
    </language>
</elementInfo>
' #txt
Pt0 f166 1352 1994 128 44 -56 -8 #rect
Pt0 f167 actionTable 'out=in;
' #txt
Pt0 f167 actionCode 'import ch.ivy.addon.portalkit.util.PermissionUtils;
import ch.ivy.addon.portalkit.enums.PortalPermission;

in.hasPermission = PermissionUtils.hasPermission(PortalPermission.STATISTIC_ANALYZE_TASK.getPermission());' #txt
Pt0 f167 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>check permission</name>
    </language>
</elementInfo>
' #txt
Pt0 f167 1048 1994 112 44 -49 -8 #rect
Pt0 f168 expr out #txt
Pt0 f168 927 2016 1048 2016 #arcP
Pt0 f169 expr out #txt
Pt0 f169 1480 2016 1537 2016 #arcP
Pt0 f170 expr out #txt
Pt0 f170 1160 2016 1248 2016 #arcP
Pt0 f171 expr in #txt
Pt0 f171 .xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>no</name>
        <nameStyle>2,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Pt0 f171 1264 2032 1552 2031 #arcP
Pt0 f171 1 1264 2064 #addKink
Pt0 f171 2 1552 2064 #addKink
Pt0 f171 1 0.23529411764705882 0 -10 #arcLabel
Pt0 f172 expr in #txt
Pt0 f172 outCond in.hasPermission #txt
Pt0 f172 .xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>yes</name>
        <nameStyle>3,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Pt0 f172 1280 2016 1352 2016 #arcP
Pt0 f172 0 0.4166666666666667 0 -11 #arcLabel
Pt0 f174 433 2385 30 30 0 15 #rect
Pt0 f175 368 2400 433 2400 #arcP
Pt0 f176 111 2400 192 2400 #arcP
Pt0 f177 outLink PortalDashboardConfiguration.ivp #txt
Pt0 f177 inParamDecl '<Boolean isPublicDashboard> param;' #txt
Pt0 f177 inParamTable 'out.isPublicDashboard=param.isPublicDashboard;
' #txt
Pt0 f177 requestEnabled true #txt
Pt0 f177 triggerEnabled false #txt
Pt0 f177 callSignature PortalDashboardConfiguration(Boolean) #txt
Pt0 f177 caseData businessCase.attach=true #txt
Pt0 f177 showInStartList 0 #txt
Pt0 f177 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>PortalDashboardConfiguration.ivp</name>
    </language>
</elementInfo>
' #txt
Pt0 f177 @C|.responsibility Everybody #txt
Pt0 f177 81 2385 30 30 -67 21 #rect
Pt0 f178 dialogId ch.ivy.addon.portal.generic.dashboard.PortalDashboardConfiguration #txt
Pt0 f178 startMethod start(Boolean) #txt
Pt0 f178 requestActionDecl '<Boolean isPublicDashboard> param;' #txt
Pt0 f178 requestMappingAction 'param.isPublicDashboard=in.isPublicDashboard;
' #txt
Pt0 f178 responseMappingAction 'out=in;
' #txt
Pt0 f178 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>PortalDashboardConfiguration</name>
    </language>
</elementInfo>
' #txt
Pt0 f178 192 2378 176 44 -84 -8 #rect
Pt0 f141 expr in #txt
Pt0 f141 784 128 1072 128 #arcP
Pt0 f141 1 784 96 #addKink
Pt0 f141 2 1072 96 #addKink
Pt0 f141 1 0.5 0 0 #arcLabel
Pt0 f150 outLink DashboardReorder.ivp #txt
Pt0 f150 inParamDecl '<Boolean isPublicDashboard> param;' #txt
Pt0 f150 inParamTable 'out.isPublicDashboard=param.isPublicDashboard;
' #txt
Pt0 f150 requestEnabled true #txt
Pt0 f150 triggerEnabled false #txt
Pt0 f150 callSignature DashboardReorder(Boolean) #txt
Pt0 f150 caseData businessCase.attach=true #txt
Pt0 f150 showInStartList 0 #txt
Pt0 f150 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>DashboardReorder.ivp</name>
    </language>
</elementInfo>
' #txt
Pt0 f150 @C|.responsibility Everybody #txt
Pt0 f150 81 2497 30 30 -61 18 #rect
Pt0 f173 dialogId ch.ivy.addon.portal.generic.dashboard.MyDashboardReorder #txt
Pt0 f173 startMethod start() #txt
Pt0 f173 requestActionDecl '<> param;' #txt
Pt0 f173 responseMappingAction 'out=in;
' #txt
Pt0 f173 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>DashboardArrangement</name>
    </language>
</elementInfo>
' #txt
Pt0 f173 432 2650 144 44 -66 -8 #rect
Pt0 f179 681 2657 30 30 0 15 #rect
Pt0 f181 576 2672 681 2672 #arcP
Pt0 f182 dialogId ch.ivy.addon.portal.generic.dashboard.PublicDashboardReorder #txt
Pt0 f182 startMethod start() #txt
Pt0 f182 requestActionDecl '<> param;' #txt
Pt0 f182 responseMappingAction 'out=in;
' #txt
Pt0 f182 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>DashboardArrangement</name>
    </language>
</elementInfo>
' #txt
Pt0 f182 432 2490 144 44 -66 -8 #rect
Pt0 f184 681 2497 30 30 0 15 #rect
Pt0 f186 576 2512 681 2512 #arcP
Pt0 f187 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>has DashboardWritePublic&#13;
permission?</name>
    </language>
</elementInfo>
' #txt
Pt0 f187 320 2496 32 32 -57 -54 #rect
Pt0 f185 expr in #txt
Pt0 f185 outCond ch.ivy.addon.portalkit.util.PermissionUtils.hasDashboardWritePublicPermission() #txt
Pt0 f185 .xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>yes</name>
    </language>
</elementInfo>
' #txt
Pt0 f185 352 2512 432 2512 #arcP
Pt0 f185 0 0.3888888888888889 0 -9 #arcLabel
Pt0 f189 321 2569 30 30 0 15 #rect
Pt0 f190 expr in #txt
Pt0 f190 .xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>no</name>
    </language>
</elementInfo>
' #txt
Pt0 f190 336 2528 336 2569 #arcP
Pt0 f190 0 0.42857142857142855 14 0 #arcLabel
Pt0 f191 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>has DashboardWriteOwn&#13;
permission?</name>
    </language>
</elementInfo>
' #txt
Pt0 f191 320 2656 32 32 -62 27 #rect
Pt0 f180 expr in #txt
Pt0 f180 outCond ch.ivy.addon.portalkit.util.PermissionUtils.hasDashboardWriteOwnPermission() #txt
Pt0 f180 .xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>yes</name>
    </language>
</elementInfo>
' #txt
Pt0 f180 352 2672 432 2672 #arcP
Pt0 f180 0 0.3888888888888889 3 -8 #arcLabel
Pt0 f192 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>is public&#13;
dashboard?</name>
    </language>
</elementInfo>
' #txt
Pt0 f192 176 2496 32 32 -34 -52 #rect
Pt0 f194 111 2512 176 2512 #arcP
Pt0 f197 expr in #txt
Pt0 f197 outCond in.isPublicDashboard #txt
Pt0 f197 .xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>yes</name>
    </language>
</elementInfo>
' #txt
Pt0 f197 208 2512 320 2512 #arcP
Pt0 f197 0 0.15178571428571427 0 14 #arcLabel
Pt0 f196 expr in #txt
Pt0 f196 .xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>no</name>
    </language>
</elementInfo>
' #txt
Pt0 f196 192 2528 320 2672 #arcP
Pt0 f196 1 192 2672 #addKink
Pt0 f196 0 0.13970588235294118 12 0 #arcLabel
Pt0 f183 expr in #txt
Pt0 f183 .xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>no</name>
    </language>
</elementInfo>
' #txt
Pt0 f183 336 2656 336 2599 #arcP
Pt0 f183 0 0.42857142857142855 -14 -1 #arcLabel
Pt0 f188 outLink DashboardDetails.ivp #txt
Pt0 f188 inParamDecl '<String dashboardId,Boolean isPublicDashboard> param;' #txt
Pt0 f188 inParamTable 'out.dashboardId=param.dashboardId;
out.isPublicDashboard=param.isPublicDashboard;
' #txt
Pt0 f188 requestEnabled true #txt
Pt0 f188 triggerEnabled false #txt
Pt0 f188 callSignature DashboardDetails(String,Boolean) #txt
Pt0 f188 caseData businessCase.attach=true #txt
Pt0 f188 showInStartList 0 #txt
Pt0 f188 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>DashboardDetails.ivp</name>
    </language>
</elementInfo>
' #txt
Pt0 f188 @C|.responsibility Everybody #txt
Pt0 f188 81 2769 30 30 -45 21 #rect
Pt0 f193 dialogId ch.ivy.addon.portal.generic.dashboard.PortalDashboardDetailModification #txt
Pt0 f193 startMethod start(String,Boolean) #txt
Pt0 f193 requestActionDecl '<String dashboardId,Boolean isPublicDashboard> param;' #txt
Pt0 f193 requestMappingAction 'param.dashboardId=in.dashboardId;
param.isPublicDashboard=in.isPublicDashboard;
' #txt
Pt0 f193 responseMappingAction 'out=in;
' #txt
Pt0 f193 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>PortalDashboardDetailModification</name>
    </language>
</elementInfo>
' #txt
Pt0 f193 208 2762 208 44 -95 -8 #rect
Pt0 f195 497 2769 30 30 0 15 #rect
Pt0 f198 111 2784 208 2784 #arcP
Pt0 f199 416 2784 497 2784 #arcP
Pt0 f200 outLink DefaultApplicationHomePageInTeams.ivp #txt
Pt0 f200 inParamDecl '<> param;' #txt
Pt0 f200 requestEnabled true #txt
Pt0 f200 triggerEnabled false #txt
Pt0 f200 callSignature DefaultApplicationHomePageInTeams() #txt
Pt0 f200 caseData businessCase.attach=true #txt
Pt0 f200 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>DefaultApplicationHomePageInTeams.ivp</name>
    </language>
</elementInfo>
' #txt
Pt0 f200 @C|.responsibility Everybody #txt
Pt0 f200 81 209 30 30 -80 18 #rect
Pt0 f201 actionTable 'out=in;
' #txt
Pt0 f201 actionCode 'import ch.addon.portal.generic.userprofile.homepage.HomepageType;
import ch.ivy.addon.portalkit.enums.SessionAttribute;
import ch.ivy.addon.portalkit.util.SecurityServiceUtils;
SecurityServiceUtils.setSessionAttribute(SessionAttribute.PORTAL_IN_TEAMS.toString(), true);
SecurityServiceUtils.setSessionAttribute(SessionAttribute.DEFAULT_PAGE_IN_TEAMS.toString(), HomepageType.DASHBOARD.toString());' #txt
Pt0 f201 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Init Teams attrs</name>
    </language>
</elementInfo>
' #txt
Pt0 f201 168 202 112 44 -42 -8 #rect
Pt0 f202 111 224 168 224 #arcP
Pt0 f202 0 0.6937327756354965 0 0 #arcLabel
Pt0 f203 208 128 32 32 0 16 #rect
Pt0 f204 expr out #txt
Pt0 f204 111 144 208 144 #arcP
Pt0 f47 color default #txt
Pt0 f47 240 144 280 144 #arcP
Pt0 f205 224 202 224 160 #arcP
Pt0 f206 outLink CaseListPageInTeams.ivp #txt
Pt0 f206 inParamDecl '<> param;' #txt
Pt0 f206 requestEnabled true #txt
Pt0 f206 triggerEnabled false #txt
Pt0 f206 callSignature CaseListPageInTeams() #txt
Pt0 f206 caseData businessCase.attach=true #txt
Pt0 f206 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>CaseListPageInTeams.ivp</name>
    </language>
</elementInfo>
' #txt
Pt0 f206 @C|.responsibility Everybody #txt
Pt0 f206 81 433 30 30 -43 18 #rect
Pt0 f207 actionTable 'out=in;
' #txt
Pt0 f207 actionCode 'import ch.addon.portal.generic.userprofile.homepage.HomepageType;
import ch.ivy.addon.portalkit.enums.SessionAttribute;
import ch.ivy.addon.portalkit.util.SecurityServiceUtils;
SecurityServiceUtils.setSessionAttribute(SessionAttribute.PORTAL_IN_TEAMS.toString(), true);
SecurityServiceUtils.setSessionAttribute(SessionAttribute.DEFAULT_PAGE_IN_TEAMS.toString(), HomepageType.CASE.toString());' #txt
Pt0 f207 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Init Teams attrs</name>
    </language>
</elementInfo>
' #txt
Pt0 f207 168 426 112 44 -42 -8 #rect
Pt0 f208 111 448 168 448 #arcP
Pt0 f208 0 0.6937327756354965 0 0 #arcLabel
Pt0 f209 208 497 32 32 0 16 #rect
Pt0 f210 expr out #txt
Pt0 f210 111 513 208 513 #arcP
Pt0 f24 color default #txt
Pt0 f24 240 513 296 513 #arcP
Pt0 f211 224 470 224 497 #arcP
Pt0 f212 208 624 32 32 0 16 #rect
Pt0 f213 expr out #txt
Pt0 f213 111 640 208 640 #arcP
Pt0 f15 color default #txt
Pt0 f15 240 640 296 640 #arcP
Pt0 f214 actionTable 'out=in;
' #txt
Pt0 f214 actionCode 'import ch.addon.portal.generic.userprofile.homepage.HomepageType;
import ch.ivy.addon.portalkit.enums.SessionAttribute;
import ch.ivy.addon.portalkit.util.SecurityServiceUtils;
SecurityServiceUtils.setSessionAttribute(SessionAttribute.PORTAL_IN_TEAMS.toString(), true);
SecurityServiceUtils.setSessionAttribute(SessionAttribute.DEFAULT_PAGE_IN_TEAMS.toString(), HomepageType.TASK.toString());' #txt
Pt0 f214 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Init Teams attrs</name>
    </language>
</elementInfo>
' #txt
Pt0 f214 168 554 112 44 -42 -8 #rect
Pt0 f215 outLink DefaultTaskListPageInTeams.ivp #txt
Pt0 f215 inParamDecl '<> param;' #txt
Pt0 f215 requestEnabled true #txt
Pt0 f215 triggerEnabled false #txt
Pt0 f215 callSignature DefaultTaskListPageInTeams() #txt
Pt0 f215 caseData businessCase.attach=true #txt
Pt0 f215 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>DefaultTaskListPageInTeams.ivp</name>
    </language>
</elementInfo>
' #txt
Pt0 f215 @C|.responsibility Everybody #txt
Pt0 f215 81 561 30 30 -51 19 #rect
Pt0 f216 111 576 168 576 #arcP
Pt0 f216 0 0.6937327756354965 0 0 #arcLabel
Pt0 f217 224 598 224 624 #arcP
Pt0 f218 208 1264 32 32 0 16 #rect
Pt0 f219 111 1280 208 1280 #arcP
Pt0 f79 color default #txt
Pt0 f79 240 1280 296 1280 #arcP
Pt0 f220 outLink DefaultProcessStartListPageInTeams.ivp #txt
Pt0 f220 inParamDecl '<> param;' #txt
Pt0 f220 requestEnabled true #txt
Pt0 f220 triggerEnabled false #txt
Pt0 f220 callSignature DefaultProcessStartListPageInTeams() #txt
Pt0 f220 caseData businessCase.attach=true #txt
Pt0 f220 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>DefaultProcessStartListPageInTeams.ivp</name>
    </language>
</elementInfo>
' #txt
Pt0 f220 @C|.responsibility Everybody #txt
Pt0 f220 81 1201 30 30 -60 17 #rect
Pt0 f221 actionTable 'out=in;
' #txt
Pt0 f221 actionCode 'import ch.addon.portal.generic.userprofile.homepage.HomepageType;
import ch.ivy.addon.portalkit.enums.SessionAttribute;
import ch.ivy.addon.portalkit.util.SecurityServiceUtils;
SecurityServiceUtils.setSessionAttribute(SessionAttribute.PORTAL_IN_TEAMS.toString(), true);
SecurityServiceUtils.setSessionAttribute(SessionAttribute.DEFAULT_PAGE_IN_TEAMS.toString(), HomepageType.PROCESS.toString());' #txt
Pt0 f221 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Init Teams attrs</name>
    </language>
</elementInfo>
' #txt
Pt0 f221 168 1194 112 44 -42 -8 #rect
Pt0 f222 111 1216 168 1216 #arcP
Pt0 f222 0 0.6937327756354965 0 0 #arcLabel
Pt0 f223 224 1238 224 1264 #arcP
Pt0 f224 497 2865 30 30 0 15 #rect
Pt0 f225 dialogId ch.ivy.addon.portal.generic.ProcessViewer #txt
Pt0 f225 startMethod start(String) #txt
Pt0 f225 requestActionDecl '<String processViewerCaseId> param;' #txt
Pt0 f225 requestMappingAction 'param.processViewerCaseId=in.processViewerCaseId;
' #txt
Pt0 f225 responseMappingAction 'out=in;
' #txt
Pt0 f225 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>ProcessViewer</name>
    </language>
</elementInfo>
' #txt
Pt0 f225 216 2856 160 48 -41 -8 #rect
Pt0 f226 outLink PortalProcessViewer.ivp #txt
Pt0 f226 inParamDecl '<String processViewerCaseId> param;' #txt
Pt0 f226 inParamTable 'out.processViewerCaseId=param.processViewerCaseId;
' #txt
Pt0 f226 requestEnabled true #txt
Pt0 f226 triggerEnabled false #txt
Pt0 f226 callSignature PortalProcessViewer(String) #txt
Pt0 f226 caseData businessCase.attach=true #txt
Pt0 f226 showInStartList 0 #txt
Pt0 f226 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>PortalProcessViewer.ivp</name>
    </language>
</elementInfo>
' #txt
Pt0 f226 @C|.responsibility Everybody #txt
Pt0 f226 81 2865 30 30 -50 18 #rect
Pt0 f227 111 2880 216 2880 #arcP
Pt0 f228 color default #txt
Pt0 f228 376 2880 497 2880 #arcP
>Proto Pt0 .colors 'default=;
' #txt
>Proto Pt0 .type ch.ivy.addon.portal.generic.PortalStartData #txt
>Proto Pt0 .processKind NORMAL #txt
>Proto Pt0 0 0 32 24 18 0 #rect
>Proto Pt0 @|BIcon #fIcon
Bk7 f8 760 160 716 160 #arcP
Bk7 f36 dialogId ch.ivy.addon.portal.generic.PortalHome #txt
Bk7 f36 startMethod start(ch.ivy.addon.portal.generic.view.TaskView) #txt
Bk7 f36 requestActionDecl '<ch.ivy.addon.portal.generic.view.TaskView taskView> param;' #txt
Bk7 f36 requestMappingAction 'param.taskView=in.taskView;
' #txt
Bk7 f36 responseMappingAction 'out=in;
' #txt
Bk7 f36 responseActionCode '
' #txt
Bk7 f36 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Portal Homepage</name>
    </language>
</elementInfo>
' #txt
Bk7 f36 604 138 112 44 -45 -8 #rect
Bk7 f22 actionTable 'out=in;
' #txt
Bk7 f22 actionCode 'import ch.ivyteam.ivy.request.IHttpRequest;
import ch.ivy.addon.portal.generic.view.TaskView;

in.taskView = TaskView.create().dataModel(in.dataModel).showHeaderToolbar(true).noTaskFoundMessage("").createNewTaskView();
' #txt
Bk7 f22 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Build task view</name>
    </language>
</elementInfo>
' #txt
Bk7 f22 452 138 112 44 -38 -8 #rect
Bk7 f54 268 144 32 32 0 16 #rect
Bk7 f43 564 160 604 160 #arcP
Bk7 f3 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Replace by customized &#13;
homepage if you have</name>
    </language>
</elementInfo>
' #txt
Bk7 f3 760 138 144 44 -63 -16 #rect
Bk7 g0 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language lang="en">
        <name>in 1</name>
    </language>
</elementInfo>
' #txt
Bk7 g0 51 147 26 26 0 5 #rect
Bk7 f1 actionTable 'out=in;
' #txt
Bk7 f1 actionCode 'import ch.addon.portal.generic.userprofile.homepage.HomepageUtils;

out.homepage = HomepageUtils.findHomepage();' #txt
Bk7 f1 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Get selected&#13;
homepage</name>
    </language>
</elementInfo>
' #txt
Bk7 f1 124 138 112 44 -33 -16 #rect
Bk7 f0 236 160 268 160 #arcP
Bk7 f4 actionTable 'out=in;
' #txt
Bk7 f4 actionCode 'import ch.ivy.addon.portalkit.util.RequestUtil;
RequestUtil.redirect(in.homepage.link);' #txt
Bk7 f4 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Redirect to &#13;
selected homepage</name>
    </language>
</elementInfo>
' #txt
Bk7 f4 340 234 128 44 -45 -16 #rect
Bk7 f5 expr in #txt
Bk7 f5 .xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>others</name>
    </language>
</elementInfo>
' #txt
Bk7 f5 284 176 340 256 #arcP
Bk7 f5 1 284 256 #addKink
Bk7 f5 1 0.42857142857142855 0 -10 #arcLabel
Bk7 f11 77 160 124 160 #arcP
Bk7 f2 364 144 32 32 0 16 #rect
Bk7 f7 expr in #txt
Bk7 f7 outCond 'ch.addon.portal.generic.userprofile.homepage.HomepageUtils.isShowDashboard(in.#homepage, in.#isShowDashboard)' #txt
Bk7 f7 .xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>dashboard</name>
    </language>
</elementInfo>
' #txt
Bk7 f7 300 160 364 160 #arcP
Bk7 f7 0 0.40625 0 -12 #arcLabel
Bk7 f6 expr in #txt
Bk7 f6 outCond ch.addon.portal.generic.userprofile.homepage.HomepageUtils.isShowLegacyUI() #txt
Bk7 f6 396 160 452 160 #arcP
Bk7 f9 dialogId ch.ivy.addon.portal.generic.dashboard.PortalDashboard #txt
Bk7 f9 startMethod start() #txt
Bk7 f9 requestActionDecl '<> param;' #txt
Bk7 f9 responseMappingAction 'out=in;
' #txt
Bk7 f9 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>PortalDashboard</name>
    </language>
</elementInfo>
' #txt
Bk7 f9 600 58 112 44 -47 -8 #rect
Bk7 f10 expr in #txt
Bk7 f10 .xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>new dashboard</name>
    </language>
</elementInfo>
' #txt
Bk7 f10 380 144 600 80 #arcP
Bk7 f10 1 380 80 #addKink
Bk7 f10 1 0.2590909090909091 0 -10 #arcLabel
>Proto Bk7 -8 -8 16 16 16 26 #rect
>Proto Bk7 @|BpmnUserTaskIcon #fIcon
Bk8 f17 actionTable 'out=in;
' #txt
Bk8 f17 actionCode 'import ch.ivyteam.ivy.workflow.ITask;
import ch.ivyteam.ivy.workflow.ICase;
import ch.ivyteam.ivy.workflow.query.CaseQuery;

long caseId = -1;
if (in.endedTaskId is initialized) {
	ITask task = ivy.wf.findTask(Long.valueOf(in.endedTaskId));
	caseId = task.getCase().getId();
}
out.caseSelected = ivy.wf.getGlobalContext().getCaseQueryExecutor().getFirstResult(CaseQuery.create().where().caseId().isEqual(caseId)) as ICase;' #txt
Bk8 f17 security system #txt
Bk8 f17 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Find case</name>
    </language>
</elementInfo>
' #txt
Bk8 f17 352 266 112 44 -27 -8 #rect
Bk8 f68 actionTable 'out=in;
' #txt
Bk8 f68 actionCode 'out.taskSelected = ivy.wf.findTask(Long.valueOf(in.endedTaskId));' #txt
Bk8 f68 security system #txt
Bk8 f68 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>find task by id</name>
    </language>
</elementInfo>
' #txt
Bk8 f68 352 170 112 44 -35 -8 #rect
Bk8 f52 actionTable 'out=in;
' #txt
Bk8 f52 actionCode 'import ch.ivy.addon.portalkit.datamodel.CaseLazyDataModel;
import ch.ivy.addon.portalkit.datamodel.SearchResultsDataModel;

in.searchResultsDataModel = new SearchResultsDataModel();
in.searchResultsDataModel.taskDataModel = in.dataModel;
in.searchResultsDataModel.keyword = in.searchResultsDataModel.taskDataModel.criteria.keyword;
in.searchResultsDataModel.caseDataModel.notKeepFilter = true;
in.searchResultsDataModel.caseDataModel.getCriteria().keyword = in.searchResultsDataModel.taskDataModel.criteria.keyword;

' #txt
Bk8 f52 security system #txt
Bk8 f52 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>build data model</name>
    </language>
</elementInfo>
' #txt
Bk8 f52 352 458 112 44 -46 -8 #rect
Bk8 f19 actionTable 'out=in;
' #txt
Bk8 f19 actionCode 'import ch.ivy.addon.portal.generic.view.TaskView;

boolean canLinkBackToCaseDetail = in.#dataModel.#criteria.#caseId is initialized; 
in.taskView = TaskView.create().dataModel(in.dataModel).canLinkBackCaseDetail(canLinkBackToCaseDetail).showHeaderToolbar(false).createNewTaskView();' #txt
Bk8 f19 security system #txt
Bk8 f19 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>build data model,
 task </name>
    </language>
</elementInfo>
' #txt
Bk8 f19 352 356 128 56 -43 -16 #rect
Bk8 f37 processCall 'Functional Processes/OpenPortalSearch:call(ch.ivy.addon.portalkit.datamodel.SearchResultsDataModel,Number)' #txt
Bk8 f37 requestActionDecl '<ch.ivy.addon.portalkit.datamodel.SearchResultsDataModel searchResultsDataModel,Number activeTabIndex> param;' #txt
Bk8 f37 requestMappingAction 'param.searchResultsDataModel=in.searchResultsDataModel;
param.activeTabIndex=1;
' #txt
Bk8 f37 responseActionDecl 'ch.ivy.addon.portal.generic.PortalStartData out;
' #txt
Bk8 f37 responseMappingAction 'out=in;
' #txt
Bk8 f37 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>OpenPortalSearch</name>
    </language>
</elementInfo>
' #txt
Bk8 f37 560 458 112 44 -50 -8 #rect
Bk8 f0 208 80 32 32 0 16 #rect
Bk8 g0 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language lang="en">
        <name>in 1</name>
    </language>
</elementInfo>
' #txt
Bk8 g0 83 83 26 26 0 5 #rect
Bk8 f23 processCall 'Functional Processes/OpenPortalCaseDetailsHook:call(ch.ivyteam.ivy.workflow.ICase,Boolean)' #txt
Bk8 f23 requestActionDecl '<ch.ivyteam.ivy.workflow.ICase caseData,Boolean isShowBackButton> param;' #txt
Bk8 f23 requestMappingAction 'param.caseData=in.caseSelected;
param.isShowBackButton=true;
' #txt
Bk8 f23 responseActionDecl 'ch.ivy.addon.portal.generic.PortalStartData out;
' #txt
Bk8 f23 responseMappingAction 'out=in;
' #txt
Bk8 f23 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>OpenPortalCaseDetailHook</name>
    </language>
</elementInfo>
' #txt
Bk8 f23 544 266 160 44 -76 -8 #rect
Bk8 f6 processCall 'Functional Processes/OpenPortalTaskDetailsHook:call(ch.ivyteam.ivy.workflow.ITask,ch.ivy.addon.portalkit.datamodel.TaskLazyDataModel,ch.ivy.addon.portalkit.enums.PortalPage,Boolean)' #txt
Bk8 f6 requestActionDecl '<ch.ivyteam.ivy.workflow.ITask task,ch.ivy.addon.portalkit.datamodel.TaskLazyDataModel dataModel,ch.ivy.addon.portalkit.enums.PortalPage portalPage,Boolean isFromTaskList> param;' #txt
Bk8 f6 requestMappingAction 'param.task=in.taskSelected;
param.dataModel=in.dataModel;
param.portalPage=in.portalPage;
param.isFromTaskList=false;
' #txt
Bk8 f6 responseActionDecl 'ch.ivy.addon.portal.generic.PortalStartData out;
' #txt
Bk8 f6 responseMappingAction 'out=in;
' #txt
Bk8 f6 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>OpenPortalTaskDetailsHook</name>
    </language>
</elementInfo>
' #txt
Bk8 f6 512 170 176 44 -78 -8 #rect
Bk8 f12 processCall 'Functional Processes/OpenPortalTasks:useView(ch.ivy.addon.portal.generic.view.TaskView)' #txt
Bk8 f12 requestActionDecl '<ch.ivy.addon.portal.generic.view.TaskView taskView> param;' #txt
Bk8 f12 requestMappingAction 'param.taskView=in.taskView;
' #txt
Bk8 f12 responseActionDecl 'ch.ivy.addon.portal.generic.PortalStartData out;
' #txt
Bk8 f12 responseMappingAction 'out=in;
' #txt
Bk8 f12 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>OpenPortalTasks</name>
    </language>
</elementInfo>
' #txt
Bk8 f12 572 360 104 48 -46 -6 #rect
Bk8 f42 expr out #txt
Bk8 f42 464 192 512 192 #arcP
Bk8 f42 0 0.075 -1 -9 #arcLabel
Bk8 f49 expr out #txt
Bk8 f49 464 480 560 480 #arcP
Bk8 f26 expr out #txt
Bk8 f26 464 288 544 288 #arcP
Bk8 f39 expr out #txt
Bk8 f39 480 384 572 384 #arcP
Bk8 f39 0 0.7418894103244236 0 0 #arcLabel
Bk8 f7 dialogId ch.ivy.addon.portal.generic.PortalUrlCallback #txt
Bk8 f7 startMethod start(String) #txt
Bk8 f7 requestActionDecl '<String callbackUrl> param;' #txt
Bk8 f7 requestMappingAction 'param.callbackUrl=in.callbackUrl;
' #txt
Bk8 f7 responseMappingAction 'out=in;
' #txt
Bk8 f7 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>PortalUrlCallback</name>
    </language>
</elementInfo>
' #txt
Bk8 f7 448 74 112 44 -45 -8 #rect
Bk8 f8 expr in #txt
Bk8 f8 outCond 'org.apache.commons.lang3.StringUtils.isNotBlank(in.#callbackUrl)' #txt
Bk8 f8 .xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Express end page</name>
    </language>
</elementInfo>
' #txt
Bk8 f8 240 96 448 96 #arcP
Bk8 f8 0 0.47115384615384615 0 -11 #arcLabel
Bk8 f2 expr in #txt
Bk8 f2 outCond 'in.isTaskStartedInDetails && !in.isTaskFinished && !in.backFromTaskDetails' #txt
Bk8 f2 230 106 352 192 #arcP
Bk8 f2 1 288 192 #addKink
Bk8 f2 0 0.770003174626784 0 0 #arcLabel
Bk8 f3 expr in #txt
Bk8 f3 outCond 'java.util.Objects.equals(ch.ivy.addon.portalkit.enums.PortalPage.CASE_DETAIL_FROM_TASK, in.#portalPage)' #txt
Bk8 f3 228 108 352 288 #arcP
Bk8 f3 1 288 288 #addKink
Bk8 f3 0 0.7110060291341136 0 0 #arcLabel
Bk8 f4 expr in #txt
Bk8 f4 outCond 'java.util.Objects.equals(ch.ivy.addon.portalkit.enums.PortalPage.TASK_LIST, in.#portalPage)' #txt
Bk8 f4 226 110 352 384 #arcP
Bk8 f4 1 256 384 #addKink
Bk8 f4 1 0.32297169520409286 0 0 #arcLabel
Bk8 f5 expr in #txt
Bk8 f5 224 112 352 480 #arcP
Bk8 f5 1 224 480 #addKink
Bk8 f5 1 0.32297169520409286 0 0 #arcLabel
Bk8 f1 109 96 208 96 #arcP
>Proto Bk0 0 0 32 24 18 0 #rect
>Proto Bk0 @|BpmnUserTaskIcon #fIcon
Bk9 f60 expr out #txt
Bk9 f60 416 160 488 160 #arcP
Bk9 f61 expr out #txt
Bk9 f61 248 160 288 160 #arcP
Bk9 f62 processCall 'Functional Processes/InitializeCaseDataModel:call()' #txt
Bk9 f62 requestActionDecl '<> param;' #txt
Bk9 f62 responseActionDecl 'ch.ivy.addon.portal.generic.PortalStartData out;
' #txt
Bk9 f62 responseMappingAction 'out=in;
out.caseDataModel=result.caseDataModel;
' #txt
Bk9 f62 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Initialize case 
data model</name>
    </language>
</elementInfo>
' #txt
Bk9 f62 136 138 112 44 -38 -20 #rect
Bk9 f59 actionTable 'out=in;
' #txt
Bk9 f59 actionCode 'import ch.ivy.addon.portalkit.util.PermissionUtils;
import ch.ivy.addon.portalkit.util.SecurityServiceUtils;
import ch.ivy.addon.portal.generic.view.CaseView;

boolean hasReadAllCasesPermission = PermissionUtils.checkReadAllCasesPermission();
in.caseDataModel.setAdminQuery(hasReadAllCasesPermission);

in.caseView = CaseView.create().dataModel(in.caseDataModel).buildNewView();' #txt
Bk9 f59 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>build data model&#13;
and case view</name>
    </language>
</elementInfo>
' #txt
Bk9 f59 288 138 128 44 -43 -16 #rect
Bk9 f55 processCall 'Functional Processes/OpenPortalCases:useView(ch.ivy.addon.portal.generic.view.CaseView)' #txt
Bk9 f55 requestActionDecl '<ch.ivy.addon.portal.generic.view.CaseView view> param;' #txt
Bk9 f55 requestMappingAction 'param.view=in.caseView;
' #txt
Bk9 f55 responseActionDecl 'ch.ivy.addon.portal.generic.PortalStartData out;
' #txt
Bk9 f55 responseMappingAction 'out=in;
' #txt
Bk9 f55 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>OpenPortalCases</name>
    </language>
</elementInfo>
' #txt
Bk9 f55 488 136 112 48 -49 -12 #rect
Bk9 g0 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language lang="en">
        <name>in 1</name>
    </language>
</elementInfo>
' #txt
Bk9 g0 51 147 26 26 0 5 #rect
Bk9 f0 77 160 136 160 #arcP
Bk9 g1 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language lang="en">
        <name>out 1</name>
    </language>
</elementInfo>
' #txt
Bk9 g1 659 147 26 26 0 5 #rect
Bk9 f1 expr out #txt
Bk9 f1 600 160 659 160 #arcP
>Proto Bk1 0 0 32 24 18 0 #rect
>Proto Bk1 @|BpmnUserTaskIcon #fIcon
Bk10 f69 actionTable 'out=in;
' #txt
Bk10 f69 actionCode 'import ch.ivy.addon.portalkit.enums.TaskAssigneeType;
import ch.ivy.addon.portal.generic.view.TaskView;
import ch.ivy.addon.portalkit.util.PermissionUtils;

boolean hasReadAllTasksPermisson = PermissionUtils.checkReadAllTasksPermission();
in.dataModel.setAdminQuery(hasReadAllTasksPermisson);
in.dataModel.setTaskAssigneeType(TaskAssigneeType.ALL);

in.taskView = TaskView.create().dataModel(in.dataModel).noTaskFoundMessage("").showHeaderToolbar(false).createNewTaskView();
' #txt
Bk10 f69 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>build data model &#13;
and task view</name>
    </language>
</elementInfo>
' #txt
Bk10 f69 296 136 112 48 -39 -16 #rect
Bk10 f67 expr out #txt
Bk10 f67 408 160 492 160 #arcP
Bk10 f118 expr out #txt
Bk10 f118 248 160 296 160 #arcP
Bk10 f84 processCall 'Functional Processes/OpenPortalTasks:useView(ch.ivy.addon.portal.generic.view.TaskView)' #txt
Bk10 f84 requestActionDecl '<ch.ivy.addon.portal.generic.view.TaskView taskView> param;' #txt
Bk10 f84 requestMappingAction 'param.taskView=in.taskView;
' #txt
Bk10 f84 responseActionDecl 'ch.ivy.addon.portal.generic.PortalStartData out;
' #txt
Bk10 f84 responseMappingAction 'out=in;
' #txt
Bk10 f84 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>OpenPortalTasks</name>
    </language>
</elementInfo>
' #txt
Bk10 f84 492 140 104 40 -48 -12 #rect
Bk10 f73 processCall 'Functional Processes/InitializeTaskDataModel:call()' #txt
Bk10 f73 requestActionDecl '<> param;' #txt
Bk10 f73 responseActionDecl 'ch.ivy.addon.portal.generic.PortalStartData out;
' #txt
Bk10 f73 responseMappingAction 'out=in;
out.dataModel=result.dataModel;
' #txt
Bk10 f73 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Init data model</name>
    </language>
</elementInfo>
' #txt
Bk10 f73 136 138 112 44 -40 -8 #rect
Bk10 g0 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language lang="en">
        <name>in 1</name>
    </language>
</elementInfo>
' #txt
Bk10 g0 51 147 26 26 0 5 #rect
Bk10 f0 77 160 136 160 #arcP
Bk10 g1 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language lang="en">
        <name>out 1</name>
    </language>
</elementInfo>
' #txt
Bk10 g1 659 147 26 26 0 5 #rect
Bk10 f1 expr out #txt
Bk10 f1 596 160 659 160 #arcP
>Proto Bk2 0 0 32 24 18 0 #rect
>Proto Bk2 @|BpmnUserTaskIcon #fIcon
Bk11 f106 actionTable 'out=in;
' #txt
Bk11 f106 actionCode 'import ch.ivyteam.ivy.workflow.ICase;
import ch.ivyteam.ivy.workflow.query.CaseQuery;

out.caseSelected = ivy.wf.getGlobalContext().getCaseQueryExecutor().getFirstResult(CaseQuery.create().where().caseId().isEqual(in.caseId)) as ICase;' #txt
Bk11 f106 security system #txt
Bk11 f106 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Find Case</name>
    </language>
</elementInfo>
' #txt
Bk11 f106 136 138 112 44 -28 -8 #rect
Bk11 f104 processCall 'Functional Processes/OpenPortalCaseDetailsHook:call(ch.ivyteam.ivy.workflow.ICase,Boolean)' #txt
Bk11 f104 requestActionDecl '<ch.ivyteam.ivy.workflow.ICase caseData,Boolean isShowBackButton> param;' #txt
Bk11 f104 requestMappingAction 'param.caseData=in.caseSelected;
param.isShowBackButton=true;
' #txt
Bk11 f104 responseActionDecl 'ch.ivy.addon.portal.generic.PortalStartData out;
' #txt
Bk11 f104 responseMappingAction 'out=in;
' #txt
Bk11 f104 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>OpenPortalCaseDetails</name>
    </language>
</elementInfo>
' #txt
Bk11 f104 288 138 144 44 -65 -8 #rect
Bk11 f107 expr out #txt
Bk11 f107 248 160 288 160 #arcP
Bk11 g0 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language lang="en">
        <name>in 1</name>
    </language>
</elementInfo>
' #txt
Bk11 g0 51 147 26 26 0 5 #rect
Bk11 f0 77 160 136 160 #arcP
Bk11 g1 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language lang="en">
        <name>out 1</name>
    </language>
</elementInfo>
' #txt
Bk11 g1 499 147 26 26 0 5 #rect
Bk11 f1 expr out #txt
Bk11 f1 432 160 499 160 #arcP
>Proto Bk3 0 0 32 24 18 0 #rect
>Proto Bk3 @|BpmnUserTaskIcon #fIcon
Bk13 f47 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Is first task?</name>
    </language>
</elementInfo>
' #txt
Bk13 f47 136 144 32 32 -25 -43 #rect
Bk13 f55 expr in #txt
Bk13 f55 .xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>No</name>
    </language>
</elementInfo>
' #txt
Bk13 f55 152 176 504 182 #arcP
Bk13 f55 1 152 224 #addKink
Bk13 f55 2 504 224 #addKink
Bk13 f55 1 0.45170454545454547 0 10 #arcLabel
Bk13 f49 expr in #txt
Bk13 f49 outCond in.isFirstTask #txt
Bk13 f49 .xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Yes</name>
    </language>
</elementInfo>
' #txt
Bk13 f49 168 160 240 160 #arcP
Bk13 f49 0 0.4861111111111111 0 -13 #arcLabel
Bk13 f4 processCall 'Functional Processes/InitializeTaskDataModel:call()' #txt
Bk13 f4 requestActionDecl '<> param;' #txt
Bk13 f4 responseActionDecl 'ch.ivy.addon.portal.generic.PortalStartData out;
' #txt
Bk13 f4 responseMappingAction 'out=in;
out.dataModel=result.dataModel;
' #txt
Bk13 f4 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>InitializeTaskDataModel</name>
    </language>
</elementInfo>
' #txt
Bk13 f4 240 138 144 44 -65 -8 #rect
Bk13 f31 384 160 440 160 #arcP
Bk13 f12 dialogId ch.ivy.addon.portal.generic.PortalFinishTaskHandle #txt
Bk13 f12 startMethod start(Boolean,ch.ivyteam.ivy.workflow.ICase) #txt
Bk13 f12 requestActionDecl '<Boolean isTaskFinished,ch.ivyteam.ivy.workflow.ICase iCase> param;' #txt
Bk13 f12 requestMappingAction 'param.isTaskFinished=in.isTaskFinished;
param.iCase=in.caseSelected;
' #txt
Bk13 f12 responseMappingAction 'out=in;
' #txt
Bk13 f12 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Display growl message&#13;
after finish task</name>
    </language>
</elementInfo>
' #txt
Bk13 f12 608 138 144 44 -54 -16 #rect
Bk13 f7 actionTable 'out=in;
' #txt
Bk13 f7 actionCode 'import ch.ivy.addon.portalkit.enums.PortalPage;
import ch.ivy.addon.portalkit.datamodel.TaskLazyDataModel;

if(in.#portalPage == PortalPage.HOME_PAGE) {
	in.dataModel.compactMode = true;
}' #txt
Bk13 f7 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Set compactMode&#13;
DataModel</name>
    </language>
</elementInfo>
' #txt
Bk13 f7 440 138 128 44 -44 -16 #rect
Bk13 g0 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language lang="en">
        <name>in 1</name>
    </language>
</elementInfo>
' #txt
Bk13 g0 51 147 26 26 0 5 #rect
Bk13 f0 77 160 136 160 #arcP
Bk13 g1 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language lang="en">
        <name>out 1</name>
    </language>
</elementInfo>
' #txt
Bk13 g1 819 147 26 26 0 5 #rect
Bk13 f1 752 160 819 160 #arcP
Bk13 f2 568 160 608 160 #arcP
>Proto Bk6 0 0 32 24 18 0 #rect
>Proto Bk6 @|BpmnServiceTaskIcon #fIcon
Pt0 f11 mainOut f2 tail #connect
Pt0 f2 head f1 in #connect
Pt0 f9 mainOut f16 tail #connect
Pt0 f16 head f0 in #connect
Pt0 f17 head f64 mainIn #connect
Pt0 f25 head f57 mainIn #connect
Pt0 f27 head f105 mainIn #connect
Pt0 f103 mainOut f26 tail #connect
Pt0 f5 out f20 tail #connect
Pt0 f20 head f0 in #connect
Pt0 f5 out f18 tail #connect
Pt0 f70 mainOut f33 tail #connect
Pt0 f33 head f32 mainIn #connect
Pt0 f32 mainOut f35 tail #connect
Pt0 f35 head f34 mainIn #connect
Pt0 f51 mainOut f41 tail #connect
Pt0 f41 head f37 mainIn #connect
Pt0 f39 mainOut f42 tail #connect
Pt0 f42 head f51 mainIn #connect
Pt0 f19 head f5 in #connect
Pt0 f60 mainOut f61 tail #connect
Pt0 f61 head f59 mainIn #connect
Pt0 f62 mainOut f66 tail #connect
Pt0 f66 head f65 mainIn #connect
Pt0 f68 mainOut f69 tail #connect
Pt0 f69 head f67 mainIn #connect
Pt0 f72 mainOut f77 tail #connect
Pt0 f77 head f74 mainIn #connect
Pt0 f73 mainOut f78 tail #connect
Pt0 f78 head f75 mainIn #connect
Pt0 f86 mainOut f91 tail #connect
Pt0 f91 head f81 in #connect
Pt0 f90 head f80 mainIn #connect
Pt0 f81 out f87 tail #connect
Pt0 f87 head f84 mainIn #connect
Pt0 f81 out f90 tail #connect
Pt0 f82 mainOut f89 tail #connect
Pt0 f89 head f83 mainIn #connect
Pt0 f83 mainOut f88 tail #connect
Pt0 f88 head f86 mainIn #connect
Pt0 f44 mainOut f46 tail #connect
Pt0 f46 head f45 mainIn #connect
Pt0 f38 mainOut f93 tail #connect
Pt0 f93 head f44 mainIn #connect
Pt0 f0 out f92 tail #connect
Pt0 f37 mainOut f8 tail #connect
Pt0 f8 head f6 mainIn #connect
Pt0 f30 head f22 in #connect
Pt0 f22 out f50 tail #connect
Pt0 f50 head f9 mainIn #connect
Pt0 f40 head f5 in #connect
Pt0 f1 out f30 tail #connect
Pt0 f1 out f36 tail #connect
Pt0 f1 out f19 tail #connect
Pt0 f10 mainOut f7 tail #connect
Pt0 f7 head f4 in #connect
Pt0 f14 mainOut f13 tail #connect
Pt0 f13 head f4 in #connect
Pt0 f49 head f31 mainIn #connect
Pt0 f4 out f29 tail #connect
Pt0 f29 head f31 mainIn #connect
Pt0 f4 out f48 tail #connect
Pt0 f48 head f11 mainIn #connect
Pt0 f12 mainOut f53 tail #connect
Pt0 f53 head f52 mainIn #connect
Pt0 f52 mainOut f55 tail #connect
Pt0 f55 head f54 mainIn #connect
Pt0 f94 mainOut f96 tail #connect
Pt0 f96 head f56 mainIn #connect
Pt0 f97 mainOut f98 tail #connect
Pt0 f98 head f95 mainIn #connect
Pt0 f99 mainOut f104 tail #connect
Pt0 f104 head f101 mainIn #connect
Pt0 f101 mainOut f102 tail #connect
Pt0 f102 head f100 mainIn #connect
Pt0 f109 mainOut f111 tail #connect
Pt0 f111 head f110 mainIn #connect
Pt0 f121 out f113 tail #connect
Pt0 f113 head f108 mainIn #connect
Pt0 f115 out f124 tail #connect
Pt0 f124 head f109 mainIn #connect
Pt0 f115 out f123 tail #connect
Pt0 f123 head f118 mainIn #connect
Pt0 f121 out f117 tail #connect
Pt0 f117 head f118 mainIn #connect
Pt0 f107 mainOut f126 tail #connect
Pt0 f126 head f125 in #connect
Pt0 f106 mainOut f128 tail #connect
Pt0 f128 head f127 in #connect
Pt0 f125 out f116 tail #connect
Pt0 f116 head f121 in #connect
Pt0 f125 out f112 tail #connect
Pt0 f112 head f118 mainIn #connect
Pt0 f127 out f119 tail #connect
Pt0 f119 head f115 in #connect
Pt0 f127 out f114 tail #connect
Pt0 f114 head f118 mainIn #connect
Pt0 f130 mainOut f131 tail #connect
Pt0 f131 head f122 mainIn #connect
Pt0 f132 mainOut f135 tail #connect
Pt0 f135 head f134 mainIn #connect
Pt0 f134 mainOut f136 tail #connect
Pt0 f136 head f133 mainIn #connect
Pt0 f140 head f139 mainIn #connect
Pt0 f21 out f49 tail #connect
Pt0 f21 out f140 tail #connect
Pt0 f120 mainOut f43 tail #connect
Pt0 f43 head f137 mainIn #connect
Pt0 f139 mainOut f23 tail #connect
Pt0 f23 head f22 in #connect
Pt0 f137 mainOut f129 tail #connect
Pt0 f129 head f21 in #connect
Pt0 f92 head S60 g0 #connect
Pt0 f18 head S10 g0 #connect
Pt0 S30 g1 f25 tail #connect
Pt0 S20 g1 f17 tail #connect
Pt0 f26 head S40 g0 #connect
Pt0 S40 g1 f27 tail #connect
Pt0 f36 head S70 g0 #connect
Pt0 S70 g1 f40 tail #connect
Pt0 f143 mainOut f147 tail #connect
Pt0 f147 head f142 mainIn #connect
Pt0 f142 mainOut f146 tail #connect
Pt0 f146 head f138 mainIn #connect
Pt0 f144 mainOut f145 tail #connect
Pt0 f145 head f143 mainIn #connect
Pt0 f151 mainOut f153 tail #connect
Pt0 f153 head f148 mainIn #connect
Pt0 f149 mainOut f155 tail #connect
Pt0 f155 head f152 mainIn #connect
Pt0 f152 mainOut f154 tail #connect
Pt0 f154 head f151 mainIn #connect
Pt0 f156 mainOut f162 tail #connect
Pt0 f162 head f157 mainIn #connect
Pt0 f159 mainOut f160 tail #connect
Pt0 f160 head f158 mainIn #connect
Pt0 f158 mainOut f161 tail #connect
Pt0 f161 head f156 mainIn #connect
Pt0 f166 mainOut f169 tail #connect
Pt0 f169 head f164 mainIn #connect
Pt0 f165 out f172 tail #connect
Pt0 f172 head f166 mainIn #connect
Pt0 f165 out f171 tail #connect
Pt0 f171 head f164 mainIn #connect
Pt0 f163 mainOut f168 tail #connect
Pt0 f168 head f167 mainIn #connect
Pt0 f167 mainOut f170 tail #connect
Pt0 f170 head f165 in #connect
Pt0 f177 mainOut f176 tail #connect
Pt0 f176 head f178 mainIn #connect
Pt0 f178 mainOut f175 tail #connect
Pt0 f175 head f174 mainIn #connect
Pt0 f22 out f141 tail #connect
Pt0 f141 head f0 in #connect
Pt0 f173 mainOut f181 tail #connect
Pt0 f181 head f179 mainIn #connect
Pt0 f182 mainOut f186 tail #connect
Pt0 f186 head f184 mainIn #connect
Pt0 f187 out f185 tail #connect
Pt0 f185 head f182 mainIn #connect
Pt0 f187 out f190 tail #connect
Pt0 f190 head f189 mainIn #connect
Pt0 f191 out f180 tail #connect
Pt0 f180 head f173 mainIn #connect
Pt0 f150 mainOut f194 tail #connect
Pt0 f194 head f192 in #connect
Pt0 f192 out f197 tail #connect
Pt0 f197 head f187 in #connect
Pt0 f192 out f196 tail #connect
Pt0 f196 head f191 in #connect
Pt0 f191 out f183 tail #connect
Pt0 f183 head f189 mainIn #connect
Pt0 f188 mainOut f198 tail #connect
Pt0 f198 head f193 mainIn #connect
Pt0 f193 mainOut f199 tail #connect
Pt0 f199 head f195 mainIn #connect
Pt0 f200 mainOut f202 tail #connect
Pt0 f202 head f201 mainIn #connect
Pt0 f28 mainOut f204 tail #connect
Pt0 f204 head f203 in #connect
Pt0 f203 out f47 tail #connect
Pt0 f47 head f137 mainIn #connect
Pt0 f201 mainOut f205 tail #connect
Pt0 f205 head f203 in #connect
Pt0 f206 mainOut f208 tail #connect
Pt0 f208 head f207 mainIn #connect
Pt0 f58 mainOut f210 tail #connect
Pt0 f210 head f209 in #connect
Pt0 f209 out f24 tail #connect
Pt0 f24 head S30 g0 #connect
Pt0 f207 mainOut f211 tail #connect
Pt0 f211 head f209 in #connect
Pt0 f63 mainOut f213 tail #connect
Pt0 f213 head f212 in #connect
Pt0 f212 out f15 tail #connect
Pt0 f15 head S20 g0 #connect
Pt0 f215 mainOut f216 tail #connect
Pt0 f216 head f214 mainIn #connect
Pt0 f214 mainOut f217 tail #connect
Pt0 f217 head f212 in #connect
Pt0 f76 mainOut f219 tail #connect
Pt0 f219 head f218 in #connect
Pt0 f218 out f79 tail #connect
Pt0 f79 head f71 mainIn #connect
Pt0 f220 mainOut f222 tail #connect
Pt0 f222 head f221 mainIn #connect
Pt0 f221 mainOut f223 tail #connect
Pt0 f223 head f218 in #connect
Pt0 f226 mainOut f227 tail #connect
Pt0 f227 head f225 mainIn #connect
Pt0 f225 mainOut f228 tail #connect
Pt0 f228 head f224 mainIn #connect
Bk7 f3 ao f8 tail #connect
Bk7 f8 head f36 @CG|ai #connect
Bk7 f22 mainOut f43 tail #connect
Bk7 f43 head f36 mainIn #connect
Bk7 f1 mainOut f0 tail #connect
Bk7 f0 head f54 in #connect
Bk7 f5 head f4 mainIn #connect
Bk7 g0 m f11 tail #connect
Bk7 f11 head f1 mainIn #connect
Bk7 f54 out f7 tail #connect
Bk7 f7 head f2 in #connect
Bk7 f54 out f5 tail #connect
Bk7 f2 out f6 tail #connect
Bk7 f6 head f22 mainIn #connect
Bk7 f2 out f10 tail #connect
Bk7 f10 head f9 mainIn #connect
Bk7 0 0 944 320 0 #ivRect
Bk8 f17 mainOut f26 tail #connect
Bk8 f26 head f23 mainIn #connect
Bk8 f19 mainOut f39 tail #connect
Bk8 f39 head f12 mainIn #connect
Bk8 f52 mainOut f49 tail #connect
Bk8 f49 head f37 mainIn #connect
Bk8 f68 mainOut f42 tail #connect
Bk8 f42 head f6 mainIn #connect
Bk8 g0 m f1 tail #connect
Bk8 f1 head f0 in #connect
Bk8 f0 out f8 tail #connect
Bk8 f8 head f7 mainIn #connect
Bk8 f0 out f2 tail #connect
Bk8 f2 head f68 mainIn #connect
Bk8 f0 out f3 tail #connect
Bk8 f3 head f17 mainIn #connect
Bk8 f0 out f4 tail #connect
Bk8 f4 head f19 mainIn #connect
Bk8 f0 out f5 tail #connect
Bk8 f5 head f52 mainIn #connect
Bk8 0 0 736 560 0 #ivRect
Bk9 f62 mainOut f61 tail #connect
Bk9 f61 head f59 mainIn #connect
Bk9 f59 mainOut f60 tail #connect
Bk9 f60 head f55 mainIn #connect
Bk9 g0 m f0 tail #connect
Bk9 f0 head f62 mainIn #connect
Bk9 f1 head g1 m #connect
Bk9 f55 mainOut f1 tail #connect
Bk9 0 0 736 320 0 #ivRect
Bk10 f73 mainOut f118 tail #connect
Bk10 f118 head f69 mainIn #connect
Bk10 f69 mainOut f67 tail #connect
Bk10 f67 head f84 mainIn #connect
Bk10 g0 m f0 tail #connect
Bk10 f0 head f73 mainIn #connect
Bk10 f1 head g1 m #connect
Bk10 f84 mainOut f1 tail #connect
Bk10 0 0 736 320 0 #ivRect
Bk11 f106 mainOut f107 tail #connect
Bk11 f107 head f104 mainIn #connect
Bk11 g0 m f0 tail #connect
Bk11 f0 head f106 mainIn #connect
Bk11 f1 head g1 m #connect
Bk11 f104 mainOut f1 tail #connect
Bk11 0 0 576 320 0 #ivRect
Bk13 f4 mainOut f31 tail #connect
Bk13 f31 head f7 mainIn #connect
Bk13 f47 out f49 tail #connect
Bk13 f49 head f4 mainIn #connect
Bk13 f47 out f55 tail #connect
Bk13 f55 head f7 mainIn #connect
Bk13 g0 m f0 tail #connect
Bk13 f0 head f47 in #connect
Bk13 f1 head g1 m #connect
Bk13 f12 mainOut f1 tail #connect
Bk13 f7 mainOut f2 tail #connect
Bk13 f2 head f12 mainIn #connect
Bk13 0 0 896 320 0 #ivRect
