<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
  xmlns:f="http://xmlns.jcp.org/jsf/core" xmlns:h="http://xmlns.jcp.org/jsf/html"
  xmlns:ui="http://xmlns.jcp.org/jsf/facelets" xmlns:ic="http://ivyteam.ch/jsf/component"
  xmlns:p="http://primefaces.org/ui" xmlns:pe="http://primefaces.org/ui/extensions"
  xmlns:cc="http://xmlns.jcp.org/jsf/composite" xmlns:c="http://xmlns.jcp.org/jsp/jstl/core">
<h:body>
  <cc:interface componentType="IvyComponent">
  </cc:interface>
  <cc:implementation>
    <c:set var="isPortalInTeams" value="#{masterDataBean.portalInTeams}" />

    <ui:fragment rendered="#{!isPortalInTeams}">
      <!-- Exception Handler for ViewExpiredExceptions -->
      <p:ajaxExceptionHandler
        type="javax.faces.application.ViewExpiredException"
        onexception="PF('timeout-warning-dialog').hide(); PF('view-expired-exception-dialog').show();" />

      <!-- Error Dialog shown if a view or session has expired -->
      <ui:decorate
        template="/layouts/decorator/portal-dialog-with-icon.xhtml">
        <ui:param name="id" value="view-expired-exception-dialog" />
        <ui:param name="widgetVar" value="view-expired-exception-dialog" />
        <ui:param name="appendTo" value="@(body)" />
        <ui:param name="iconClass" value="si si-road-sign-warning" />
        <ui:param name="iconStyleClass"
          value="portal-dialog-warning-icon" />
        <ui:param name="headerText"
          value="#{ivy.cms.co('/ch.ivy.addon.portalkit.ui.jsf/common/warning')}" />
        <ui:param name="dialogContent"
          value="#{ivy.session.isSessionUserUnknown() ? ivy.cms.co('/ch.ivy.addon.portalkit.ui.jsf/common/sessionExpried') : ivy.cms.co('/ch.ivy.addon.portalkit.ui.jsf/common/viewExpired')}" />

        <ui:define name="dialogFooter">
          <p:commandButton
            value="#{ivy.cms.co('/ch.ivy.addon.portalkit.ui.jsf/common/ok')}"
            onclick="redirectDefaultPage();"
            icon="#{visibilityBean.generateButtonIcon('si si-check-1')}"
            type="button" />
        </ui:define>
      </ui:decorate>
    </ui:fragment>
    <ui:fragment rendered="#{isPortalInTeams}">
      <!-- Exception Handler for ViewExpiredExceptions -->
      <p:ajaxExceptionHandler
        type="javax.faces.application.ViewExpiredException"
        update="ms-teams-view-expired-exception-dialog"
        onexception="PF('timeout-warning-dialog').hide();PF('ms-teams-view-expired-exception-dialog').show();" />

      <!-- Error Dialog shown if a view or session has expired -->
      <p:confirmDialog id="ms-teams-view-expired-exception-dialog"
        header="#{ivy.cms.co('/ch.ivy.addon.portalkit.ui.jsf/common/warning')}"
        message="#{ivy.cms.co('/ch.ivy.addon.portalkit.ui.jsf/common/sessionExpriedInTeams')}"
        widgetVar="ms-teams-view-expired-exception-dialog"
        appendTo="@(body)" closable="false" responsive="true">
      </p:confirmDialog>
    </ui:fragment>
    <script type="text/javascript">
      var redirectPage = "#{userMenuBean.homePageURL}";
      function redirectDefaultPage() {
        window.location.href = redirectPage;
      }
    </script>
  </cc:implementation>
</h:body>

</html>