<html xmlns="http://www.w3.org/1999/xhtml" xmlns:f="http://xmlns.jcp.org/jsf/core" xmlns:h="http://xmlns.jcp.org/jsf/html"
  xmlns:ui="http://xmlns.jcp.org/jsf/facelets" xmlns:cc="http://xmlns.jcp.org/jsf/composite" xmlns:ic="http://ivyteam.ch/jsf/component"
  xmlns:p="http://primefaces.org/ui" xmlns:pe="http://primefaces.org/ui/extensions" xmlns:c="http://xmlns.jcp.org/jsp/jstl/core">
<cc:interface componentType="IvyComponent">
  <cc:attribute name="threshold" type="com.axonivy.portal.bo.Threshold" />
  <cc:attribute name="managedBean" required="true" />
  <cc:attribute name="readOnly" default="false" />
  <cc:attribute name="componentToUpdate" />
  <cc:attribute name="onCompleteRemoveThreshold" />
  <cc:attribute name="thresholdIndex" />
  <cc:attribute name="messageId" />
  <cc:attribute name="componentToUpdateWhenRemoveThreshold" />
  <cc:attribute name="categoryData" />
</cc:interface>

<cc:implementation>
  <c:set var="managedBean" value="#{cc.attrs.managedBean}" />
  <c:set var="threshold" value="#{cc.attrs.threshold}" />
  <c:set var="thresholdIndex" value="#{cc.attrs.thresholdIndex}" />
  <c:set var="categoryData" value="#{cc.attrs.categoryData}" />

  <div class="ui-g-12 pl-0">
    <h:panelGroup id="threshold-panel" layout="block" styleClass="flex">
         <h:panelGroup class="threshold-item mt-3 mr-3" layout="block">
             <p:selectOneMenu class="threshold-category-data" required="true" styleClass="w-full"
               value="#{threshold.categoryValue}">
               <f:selectItems value="#{statisticConfigurationBean.categoryData}"
                 var="value" itemValue="#{value}" itemLabel="#{statisticConfigurationBean.displayThresholdCategoryValue(value)}"/>
                <p:ajax event="itemSelect" partialSubmit="true" global="false"/>
                <f:param name="skipValidator" value="true" />
                <f:attribute name="threshold" value="#{threshold}" />
                <f:attribute name="thresholdIndex" value="#{thresholdIndex}" />
             </p:selectOneMenu>
         </h:panelGroup>

         <h:panelGroup class="threshold-item mt-3 mr-3" layout="block">
             <p:selectOneMenu label="Operator" required="true" styleClass="threshold-operator-value"
               value="#{threshold.operator}">
               <f:selectItems value="#{statisticConfigurationBean.getAllOperatorField()}"
                 var="operator" itemValue="#{operator}" itemLabel="#{operator.getCmsName()}" />
                <p:ajax event="change" partialSubmit="true" global="false"/>
                <f:param name="skipValidator" value="true" />
                <f:attribute name="threshold" value="#{threshold}" />
                <f:attribute name="thresholdIndex" value="#{thresholdIndex}" />
             </p:selectOneMenu>
         </h:panelGroup>
         
         <h:panelGroup class="threshold-item mt-3 mr-3" layout="block">
          <p:inputText label="Threshold value" styleClass="threshold-input-value" required="true" value="#{threshold.value}">
            <p:ajax event="change" partialSubmit="true" global="false"/>
            <f:param name="skipValidator" value="true" />
            <f:attribute name="threshold" value="#{threshold}" />
            <f:attribute name="thresholdIndex" value="#{thresholdIndex}" />
          </p:inputText>
         </h:panelGroup>
         
         <h:panelGroup class="threshold-item mt-3 mr-3" layout="block">
           <p:colorPicker styleClass="threshold-color-value" value="#{threshold.backgroundColor}" required="true" clearButton="true" closeButton="true" size="10">
            <f:param name="skipValidator" value="true" />
            <p:ajax event="change" partialSubmit="true" global="false"/>
            <f:attribute name="threshold" value="#{threshold}" />
            <f:attribute name="thresholdIndex" value="#{thresholdIndex}" />
           </p:colorPicker>
         </h:panelGroup>

         <div class="remove-threshold-panel align-items-center flex">
          <p:commandButton id="remove-threshold" icon="si si-subtract"
            styleClass="rounded-button ui-button-outlined action-column-icon-button ui-button-danger dashboard-widget-filter__remove-filter"
            actionListener="#{managedBean.removeThreshold(threshold)}"
            update="#{cc.attrs.componentToUpdateWhenRemoveThreshold} #{cc.attrs.componentToUpdate}" global="false"
            immediate="true" partialSubmit="true">
            <f:param name="skipValidator" value="true" />
          </p:commandButton>
         </div>
    </h:panelGroup>
  </div>

</cc:implementation>

</html>