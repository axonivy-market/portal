{
  "$schema" : "https://json-schema.axonivy.com/process/12.0.0/process.json",
  "id" : "153CACC26D0D4C3D",
  "config" : {
    "data" : "portalKit_test.DataCreationData"
  },
  "elements" : [ {
      "id" : "f0",
      "type" : "RequestStart",
      "name" : "createTasks(String)",
      "config" : {
        "signature" : "createTasks",
        "input" : {
          "params" : [
            { "name" : "taskStructureInfo", "type" : "String", "desc" : "" }
          ],
          "map" : {
            "out.taskStructureInfo" : "param.taskStructureInfo"
          }
        },
        "request" : {
          "isHttpRequestable" : false
        },
        "triggerable" : true,
        "task" : {
          "responsible" : {
            "activator" : "SYSTEM"
          }
        },
        "case" : {
          "attachToBusinessCase" : false
        }
      },
      "visual" : {
        "at" : { "x" : 64, "y" : 336 },
        "labelOffset" : { "x" : 76, "y" : 20 }
      },
      "connect" : [
        { "id" : "f43", "to" : "f23" }
      ]
    }, {
      "id" : "f1",
      "type" : "TaskEnd",
      "visual" : {
        "at" : { "x" : 480, "y" : 216 }
      }
    }, {
      "id" : "f5",
      "type" : "TaskEnd",
      "visual" : {
        "at" : { "x" : 480, "y" : 256 }
      }
    }, {
      "id" : "f6",
      "type" : "TaskEnd",
      "visual" : {
        "at" : { "x" : 480, "y" : 288 }
      }
    }, {
      "id" : "f23",
      "type" : "Script",
      "name" : "set case name",
      "config" : {
        "output" : {
          "code" : [
            "import org.apache.commons.lang3.StringUtils;",
            "in.caseName = in.taskStructureInfo + \"_\" + ivy.case.getId();",
            "in.caseStructureInfo = StringUtils.replace(in.taskStructureInfo,StringUtils.SPACE,\"_\");"
          ]
        }
      },
      "visual" : {
        "at" : { "x" : 200, "y" : 336 }
      },
      "connect" : [
        { "id" : "f4", "to" : "f3", "var" : "in1" }
      ]
    }, {
      "id" : "f25",
      "type" : "RequestStart",
      "name" : "createTestDataWithCategory.ivp",
      "config" : {
        "signature" : "createTestDataWithCategory",
        "request" : {
          "name" : "Create test data with category"
        },
        "case" : {
          "name" : "Create test data with category",
          "attachToBusinessCase" : false
        }
      },
      "visual" : {
        "at" : { "x" : 64, "y" : 96 },
        "labelOffset" : { "x" : 56, "y" : 40 }
      },
      "connect" : [
        { "id" : "f37", "to" : "f24" }
      ]
    }, {
      "id" : "f28",
      "type" : "TriggerCall",
      "name" : "DataCreation",
      "config" : {
        "processCall" : "Start Processes/DataCreation:createTasks(String)",
        "call" : {
          "map" : {
            "param.taskStructureInfo" : "in.handler.getNextTaskStructureInfo()"
          }
        }
      },
      "visual" : {
        "at" : { "x" : 640, "y" : 96 }
      },
      "connect" : [
        { "id" : "f42", "to" : "f41", "via" : [ { "x" : 640, "y" : 48 } ] }
      ]
    }, {
      "id" : "f30",
      "type" : "Script",
      "name" : "init handler",
      "config" : {
        "output" : {
          "code" : [
            "import ch.ivy.addon.portalkit.test.util.DataCreationHandler;",
            "if(in.attachToBusinessCase) {",
            " ivy.case.name = \"Create test data with category attach to one business case\";  ",
            "}",
            "in.handler = new DataCreationHandler(in.numOfCats, in.numOfSubCats, in.numOfCasesPerSubCat);"
          ]
        },
        "sudo" : true
      },
      "visual" : {
        "at" : { "x" : 352, "y" : 96 }
      },
      "connect" : [
        { "id" : "f33", "to" : "f32" }
      ]
    }, {
      "id" : "f32",
      "type" : "Alternative",
      "config" : {
        "conditions" : {
          "f82" : "in.handler.createMoreTasks()"
        }
      },
      "visual" : {
        "at" : { "x" : 416, "y" : 96 }
      },
      "connect" : [
        { "id" : "f82", "to" : "f81" },
        { "id" : "f35", "to" : "f34" }
      ]
    }, {
      "id" : "f34",
      "type" : "TaskEnd",
      "visual" : {
        "at" : { "x" : 416, "y" : 168 }
      }
    }, {
      "id" : "f27",
      "type" : "DialogCall",
      "config" : {
        "dialog" : "ch.ivy.addon.portalkit.test.DefaultDialog:start()"
      },
      "visual" : {
        "at" : { "x" : 400, "y" : 264 }
      },
      "connect" : [
        { "id" : "f2", "to" : "f1" }
      ]
    }, {
      "id" : "f41",
      "type" : "Script",
      "name" : [
        "Sleep a bit before",
        "triggering new process"
      ],
      "config" : {
        "output" : {
          "code" : "Thread.sleep(10);"
        }
      },
      "visual" : {
        "at" : { "x" : 464, "y" : 48 }
      },
      "connect" : [
        { "id" : "f26", "to" : "f32", "via" : [ { "x" : 416, "y" : 48 } ] }
      ]
    }, {
      "id" : "f24",
      "type" : "DialogCall",
      "name" : "input number of tasks",
      "config" : {
        "dialog" : "ch.ivy.addon.portalkit.test.DataCreation:start()",
        "output" : {
          "map" : {
            "out" : "in",
            "out.attachToBusinessCase" : "result.attachToBussinessCase",
            "out.numOfCasesPerSubCat" : "result.numOfCasesPerSubCat",
            "out.numOfCats" : "result.numOfCats",
            "out.numOfSubCats" : "result.numOfSubCats"
          }
        }
      },
      "visual" : {
        "at" : { "x" : 264, "y" : 96 }
      },
      "connect" : [
        { "id" : "f31", "to" : "f30" }
      ]
    }, {
      "id" : "f3",
      "type" : "TaskSwitchGateway",
      "config" : {
        "tasks" : [ {
            "id" : "TaskA",
            "name" : "<%=in1.caseName%>_A",
            "category" : "<%=in1.taskStructureInfo%>",
            "priority" : {
              "level" : "LOW"
            }
          }, {
            "id" : "TaskB",
            "name" : "<%=in1.caseName%>_B",
            "category" : "<%=in1.taskStructureInfo%>"
          }, {
            "id" : "TaskC",
            "name" : "<%=in1.caseName%>_C",
            "category" : "<%=in1.taskStructureInfo%>",
            "priority" : {
              "level" : "HIGH"
            }
          } ],
        "case" : {
          "name" : "<%=in1.caseName%>",
          "category" : "<%=in1.caseStructureInfo%>"
        }
      },
      "visual" : {
        "at" : { "x" : 288, "y" : 336 }
      },
      "connect" : [
        { "id" : "f7", "to" : "f27", "condition" : "ivp==\"TaskA.ivp\"" },
        { "id" : "f8", "to" : "f5", "condition" : "ivp==\"TaskB.ivp\"" },
        { "id" : "f9", "to" : "f6", "condition" : "ivp==\"TaskC.ivp\"" }
      ]
    }, {
      "id" : "f10",
      "type" : "RequestStart",
      "name" : "DestroyTask",
      "config" : {
        "signature" : "destroyTask"
      },
      "visual" : {
        "at" : { "x" : 64, "y" : 480 },
        "labelOffset" : { "x" : 56, "y" : 20 }
      },
      "connect" : [
        { "id" : "f14", "to" : "f13" }
      ]
    }, {
      "id" : "f11",
      "type" : "TaskEnd",
      "visual" : {
        "at" : { "x" : 320, "y" : 480 }
      }
    }, {
      "id" : "f13",
      "type" : "DialogCall",
      "config" : {
        "dialog" : "ch.ivy.addon.portalkit.showroom.multiapp.tasks.DestroyTaskPage:start()"
      },
      "visual" : {
        "at" : { "x" : 192, "y" : 480 }
      },
      "connect" : [
        { "id" : "f12", "to" : "f11" }
      ]
    }, {
      "id" : "f15",
      "type" : "RequestStart",
      "name" : "createTestUser.ivp",
      "config" : {
        "signature" : "createTestUser",
        "request" : {
          "name" : "Create test user"
        }
      },
      "visual" : {
        "at" : { "x" : 64, "y" : 576 }
      },
      "connect" : [
        { "id" : "f19", "to" : "f16" }
      ]
    }, {
      "id" : "f16",
      "type" : "Script",
      "config" : {
        "output" : {
          "code" : [
            "import ch.ivyteam.ivy.security.ISecurityContext;",
            "import java.util.Locale;",
            "import ch.ivyteam.ivy.security.user.NewUser;",
            "if (ISecurityContext.current().users().find(\"test_change_password_user\") != null) {",
            "  ISecurityContext.current().users().delete(\"test_change_password_user\");",
            "}",
            "NewUser user = NewUser",
            "    .create(\"test_change_password_user\")",
            "    .fullName(\"Elton\")",
            "    .password(\"123\")",
            "    .language(java.util.Locale.ENGLISH)",
            "    .toNewUser();",
            "ISecurityContext.current().users().create(user);"
          ]
        },
        "sudo" : true
      },
      "visual" : {
        "at" : { "x" : 208, "y" : 576 }
      },
      "connect" : [
        { "id" : "f18", "to" : "f17" }
      ]
    }, {
      "id" : "f17",
      "type" : "TaskEnd",
      "visual" : {
        "at" : { "x" : 336, "y" : 576 }
      }
    }, {
      "id" : "f20",
      "type" : "RequestStart",
      "name" : "createRelatedTasksTestUser.ivp",
      "config" : {
        "signature" : "createRelatedTasksTestUser"
      },
      "visual" : {
        "at" : { "x" : 64, "y" : 736 },
        "labelOffset" : { "x" : 54, "y" : 46 }
      },
      "connect" : [
        { "id" : "f36", "to" : "f22" }
      ]
    }, {
      "id" : "f21",
      "type" : "TaskEnd",
      "visual" : {
        "at" : { "x" : 352, "y" : 736 }
      }
    }, {
      "id" : "f22",
      "type" : "Script",
      "config" : {
        "output" : {
          "code" : [
            "import ch.ivyteam.ivy.security.ISecurityContext;",
            "import ch.ivyteam.ivy.security.user.NewUser;",
            "if (ISecurityContext.current().users().find(\"test_related_tasks_user\") != null) {",
            "  ISecurityContext.current().users().delete(\"test_related_tasks_user\");",
            "}",
            "",
            "NewUser user = NewUser",
            "    .create(\"test_related_tasks_user\")",
            "    .fullName(\"Related Tasks User\")",
            "    .password(\"+d3m0++\")",
            "    .language(java.util.Locale.ENGLISH)",
            "    .toNewUser();",
            "ISecurityContext.current().users().create(user);"
          ]
        },
        "sudo" : true
      },
      "visual" : {
        "at" : { "x" : 224, "y" : 736 }
      },
      "connect" : [
        { "id" : "f38", "to" : "f21" }
      ]
    }, {
      "id" : "f48",
      "type" : "RequestStart",
      "name" : "createTestUsers.ivp",
      "config" : {
        "signature" : "createTestUsers",
        "request" : {
          "name" : "Create multiple test users",
          "description" : "Create multiple test users"
        }
      },
      "visual" : {
        "at" : { "x" : 608, "y" : 384 },
        "description" : "create multiple test users"
      },
      "connect" : [
        { "id" : "f56", "to" : "f55" }
      ]
    }, {
      "id" : "f55",
      "type" : "DialogCall",
      "name" : "Input number of user",
      "config" : {
        "dialog" : "ch.ivy.addon.portalkit.test.CreateMultipleTestUsers:start()",
        "output" : {
          "map" : {
            "out" : "in",
            "out.numerOfUsers" : "result.numberOfUsers"
          }
        }
      },
      "visual" : {
        "at" : { "x" : 784, "y" : 384 },
        "size" : { "width" : 128 }
      },
      "connect" : [
        { "id" : "f57", "to" : "f60" }
      ]
    }, {
      "id" : "f59",
      "type" : "Alternative",
      "config" : {
        "conditions" : {
          "f68" : "in.counter <= in.numerOfUsers"
        }
      },
      "visual" : {
        "at" : { "x" : 1096, "y" : 384 }
      },
      "connect" : [
        { "id" : "f68", "to" : "f61" },
        { "id" : "f64", "to" : "f62", "via" : [ { "x" : 1096, "y" : 448 } ] }
      ]
    }, {
      "id" : "f60",
      "type" : "Script",
      "name" : [
        "Count total user ",
        "in application"
      ],
      "config" : {
        "output" : {
          "code" : [
            "import ch.ivyteam.ivy.security.ISecurityContext;",
            "import ch.ivyteam.ivy.security.query.UserQuery;",
            "import ch.ivyteam.ivy.security.IUser;",
            "",
            "UserQuery userQuery = ISecurityContext.current().users().query();",
            "List<IUser> users = userQuery.executor().results();",
            "in.numberOfUsersInApplication = users.size();",
            "in.counter = 1;"
          ]
        },
        "sudo" : true
      },
      "visual" : {
        "at" : { "x" : 968, "y" : 384 },
        "size" : { "width" : 128 }
      },
      "connect" : [
        { "id" : "f67", "to" : "f59" }
      ]
    }, {
      "id" : "f61",
      "type" : "Script",
      "name" : "Create test user",
      "config" : {
        "output" : {
          "code" : [
            "import ch.ivyteam.ivy.security.ISecurityContext;",
            "import java.util.Locale;",
            "import ch.ivyteam.ivy.security.user.NewUser;",
            "",
            "Integer userIndex =  in.numberOfUsersInApplication + in.counter;",
            "String username = \"testuser_\" + userIndex;",
            "",
            "if (ISecurityContext.current().users().find(username) != null) {",
            "  ISecurityContext.current().users().delete(username);",
            "}",
            "",
            "NewUser user = NewUser",
            "    .create(username)",
            "    .fullName(username)",
            "    .password(\"+d3m0++\")",
            "    .language(java.util.Locale.ENGLISH)",
            "    .toNewUser();",
            "ISecurityContext.current().users().create(user);",
            "in.counter++;"
          ]
        },
        "sudo" : true
      },
      "visual" : {
        "at" : { "x" : 1216, "y" : 384 }
      },
      "connect" : [
        { "id" : "f66", "to" : "f63" }
      ]
    }, {
      "id" : "f62",
      "type" : "TaskEnd",
      "visual" : {
        "at" : { "x" : 1344, "y" : 448 }
      }
    }, {
      "id" : "f63",
      "type" : "Alternative",
      "visual" : {
        "at" : { "x" : 1344, "y" : 384 }
      },
      "connect" : [
        { "id" : "f65", "to" : "f59", "via" : [ { "x" : 1344, "y" : 296 }, { "x" : 1096, "y" : 296 } ] }
      ]
    }, {
      "id" : "f39",
      "type" : "Script",
      "name" : "Hide 2nd task",
      "config" : {
        "output" : {
          "code" : [
            "import com.axonivy.portal.components.publicapi.CaseAPI;",
            "import com.axonivy.portal.components.publicapi.TaskAPI;",
            "TaskAPI.setHidePropertyToHideInPortal(ivy.task);",
            "CaseAPI.setHidePropertyToHideInPortal(ivy.case);"
          ]
        },
        "sudo" : true
      },
      "visual" : {
        "at" : { "x" : 978, "y" : 576 }
      },
      "connect" : [
        { "id" : "f47", "to" : "f44" }
      ]
    }, {
      "id" : "f40",
      "type" : "TaskSwitchEvent",
      "config" : {
        "task" : {
          "name" : "Second Hidden Task",
          "description" : "Task, which has the HIDE additional property, won't be displayed in Portal",
          "responsible" : {
            "activator" : "SYSTEM"
          },
          "skipTasklist" : true
        },
        "case" : {
          "name" : "Case contains hidden task"
        }
      },
      "visual" : {
        "at" : { "x" : 856, "y" : 576 }
      },
      "connect" : [
        { "id" : "f51", "to" : "f39", "condition" : "ivp==\"TaskA.ivp\"" }
      ]
    }, {
      "id" : "f44",
      "type" : "TaskEnd",
      "visual" : {
        "at" : { "x" : 1088, "y" : 576 }
      }
    }, {
      "id" : "f45",
      "type" : "Script",
      "name" : "Hide 1st task",
      "config" : {
        "output" : {
          "code" : [
            "import com.axonivy.portal.components.publicapi.TaskAPI;",
            "TaskAPI.setHidePropertyToHideInPortal(ivy.task);"
          ]
        },
        "sudo" : true
      },
      "visual" : {
        "at" : { "x" : 736, "y" : 576 }
      },
      "connect" : [
        { "id" : "f49", "to" : "f40", "var" : "in1" }
      ]
    }, {
      "id" : "f46",
      "type" : "RequestStart",
      "name" : "createHiddenTaskAndCase()",
      "config" : {
        "signature" : "createHiddenTaskAndCase",
        "request" : {
          "name" : "Process contains hidden task and cases",
          "description" : "Task and Case, which has the HIDE additional property, won't be displayed in Portal",
          "isVisibleOnStartList" : false
        },
        "triggerable" : true,
        "task" : {
          "name" : "First hidden Task",
          "description" : "Task, which has the HIDE additional property, won't be displayed in Portal",
          "responsible" : {
            "activator" : "SYSTEM"
          }
        },
        "case" : {
          "name" : "Hidden case"
        }
      },
      "visual" : {
        "at" : { "x" : 616, "y" : 576 },
        "labelOffset" : { "x" : -3, "y" : 42 }
      },
      "connect" : [
        { "id" : "f50", "to" : "f45" }
      ]
    }, {
      "id" : "f52",
      "type" : "RequestStart",
      "name" : "createHiddenTasksAndCases.ivp",
      "config" : {
        "signature" : "createHiddenTasksAndCases",
        "request" : {
          "name" : "Process to create hidden tasks and cases",
          "description" : "Process to create hidden tasks and cases"
        },
        "case" : {
          "name" : "Hidden case"
        }
      },
      "visual" : {
        "at" : { "x" : 912, "y" : 96 }
      },
      "connect" : [
        { "id" : "f54", "to" : "f53" }
      ]
    }, {
      "id" : "f53",
      "type" : "DialogCall",
      "name" : "Input number of cases",
      "config" : {
        "dialog" : "ch.ivy.addon.portalkit.test.CreateHiddenTasksAndCases:start()",
        "output" : {
          "map" : {
            "out" : "in",
            "out.numberOfCases" : "result.numberOfCases"
          }
        }
      },
      "visual" : {
        "at" : { "x" : 1088, "y" : 96 },
        "size" : { "width" : 128 }
      },
      "connect" : [
        { "id" : "f69", "to" : "f58" }
      ]
    }, {
      "id" : "f58",
      "type" : "Script",
      "name" : "init counter",
      "config" : {
        "output" : {
          "code" : [
            "import ch.ivy.addon.portalkit.enums.AdditionalProperty;",
            "",
            "in.counter = 1;",
            "ivy.case.customFields().stringField(AdditionalProperty.HIDE.toString()).set(AdditionalProperty.HIDE.toString());"
          ]
        }
      },
      "visual" : {
        "at" : { "x" : 1344, "y" : 96 }
      },
      "connect" : [
        { "id" : "f71", "to" : "f70" }
      ]
    }, {
      "id" : "f70",
      "type" : "Alternative",
      "config" : {
        "conditions" : {
          "f73" : "in.counter <= in.numberOfCases"
        }
      },
      "visual" : {
        "at" : { "x" : 1472, "y" : 96 }
      },
      "connect" : [
        { "id" : "f73", "to" : "f72" },
        { "id" : "f113", "to" : "f112", "var" : "in1" }
      ]
    }, {
      "id" : "f72",
      "type" : "TriggerCall",
      "name" : "DataCreation",
      "config" : {
        "processCall" : "Start Processes/DataCreation:createHiddenTaskAndCase()"
      },
      "visual" : {
        "at" : { "x" : 1584, "y" : 96 }
      },
      "connect" : [
        { "id" : "f77", "to" : "f76" }
      ]
    }, {
      "id" : "f74",
      "type" : "TaskEnd",
      "visual" : {
        "at" : { "x" : 1472, "y" : 288 }
      }
    }, {
      "id" : "f76",
      "type" : "Script",
      "name" : "increate counter",
      "config" : {
        "output" : {
          "code" : "in.counter++;"
        }
      },
      "visual" : {
        "at" : { "x" : 1728, "y" : 96 }
      },
      "connect" : [
        { "id" : "f78", "to" : "f70", "via" : [ { "x" : 1728, "y" : 24 }, { "x" : 1472, "y" : 24 } ] }
      ]
    }, {
      "id" : "f79",
      "type" : "RequestStart",
      "name" : "createTaskAttachToBusinessCase(String)",
      "config" : {
        "signature" : "createTaskAttachToBusinessCase",
        "input" : {
          "params" : [
            { "name" : "taskStructureInfo", "type" : "String", "desc" : "" }
          ],
          "map" : {
            "out.taskStructureInfo" : "param.taskStructureInfo"
          }
        },
        "request" : {
          "isHttpRequestable" : false
        },
        "triggerable" : true,
        "task" : {
          "responsible" : {
            "activator" : "SYSTEM"
          }
        }
      },
      "visual" : {
        "at" : { "x" : 64, "y" : 224 },
        "labelOffset" : { "x" : 115, "y" : 39 }
      },
      "connect" : [
        { "id" : "f80", "to" : "f23" }
      ]
    }, {
      "id" : "f81",
      "type" : "Alternative",
      "config" : {
        "conditions" : {
          "f29" : "!in.attachToBusinessCase"
        }
      },
      "visual" : {
        "at" : { "x" : 512, "y" : 96 }
      },
      "connect" : [
        { "id" : "f29", "to" : "f28" },
        { "id" : "f84", "to" : "f83", "via" : [ { "x" : 512, "y" : 160 } ] }
      ]
    }, {
      "id" : "f83",
      "type" : "TriggerCall",
      "name" : "DataCreation",
      "config" : {
        "processCall" : "Start Processes/DataCreation:createTaskAttachToBusinessCase(String)",
        "call" : {
          "map" : {
            "param.taskStructureInfo" : "in.handler.getNextTaskStructureInfo()"
          }
        }
      },
      "visual" : {
        "at" : { "x" : 640, "y" : 160 }
      },
      "connect" : [
        { "id" : "f85", "to" : "f41", "via" : [ { "x" : 752, "y" : 160 }, { "x" : 752, "y" : 48 } ] }
      ]
    }, {
      "id" : "f86",
      "type" : "RequestStart",
      "name" : "hideOrUnHideTaskCase.ivp",
      "config" : {
        "signature" : "hideOrUnHideTaskCase"
      },
      "visual" : {
        "at" : { "x" : 64, "y" : 864 },
        "labelOffset" : { "x" : 59, "y" : 45 }
      },
      "connect" : [
        { "id" : "f89", "to" : "f88" }
      ]
    }, {
      "id" : "f87",
      "type" : "TaskEnd",
      "visual" : {
        "at" : { "x" : 512, "y" : 864 }
      }
    }, {
      "id" : "f88",
      "type" : "DialogCall",
      "name" : "Hide or unhide task case",
      "config" : {
        "dialog" : "ch.ivy.addon.portalkit.test.HideOrUnHideTaskCase:start()"
      },
      "visual" : {
        "at" : { "x" : 288, "y" : 864 },
        "size" : { "width" : 144 }
      },
      "connect" : [
        { "id" : "f90", "to" : "f87" }
      ]
    }, {
      "id" : "f91",
      "type" : "RequestStart",
      "name" : "createCaseHaveCategoryTreeWithCMS.ivp",
      "config" : {
        "signature" : "createCaseHaveCategoryTreeWithCMS",
        "request" : {
          "name" : "Create Case Have Category Tree With CMS"
        }
      },
      "visual" : {
        "at" : { "x" : 64, "y" : 992 },
        "labelOffset" : { "x" : 81, "y" : 46 }
      },
      "connect" : [
        { "id" : "f101", "to" : "f100" }
      ]
    }, {
      "id" : "f92",
      "type" : "RequestStart",
      "name" : "createCaseWithSpecificCategory(java.lang.String)",
      "config" : {
        "signature" : "createCaseWithSpecificCategory",
        "input" : {
          "params" : [
            { "name" : "caseCategory", "type" : "String", "desc" : "" }
          ],
          "map" : {
            "out.caseCategory" : "param.caseCategory"
          }
        },
        "request" : {
          "isVisibleOnStartList" : false
        },
        "triggerable" : true,
        "task" : {
          "responsible" : {
            "activator" : "SYSTEM"
          }
        },
        "case" : {
          "attachToBusinessCase" : false
        }
      },
      "visual" : {
        "at" : { "x" : 608, "y" : 736 },
        "labelOffset" : { "x" : -4, "y" : 46 }
      },
      "connect" : [
        { "id" : "f96", "to" : "f95" }
      ]
    }, {
      "id" : "f95",
      "type" : "Script",
      "config" : {
        "output" : {
          "code" : [
            "ivy.case.setCategoryPath(in.caseCategory);",
            "ivy.case.setName(\"Case with category path: \" + in.caseCategory);"
          ]
        }
      },
      "visual" : {
        "at" : { "x" : 736, "y" : 736 }
      },
      "connect" : [
        { "id" : "f94", "to" : "f93" }
      ]
    }, {
      "id" : "f97",
      "type" : "TaskEnd",
      "visual" : {
        "at" : { "x" : 1088, "y" : 736 }
      }
    }, {
      "id" : "f93",
      "type" : "TaskSwitchEvent",
      "config" : {
        "task" : {
          "name" : "System Task",
          "responsible" : {
            "activator" : "SYSTEM"
          }
        }
      },
      "visual" : {
        "at" : { "x" : 880, "y" : 736 }
      },
      "connect" : [
        { "id" : "f98", "to" : "f97", "condition" : "ivp==\"TaskA.ivp\"" }
      ]
    }, {
      "id" : "f99",
      "type" : "TriggerCall",
      "name" : [
        "Create case ",
        "with specific category"
      ],
      "config" : {
        "processCall" : "Start Processes/DataCreation:createCaseWithSpecificCategory(String)",
        "call" : {
          "map" : {
            "param.caseCategory" : "in.caseCatagories.get(in.counter)"
          }
        }
      },
      "visual" : {
        "at" : { "x" : 528, "y" : 992 },
        "size" : { "width" : 144 }
      },
      "connect" : [
        { "id" : "f108", "to" : "f110" }
      ]
    }, {
      "id" : "f100",
      "type" : "Script",
      "name" : "Init categories",
      "config" : {
        "output" : {
          "code" : [
            "in.caseCatagories.add(\"/Test/ETest_1/Test_1_1\");",
            "in.caseCatagories.add(\"/Test/ETest_1/Test_1_2\");",
            "in.caseCatagories.add(\"/Test/CTest_2/Test_2_1\");",
            "in.caseCatagories.add(\"/Test/CTest_2/Test_2_2\");",
            "in.caseCatagories.add(\"/Test/BTest_3/Test_3_1\");",
            "in.caseCatagories.add(\"/Test/BTest_3/Test_3_2\");",
            "in.caseCatagories.add(\"/Test/ATest_4/Test_4_1\");",
            "in.caseCatagories.add(\"/Test/ATest_4/Test_4_2\");",
            "in.caseCatagories.add(\"/Test/DTest_5/Test_5_1\");",
            "in.caseCatagories.add(\"/Test/DTest_5/Test_5_2\");",
            "in.numOfCats = in.caseCatagories.size();",
            "in.counter = 0;"
          ]
        }
      },
      "visual" : {
        "at" : { "x" : 240, "y" : 992 }
      },
      "connect" : [
        { "id" : "f103", "to" : "f102" }
      ]
    }, {
      "id" : "f102",
      "type" : "Alternative",
      "config" : {
        "conditions" : {
          "f104" : "in.counter < in.numOfCats"
        }
      },
      "visual" : {
        "at" : { "x" : 384, "y" : 992 }
      },
      "connect" : [
        { "id" : "f104", "to" : "f99" },
        { "id" : "f106", "to" : "f105" }
      ]
    }, {
      "id" : "f105",
      "type" : "TaskEnd",
      "visual" : {
        "at" : { "x" : 384, "y" : 1056 }
      }
    }, {
      "id" : "f107",
      "type" : "Alternative",
      "visual" : {
        "at" : { "x" : 832, "y" : 992 }
      },
      "connect" : [
        { "id" : "f109", "to" : "f102", "via" : [ { "x" : 832, "y" : 920 }, { "x" : 384, "y" : 920 } ] }
      ]
    }, {
      "id" : "f110",
      "type" : "Script",
      "name" : "increase counter",
      "config" : {
        "output" : {
          "code" : "in.counter++;"
        }
      },
      "visual" : {
        "at" : { "x" : 696, "y" : 992 }
      },
      "connect" : [
        { "id" : "f111", "to" : "f107" }
      ]
    }, {
      "id" : "f112",
      "type" : "TaskSwitchGateway",
      "visual" : {
        "at" : { "x" : 1472, "y" : 192 }
      },
      "connect" : [
        { "id" : "f75", "to" : "f74", "condition" : "ivp==\"TaskA.ivp\"" }
      ]
    }, {
      "id" : "f119",
      "type" : "RequestStart",
      "name" : "disableVisibilityUser.ivp",
      "config" : {
        "signature" : "disableVisibilityUser",
        "request" : {
          "name" : "Create and disable visibility user"
        }
      },
      "visual" : {
        "at" : { "x" : 992, "y" : 920 },
        "labelOffset" : { "x" : -2, "y" : 38 }
      },
      "connect" : [
        { "id" : "f121", "to" : "f120" }
      ]
    }, {
      "id" : "f120",
      "type" : "Script",
      "name" : "Create disabled user",
      "config" : {
        "output" : {
          "code" : [
            "import ch.ivyteam.ivy.security.ISecurityContext;",
            "import ch.ivyteam.ivy.security.user.NewUser;",
            "import ch.ivyteam.ivy.security.IUser;",
            "",
            "IUser user = ISecurityContext.current().users().find(\"visibility_test_user\");",
            "",
            "if (user != null) {",
            "  user.disable();",
            "}",
            "else {",
            "  user = ISecurityContext.current().users().create(NewUser.create(\"visibility_test_user\").password(\"+d3m0++\").fullName(\"Visibility Test User\").toNewUser());",
            "  user.disable();",
            "}",
            "ivy.log.warn(\"Disable visibility user\");"
          ]
        },
        "sudo" : true
      },
      "visual" : {
        "at" : { "x" : 1120, "y" : 920 },
        "size" : { "width" : 128 }
      },
      "connect" : [
        { "id" : "f123", "to" : "f122" }
      ]
    }, {
      "id" : "f122",
      "type" : "TaskEnd",
      "visual" : {
        "at" : { "x" : 1248, "y" : 920 }
      }
    }, {
      "id" : "f129",
      "type" : "RequestStart",
      "name" : "createTaskAndCaseForDisabledUser.ivp",
      "config" : {
        "signature" : "createTaskAndCaseForDisabledUser",
        "request" : {
          "name" : "Create task and case for disabled user"
        },
        "case" : {
          "name" : "Disabled user's case"
        }
      },
      "visual" : {
        "at" : { "x" : 992, "y" : 1008 },
        "labelOffset" : { "x" : 20, "y" : 44 }
      },
      "connect" : [
        { "id" : "f135", "to" : "f134" }
      ]
    }, {
      "id" : "f130",
      "type" : "TaskSwitchEvent",
      "config" : {
        "task" : {
          "name" : "Task for disabled user",
          "responsible" : {
            "type" : "USER_FROM_ATTRIBUTE",
            "activator" : "\"visibility_test_user\""
          }
        }
      },
      "visual" : {
        "at" : { "x" : 1248, "y" : 1008 }
      },
      "connect" : [
        { "id" : "f133", "to" : "f132" }
      ]
    }, {
      "id" : "f132",
      "type" : "TaskEnd",
      "visual" : {
        "at" : { "x" : 1376, "y" : 1008 }
      }
    }, {
      "id" : "f134",
      "type" : "Script",
      "config" : {
        "output" : {
          "code" : [
            "import ch.ivyteam.ivy.security.ISecurityContext;",
            "ivy.case.setCreatorUser(ISecurityContext.current().users().find(\"visibility_test_user\"));"
          ]
        },
        "sudo" : true
      },
      "visual" : {
        "at" : { "x" : 1120, "y" : 1008 }
      },
      "connect" : [
        { "id" : "f131", "to" : "f130" }
      ]
    }, {
      "id" : "f124",
      "type" : "RequestStart",
      "name" : "enableVisibilityUser.ivp",
      "config" : {
        "signature" : "enableVisibilityUser",
        "request" : {
          "name" : "Enable visibility user"
        }
      },
      "visual" : {
        "at" : { "x" : 992, "y" : 848 },
        "labelOffset" : { "x" : -5, "y" : 37 }
      },
      "connect" : [
        { "id" : "f126", "to" : "f125" }
      ]
    }, {
      "id" : "f125",
      "type" : "Script",
      "name" : "Enable visibility user",
      "config" : {
        "output" : {
          "code" : [
            "import ch.ivyteam.ivy.security.ISecurityContext;",
            "import ch.ivyteam.ivy.security.user.NewUser;",
            "import ch.ivyteam.ivy.security.IUser;",
            "",
            "IUser user = ISecurityContext.current().users().find(\"visibility_test_user\");",
            "",
            "if (user != null) {",
            "  user.enable();",
            "}",
            "else {",
            "  user = ISecurityContext.current().users().create(NewUser.create(\"visibility_test_user\").password(\"+d3m0++\").fullName(\"Visibility Test User\").toNewUser());",
            "  user.enable();",
            "}",
            "ivy.log.warn(\"Enable visibility user\");"
          ]
        },
        "sudo" : true
      },
      "visual" : {
        "at" : { "x" : 1120, "y" : 848 },
        "size" : { "width" : 128 }
      },
      "connect" : [
        { "id" : "f128", "to" : "f127" }
      ]
    }, {
      "id" : "f127",
      "type" : "TaskEnd",
      "visual" : {
        "at" : { "x" : 1248, "y" : 848 }
      }
    }, {
      "id" : "f137",
      "type" : "TaskEnd",
      "visual" : {
        "at" : { "x" : 448, "y" : 1152 }
      }
    }, {
      "id" : "S10",
      "type" : "EmbeddedProcess",
      "name" : "Create 3 tasks with system state",
      "elements" : [ {
          "id" : "S10-g0",
          "type" : "EmbeddedStart",
          "visual" : {
            "at" : { "x" : 64, "y" : 256 }
          },
          "parentConnector" : "f139",
          "connect" : [
            { "id" : "S10-f2", "to" : "S10-f1", "var" : "in1" }
          ]
        }, {
          "id" : "S10-g1",
          "type" : "EmbeddedEnd",
          "visual" : {
            "at" : { "x" : 736, "y" : 256 }
          },
          "parentConnector" : "f138"
        }, {
          "id" : "S10-f1",
          "type" : "TaskSwitchGateway",
          "config" : {
            "tasks" : [ {
                "id" : "TaskA",
                "name" : "Task Switch A",
                "skipTasklist" : true,
                "expiry" : {
                  "timeout" : "new Duration(\"2D\")"
                }
              }, {
                "id" : "TaskB",
                "name" : "Task Switch B",
                "skipTasklist" : true,
                "delay" : "new Duration(50000)",
                "customFields" : [
                  { "name" : "StateExampleTaskSwitchB", "type" : "STRING", "value" : "\"TaskWillBeDestroyed\"" }
                ]
              }, {
                "id" : "TaskC",
                "name" : "Task Switch C",
                "skipTasklist" : true,
                "delay" : "new Duration(50000)"
              } ]
          },
          "visual" : {
            "at" : { "x" : 208, "y" : 256 }
          },
          "connect" : [
            { "id" : "S10-f4", "to" : "S10-f3", "label" : {
                "name" : "Task A",
                "offset" : { "y" : -14 }
              }, "condition" : "ivp==\"TaskA.ivp\"" },
            { "id" : "S10-f11", "to" : "S10-f10", "via" : [ { "x" : 208, "y" : 160 } ], "label" : {
                "name" : "Task B",
                "segment" : 1.49,
                "offset" : { "y" : -11 }
              }, "condition" : "ivp==\"TaskB.ivp\"" },
            { "id" : "S10-f7", "to" : "S10-f5", "via" : [ { "x" : 208, "y" : 352 }, { "x" : 640, "y" : 352 } ], "label" : {
                "name" : "Task C",
                "segment" : 1.46,
                "offset" : { "y" : -13 }
              }, "condition" : "ivp==\"TaskC.ivp\"", "var" : "in2" }
          ]
        }, {
          "id" : "S10-f3",
          "type" : "Script",
          "name" : "Call TaskUtils to destroy task with customField",
          "config" : {
            "output" : {
              "code" : [
                "import ch.ivy.addon.portalkit.test.util.TaskUtils;",
                "",
                "TaskUtils.destroyTaskByCustomField(\"StateExampleTaskSwitchB\");"
              ]
            }
          },
          "visual" : {
            "at" : { "x" : 440, "y" : 256 },
            "size" : { "width" : 272 }
          },
          "connect" : [
            { "id" : "S10-f6", "to" : "S10-f5", "var" : "in1" }
          ]
        }, {
          "id" : "S10-f5",
          "type" : "TaskSwitchGateway",
          "visual" : {
            "at" : { "x" : 640, "y" : 256 }
          },
          "connect" : [
            { "id" : "S10-f0", "to" : "S10-g1", "condition" : "ivp==\"TaskA.ivp\"" }
          ]
        }, {
          "id" : "S10-f10",
          "type" : "TaskEnd",
          "visual" : {
            "at" : { "x" : 640, "y" : 160 }
          }
        }, {
          "id" : "S10-f8",
          "type" : "ErrorStartEvent",
          "name" : "test:expiry",
          "config" : {
            "errorCode" : "test:expiry"
          },
          "visual" : {
            "at" : { "x" : 64, "y" : 464 },
            "labelOffset" : { "x" : 13, "y" : 33 }
          },
          "connect" : [
            { "id" : "S10-f9", "to" : "S10-f12" }
          ]
        }, {
          "id" : "S10-f12",
          "type" : "TaskEnd",
          "visual" : {
            "at" : { "x" : 544, "y" : 464 },
            "labelOffset" : { "x" : 13, "y" : 33 }
          }
        } ],
      "visual" : {
        "at" : { "x" : 256, "y" : 1152 },
        "size" : { "width" : 192 }
      },
      "connect" : [
        { "id" : "f138", "to" : "f137" }
      ]
    }, {
      "id" : "f136",
      "type" : "RequestStart",
      "name" : "createTaskWithSystemState.ivp",
      "config" : {
        "signature" : "createTaskWithSystemState",
        "request" : {
          "name" : "Create Task With System State (Ready for join, destroyed, delay)"
        },
        "task" : {
          "name" : "Create Tasks With System States"
        },
        "case" : {
          "name" : "Create Tasks With System States"
        }
      },
      "visual" : {
        "at" : { "x" : 64, "y" : 1152 },
        "labelOffset" : { "x" : 49, "y" : 48 }
      },
      "connect" : [
        { "id" : "f139", "to" : "S10" }
      ]
    }, {
      "id" : "f150",
      "type" : "RequestStart",
      "name" : "createThirdPartyApp.ivp",
      "config" : {
        "signature" : "createThirdPartyApp",
        "request" : {
          "name" : "Create third party app",
          "description" : "Create third party app"
        }
      },
      "visual" : {
        "at" : { "x" : 64, "y" : 1280 },
        "labelOffset" : { "x" : 51, "y" : 37 }
      },
      "connect" : [
        { "id" : "f153", "to" : "f152" }
      ]
    }, {
      "id" : "f151",
      "type" : "TaskEnd",
      "visual" : {
        "at" : { "x" : 448, "y" : 1280 }
      }
    }, {
      "id" : "f152",
      "type" : "Script",
      "name" : "create 3rd app",
      "config" : {
        "output" : {
          "code" : [
            "import com.axonivy.portal.components.util.Locales;",
            "import ch.ivy.addon.portalkit.util.DisplayNameConvertor;",
            "import ch.ivy.addon.portalkit.configuration.Application;",
            "import ch.ivy.addon.portalkit.service.RegisteredApplicationService;",
            "",
            "DisplayNameConvertor convertor = new DisplayNameConvertor();",
            "convertor.add(new Locales().getCurrentLocale(), \"Google\");",
            "",
            "Application app = new Application();",
            "app.displayName = convertor.toJson();",
            "app.link = \"https://www.google.com/\";",
            "app.menuIcon = \"fa fa-play\";",
            "app.menuOrdinal = 99;",
            "app.name = convertor.toJson();",
            "",
            "RegisteredApplicationService applicationService = RegisteredApplicationService.getInstance();",
            "app = applicationService.save(app) as Application;"
          ]
        },
        "sudo" : true
      },
      "visual" : {
        "at" : { "x" : 240, "y" : 1280 }
      },
      "connect" : [
        { "id" : "f154", "to" : "f151" }
      ]
    }, {
      "id" : "f114",
      "type" : "RequestStart",
      "name" : "testThrowableError.ivp",
      "config" : {
        "signature" : "testThrowableError"
      },
      "visual" : {
        "at" : { "x" : 64, "y" : 1408 },
        "labelOffset" : { "x" : 48, "y" : 37 }
      },
      "connect" : [
        { "id" : "f157", "to" : "f156" }
      ]
    }, {
      "id" : "f115",
      "type" : "TaskEnd",
      "visual" : {
        "at" : { "x" : 384, "y" : 1408 }
      }
    }, {
      "id" : "f117",
      "type" : "RequestStart",
      "name" : "startTest500.ivp",
      "config" : {
        "signature" : "startTest500"
      },
      "visual" : {
        "at" : { "x" : 64, "y" : 1536 },
        "labelOffset" : { "x" : 27, "y" : 37 }
      },
      "connect" : [
        { "id" : "f159", "to" : "f158" }
      ]
    }, {
      "id" : "f118",
      "type" : "TaskEnd",
      "visual" : {
        "at" : { "x" : 384, "y" : 1536 }
      }
    }, {
      "id" : "f156",
      "type" : "DialogCall",
      "name" : "Test throwable",
      "config" : {
        "dialog" : "ch.ivy.addon.portalkit.component.IconSelection:start()"
      },
      "visual" : {
        "at" : { "x" : 232, "y" : 1408 }
      },
      "connect" : [
        { "id" : "f116", "to" : "f115" }
      ]
    }, {
      "id" : "f158",
      "type" : "Script",
      "name" : "Test 500",
      "config" : {
        "output" : {
          "code" : [
            "import ch.ivyteam.ivy.bpm.error.BpmError;",
            "BpmError.create(\"frame:unsupported:url\").withMessage(\"only relative urls are supported (security reasons)\").throwError();"
          ]
        },
        "sudo" : true
      },
      "visual" : {
        "at" : { "x" : 208, "y" : 1536 }
      },
      "connect" : [
        { "id" : "f155", "to" : "f118" }
      ]
    }, {
      "id" : "f160",
      "type" : "RequestStart",
      "name" : "createUserTaskWidgetFilters.ivp",
      "config" : {
        "signature" : "createUserTaskWidgetFilters"
      },
      "visual" : {
        "at" : { "x" : 672, "y" : 1408 },
        "labelOffset" : { "x" : -5, "y" : 44 }
      },
      "connect" : [
        { "id" : "f163", "to" : "f161" }
      ]
    }, {
      "id" : "f161",
      "type" : "Script",
      "name" : "Dummy widget filter",
      "config" : {
        "output" : {
          "code" : [
            "import ch.ivy.addon.portalkit.dto.dashboard.WidgetFilterModel;",
            "import ch.ivy.addon.portalkit.dto.dashboard.TaskDashboardWidget;",
            "import ch.ivy.addon.portalkit.service.WidgetFilterService;",
            "",
            "for (int i = 0; i < 5; i++) {",
            "  TaskDashboardWidget widget = new TaskDashboardWidget();",
            "  widget.id = \"task_1\";",
            "  WidgetFilterModel filterModel = new WidgetFilterModel();",
            "  filterModel.widgetId = widget.id;",
            "  filterModel.widgetType = widget.getType();",
            "  filterModel.widgetName = \"Your tasks\";",
            "  filterModel.name = \"Tasks Filterset \" + i;",
            "  WidgetFilterService.getInstance().save(filterModel);",
            "}"
          ]
        }
      },
      "visual" : {
        "at" : { "x" : 784, "y" : 1408 }
      },
      "connect" : [
        { "id" : "f164", "to" : "f162" }
      ]
    }, {
      "id" : "f162",
      "type" : "TaskEnd",
      "visual" : {
        "at" : { "x" : 896, "y" : 1408 }
      }
    }, {
      "id" : "f165",
      "type" : "RequestStart",
      "name" : "createJSonFile.ivp",
      "config" : {
        "signature" : "createJSonFile",
        "input" : {
          "params" : [
            { "name" : "filePath", "type" : "String", "desc" : "" },
            { "name" : "key", "type" : "String", "desc" : "" }
          ],
          "map" : {
            "out.jsonFilePath" : "param.filePath",
            "out.jsonKey" : "param.key"
          }
        },
        "request" : {
          "isVisibleOnStartList" : false
        }
      },
      "visual" : {
        "at" : { "x" : 64, "y" : 1664 },
        "labelOffset" : { "x" : 37, "y" : 37 }
      },
      "connect" : [
        { "id" : "f169", "to" : "f168" }
      ]
    }, {
      "id" : "f168",
      "type" : "Script",
      "name" : "Update Json variable",
      "config" : {
        "output" : {
          "code" : [
            "import java.io.InputStream;",
            "import java.io.FileInputStream;",
            "import java.nio.charset.StandardCharsets;",
            "import ch.ivy.addon.portalkit.enums.PortalVariable;",
            "",
            "InputStream inputstream = new FileInputStream(in.jsonFilePath);",
            "String config = new String(inputstream.readAllBytes(), StandardCharsets.UTF_8);",
            "ivy.var.set(in.jsonKey, config);"
          ]
        },
        "sudo" : true
      },
      "visual" : {
        "at" : { "x" : 216, "y" : 1664 },
        "size" : { "width" : 128 }
      },
      "connect" : [
        { "id" : "f167", "to" : "f166" }
      ]
    }, {
      "id" : "f166",
      "type" : "TaskEnd",
      "visual" : {
        "at" : { "x" : 384, "y" : 1664 }
      }
    }, {
      "id" : "f170",
      "type" : "RequestStart",
      "name" : "create5kRoles.ivp",
      "config" : {
        "signature" : "create5kRoles",
        "request" : {
          "name" : "Create 5000 roles",
          "description" : "Create 5000 roles to test IVYPORTAL-13607"
        }
      },
      "visual" : {
        "at" : { "x" : 576, "y" : 1632 },
        "labelOffset" : { "x" : 36, "y" : 37 }
      },
      "connect" : [
        { "id" : "f173", "to" : "f172" }
      ]
    }, {
      "id" : "f171",
      "type" : "TaskEnd",
      "visual" : {
        "at" : { "x" : 904, "y" : 1632 }
      }
    }, {
      "id" : "f172",
      "type" : "Script",
      "name" : "create 5k roles",
      "config" : {
        "output" : {
          "code" : [
            "import ch.ivyteam.ivy.security.IRole;",
            "import ch.ivyteam.ivy.security.role.NewRole;",
            "",
            "// CLEAN UP\",",
            "ivy.security.roles().delete(\"SERVICE_INTEGRATION_TEAM\");",
            "ivy.security.roles().delete(\"PROJECT_EDITOR\");",
            "           ",
            "for (int i = 0; i < 5000; i ++){",
            "  ivy.security.roles().delete(\"PROJECT_EDITOR_\" + i);",
            "}",
            "",
            "// CREATE",
            "NewRole serviceIntegrationTeamNewRole = NewRole",
            ".create(\"SERVICE_INTEGRATION_TEAM\")",
            ".displayName(\"Service Integration Team\")",
            ".description(\"Service Integration Team\")",
            ".toNewRole();",
            "",
            "IRole serviceIntegrationTeam = ivy.security.roles().create(serviceIntegrationTeamNewRole);",
            "",
            "NewRole projectEditorNewRole = NewRole",
            ".create(\"PROJECT_EDITOR\")",
            ".displayName(\"Project Editor\")",
            ".description(\"Project Editor\")",
            ".toNewRole();",
            "",
            "IRole projectEditor = ivy.security.roles().create(projectEditorNewRole);",
            "for (int i = 0; i < 5000; i ++){",
            "  IRole role = ivy.security.roles().create(\"PROJECT_EDITOR_\" + i);",
            "  projectEditor.addRoleMember(role);",
            "  role.addRoleMember(serviceIntegrationTeam);",
            "}",
            "",
            "ivy.session.getSessionUser().addRole(serviceIntegrationTeam);"
          ]
        },
        "sudo" : true
      },
      "visual" : {
        "at" : { "x" : 744, "y" : 1632 }
      },
      "connect" : [
        { "id" : "f174", "to" : "f171" }
      ]
    }, {
      "id" : "f175",
      "type" : "RequestStart",
      "name" : "testProcessViewerPermission.ivp",
      "config" : {
        "signature" : "testProcessViewerPermission"
      },
      "visual" : {
        "at" : { "x" : 64, "y" : 1792 }
      },
      "connect" : [
        { "id" : "f178", "to" : "f177" }
      ]
    }, {
      "id" : "f176",
      "type" : "TaskEnd",
      "visual" : {
        "at" : { "x" : 384, "y" : 1792 }
      }
    }, {
      "id" : "f177",
      "type" : "DialogCall",
      "name" : "ProcessViewer",
      "config" : {
        "dialog" : "ch.ivy.addon.portal.generic.ProcessViewer:start(Long,Long,String)",
        "call" : {
          "map" : { },
          "code" : [
            "import com.axonivy.portal.components.publicapi.ProcessStartAPI;",
            "param.processId = ProcessStartAPI.findRelativeUrlByProcessStartFriendlyRequestPath(\"Start Processes/ProcessViewerPermission/startWithPermission.ivp\");"
          ]
        }
      },
      "visual" : {
        "at" : { "x" : 216, "y" : 1792 }
      },
      "connect" : [
        { "id" : "f179", "to" : "f176" }
      ]
    }, {
      "id" : "f180",
      "type" : "RequestStart",
      "name" : "createSampleNewsFeed.ivp",
      "config" : {
        "signature" : "createSampleNewsFeed"
      },
      "visual" : {
        "at" : { "x" : 64, "y" : 1896 }
      },
      "connect" : [
        { "id" : "f184", "to" : "f183" }
      ]
    }, {
      "id" : "f181",
      "type" : "TaskEnd",
      "visual" : {
        "at" : { "x" : 384, "y" : 1896 }
      }
    }, {
      "id" : "f183",
      "type" : "Script",
      "name" : "Dummy data",
      "config" : {
        "output" : {
          "code" : [
            "import ch.ivy.addon.portalkit.test.util.DashboardCreationUtils;",
            "DashboardCreationUtils.createDummyDataForNewsFeed();"
          ]
        },
        "sudo" : true
      },
      "visual" : {
        "at" : { "x" : 216, "y" : 1896 }
      },
      "connect" : [
        { "id" : "f182", "to" : "f181" }
      ]
    }, {
      "id" : "f140",
      "type" : "RequestStart",
      "name" : "createSampleProcesses",
      "config" : {
        "signature" : "createSampleProcesses"
      },
      "visual" : {
        "at" : { "x" : 56, "y" : 2000 }
      },
      "connect" : [
        { "id" : "f142", "to" : "f141" }
      ]
    }, {
      "id" : "f141",
      "type" : "Script",
      "config" : {
        "output" : {
          "code" : [
            "import ch.ivy.addon.portalkit.service.ExternalLinkService;",
            "import ch.ivyteam.ivy.security.ISecurityContext;",
            "import ch.ivy.addon.portalkit.configuration.ExternalLink;",
            "",
            "ExternalLink externalLink = new ExternalLink();",
            "externalLink.name = \"A sample for External link to Google\";",
            "externalLink.securityMemberId = ISecurityContext.current().users().find(\"demo\").getSecurityMemberId();",
            "externalLink.setIsPublic(true);",
            "externalLink.link = \"google.com\";",
            "ExternalLinkService externalLinkService = ExternalLinkService.getInstance();",
            "externalLinkService.save(externalLink);\""
          ]
        }
      },
      "visual" : {
        "at" : { "x" : 216, "y" : 2000 }
      },
      "connect" : [
        { "id" : "f144", "to" : "f143" }
      ]
    }, {
      "id" : "f143",
      "type" : "TaskEnd",
      "visual" : {
        "at" : { "x" : 384, "y" : 2000 }
      }
    }, {
      "id" : "f185",
      "type" : "RequestStart",
      "name" : "create5kUsersHas100Roles.ivp",
      "config" : {
        "signature" : "create5kUsersHas500Roles",
        "request" : {
          "name" : "Create 5k users has 100 roles",
          "description" : "Create 5k users has 100 roles to test IVYPORTAL-13607"
        }
      },
      "visual" : {
        "at" : { "x" : 568, "y" : 1832 },
        "labelOffset" : { "x" : 36, "y" : 37 }
      },
      "connect" : [
        { "id" : "f188", "to" : "f190" }
      ]
    }, {
      "id" : "f186",
      "type" : "Script",
      "name" : "Create 100 roles",
      "config" : {
        "output" : {
          "code" : [
            "import ch.ivyteam.ivy.persistence.query.IPagedResult;",
            "import ch.ivyteam.ivy.security.IUser;",
            "import ch.ivyteam.ivy.security.IRole;",
            "import ch.ivyteam.ivy.security.role.NewRole;",
            "import ch.ivyteam.ivy.security.user.NewUser;",
            "import ch.ivyteam.ivy.security.ISecurityContext;",
            "import java.util.ArrayList;",
            "",
            "// CLEAN UP\",",
            "ivy.security.roles().delete(\"SERVICE_INTEGRATION_TEAM\");",
            "ivy.security.roles().delete(\"PROJECT_EDITOR\");",
            "           ",
            "for (int i = 0; i < 100; i ++){",
            "  ivy.security.roles().delete(\"PROJECT_EDITOR_\" + i);",
            "}",
            "",
            "// CREATE",
            "NewRole serviceIntegrationTeamNewRole = NewRole",
            ".create(\"SERVICE_INTEGRATION_TEAM\")",
            ".displayName(\"Service Integration Team\")",
            ".description(\"Service Integration Team\")",
            ".toNewRole();",
            "",
            "IRole serviceIntegrationTeam = ivy.security.roles().create(serviceIntegrationTeamNewRole);",
            "",
            "NewRole projectEditorNewRole = NewRole",
            ".create(\"PROJECT_EDITOR\")",
            ".displayName(\"Project Editor\")",
            ".description(\"Project Editor\")",
            ".toNewRole();",
            "",
            "IPagedResult<IUser> allUsers = ivy.security.users().paged(5000);",
            "List iRoles = new ArrayList();",
            "IRole projectEditor = ivy.security.roles().create(projectEditorNewRole);",
            "for (int i = 0; i < 100; i ++){",
            "  IRole role = ivy.security.roles().create(\"PROJECT_EDITOR_\" + i);",
            "  projectEditor.addRoleMember(role);",
            "  role.addRoleMember(serviceIntegrationTeam);",
            "  ",
            "  iRoles.add(role);  ",
            "}",
            "  ",
            "for (IUser iuser : allUsers) {",
            "  for (IRole role : iRoles) {",
            "    iuser.addRole(role);",
            "  }",
            "}",
            "",
            "ivy.session.getSessionUser().addRole(serviceIntegrationTeam);"
          ]
        },
        "sudo" : true
      },
      "visual" : {
        "at" : { "x" : 984, "y" : 1832 }
      },
      "connect" : [
        { "id" : "f189", "to" : "f187" }
      ]
    }, {
      "id" : "f187",
      "type" : "TaskEnd",
      "visual" : {
        "at" : { "x" : 1136, "y" : 1832 }
      }
    }, {
      "id" : "f190",
      "type" : "Script",
      "name" : "Create 5k users",
      "config" : {
        "output" : {
          "code" : [
            "import ch.ivyteam.ivy.security.ISecurityContext;",
            "import java.util.Locale;",
            "import ch.ivyteam.ivy.security.user.NewUser;",
            "",
            "",
            "for (int i = 0; i < 5000; i++) {",
            "  String username = \"testuser_\" + i;",
            "  ",
            "  if (ISecurityContext.current().users().find(username) != null) {",
            "    ISecurityContext.current().users().delete(username);",
            "  }",
            "  ",
            "  NewUser user = NewUser",
            "      .create(username)",
            "      .fullName(username)",
            "      .password(\"+d3m0++\")",
            "      .language(java.util.Locale.ENGLISH)",
            "      .toNewUser();",
            "  ISecurityContext.current().users().create(user);",
            "  in.counter++;",
            "}"
          ]
        }
      },
      "visual" : {
        "at" : { "x" : 744, "y" : 1832 }
      },
      "connect" : [
        { "id" : "f191", "to" : "f186", "color" : "default" }
      ]
    }, {
      "id" : "f145",
      "type" : "RequestStart",
      "name" : "createABusinessCaseHasLotsOfTasksCases",
      "config" : {
        "signature" : "createBusinessCaseHasLotsOfTasksCases",
        "request" : {
          "name" : "Create a business case has lots of tasks cases"
        },
        "task" : {
          "name" : "First task of the case"
        },
        "case" : {
          "name" : "Business case has lots of tasks cases"
        }
      },
      "visual" : {
        "at" : { "x" : 64, "y" : 2144 },
        "labelOffset" : { "x" : 17, "y" : 49 }
      },
      "connect" : [
        { "id" : "f147", "to" : "f146" }
      ]
    }, {
      "id" : "f146",
      "type" : "Script",
      "name" : "Init",
      "config" : {
        "output" : {
          "code" : "in.counter = 0;"
        }
      },
      "visual" : {
        "at" : { "x" : 216, "y" : 2144 }
      },
      "connect" : [
        { "id" : "f216", "to" : "f217" }
      ]
    }, {
      "id" : "f148",
      "type" : "RequestStart",
      "name" : "createACaseHasLotsOfTasks",
      "config" : {
        "signature" : "createCaseHasLotsOfTasks",
        "request" : {
          "isHttpRequestable" : false
        },
        "triggerable" : true,
        "task" : {
          "name" : "First task of the case",
          "responsible" : {
            "activator" : "SYSTEM"
          }
        },
        "case" : {
          "name" : "Technical case"
        }
      },
      "visual" : {
        "at" : { "x" : 64, "y" : 2352 }
      },
      "connect" : [
        { "id" : "f192", "to" : "f149" }
      ]
    }, {
      "id" : "f149",
      "type" : "Script",
      "name" : "Init",
      "config" : {
        "output" : {
          "code" : "in.persistedCounter = 0;"
        }
      },
      "visual" : {
        "at" : { "x" : 216, "y" : 2352 }
      },
      "connect" : [
        { "id" : "f194", "to" : "f224" }
      ]
    }, {
      "id" : "f193",
      "type" : "TaskSwitchGateway",
      "config" : {
        "tasks" : [ {
            "id" : "TaskA",
            "name" : "<%= \"Task A \" + in1.persistedCounter + \" of case \" + ivy.case.getId() %>"
          }, {
            "id" : "TaskB",
            "name" : "<%= \"Task B \" + in1.persistedCounter + \" of case \" + ivy.case.getId() %>"
          }, {
            "id" : "TaskC",
            "name" : "<%= \"Task C \" + in1.persistedCounter + \" of case \" + ivy.case.getId() %>"
          }, {
            "id" : "TaskD",
            "name" : "<%= \"Task D \" + in1.persistedCounter + \" of case \" + ivy.case.getId() %>"
          }, {
            "id" : "TaskE",
            "name" : "<%= \"Task E \" + in1.persistedCounter + \" of case \" + ivy.case.getId() %>"
          }, {
            "id" : "TaskF",
            "name" : "<%= \"Task F \" + in1.persistedCounter + \" of case \" + ivy.case.getId() %>"
          }, {
            "id" : "TaskG",
            "name" : "<%= \"Task G \" + in1.persistedCounter + \" of case \" + ivy.case.getId() %>"
          }, {
            "id" : "TaskH",
            "name" : "<%= \"Task H \" + in1.persistedCounter + \" of case \" + ivy.case.getId() %>"
          }, {
            "id" : "TaskI",
            "name" : "<%= \"Task I \" + in1.persistedCounter + \" of case \" + ivy.case.getId() %>"
          }, {
            "id" : "TaskJ",
            "name" : "<%= \"Task J \" + in1.persistedCounter + \" of case \" + ivy.case.getId() %>",
            "responsible" : {
              "activator" : "SYSTEM"
            }
          } ]
      },
      "visual" : {
        "at" : { "x" : 480, "y" : 2352 },
        "labelOffset" : { "x" : 14, "y" : 34 }
      },
      "connect" : [
        { "id" : "f196", "to" : "f195", "condition" : "ivp==\"TaskA.ivp\"" },
        { "id" : "f198", "to" : "f197", "condition" : "ivp==\"TaskB.ivp\"" },
        { "id" : "f207", "to" : "f199", "condition" : "ivp==\"TaskC.ivp\"" },
        { "id" : "f208", "to" : "f200", "condition" : "ivp==\"TaskD.ivp\"" },
        { "id" : "f209", "to" : "f205", "condition" : "ivp==\"TaskE.ivp\"" },
        { "id" : "f210", "to" : "f206", "condition" : "ivp==\"TaskF.ivp\"" },
        { "id" : "f211", "to" : "f201", "condition" : "ivp==\"TaskG.ivp\"" },
        { "id" : "f212", "to" : "f202", "condition" : "ivp==\"TaskH.ivp\"" },
        { "id" : "f213", "to" : "f227", "condition" : "ivp==\"TaskI.ivp\"" },
        { "id" : "f228", "to" : "f204", "via" : [ { "x" : 480, "y" : 2272 } ], "condition" : "ivp==\"TaskJ.ivp\"" }
      ]
    }, {
      "id" : "f195",
      "type" : "TaskEnd",
      "visual" : {
        "at" : { "x" : 608, "y" : 2352 },
        "labelOffset" : { "x" : 13, "y" : 33 }
      }
    }, {
      "id" : "f197",
      "type" : "TaskEnd",
      "visual" : {
        "at" : { "x" : 608, "y" : 2384 },
        "labelOffset" : { "x" : 13, "y" : 33 }
      }
    }, {
      "id" : "f199",
      "type" : "TaskEnd",
      "visual" : {
        "at" : { "x" : 608, "y" : 2416 },
        "labelOffset" : { "x" : 13, "y" : 33 }
      }
    }, {
      "id" : "f200",
      "type" : "TaskEnd",
      "visual" : {
        "at" : { "x" : 608, "y" : 2448 },
        "labelOffset" : { "x" : 13, "y" : 33 }
      }
    }, {
      "id" : "f201",
      "type" : "TaskEnd",
      "visual" : {
        "at" : { "x" : 544, "y" : 2480 },
        "labelOffset" : { "x" : 13, "y" : 33 }
      }
    }, {
      "id" : "f202",
      "type" : "TaskEnd",
      "visual" : {
        "at" : { "x" : 512, "y" : 2480 },
        "labelOffset" : { "x" : 13, "y" : 33 }
      }
    }, {
      "id" : "f205",
      "type" : "TaskEnd",
      "visual" : {
        "at" : { "x" : 608, "y" : 2480 },
        "labelOffset" : { "x" : 13, "y" : 33 }
      }
    }, {
      "id" : "f206",
      "type" : "TaskEnd",
      "visual" : {
        "at" : { "x" : 576, "y" : 2480 },
        "labelOffset" : { "x" : 13, "y" : 33 }
      }
    }, {
      "id" : "f215",
      "type" : "TriggerCall",
      "name" : "Create a case has lots of tasks",
      "config" : {
        "processCall" : "Start Processes/DataCreation:createCaseHasLotsOfTasks()"
      },
      "visual" : {
        "at" : { "x" : 576, "y" : 2144 }
      },
      "connect" : [
        { "id" : "f219", "to" : "f222" }
      ]
    }, {
      "id" : "f217",
      "type" : "Alternative",
      "name" : "counter < 50",
      "config" : {
        "conditions" : {
          "f218" : "in.counter < 50"
        }
      },
      "visual" : {
        "at" : { "x" : 384, "y" : 2144 },
        "labelOffset" : { "x" : -24, "y" : -8 }
      },
      "connect" : [
        { "id" : "f218", "to" : "f215", "label" : {
            "name" : "Yes"
          }, "color" : "default" },
        { "id" : "f221", "to" : "f220", "label" : {
            "name" : "No"
          } }
      ]
    }, {
      "id" : "f220",
      "type" : "TaskEnd",
      "visual" : {
        "at" : { "x" : 384, "y" : 2208 }
      }
    }, {
      "id" : "f222",
      "type" : "Script",
      "name" : "Increase counter",
      "config" : {
        "output" : {
          "code" : [
            "import java.lang.Thread;",
            "in.counter++;",
            "Thread.sleep(1000);",
            "ivy.log.warn(\"Increased counter {0} of business case {1}\", in.counter, ivy.case.getId());"
          ]
        }
      },
      "visual" : {
        "at" : { "x" : 576, "y" : 2064 }
      },
      "connect" : [
        { "id" : "f223", "to" : "f217", "via" : [ { "x" : 384, "y" : 2064 } ] }
      ]
    }, {
      "id" : "f204",
      "type" : "Script",
      "name" : "Increase counter",
      "config" : {
        "output" : {
          "code" : [
            "import java.lang.Thread;",
            "in.persistedCounter++;",
            "Thread.sleep(100);",
            "ivy.log.warn(\"Increased counter {0} of case {1}\", in.persistedCounter, ivy.case.getId());"
          ]
        }
      },
      "visual" : {
        "at" : { "x" : 384, "y" : 2272 }
      },
      "connect" : [
        { "id" : "f203", "to" : "f224" }
      ]
    }, {
      "id" : "f224",
      "type" : "Alternative",
      "name" : "counter < 10",
      "config" : {
        "conditions" : {
          "f225" : "in.persistedCounter < 10"
        }
      },
      "visual" : {
        "at" : { "x" : 384, "y" : 2352 },
        "labelOffset" : { "x" : -24, "y" : -8 }
      },
      "connect" : [
        { "id" : "f225", "to" : "f193", "label" : {
            "name" : "Yes"
          }, "color" : "default", "var" : "in1" },
        { "id" : "f226", "to" : "f214", "label" : {
            "name" : "No"
          } }
      ]
    }, {
      "id" : "f214",
      "type" : "TaskEnd",
      "visual" : {
        "at" : { "x" : 384, "y" : 2480 }
      }
    }, {
      "id" : "f227",
      "type" : "TaskEnd",
      "visual" : {
        "at" : { "x" : 480, "y" : 2480 },
        "labelOffset" : { "x" : 13, "y" : 33 }
      }
    }, {
      "id" : "f229",
      "type" : "RequestStart",
      "name" : "displayCustomFieldBusinessCaseOnTaskWidget.ivp",
      "config" : {
        "signature" : "displayCustomFieldCaseOnTaskWidget",
        "request" : {
          "name" : "Display Custom Business Case Field on Task Widget"
        }
      },
      "visual" : {
        "at" : { "x" : 64, "y" : 2560 }
      },
      "connect" : [
        { "id" : "f231", "to" : "f230" }
      ]
    }, {
      "id" : "f230",
      "type" : "Script",
      "name" : "Set custom case field",
      "config" : {
        "output" : {
          "code" : "ivy.case.customFields().stringField(\"CustomerName\").set(\"AxonIvy\");"
        },
        "sudo" : true
      },
      "visual" : {
        "at" : { "x" : 248, "y" : 2560 }
      },
      "connect" : [
        { "id" : "f233", "to" : "f232" }
      ]
    }, {
      "id" : "f232",
      "type" : "TriggerCall",
      "name" : "Start Processes/DataCreation",
      "config" : {
        "processCall" : "Start Processes/DataCreation:subCustomCaseField()"
      },
      "visual" : {
        "at" : { "x" : 408, "y" : 2560 }
      },
      "connect" : [
        { "id" : "f237", "to" : "f236" }
      ]
    }, {
      "id" : "f234",
      "type" : "RequestStart",
      "name" : "subCustomCaseField.ivp",
      "config" : {
        "signature" : "subCustomCaseField",
        "request" : {
          "name" : "Sub Custom Case Field"
        },
        "triggerable" : true,
        "task" : {
          "responsible" : {
            "activator" : "SYSTEM"
          }
        },
        "case" : {
          "name" : "Sub Custom Case Field"
        }
      },
      "visual" : {
        "at" : { "x" : 64, "y" : 2704 }
      },
      "connect" : [
        { "id" : "f238", "to" : "f235" }
      ]
    }, {
      "id" : "f235",
      "type" : "TaskSwitchEvent",
      "config" : {
        "task" : {
          "name" : "Task is from subCase",
          "description" : "Test Case CustomField from business case is displayed (Add CustomerName customfield column to test)"
        }
      },
      "visual" : {
        "at" : { "x" : 544, "y" : 2704 },
        "labelOffset" : { "x" : 14, "y" : 34 }
      },
      "connect" : [
        { "id" : "f241", "to" : "f240" }
      ]
    }, {
      "id" : "f236",
      "type" : "TaskSwitchEvent",
      "config" : {
        "task" : {
          "name" : "Task is from main Case",
          "description" : "Test Case CustomField from business case is displayed (Add CustomerName customfield column to test)"
        }
      },
      "visual" : {
        "at" : { "x" : 544, "y" : 2560 },
        "labelOffset" : { "x" : 14, "y" : 34 }
      },
      "connect" : [
        { "id" : "f242", "to" : "f239" }
      ]
    }, {
      "id" : "f239",
      "type" : "TaskEnd",
      "visual" : {
        "at" : { "x" : 656, "y" : 2560 },
        "labelOffset" : { "x" : 13, "y" : 33 }
      }
    }, {
      "id" : "f240",
      "type" : "TaskEnd",
      "visual" : {
        "at" : { "x" : 656, "y" : 2704 },
        "labelOffset" : { "x" : 13, "y" : 33 }
      }
    } ]
}