[Ivy]
17727FBAA8BC2EDF 9.4.0 #module
>Proto >Proto Collection #zClass
Cs0 CaseItemRelatedTasksProcess Big #zClass
Cs0 RD #cInfo
Cs0 #process
Cs0 @TextInP .type .type #zField
Cs0 @TextInP .processKind .processKind #zField
Cs0 @AnnotationInP-0n ai ai #zField
Cs0 @MessageFlowInP-0n messageIn messageIn #zField
Cs0 @MessageFlowOutP-0n messageOut messageOut #zField
Cs0 @TextInP .xml .xml #zField
Cs0 @TextInP .responsibility .responsibility #zField
Cs0 @UdInit f0 '' #zField
Cs0 @UdProcessEnd f1 '' #zField
Cs0 @UdMethod f6 '' #zField
Cs0 @UdProcessEnd f7 '' #zField
Cs0 @GridStep f14 '' #zField
Cs0 @GridStep f33 '' #zField
Cs0 @GridStep f31 '' #zField
Cs0 @PushWFArc f36 '' #zField
Cs0 @UdMethod f45 '' #zField
Cs0 @PushWFArc f47 '' #zField
Cs0 @PushWFArc f8 '' #zField
Cs0 @PushWFArc f9 '' #zField
Cs0 @GridStep f4 '' #zField
Cs0 @PushWFArc f51 '' #zField
Cs0 @UdMethod f43 '' #zField
Cs0 @UdMethod f97 '' #zField
Cs0 @UdProcessEnd f46 '' #zField
Cs0 @GridStep f66 '' #zField
Cs0 @GridStep f80 '' #zField
Cs0 @Alternative f99 '' #zField
Cs0 @GridStep f2 '' #zField
Cs0 @UdMethod f5 '' #zField
Cs0 @Alternative f77 '' #zField
Cs0 @UdProcessEnd f68 '' #zField
Cs0 @UdProcessEnd f98 '' #zField
Cs0 @GridStep f49 '' #zField
Cs0 @Alternative f79 '' #zField
Cs0 @PushWFArc f81 '' #zField
Cs0 @PushWFArc f11 '' #zField
Cs0 @PushWFArc f87 '' #zField
Cs0 @PushWFArc f101 '' #zField
Cs0 @PushWFArc f60 '' #zField
Cs0 @PushWFArc f92 '' #zField
Cs0 @PushWFArc f100 '' #zField
Cs0 @PushWFArc f10 '' #zField
Cs0 @PushWFArc f67 '' #zField
Cs0 @PushWFArc f71 '' #zField
Cs0 @PushWFArc f58 '' #zField
Cs0 @UdProcessEnd f15 '' #zField
Cs0 @GridStep f16 '' #zField
Cs0 @GridStep f62 '' #zField
Cs0 @UdMethod f61 '' #zField
Cs0 @PushWFArc f17 '' #zField
Cs0 @PushWFArc f85 '' #zField
Cs0 @PushWFArc f84 '' #zField
Cs0 @UdMethod f24 '' #zField
Cs0 @UdProcessEnd f25 '' #zField
Cs0 @GridStep f27 '' #zField
Cs0 @PushWFArc f28 '' #zField
Cs0 @PushWFArc f26 '' #zField
Cs0 @UdProcessEnd f44 '' #zField
Cs0 @UdProcessEnd f53 '' #zField
Cs0 @CallSub f30 '' #zField
Cs0 @UdMethod f32 '' #zField
Cs0 @CallSub f34 '' #zField
Cs0 @UdMethod f35 '' #zField
Cs0 @PushWFArc f52 '' #zField
Cs0 @PushWFArc f37 '' #zField
Cs0 @PushWFArc f38 '' #zField
Cs0 @PushWFArc f55 '' #zField
Cs0 @GridStep f76 '' #zField
Cs0 @UdMethod f18 '' #zField
Cs0 @CallSub f75 '' #zField
Cs0 @CallSub f19 '' #zField
Cs0 @GridStep f82 '' #zField
Cs0 @CallSub f20 '' #zField
Cs0 @UdProcessEnd f21 '' #zField
Cs0 @Alternative f78 '' #zField
Cs0 @PushWFArc f88 '' #zField
Cs0 @PushWFArc f86 '' #zField
Cs0 @PushWFArc f22 '' #zField
Cs0 @PushWFArc f83 '' #zField
Cs0 @PushWFArc f90 '' #zField
Cs0 @PushWFArc f23 '' #zField
Cs0 @PushWFArc f89 '' #zField
Cs0 @PushWFArc f91 '' #zField
Cs0 @PushWFArc f3 '' #zField
>Proto Cs0 Cs0 CaseItemRelatedTasksProcess #zField
Cs0 f0 guid 167E9A75EF3D0909 #txt
Cs0 f0 method start() #txt
Cs0 f0 inParameterDecl '<> param;' #txt
Cs0 f0 inParameterMapAction 'out.currentPortalPage="CASE_DETAIL_FROM_TASK";
' #txt
Cs0 f0 outParameterDecl '<> result;' #txt
Cs0 f0 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>start()</name>
    </language>
</elementInfo>
' #txt
Cs0 f0 83 83 26 26 -16 15 #rect
Cs0 f1 339 83 26 26 0 12 #rect
Cs0 f6 guid 167E9A777AB171EA #txt
Cs0 f6 method initData(ch.ivyteam.ivy.workflow.ICase) #txt
Cs0 f6 inParameterDecl '<ch.ivyteam.ivy.workflow.ICase iCase> param;' #txt
Cs0 f6 inParameterMapAction 'out.iCase=param.iCase;
' #txt
Cs0 f6 outParameterDecl '<> result;' #txt
Cs0 f6 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>initData(ICase)</name>
    </language>
</elementInfo>
' #txt
Cs0 f6 83 179 26 26 -41 15 #rect
Cs0 f7 339 179 26 26 0 12 #rect
Cs0 f14 actionTable 'out=in;
' #txt
Cs0 f14 actionCode 'import ch.ivy.addon.portalkit.datamodel.internal.RelatedTaskLazyDataModel;

in.dataModel = new RelatedTaskLazyDataModel(in.iCase);
in.dataModel.initColumnsConfiguration();
' #txt
Cs0 f14 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Init data model</name>
    </language>
</elementInfo>
' #txt
Cs0 f14 168 170 112 44 -40 -8 #rect
Cs0 f33 actionTable 'out=in;
' #txt
Cs0 f33 actionCode 'import ch.ivy.addon.portalkit.util.TaskUtils;

TaskUtils.updateTaskStartedAttribute(false);' #txt
Cs0 f33 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Update TaskStartedAttribute</name>
    </language>
</elementInfo>
' #txt
Cs0 f33 168 362 160 44 -76 -8 #rect
Cs0 f31 actionTable 'out=in;
' #txt
Cs0 f31 actionCode 'import ch.ivy.addon.portal.generic.navigation.PortalNavigator;

if (in.inFrame) {
	PortalNavigator.navigateToPortalTaskDetailsInFrame(in.taskId);
} else {
	PortalNavigator.navigateToPortalTaskDetails(in.taskId);
}' #txt
Cs0 f31 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Navigate to task details</name>
    </language>
</elementInfo>
' #txt
Cs0 f31 384 360 176 48 -59 -8 #rect
Cs0 f36 328 384 384 384 #arcP
Cs0 f45 guid 1720C62D9BF92EB1 #txt
Cs0 f45 method navigateToSelectedTaskDetails(Long,Boolean,Boolean) #txt
Cs0 f45 inParameterDecl '<Long taskId,Boolean isWorkingOnTask,Boolean inFrame> param;' #txt
Cs0 f45 inParameterMapAction 'out.inFrame=param.inFrame;
out.isWorkingOnTask=param.isWorkingOnTask;
out.taskId=param.taskId;
' #txt
Cs0 f45 outParameterDecl '<> result;' #txt
Cs0 f45 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>navigateToSelectedTaskDetails(Long,Boolean,Boolean)</name>
    </language>
</elementInfo>
' #txt
Cs0 f45 83 371 26 26 -77 20 #rect
Cs0 f47 109 384 168 384 #arcP
Cs0 f47 0 0.5541990710792534 0 0 #arcLabel
Cs0 f8 109 192 168 192 #arcP
Cs0 f9 280 192 339 192 #arcP
Cs0 f4 actionTable 'out=in;
' #txt
Cs0 f4 actionCode 'import ch.ivy.addon.portalkit.util.PermissionUtils;
import ch.ivy.addon.portal.generic.navigation.PortalNavigator;

if (in.inFrame) {
	PortalNavigator.navigateToPortalRelatedTasksOfCaseInFrame(in.iCase.getId(), true, PermissionUtils.getCaseName(in.iCase));
} else {
	PortalNavigator.navigateToPortalRelatedTasksOfCase(in.iCase.getId(), true, PermissionUtils.getCaseName(in.iCase));
}' #txt
Cs0 f4 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Navigate to task list</name>
    </language>
</elementInfo>
' #txt
Cs0 f4 392 266 112 44 -50 -8 #rect
Cs0 f51 109 288 392 288 #arcP
Cs0 f51 0 0.5658938645158399 0 0 #arcLabel
Cs0 f43 guid 1720C5CCA7DA3932 #txt
Cs0 f43 method navigateToRelatedTasksOfCase(Boolean,Boolean) #txt
Cs0 f43 inParameterDecl '<Boolean isWorkingOnTask,Boolean inFrame> param;' #txt
Cs0 f43 inParameterMapAction 'out.inFrame=param.inFrame;
out.isWorkingOnTask=param.isWorkingOnTask;
' #txt
Cs0 f43 outParameterDecl '<> result;' #txt
Cs0 f43 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>navigateToRelatedTasksOfCase(Boolean,Boolean)</name>
    </language>
</elementInfo>
' #txt
Cs0 f43 83 275 26 26 -78 23 #rect
Cs0 f97 guid 1774C81671A1604F #txt
Cs0 f97 method validate(ch.ivyteam.ivy.workflow.ITask,ch.ivy.addon.portalkit.datamodel.internal.RelatedTaskLazyDataModel) #txt
Cs0 f97 inParameterDecl '<ch.ivyteam.ivy.workflow.ITask task,ch.ivy.addon.portalkit.datamodel.internal.RelatedTaskLazyDataModel dataModel> param;' #txt
Cs0 f97 inParameterMapAction 'out.dataModel=param.dataModel;
out.task=param.task;
' #txt
Cs0 f97 outParameterDecl '<> result;' #txt
Cs0 f97 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>validate(ITask,RelatedTaskLazyDataModel)</name>
    </language>
</elementInfo>
' #txt
Cs0 f97 83 659 26 26 -60 16 #rect
Cs0 f46 587 467 26 26 0 12 #rect
Cs0 f66 actionTable 'out=in;
' #txt
Cs0 f66 actionCode 'import org.primefaces.PrimeFaces;
import ch.ivyteam.ivy.security.IUser;
import org.apache.commons.lang3.StringUtils;
import ch.ivyteam.ivy.workflow.TaskState;
import javax.faces.context.FacesContext;
import javax.faces.application.FacesMessage;

FacesContext facesContext = FacesContext.getCurrentInstance();

String notification;
if(in.task.getState() == TaskState.DONE){
	notification = ivy.cms.co("/ch.ivy.addon.portalkit.ui.jsf/components/taskStart/cannotStartMessages/taskDone", [in.task.getName()]);
} else {
	IUser worker = in.task.getWorkerUser();
	if (worker != null){
		String fullName = worker.getFullName();
		String workerName = StringUtils.isBlank(fullName) ? worker.getName() : worker.getFullName() + " (" + worker.getName() + ")";
		notification = ivy.cms.co("/ch.ivy.addon.portalkit.ui.jsf/components/taskStart/cannotStartMessages/isAnotherUserWorking", [in.task.name, in.task.getId(), workerName]);
	} else {
		notification = ivy.cms.co("/ch.ivy.addon.portalkit.ui.jsf/components/taskStart/cannotStartMessages/noPermission", [in.task.getName()]);
	}
}

facesContext.validationFailed();
facesContext.addMessage("portal-global-growl-message", new FacesMessage(FacesMessage.SEVERITY_INFO, notification, null));
PrimeFaces.current().ajax().update("portal-global-growl");  
' #txt
Cs0 f66 security system #txt
Cs0 f66 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Display error</name>
    </language>
</elementInfo>
' #txt
Cs0 f66 424 554 112 44 -35 -8 #rect
Cs0 f80 actionTable 'out=in;
' #txt
Cs0 f80 actionCode 'import ch.ivy.addon.portalkit.util.TaskUtils;
import ch.ivy.addon.portalkit.jsf.ManagedBeans;
import ch.ivy.addon.portalkit.bean.TaskActionBean;

TaskActionBean taskActionBean = ManagedBeans.get("taskActionBean") as TaskActionBean;
in.task = TaskUtils.findTaskById(in.task.getId());
out.canUserResumeTask = taskActionBean.canResume(in.task);' #txt
Cs0 f80 security system #txt
Cs0 f80 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Check if can resume</name>
    </language>
</elementInfo>
' #txt
Cs0 f80 160 650 128 44 -56 -8 #rect
Cs0 f99 336 560 32 32 0 16 #rect
Cs0 f2 actionTable 'out=in;
' #txt
Cs0 f2 actionCode 'import ch.ivy.addon.portalkit.util.TaskUtils;
import ch.ivy.addon.portalkit.jsf.ManagedBeans;
import ch.ivy.addon.portalkit.bean.TaskActionBean;

TaskActionBean taskActionBean = ManagedBeans.get("taskActionBean") as TaskActionBean;
in.task = TaskUtils.findTaskById(in.task.getId());
out.canUserResumeTask = taskActionBean.canResume(in.task);' #txt
Cs0 f2 security system #txt
Cs0 f2 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Check if can resume</name>
    </language>
</elementInfo>
' #txt
Cs0 f2 160 458 128 44 -56 -8 #rect
Cs0 f5 guid 1774C81671AA10A1 #txt
Cs0 f5 method openTask(ch.ivyteam.ivy.workflow.ITask,ch.ivy.addon.portalkit.datamodel.internal.RelatedTaskLazyDataModel) #txt
Cs0 f5 inParameterDecl '<ch.ivyteam.ivy.workflow.ITask task,ch.ivy.addon.portalkit.datamodel.internal.RelatedTaskLazyDataModel dataModel> param;' #txt
Cs0 f5 inParameterMapAction 'out.dataModel=param.dataModel;
out.task=param.task;
' #txt
Cs0 f5 outParameterDecl '<> result;' #txt
Cs0 f5 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>openTask(ITask,RelatedTaskLazyDataModel)</name>
    </language>
</elementInfo>
' #txt
Cs0 f5 83 467 26 26 -80 15 #rect
Cs0 f77 338 466 28 28 14 0 #rect
Cs0 f68 595 563 26 26 0 12 #rect
Cs0 f98 467 659 26 26 0 12 #rect
Cs0 f49 actionTable 'out=in;
' #txt
Cs0 f49 actionCode 'import ch.ivy.addon.portalkit.datamodel.TaskLazyDataModel;
import ch.ivy.addon.portalkit.enums.PortalPage;
import ch.ivy.addon.portalkit.enums.NavigationHistory;
import ch.ivy.addon.portalkit.dto.TaskEndInfo;
import ch.ivy.addon.portalkit.service.StickyTaskListService;
import ch.ivy.addon.portalkit.util.SecurityServiceUtils;
import javax.faces.context.FacesContext;
import ch.ivy.addon.portalkit.util.PermissionUtils;
import ch.ivy.addon.portalkit.enums.TaskAssigneeType;

TaskEndInfo taskEndInfo = new TaskEndInfo();
taskEndInfo.setDataModel(in.dataModel);
taskEndInfo.setPortalPage(PortalPage.valueOf(in.currentPortalPage));

String taskEndInfoSessionAttributeKey = StickyTaskListService.service().getTaskEndInfoSessionAttributeKey(in.task.getId());
SecurityServiceUtils.setSessionAttribute(taskEndInfoSessionAttributeKey, taskEndInfo);

// Put the "embedInIFrame" param to the task start link to open it in the DefaultFramePage process
// Then this process will open task in IFrame or not based on its "embedInIFrame" String custom field
FacesContext.getCurrentInstance().getExternalContext().redirect(in.task.getStartLinkEmbedded().getRelative());' #txt
Cs0 f49 security system #txt
Cs0 f49 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Store task end info&#13;
Start task</name>
    </language>
</elementInfo>
' #txt
Cs0 f49 416 458 128 44 -44 -16 #rect
Cs0 f79 336 656 32 32 0 16 #rect
Cs0 f81 expr out #txt
Cs0 f81 109 672 160 672 #arcP
Cs0 f11 expr in #txt
Cs0 f11 outCond in.canUserResumeTask #txt
Cs0 f11 366 480 416 480 #arcP
Cs0 f87 expr out #txt
Cs0 f87 288 672 336 672 #arcP
Cs0 f101 expr in #txt
Cs0 f101 352 656 352 592 #arcP
Cs0 f60 expr out #txt
Cs0 f60 288 480 338 480 #arcP
Cs0 f92 expr in #txt
Cs0 f92 outCond in.canUserResumeTask #txt
Cs0 f92 368 672 467 672 #arcP
Cs0 f100 expr in #txt
Cs0 f100 352 494 352 560 #arcP
Cs0 f100 0 0.6038825846613081 0 0 #arcLabel
Cs0 f10 544 480 587 480 #arcP
Cs0 f67 expr in #txt
Cs0 f67 368 576 424 576 #arcP
Cs0 f67 0 0.1527488616366867 0 0 #arcLabel
Cs0 f71 expr out #txt
Cs0 f71 536 576 595 576 #arcP
Cs0 f58 expr out #txt
Cs0 f58 109 480 160 480 #arcP
Cs0 f15 587 755 26 26 0 12 #rect
Cs0 f16 actionTable 'out=in;
' #txt
Cs0 f16 actionCode 'import ch.ivy.addon.portalkit.datamodel.TaskLazyDataModel;
import ch.ivy.addon.portalkit.enums.PortalPage;
import ch.ivy.addon.portalkit.enums.NavigationHistory;
import ch.ivy.addon.portalkit.dto.TaskEndInfo;
import ch.ivy.addon.portalkit.service.StickyTaskListService;
import ch.ivy.addon.portalkit.util.SecurityServiceUtils;
import javax.faces.context.FacesContext;
import ch.ivy.addon.portalkit.util.PermissionUtils;
import ch.ivy.addon.portalkit.enums.TaskAssigneeType;

TaskEndInfo taskEndInfo = new TaskEndInfo();
taskEndInfo.setDataModel(in.dataModel);
taskEndInfo.setPortalPage(PortalPage.valueOf(in.currentPortalPage));

String taskEndInfoSessionAttributeKey = StickyTaskListService.service().getTaskEndInfoSessionAttributeKey(in.selectedTask.getId());
SecurityServiceUtils.setSessionAttribute(taskEndInfoSessionAttributeKey, taskEndInfo);

// Put the "embedInIFrame" param to the task start link to open it in the DefaultFramePage process
// Then this process will open task in IFrame or not based on its "embedInIFrame" String custom field
FacesContext.getCurrentInstance().getExternalContext().redirect(in.selectedTask.getStartLinkEmbedded().getRelative());' #txt
Cs0 f16 security system #txt
Cs0 f16 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Store task end info&#13;
Start task</name>
    </language>
</elementInfo>
' #txt
Cs0 f16 416 746 128 44 -44 -16 #rect
Cs0 f62 actionTable 'out=in;
' #txt
Cs0 f62 actionCode 'import ch.ivy.addon.portalkit.util.TaskUtils;

TaskUtils.resetTask(in.selectedTask);
' #txt
Cs0 f62 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Reset task</name>
    </language>
</elementInfo>
' #txt
Cs0 f62 192 746 112 44 -29 -8 #rect
Cs0 f61 guid 1775BC8F03CA8B79 #txt
Cs0 f61 method resetAndOpenTask(String,Long) #txt
Cs0 f61 inParameterDecl '<String currentPortalPage,Long selectedTaskItemId> param;' #txt
Cs0 f61 inParameterMapAction 'out.currentPortalPage=param.currentPortalPage;
' #txt
Cs0 f61 inActionCode 'import ch.ivy.addon.portalkit.util.TaskUtils;

out.selectedTask = TaskUtils.findTaskUserHasPermissionToSee(param.selectedTaskItemId);
' #txt
Cs0 f61 outParameterDecl '<> result;' #txt
Cs0 f61 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>resetAndOpenTask(String,Long)</name>
    </language>
</elementInfo>
' #txt
Cs0 f61 83 755 26 26 -57 15 #rect
Cs0 f17 304 768 416 768 #arcP
Cs0 f85 expr out #txt
Cs0 f85 109 768 192 768 #arcP
Cs0 f84 544 768 587 768 #arcP
Cs0 f24 guid 1775C5F343E94620 #txt
Cs0 f24 method destroyTask(ch.ivyteam.ivy.workflow.ITask) #txt
Cs0 f24 inParameterDecl '<ch.ivyteam.ivy.workflow.ITask selectedTask> param;' #txt
Cs0 f24 inParameterMapAction 'out.task=param.selectedTask;
' #txt
Cs0 f24 outParameterDecl '<> result;' #txt
Cs0 f24 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>destroyTask(ITask)</name>
    </language>
</elementInfo>
' #txt
Cs0 f24 83 851 26 26 -25 15 #rect
Cs0 f25 355 851 26 26 0 12 #rect
Cs0 f27 actionTable 'out=in;
' #txt
Cs0 f27 actionCode 'import ch.ivy.addon.portalkit.util.TaskUtils;

Long destroyedTaskId = in.task.getId();
TaskUtils.destroyTaskById(destroyedTaskId);
in.task = TaskUtils.findTaskById(destroyedTaskId);' #txt
Cs0 f27 security system #txt
Cs0 f27 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Destroy task</name>
    </language>
</elementInfo>
' #txt
Cs0 f27 184 842 112 44 -34 -8 #rect
Cs0 f28 109 864 184 864 #arcP
Cs0 f26 296 864 355 864 #arcP
Cs0 f44 403 1139 26 26 0 12 #rect
Cs0 f53 403 1235 26 26 0 12 #rect
Cs0 f30 processCall 'Ivy Data Processes/TaskService:findTasksByCriteria(ch.ivy.addon.portalkit.ivydata.searchcriteria.TaskSearchCriteria,Integer,Integer)' #txt
Cs0 f30 requestActionDecl '<ch.ivy.addon.portalkit.ivydata.searchcriteria.TaskSearchCriteria taskSearchCriteria,Integer startIndex,Integer count> param;' #txt
Cs0 f30 requestMappingAction 'param.taskSearchCriteria=in.taskSearchCriteria;
param.startIndex=in.startIndex;
param.count=in.count;
' #txt
Cs0 f30 responseActionDecl 'ch.ivy.addon.portalkit.component.TaskWidget.TaskWidgetData out;
' #txt
Cs0 f30 responseMappingAction 'out=in;
out.tasks=result.tasks;
' #txt
Cs0 f30 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Find tasks</name>
    </language>
</elementInfo>
' #txt
Cs0 f30 200 1130 112 44 -28 -8 #rect
Cs0 f32 guid 178019346DF34FD9 #txt
Cs0 f32 method countTasks(ch.ivy.addon.portalkit.ivydata.searchcriteria.TaskSearchCriteria) #txt
Cs0 f32 inParameterDecl '<ch.ivy.addon.portalkit.ivydata.searchcriteria.TaskSearchCriteria criteria> param;' #txt
Cs0 f32 inParameterMapAction 'out.taskSearchCriteria=param.criteria;
' #txt
Cs0 f32 outParameterDecl '<Long totalTasks> result;' #txt
Cs0 f32 outParameterMapAction 'result.totalTasks=in.totalTasks;
' #txt
Cs0 f32 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>countTasks(TaskSearchCriteria)</name>
    </language>
</elementInfo>
' #txt
Cs0 f32 83 1235 26 26 -89 15 #rect
Cs0 f34 processCall 'Ivy Data Processes/TaskService:countTasksByCriteria(ch.ivy.addon.portalkit.ivydata.searchcriteria.TaskSearchCriteria)' #txt
Cs0 f34 requestActionDecl '<ch.ivy.addon.portalkit.ivydata.searchcriteria.TaskSearchCriteria taskSearchCriteria> param;' #txt
Cs0 f34 requestMappingAction 'param.taskSearchCriteria=in.taskSearchCriteria;
' #txt
Cs0 f34 responseActionDecl 'ch.ivy.addon.portalkit.component.TaskWidget.TaskWidgetData out;
' #txt
Cs0 f34 responseMappingAction 'out=in;
out.totalTasks=result.totalTasks;
' #txt
Cs0 f34 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Count tasks</name>
    </language>
</elementInfo>
' #txt
Cs0 f34 200 1226 112 44 -33 -8 #rect
Cs0 f35 guid 178019346DFD95F4 #txt
Cs0 f35 method findTasks(ch.ivy.addon.portalkit.ivydata.searchcriteria.TaskSearchCriteria,Integer,Integer) #txt
Cs0 f35 inParameterDecl '<ch.ivy.addon.portalkit.ivydata.searchcriteria.TaskSearchCriteria criteria,Integer startIndex,Integer count> param;' #txt
Cs0 f35 inParameterMapAction 'out.count=param.count;
out.startIndex=param.startIndex;
out.taskSearchCriteria=param.criteria;
' #txt
Cs0 f35 outParameterDecl '<java.util.List<ch.ivyteam.ivy.workflow.ITask> tasks> result;' #txt
Cs0 f35 outParameterMapAction 'result.tasks=in.tasks;
' #txt
Cs0 f35 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>findTasks(TaskSearchCriteria,Integer,Integer)</name>
    </language>
</elementInfo>
' #txt
Cs0 f35 83 1139 26 26 -89 18 #rect
Cs0 f52 expr out #txt
Cs0 f52 312 1152 403 1152 #arcP
Cs0 f37 expr out #txt
Cs0 f37 312 1248 403 1248 #arcP
Cs0 f38 expr out #txt
Cs0 f38 109 1152 200 1152 #arcP
Cs0 f55 expr out #txt
Cs0 f55 109 1248 200 1248 #arcP
Cs0 f76 actionTable 'out=in;
' #txt
Cs0 f76 actionCode 'import java.util.ArrayList;
in.loopCounter = 0;
in.maxResultNumberPerQuery = 100000;
in.collectedTasksForExporting = new ArrayList();' #txt
Cs0 f76 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>init data</name>
    </language>
</elementInfo>
' #txt
Cs0 f76 320 938 112 44 -21 -8 #rect
Cs0 f18 guid 178100AAF132C580 #txt
Cs0 f18 method getExportedFile(java.util.List<String>) #txt
Cs0 f18 inParameterDecl '<java.util.List<String> columnsVisibility> param;' #txt
Cs0 f18 inParameterMapAction 'out.relatedTaskColumnsVisibility=param.columnsVisibility;
' #txt
Cs0 f18 outParameterDecl '<org.primefaces.model.StreamedContent exportedFile> result;' #txt
Cs0 f18 outParameterMapAction 'result.exportedFile=in.exportedFile;
' #txt
Cs0 f18 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>getExportedFile(List&lt;String&gt;)</name>
    </language>
</elementInfo>
' #txt
Cs0 f18 83 947 26 26 -46 15 #rect
Cs0 f75 processCall 'Ivy Data Processes/TaskService:findTasksByCriteria(ch.ivy.addon.portalkit.ivydata.searchcriteria.TaskSearchCriteria,Integer,Integer)' #txt
Cs0 f75 requestActionDecl '<ch.ivy.addon.portalkit.ivydata.searchcriteria.TaskSearchCriteria taskSearchCriteria,Integer startIndex,Integer count> param;' #txt
Cs0 f75 requestMappingAction 'param.taskSearchCriteria=in.taskSearchCriteria;
param.startIndex=in.loopCounter * in.maxResultNumberPerQuery;
param.count=in.maxResultNumberPerQuery;
' #txt
Cs0 f75 responseActionDecl 'ch.ivy.addon.portalkit.component.TaskAnalysisWidget.TaskAnalysisWidgetData out;
' #txt
Cs0 f75 responseMappingAction 'out=in;
' #txt
Cs0 f75 responseActionCode in.collectedTasksForExporting.addAll(result.tasks); #txt
Cs0 f75 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>find tasks</name>
    </language>
</elementInfo>
' #txt
Cs0 f75 424 1066 112 44 -26 -8 #rect
Cs0 f19 processCall 'Ivy Data Processes/TaskService:countTasksByCriteria(ch.ivy.addon.portalkit.ivydata.searchcriteria.TaskSearchCriteria)' #txt
Cs0 f19 requestActionDecl '<ch.ivy.addon.portalkit.ivydata.searchcriteria.TaskSearchCriteria taskSearchCriteria> param;' #txt
Cs0 f19 requestMappingAction 'param.taskSearchCriteria=in.taskSearchCriteria;
' #txt
Cs0 f19 responseActionDecl 'ch.ivy.addon.portalkit.component.TaskAnalysisWidget.TaskAnalysisWidgetData out;
' #txt
Cs0 f19 responseMappingAction 'out=in;
out.totalTasks=result.totalTasks;
' #txt
Cs0 f19 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>count tasks</name>
    </language>
</elementInfo>
' #txt
Cs0 f19 176 938 112 44 -31 -8 #rect
Cs0 f82 actionTable 'out=in;
' #txt
Cs0 f82 actionCode in.loopCounter++; #txt
Cs0 f82 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>counter++</name>
    </language>
</elementInfo>
' #txt
Cs0 f82 576 1066 112 44 -27 -8 #rect
Cs0 f20 processCall 'Functional Processes/ExportTaskToExcel:exportToExcel(java.util.List<ch.ivyteam.ivy.workflow.ITask>,java.util.List<String>)' #txt
Cs0 f20 requestActionDecl '<java.util.List<ch.ivyteam.ivy.workflow.ITask> collectedTasksForExporting,java.util.List<String> columnsVisibility> param;' #txt
Cs0 f20 requestMappingAction 'param.collectedTasksForExporting=in.collectedTasksForExporting;
param.columnsVisibility=in.relatedTaskColumnsVisibility;
' #txt
Cs0 f20 responseMappingAction 'out=in;
out.exportedFile=result.exportedFile;
' #txt
Cs0 f20 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>export to excel</name>
    </language>
</elementInfo>
' #txt
Cs0 f20 616 938 112 44 -38 -8 #rect
Cs0 f21 851 947 26 26 0 12 #rect
Cs0 f78 464 944 32 32 0 16 #rect
Cs0 f88 728 960 851 960 #arcP
Cs0 f86 496 960 616 960 #arcP
Cs0 f22 432 960 464 960 #arcP
Cs0 f83 288 960 320 960 #arcP
Cs0 f90 expr out #txt
Cs0 f90 536 1088 576 1088 #arcP
Cs0 f23 expr out #txt
Cs0 f23 109 960 176 960 #arcP
Cs0 f89 expr in #txt
Cs0 f89 outCond 'in.loopCounter <= in.totalTasks / in.maxResultNumberPerQuery' #txt
Cs0 f89 480 976 480 1066 #arcP
Cs0 f91 632 1066 489 967 #arcP
Cs0 f3 109 96 339 96 #arcP
>Proto Cs0 .type ch.ivy.addon.portalkit.component.CaseItemRelatedTasks.CaseItemRelatedTasksData #txt
>Proto Cs0 .processKind HTML_DIALOG #txt
>Proto Cs0 -8 -8 16 16 16 26 #rect
Cs0 f33 mainOut f36 tail #connect
Cs0 f36 head f31 mainIn #connect
Cs0 f45 mainOut f47 tail #connect
Cs0 f47 head f33 mainIn #connect
Cs0 f43 mainOut f51 tail #connect
Cs0 f51 head f4 mainIn #connect
Cs0 f6 mainOut f8 tail #connect
Cs0 f8 head f14 mainIn #connect
Cs0 f14 mainOut f9 tail #connect
Cs0 f9 head f7 mainIn #connect
Cs0 f5 mainOut f58 tail #connect
Cs0 f58 head f2 mainIn #connect
Cs0 f2 mainOut f60 tail #connect
Cs0 f60 head f77 in #connect
Cs0 f66 mainOut f71 tail #connect
Cs0 f71 head f68 mainIn #connect
Cs0 f97 mainOut f81 tail #connect
Cs0 f81 head f80 mainIn #connect
Cs0 f80 mainOut f87 tail #connect
Cs0 f87 head f79 in #connect
Cs0 f79 out f92 tail #connect
Cs0 f92 head f98 mainIn #connect
Cs0 f100 head f99 in #connect
Cs0 f99 out f67 tail #connect
Cs0 f67 head f66 mainIn #connect
Cs0 f79 out f101 tail #connect
Cs0 f101 head f99 in #connect
Cs0 f49 mainOut f10 tail #connect
Cs0 f10 head f46 mainIn #connect
Cs0 f77 out f11 tail #connect
Cs0 f11 head f49 mainIn #connect
Cs0 f77 out f100 tail #connect
Cs0 f61 mainOut f85 tail #connect
Cs0 f85 head f62 mainIn #connect
Cs0 f16 mainOut f84 tail #connect
Cs0 f84 head f15 mainIn #connect
Cs0 f62 mainOut f17 tail #connect
Cs0 f17 head f16 mainIn #connect
Cs0 f24 mainOut f28 tail #connect
Cs0 f28 head f27 mainIn #connect
Cs0 f27 mainOut f26 tail #connect
Cs0 f26 head f25 mainIn #connect
Cs0 f35 mainOut f38 tail #connect
Cs0 f38 head f30 mainIn #connect
Cs0 f30 mainOut f52 tail #connect
Cs0 f52 head f44 mainIn #connect
Cs0 f32 mainOut f55 tail #connect
Cs0 f55 head f34 mainIn #connect
Cs0 f34 mainOut f37 tail #connect
Cs0 f37 head f53 mainIn #connect
Cs0 f19 mainOut f83 tail #connect
Cs0 f83 head f76 mainIn #connect
Cs0 f76 mainOut f22 tail #connect
Cs0 f22 head f78 in #connect
Cs0 f89 head f75 mainIn #connect
Cs0 f75 mainOut f90 tail #connect
Cs0 f90 head f82 mainIn #connect
Cs0 f82 mainOut f91 tail #connect
Cs0 f91 head f78 in #connect
Cs0 f18 mainOut f23 tail #connect
Cs0 f23 head f19 mainIn #connect
Cs0 f78 out f89 tail #connect
Cs0 f78 out f86 tail #connect
Cs0 f86 head f20 mainIn #connect
Cs0 f20 mainOut f88 tail #connect
Cs0 f88 head f21 mainIn #connect
Cs0 f0 mainOut f3 tail #connect
Cs0 f3 head f1 mainIn #connect
