<html xmlns="http://www.w3.org/1999/xhtml" xmlns:f="http://xmlns.jcp.org/jsf/core"
  xmlns:h="http://xmlns.jcp.org/jsf/html" xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
  xmlns:cc="http://xmlns.jcp.org/jsf/composite" xmlns:ic="http://ivyteam.ch/jsf/component"
  xmlns:p="http://primefaces.org/ui" xmlns:pe="http://primefaces.org/ui/extensions"
  >

<cc:interface componentType="IvyComponent">
  <cc:attribute name="roleNames" />
  <cc:attribute name="componentId" default="user-selection" />
  <cc:attribute name="selectedUser" type="ch.ivy.addon.portalkit.dto.UserDTO" required="true" />
  <cc:attribute name="requiredMessage" default="Value is required." />
  <cc:attribute name="forceSelection" default="true" />
  <cc:attribute name="minQueryLength" default="1" />
  <cc:attribute name="isDisabled" />
  <cc:attribute name="isRequired" />
  <cc:attribute name="isReadOnly" />
  <cc:attribute name="isRenderedAutoComplete" default="true" />
  <cc:attribute name="isRenderedMessage" default="true" />
  <cc:attribute name="isRenderedLabel" default="true" />
  <cc:attribute name="hightlight" default="true" />
  <cc:attribute name="floatingLabel" />
  <cc:attribute name="autoCompleteStyleClass" />
  <cc:attribute name="autoCompletePanelStyleClass" />
  <cc:attribute name="labelPanelStyleClass" />
  <cc:attribute name="labelStyleClass" />
  <cc:attribute name="label" />
  <cc:attribute name="messageStyleClass" />
  <cc:attribute name="formatToDisplay" default="#{user.getDisplayName()}"/>
  <cc:attribute name="moreText" default="#{ivy.cms.co('/ch.ivy.addon.portalkit.ui.jsf/common/more')}..."/>
  <cc:attribute name="queryDelay" default="300"/>
  <cc:attribute name="maxResults" default="100" />
  <cc:attribute name="scrollHeight" default="400"/>
</cc:interface>

<cc:implementation>
  <f:event listener="#{logic.initUsers}" type="preRenderComponent" />
  <h:panelGroup id="#{cc.attrs.componentId}-label-panel" layout="block" rendered="#{cc.attrs.isRenderedLabel and !cc.attrs.floatingLabel}"
    styleClass="#{cc.attrs.labelPanelStyleClass}">
    <p:outputLabel id="#{cc.attrs.componentId}-label" value="#{cc.attrs.label}" for="#{cc.attrs.componentId}"
      styleClass="#{cc.attrs.labelStyleClass}" />
  </h:panelGroup>

  <h:panelGroup id="#{cc.attrs.componentId}-autocomplete-panel" layout="block"
    rendered="#{cc.attrs.isRenderedAutoComplete}" styleClass="#{cc.attrs.autoCompletePanelStyleClass} md-inputfield">
    <p:autoComplete id="#{cc.attrs.componentId}" value="#{cc.attrs.selectedUser}" scrollHeight="#{cc.attrs.scrollHeight}"
      completeMethod="#{logic.completeUser}" required="#{cc.attrs.isRequired}" var="user"
      itemValue="#{user}" itemLabel="#{cc.attrs.formatToDisplay}" forceSelection="#{cc.attrs.forceSelection}"
      minQueryLength="#{cc.attrs.minQueryLength}" styleClass="#{cc.attrs.autoCompleteStyleClass}"
      autoHighlight="#{cc.attrs.hightlight}" converter="pojoConverter" cache="true" dynamic="true" dropdown="true"
      disabled="#{cc.attrs.isDisabled}" readonly="#{cc.attrs.isReadOnly}" requiredMessage="#{cc.attrs.requiredMessage}"
      moreText="#{cc.attrs.moreText}" queryDelay="#{cc.attrs.queryDelay}" maxResults="#{cc.attrs.maxResults}">
      <cc:insertFacet name="additionalFacet" />
    </p:autoComplete>
    <p:outputLabel id="#{cc.attrs.componentId}-label-by" value="#{cc.attrs.label}" for="#{cc.attrs.componentId}"
      styleClass="#{cc.attrs.labelStyleClass}" rendered="#{cc.attrs.floatingLabel}" />
    <p:message id="#{cc.attrs.componentId}-message" for="#{cc.attrs.componentId}"
      rendered="#{cc.attrs.isRenderedMessage}" styleClass="#{cc.attrs.messageStyleClass}" />
  </h:panelGroup>
</cc:implementation>
</html>

