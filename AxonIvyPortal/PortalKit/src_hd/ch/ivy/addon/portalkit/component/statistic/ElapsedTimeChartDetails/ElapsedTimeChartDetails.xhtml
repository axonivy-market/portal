<html xmlns="http://www.w3.org/1999/xhtml" xmlns:f="http://xmlns.jcp.org/jsf/core"
  xmlns:h="http://xmlns.jcp.org/jsf/html" xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
  xmlns:cc="http://xmlns.jcp.org/jsf/composite" xmlns:ic="http://ivyteam.ch/jsf/component"
  xmlns:p="http://primefaces.org/ui" xmlns:pe="http://primefaces.org/ui/extensions"
  xmlns:pm="http://primefaces.org/mobile" xmlns:c="http://xmlns.jcp.org/jsp/jstl/core"
  xmlns:jsf="http://xmlns.jcp.org/jsf">

<cc:interface componentType="IvyComponent">
  <cc:attribute name="caseCategory" required="true" />
  <cc:attribute name="statisticChart" required="true" />
  <cc:attribute name="chunkSize" shortDescription="Number of items to fetch for each lazy load" default="20" />
</cc:interface>

<cc:implementation>
  <f:event listener="#{elapsedTimeDetailsBean.initialize(cc.attrs.caseCategory, cc.attrs.statisticChart)}"
    type="preRenderComponent" />
  <f:event listener="#{logic.initialize(cc.attrs.caseCategory)}" type="preRenderComponent" />
  <div id="#{cc.clientId}:elapsed-time-details-category" class="widget case-widget-container">
    <h:form id="export-button-form">
      <p:commandButton id="export-button" ajax="false" styleClass="export-button"
        value="#{ivy.cms.co('/ch.ivy.addon.portalkit.ui.jsf/noteHistory/exportButton')}">
        <p:dataExporter type="xls" target="case-table" fileName="#{elapsedTimeDetailsBean.getExcelFileName()}" />
      </p:commandButton>

      <p:dataTable id="case-table" widgetVar="case-table" var="elapsedTimeDetail" value="#{data.dataModel}"
        rowKey="#{elapsedTimeDetail.getId()}" sortMode="single" lazy="true" scrollable="true" liveScroll="true"
        scrollRows="20" styleClass="task-table" rows="#{cc.attrs.chunkSize}">

        <p:ajax event="sort" update="case-table" onstart="liveScroll()" />

        <p:column id="case-id"
          headerText="#{ivy.cms.co('/ch.ivy.addon.portalkit.ui.jsf/statistic/taskAnalysis/caseID')}" sortable="false"
          width="120">
          <h:outputText value="#{elapsedTimeDetail.getId()}" />
        </p:column>

        <p:column id="case-name"
          headerText="#{ivy.cms.co('/ch.ivy.addon.portalkit.ui.jsf/statistic/taskAnalysis/caseName')}" sortable="false"
          width="250">
          <h:outputText value="#{elapsedTimeDetail.getName()}" />
        </p:column>

        <p:column id="case-creator"
          headerText="#{ivy.cms.co('/ch.ivy.addon.portalkit.ui.jsf/caseList/defaultColumns/CREATOR')}" sortable="false"
          width="200">
          <h:outputText value="#{elapsedTimeDetail.getCreatorUserName()}" />
        </p:column>

        <p:column id="case-created"
          headerText="#{ivy.cms.co('/ch.ivy.addon.portalkit.ui.jsf/caseList/defaultColumns/CREATION_TIME')}"
          sortBy="false" width="120">
          <h:outputText value="#{elapsedTimeDetail.getStartTimestamp()}">
            <f:convertDateTime pattern="#{ivy.cms.co('/patterns/dateTimePattern')}" />
          </h:outputText>
        </p:column>

        <p:column id="case-finished"
          headerText="#{ivy.cms.co('/ch.ivy.addon.portalkit.ui.jsf/caseList/defaultColumns/FINISHED_TIME')}"
          sortBy="false" width="120">
          <h:outputText value="#{elapsedTimeDetail.getEndTimestamp()}">
            <f:convertDateTime pattern="#{ivy.cms.co('/patterns/dateTimePattern')}" />
          </h:outputText>
        </p:column>

        <p:column id="case-elapsed-time"
          headerText="#{ivy.cms.co('/ch.ivy.addon.portalkit.ui.jsf/statistic/chart/elapsedTime')}" sortable="false"
          width="200">
          <h:outputText value="#{elapsedTimeDetail.getBusinessRuntime().toNumber()}" />
        </p:column>
      </p:dataTable>
    </h:form>
  </div>

</cc:implementation>
</html>