[Ivy]
150CB86EFC2F2972 3.20 #module
>Proto >Proto Collection #zClass
Ts0 TaskItemProcess Big #zClass
Ts0 RD #cInfo
Ts0 #process
Ts0 @TextInP .ui2RdDataAction .ui2RdDataAction #zField
Ts0 @TextInP .rdData2UIAction .rdData2UIAction #zField
Ts0 @TextInP .resExport .resExport #zField
Ts0 @TextInP .type .type #zField
Ts0 @TextInP .processKind .processKind #zField
Ts0 @AnnotationInP-0n ai ai #zField
Ts0 @MessageFlowInP-0n messageIn messageIn #zField
Ts0 @MessageFlowOutP-0n messageOut messageOut #zField
Ts0 @TextInP .xml .xml #zField
Ts0 @TextInP .responsibility .responsibility #zField
Ts0 @RichDialogInitStart f0 '' #zField
Ts0 @RichDialogProcessEnd f1 '' #zField
Ts0 @CallSub f29 '' #zField
Ts0 @RichDialogMethodStart f27 '' #zField
Ts0 @RichDialogProcessEnd f28 '' #zField
Ts0 @PushWFArc f34 '' #zField
Ts0 @PushWFArc f48 '' #zField
Ts0 @GridStep f8 '' #zField
Ts0 @RichDialogProcessEnd f15 '' #zField
Ts0 @Alternative f40 '' #zField
Ts0 @GridStep f20 '' #zField
Ts0 @CallSub f23 '' #zField
Ts0 @RichDialogProcessEnd f13 '' #zField
Ts0 @CallSub f51 '' #zField
Ts0 @CallSub f7 '' #zField
Ts0 @RichDialogMethodStart f14 '' #zField
Ts0 @RichDialogMethodStart f12 '' #zField
Ts0 @GridStep f26 '' #zField
Ts0 @PushWFArc f11 '' #zField
Ts0 @PushWFArc f25 '' #zField
Ts0 @PushWFArc f41 '' #zField
Ts0 @PushWFArc f43 '' #zField
Ts0 @PushWFArc f24 '' #zField
Ts0 @PushWFArc f52 '' #zField
Ts0 @GridStep f6 '' #zField
Ts0 @RichDialogProcessStart f16 '' #zField
Ts0 @RichDialogProcessEnd f17 '' #zField
Ts0 @PushWFArc f9 '' #zField
Ts0 @PushWFArc f18 '' #zField
Ts0 @CallSub f102 '' #zField
Ts0 @RichDialogMethodStart f87 '' #zField
Ts0 @RichDialogProcessEnd f92 '' #zField
Ts0 @PushWFArc f103 '' #zField
Ts0 @GridStep f47 '' #zField
Ts0 @RichDialogMethodStart f45 '' #zField
Ts0 @Alternative f77 '' #zField
Ts0 @CallSub f73 '' #zField
Ts0 @RichDialogProcessEnd f46 '' #zField
Ts0 @GridStep f79 '' #zField
Ts0 @PushWFArc f50 '' #zField
Ts0 @PushWFArc f78 '' #zField
Ts0 @PushWFArc f80 '' #zField
Ts0 @PushWFArc f81 '' #zField
Ts0 @RichDialogProcessEnd f22 '' #zField
Ts0 @GridStep f3 '' #zField
Ts0 @RichDialogProcessStart f21 '' #zField
Ts0 @PushWFArc f4 '' #zField
Ts0 @PushWFArc f5 '' #zField
Ts0 @CallSub f33 '' #zField
Ts0 @RichDialogMethodStart f30 '' #zField
Ts0 @PushWFArc f35 '' #zField
Ts0 @PushWFArc f71 '' #zField
Ts0 @CallSub f72 '' #zField
Ts0 @PushWFArc f10 '' #zField
Ts0 @Alternative f75 '' #zField
Ts0 @PushWFArc f74 '' #zField
Ts0 @PushWFArc f83 '' #zField
Ts0 @GridStep f84 '' #zField
Ts0 @PushWFArc f85 '' #zField
Ts0 @PushWFArc f82 '' #zField
Ts0 @GridStep f86 '' #zField
Ts0 @CallSub f88 '' #zField
Ts0 @GridStep f89 '' #zField
Ts0 @PushWFArc f90 '' #zField
Ts0 @PushWFArc f91 '' #zField
Ts0 @PushWFArc f93 '' #zField
Ts0 @PushWFArc f42 '' #zField
Ts0 @PushWFArc f59 '' #zField
Ts0 @CallSub f37 '' #zField
Ts0 @PushWFArc f38 '' #zField
Ts0 @GridStep f44 '' #zField
Ts0 @PushWFArc f53 '' #zField
Ts0 @CallSub f54 '' #zField
Ts0 @GridStep f56 '' #zField
Ts0 @PushWFArc f58 '' #zField
Ts0 @PushWFArc f57 '' #zField
Ts0 @PushWFArc f55 '' #zField
Ts0 @PushWFArc f60 '' #zField
Ts0 @CallSub f31 '' #zField
Ts0 @RichDialogProcessEnd f32 '' #zField
Ts0 @RichDialogMethodStart f36 '' #zField
Ts0 @GridStep f39 '' #zField
Ts0 @PushWFArc f62 '' #zField
Ts0 @PushWFArc f63 '' #zField
Ts0 @PushWFArc f61 '' #zField
Ts0 @RichDialogMethodStart f64 '' #zField
Ts0 @RichDialogProcessEnd f67 '' #zField
Ts0 @PushWFArc f65 '' #zField
Ts0 @GridStep f66 '' #zField
Ts0 @PushWFArc f2 '' #zField
Ts0 @PushWFArc f68 '' #zField
Ts0 @RichDialogMethodStart f76 '' #zField
Ts0 @RichDialogProcessEnd f94 '' #zField
Ts0 @RichDialogMethodStart f96 '' #zField
Ts0 @PushWFArc f19 '' #zField
Ts0 @PushWFArc f69 '' #zField
Ts0 @RichDialogProcessEnd f70 '' #zField
Ts0 @PushWFArc f95 '' #zField
Ts0 @RichDialogMethodStart f97 '' #zField
Ts0 @RichDialogProcessEnd f98 '' #zField
Ts0 @GridStep f100 '' #zField
Ts0 @PushWFArc f99 '' #zField
Ts0 @CallSub f104 '' #zField
Ts0 @PushWFArc f105 '' #zField
Ts0 @PushWFArc f101 '' #zField
Ts0 @GridStep f106 '' #zField
Ts0 @PushWFArc f107 '' #zField
Ts0 @PushWFArc f49 '' #zField
Ts0 @RichDialogMethodStart f108 '' #zField
Ts0 @RichDialogProcessEnd f109 '' #zField
Ts0 @PushWFArc f110 '' #zField
>Proto Ts0 Ts0 TaskItemProcess #zField
Ts0 f0 guid 150CB86EFDA88218 #txt
Ts0 f0 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f0 method start() #txt
Ts0 f0 disableUIEvents true #txt
Ts0 f0 inParameterDecl 'ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent methodEvent = event as ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent;
<> param = methodEvent.getInputArguments();
' #txt
Ts0 f0 outParameterDecl '<> result;
' #txt
Ts0 f0 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>start()</name>
        <nameStyle>7,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f0 56 53 22 22 14 0 #rect
Ts0 f0 @|RichDialogInitStartIcon #fIcon
Ts0 f1 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f1 56 277 22 22 14 0 #rect
Ts0 f1 @|RichDialogProcessEndIcon #fIcon
Ts0 f29 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f29 processCall MultiPortal/TaskService:resetTask(ch.ivy.addon.portalkit.persistence.domain.Server,Long) #txt
Ts0 f29 doCall true #txt
Ts0 f29 requestActionDecl '<ch.ivy.addon.portalkit.persistence.domain.Server ivyServer,java.lang.Long taskId> param;
' #txt
Ts0 f29 requestMappingAction 'param.ivyServer=in.serverOfSelectedTask;
param.taskId=in.selectedTask.id;
' #txt
Ts0 f29 responseActionDecl 'ch.ivy.addon.portalkit.component.TaskItem.TaskItemData out;
' #txt
Ts0 f29 responseMappingAction 'out=in;
out.errors=result.errors;
out.selectedTask.canDelegate=result.task.canDelegate;
out.selectedTask.canPark=result.task.canPark;
out.selectedTask.canReset=result.task.canReset;
out.selectedTask.canResume=result.task.canResume;
out.selectedTask.state=result.task.getState();
' #txt
Ts0 f29 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>resetTask(Server,Long)</name>
        <nameStyle>22,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f29 54 468 36 24 20 -2 #rect
Ts0 f29 @|CallSubIcon #fIcon
Ts0 f27 guid 154B7A65A0D3F491 #txt
Ts0 f27 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f27 method resetTask(ch.ivy.addon.portalkit.bo.RemoteTask) #txt
Ts0 f27 disableUIEvents false #txt
Ts0 f27 inParameterDecl 'ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent methodEvent = event as ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent;
<ch.ivy.addon.portalkit.bo.RemoteTask task> param = methodEvent.getInputArguments();
' #txt
Ts0 f27 inParameterMapAction 'out.selectedTask=param.task;
out.serverOfSelectedTask=param.task.#applicationRegister.#server;
' #txt
Ts0 f27 outParameterDecl '<> result;
' #txt
Ts0 f27 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>resetTask(RemoteTask)</name>
        <nameStyle>21,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f27 61 405 22 22 14 0 #rect
Ts0 f27 @|RichDialogMethodStartIcon #fIcon
Ts0 f28 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f28 61 565 22 22 14 0 #rect
Ts0 f28 @|RichDialogProcessEndIcon #fIcon
Ts0 f34 expr out #txt
Ts0 f34 72 427 72 468 #arcP
Ts0 f48 expr out #txt
Ts0 f48 72 492 72 565 #arcP
Ts0 f8 actionDecl 'ch.ivy.addon.portalkit.component.TaskItem.TaskItemData out;
' #txt
Ts0 f8 actionTable 'out=in;
' #txt
Ts0 f8 actionCode 'import ch.ivy.ws.addon.IvySecurityMember;

if (in.#selectedUser is initialized) {
	in.ivySecurityMember.setMemberName("#" + in.selectedUser.memberName);
} else if (in.#selectedRole is initialized) {
	in.ivySecurityMember.setMemberName(in.selectedRole.memberName);
}' #txt
Ts0 f8 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f8 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>set security member</name>
        <nameStyle>19,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f8 1134 660 36 24 20 -2 #rect
Ts0 f8 @|StepIcon #fIcon
Ts0 f15 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f15 1142 1246 20 20 13 0 #rect
Ts0 f15 @|RichDialogProcessEndIcon #fIcon
Ts0 f40 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f40 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>can user resume task?</name>
        <nameStyle>21,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f40 1138 850 28 28 11 -21 #rect
Ts0 f40 @|AlternativeIcon #fIcon
Ts0 f20 actionDecl 'ch.ivy.addon.portalkit.component.TaskItem.TaskItemData out;
' #txt
Ts0 f20 actionTable 'out=in;
' #txt
Ts0 f20 actionCode '
import ch.ivyteam.wf.processes.SecurityMemberData;

in.serverOfSelectedTask = in.selectedTask.#applicationRegister.#server;
in.disabledDelegateButton = true;
in.isUserDelegated = true;
in.selectedUser = null;
in.selectedRole = null;' #txt
Ts0 f20 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f20 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>init data</name>
        <nameStyle>9,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f20 878 468 36 24 20 -2 #rect
Ts0 f20 @|StepIcon #fIcon
Ts0 f23 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f23 processCall MultiPortal/TaskService:delegateTask(ch.ivy.ws.addon.IvySecurityMember,ch.ivy.addon.portalkit.persistence.domain.Server,Long) #txt
Ts0 f23 doCall true #txt
Ts0 f23 requestActionDecl '<ch.ivy.ws.addon.IvySecurityMember ivySecurityMember,ch.ivy.addon.portalkit.persistence.domain.Server ivyServer,java.lang.Long taskId> param;
' #txt
Ts0 f23 requestMappingAction 'param.ivySecurityMember=in.ivySecurityMember;
param.ivyServer=in.serverOfSelectedTask;
param.taskId=in.selectedTask.id;
' #txt
Ts0 f23 responseActionDecl 'ch.ivy.addon.portalkit.component.TaskItem.TaskItemData out;
' #txt
Ts0 f23 responseMappingAction 'out=in;
' #txt
Ts0 f23 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>delegateTask</name>
        <nameStyle>12,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f23 1134 724 36 24 20 -2 #rect
Ts0 f23 @|CallSubIcon #fIcon
Ts0 f13 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f13 885 725 22 22 14 0 #rect
Ts0 f13 @|RichDialogProcessEndIcon #fIcon
Ts0 f51 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f51 processCall MultiPortal/SecurityService:findSecurityMembersToDelegateBy(Long,ch.ivy.addon.portalkit.persistence.domain.Server) #txt
Ts0 f51 doCall true #txt
Ts0 f51 requestActionDecl '<java.lang.Long taskId,ch.ivy.addon.portalkit.persistence.domain.Server server> param;
' #txt
Ts0 f51 requestMappingAction 'param.taskId=in.selectedTask.id;
param.server=in.serverOfSelectedTask;
' #txt
Ts0 f51 responseActionDecl 'ch.ivy.addon.portalkit.component.TaskItem.TaskItemData out;
' #txt
Ts0 f51 responseMappingAction 'out=in;
out.errors=result.errors;
out.securityMemberData=result.securityMemberData;
' #txt
Ts0 f51 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>SecurityService</name>
        <nameStyle>15,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f51 878 532 36 24 20 -2 #rect
Ts0 f51 @|CallSubIcon #fIcon
Ts0 f7 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f7 processCall MultiPortal/TaskService:canUserResumeTask(String,ch.ivy.addon.portalkit.persistence.domain.Server,Long) #txt
Ts0 f7 doCall true #txt
Ts0 f7 requestActionDecl '<java.lang.String userName,ch.ivy.addon.portalkit.persistence.domain.Server ivyServer,java.lang.Long taskId> param;
' #txt
Ts0 f7 requestMappingAction 'param.userName=ivy.session.getSessionUserName();
param.ivyServer=in.serverOfSelectedTask;
param.taskId=in.selectedTask.id;
' #txt
Ts0 f7 responseActionDecl 'ch.ivy.addon.portalkit.component.TaskItem.TaskItemData out;
' #txt
Ts0 f7 responseMappingAction 'out=in;
out.errors=result.errors;
' #txt
Ts0 f7 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>canUserResumeTask</name>
        <nameStyle>17,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f7 1134 788 36 24 20 -2 #rect
Ts0 f7 @|CallSubIcon #fIcon
Ts0 f14 guid 154B7B2435DA5CE4 #txt
Ts0 f14 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f14 method delegateTask() #txt
Ts0 f14 disableUIEvents false #txt
Ts0 f14 inParameterDecl 'ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent methodEvent = event as ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent;
<> param = methodEvent.getInputArguments();
' #txt
Ts0 f14 outParameterDecl '<> result;
' #txt
Ts0 f14 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>delegateTask()</name>
        <nameStyle>14,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f14 1142 406 20 20 13 0 #rect
Ts0 f14 @|RichDialogMethodStartIcon #fIcon
Ts0 f12 guid 154B7B243613D465 #txt
Ts0 f12 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f12 method initDataToDelegate(ch.ivy.addon.portalkit.bo.RemoteTask) #txt
Ts0 f12 disableUIEvents false #txt
Ts0 f12 inParameterDecl 'ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent methodEvent = event as ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent;
<ch.ivy.addon.portalkit.bo.RemoteTask task> param = methodEvent.getInputArguments();
' #txt
Ts0 f12 inParameterMapAction 'out.selectedTask=param.task;
' #txt
Ts0 f12 outParameterDecl '<> result;
' #txt
Ts0 f12 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>initDataToDelegate(RemoteTask)</name>
        <nameStyle>30,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f12 885 405 22 22 14 0 #rect
Ts0 f12 @|RichDialogMethodStartIcon #fIcon
Ts0 f26 actionDecl 'ch.ivy.addon.portalkit.component.TaskItem.TaskItemData out;
' #txt
Ts0 f26 actionTable 'out=in;
' #txt
Ts0 f26 actionCode 'in.expandedTask = null;' #txt
Ts0 f26 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f26 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>reset expanded task</name>
        <nameStyle>19,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f26 1262 908 36 24 20 -11 #rect
Ts0 f26 @|StepIcon #fIcon
Ts0 f11 expr out #txt
Ts0 f11 1152 684 1152 724 #arcP
Ts0 f25 expr out #txt
Ts0 f25 1152 748 1152 788 #arcP
Ts0 f41 expr out #txt
Ts0 f41 1152 812 1152 850 #arcP
Ts0 f43 expr in #txt
Ts0 f43 .xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>NO</name>
        <nameStyle>2,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f43 1166 864 1280 908 #arcP
Ts0 f43 1 1280 864 #addKink
Ts0 f43 1 0.3269230769230769 16 0 #arcLabel
Ts0 f24 expr out #txt
Ts0 f24 896 427 896 468 #arcP
Ts0 f52 expr out #txt
Ts0 f52 896 492 896 532 #arcP
Ts0 f6 actionDecl 'ch.ivy.addon.portalkit.component.TaskItem.TaskItemData out;
' #txt
Ts0 f6 actionTable 'out=in;
' #txt
Ts0 f6 actionCode 'if (in.#selectedRole is initialized || in.#selectedUser is initialized) {
	in.disabledDelegateButton = false;
} else {
	in.disabledDelegateButton = true;
}' #txt
Ts0 f6 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f6 -114 1268 36 24 20 -2 #rect
Ts0 f6 @|StepIcon #fIcon
Ts0 f16 guid 154B7BB692A1ABF4 #txt
Ts0 f16 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f16 actionDecl 'ch.ivy.addon.portalkit.component.TaskItem.TaskItemData out;
' #txt
Ts0 f16 actionTable 'out=in;
' #txt
Ts0 f16 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>checkValue</name>
        <nameStyle>10,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f16 -106 1206 20 20 13 0 #rect
Ts0 f16 @|RichDialogProcessStartIcon #fIcon
Ts0 f17 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f17 -106 1334 20 20 13 0 #rect
Ts0 f17 @|RichDialogProcessEndIcon #fIcon
Ts0 f9 expr out #txt
Ts0 f9 -96 1226 -96 1268 #arcP
Ts0 f18 expr out #txt
Ts0 f18 -96 1292 -96 1334 #arcP
Ts0 f102 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f102 processCall MultiPortal/TaskService:parkTask(String,ch.ivy.addon.portalkit.persistence.domain.Server,Long) #txt
Ts0 f102 doCall true #txt
Ts0 f102 requestActionDecl '<java.lang.String userName,ch.ivy.addon.portalkit.persistence.domain.Server server,java.lang.Long taskId> param;
' #txt
Ts0 f102 requestMappingAction 'param.userName=ivy.session.getSessionUserName();
param.server=in.serverOfSelectedTask;
param.taskId=in.selectedTask.id;
' #txt
Ts0 f102 responseActionDecl 'ch.ivy.addon.portalkit.component.TaskItem.TaskItemData out;
' #txt
Ts0 f102 responseMappingAction 'out=in;
out.errors=result.errors;
out.selectedTask.state=result.task.getState();
' #txt
Ts0 f102 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>TaskService</name>
        <nameStyle>11,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f102 246 468 36 24 20 -2 #rect
Ts0 f102 @|CallSubIcon #fIcon
Ts0 f87 guid 154B7C31D923E08E #txt
Ts0 f87 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f87 method parkTask(ch.ivy.addon.portalkit.bo.RemoteTask) #txt
Ts0 f87 disableUIEvents false #txt
Ts0 f87 inParameterDecl 'ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent methodEvent = event as ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent;
<ch.ivy.addon.portalkit.bo.RemoteTask task> param = methodEvent.getInputArguments();
' #txt
Ts0 f87 inParameterMapAction 'out.selectedTask=param.task;
out.serverOfSelectedTask=param.task.#applicationRegister.#server;
' #txt
Ts0 f87 outParameterDecl '<> result;
' #txt
Ts0 f87 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>parkTask(RemoteTask)</name>
        <nameStyle>20,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f87 253 405 22 22 14 0 #rect
Ts0 f87 @|RichDialogMethodStartIcon #fIcon
Ts0 f92 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f92 253 565 22 22 14 0 #rect
Ts0 f92 @|RichDialogProcessEndIcon #fIcon
Ts0 f103 expr out #txt
Ts0 f103 264 427 264 468 #arcP
Ts0 f47 actionDecl 'ch.ivy.addon.portalkit.component.TaskItem.TaskItemData out;
' #txt
Ts0 f47 actionTable 'out=in;
' #txt
Ts0 f47 actionCode 'import javax.faces.context.FacesContext;

FacesContext.getCurrentInstance().getExternalContext().redirect(in.selectedTask.fullRequestPath);' #txt
Ts0 f47 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f47 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>open task</name>
        <nameStyle>9,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f47 614 876 36 24 20 -2 #rect
Ts0 f47 @|StepIcon #fIcon
Ts0 f45 guid 154B7C678FCFF10D #txt
Ts0 f45 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f45 method openTask(ch.ivy.addon.portalkit.bo.RemoteTask,ch.ivy.addon.portalkit.datamodel.TaskLazyDataModel) #txt
Ts0 f45 disableUIEvents false #txt
Ts0 f45 inParameterDecl 'ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent methodEvent = event as ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent;
<ch.ivy.addon.portalkit.bo.RemoteTask task,ch.ivy.addon.portalkit.datamodel.TaskLazyDataModel dataModel> param = methodEvent.getInputArguments();
' #txt
Ts0 f45 inParameterMapAction 'out.dataModel=param.dataModel;
out.selectedTask=param.task;
' #txt
Ts0 f45 outParameterDecl '<> result;
' #txt
Ts0 f45 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>openTask(RemoteTask)</name>
        <nameStyle>20,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f45 619 405 22 22 14 0 #rect
Ts0 f45 @|RichDialogMethodStartIcon #fIcon
Ts0 f77 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f77 616 530 28 28 14 0 #rect
Ts0 f77 @|AlternativeIcon #fIcon
Ts0 f73 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f73 processCall MultiPortal/TaskService:canUserResumeTask(String,ch.ivy.addon.portalkit.persistence.domain.Server,Long) #txt
Ts0 f73 doCall true #txt
Ts0 f73 requestActionDecl '<java.lang.String userName,ch.ivy.addon.portalkit.persistence.domain.Server ivyServer,java.lang.Long taskId> param;
' #txt
Ts0 f73 requestMappingAction 'param.userName=ivy.session.getSessionUserName();
param.ivyServer=in.selectedTask.#applicationRegister.#server;
param.taskId=in.selectedTask.id;
' #txt
Ts0 f73 responseActionDecl 'ch.ivy.addon.portalkit.component.TaskItem.TaskItemData out;
' #txt
Ts0 f73 responseMappingAction 'out=in;
out.canUserResumeTask=result.canUserResumeTask;
out.errors=result.errors;
out.workerUserName=result.workerUserName;
' #txt
Ts0 f73 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>canUserResumeTask</name>
        <nameStyle>17,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f73 612 468 36 24 20 -2 #rect
Ts0 f73 @|CallSubIcon #fIcon
Ts0 f46 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f46 621 949 22 22 14 0 #rect
Ts0 f46 @|RichDialogProcessEndIcon #fIcon
Ts0 f79 actionDecl 'ch.ivy.addon.portalkit.component.TaskItem.TaskItemData out;
' #txt
Ts0 f79 actionTable 'out=in;
' #txt
Ts0 f79 actionCode 'import java.util.Arrays;
import ch.ivyteam.ivy.workflow.TaskState;
import javax.faces.context.FacesContext;
import javax.faces.application.FacesMessage;
import org.primefaces.context.RequestContext;

RequestContext requesContext = RequestContext.getCurrentInstance();
FacesContext facesContext = FacesContext.getCurrentInstance();

String notification;
if(in.selectedTask.state == TaskState.DONE){
	notification = ivy.cms.co("/ch.ivy.addon.portalkit.ui.jsf/components/taskStart/cannotStartMessages/taskDone", Arrays.asList(in.selectedTask.getName()));
} else {
	if(!in.workerUserName.isEmpty()){
		notification = ivy.cms.co("/ch.ivy.addon.portalkit.ui.jsf/components/taskStart/cannotStartMessages/isAnotherUserWorking", Arrays.asList(in.selectedTask.name, in.selectedTask.id, in.workerUserName));
	} else {
		notification = ivy.cms.co("/ch.ivy.addon.portalkit.ui.jsf/components/taskStart/cannotStartMessages/noPermission", Arrays.asList(in.selectedTask.getName()));
	}
}

facesContext.validationFailed();
facesContext.addMessage(null, new FacesMessage(FacesMessage.SEVERITY_INFO, notification, null));
requesContext.update("task-widget:cannot-start-task-notification");  
' #txt
Ts0 f79 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f79 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>display error</name>
        <nameStyle>13
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f79 740 724 36 24 20 -2 #rect
Ts0 f79 @|StepIcon #fIcon
Ts0 f50 expr out #txt
Ts0 f50 632 900 632 949 #arcP
Ts0 f78 expr out #txt
Ts0 f78 630 492 630 530 #arcP
Ts0 f80 expr in #txt
Ts0 f80 644 544 758 724 #arcP
Ts0 f80 1 758 544 #addKink
Ts0 f80 0 0.7790944249033374 0 0 #arcLabel
Ts0 f81 expr out #txt
Ts0 f81 758 748 643 960 #arcP
Ts0 f81 1 758 960 #addKink
Ts0 f81 1 0.22090557509666262 0 0 #arcLabel
Ts0 f22 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f22 215 277 22 22 14 0 #rect
Ts0 f22 @|RichDialogProcessEndIcon #fIcon
Ts0 f3 actionDecl 'ch.ivy.addon.portalkit.component.TaskItem.TaskItemData out;
' #txt
Ts0 f3 actionTable 'out=in;
' #txt
Ts0 f3 actionCode 'if (in.isUserDelegated){
	out.selectedRole = null;
	if (out.#selectedUser == null) {
		out.disabledDelegateButton = true;
	}
} else {
	out.selectedUser = null;
	if (out.#selectedRole == null) {
		out.disabledDelegateButton = true;
	}
}' #txt
Ts0 f3 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f3 208 148 36 24 20 -2 #rect
Ts0 f3 @|StepIcon #fIcon
Ts0 f21 guid 154B7CE9789902D5 #txt
Ts0 f21 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f21 actionDecl 'ch.ivy.addon.portalkit.component.TaskItem.TaskItemData out;
' #txt
Ts0 f21 actionTable 'out=in;
' #txt
Ts0 f21 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>changeAssignType</name>
        <nameStyle>16,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f21 215 53 22 22 14 0 #rect
Ts0 f21 @|RichDialogProcessStartIcon #fIcon
Ts0 f4 expr out #txt
Ts0 f4 226 75 226 148 #arcP
Ts0 f5 expr out #txt
Ts0 f5 226 172 226 277 #arcP
Ts0 f33 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f33 processCall MultiPortal/TaskService:resetTask(ch.ivy.addon.portalkit.persistence.domain.Server,Long) #txt
Ts0 f33 doCall true #txt
Ts0 f33 requestActionDecl '<ch.ivy.addon.portalkit.persistence.domain.Server ivyServer,java.lang.Long taskId> param;
' #txt
Ts0 f33 requestMappingAction 'param.ivyServer=in.selectedTask.applicationRegister.server;
param.taskId=in.selectedTask.id;
' #txt
Ts0 f33 responseActionDecl 'ch.ivy.addon.portalkit.component.TaskItem.TaskItemData out;
' #txt
Ts0 f33 responseMappingAction 'out=in;
out.errors=result.errors;
out.selectedTask.state=ch.ivyteam.ivy.workflow.TaskState.SUSPENDED;
' #txt
Ts0 f33 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>resetTask(Server,Long)</name>
        <nameStyle>22,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f33 422 468 36 24 20 -2 #rect
Ts0 f33 @|CallSubIcon #fIcon
Ts0 f30 guid 154B7F53C6183946 #txt
Ts0 f30 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f30 method resetAndOpenTask() #txt
Ts0 f30 disableUIEvents false #txt
Ts0 f30 inParameterDecl 'ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent methodEvent = event as ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent;
<> param = methodEvent.getInputArguments();
' #txt
Ts0 f30 outParameterDecl '<> result;
' #txt
Ts0 f30 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>resetAndOpenTask()</name>
        <nameStyle>18,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f30 429 405 22 22 14 0 #rect
Ts0 f30 @|RichDialogMethodStartIcon #fIcon
Ts0 f35 expr out #txt
Ts0 f35 440 427 440 468 #arcP
Ts0 f71 expr out #txt
Ts0 f71 264 492 264 565 #arcP
Ts0 f72 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f72 processCall MultiPortal/TaskService:resetTask(ch.ivy.addon.portalkit.persistence.domain.Server,Long) #txt
Ts0 f72 doCall true #txt
Ts0 f72 requestActionDecl '<ch.ivy.addon.portalkit.persistence.domain.Server ivyServer,java.lang.Long taskId> param;
' #txt
Ts0 f72 requestMappingAction 'param.ivyServer=in.serverOfSelectedTask;
param.taskId=in.selectedTask.id;
' #txt
Ts0 f72 responseActionDecl 'ch.ivy.addon.portalkit.component.TaskItem.TaskItemData out;
' #txt
Ts0 f72 responseMappingAction 'out=in;
out.errors=result.errors;
' #txt
Ts0 f72 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>resetTask(Server,Long)</name>
        <nameStyle>22,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f72 1134 596 36 24 20 -2 #rect
Ts0 f72 @|CallSubIcon #fIcon
Ts0 f10 expr out #txt
Ts0 f10 1152 620 1152 660 #arcP
Ts0 f75 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f75 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>valid states
to reset?</name>
        <nameStyle>22
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f75 1138 530 28 28 14 0 #rect
Ts0 f75 @|AlternativeIcon #fIcon
Ts0 f74 expr in #txt
Ts0 f74 outCond in.IsValidStatesToReset #txt
Ts0 f74 1152 558 1152 596 #arcP
Ts0 f83 expr in #txt
Ts0 f83 1138 544 1134 672 #arcP
Ts0 f83 1 1088 544 #addKink
Ts0 f83 2 1088 672 #addKink
Ts0 f83 1 0.484375 0 0 #arcLabel
Ts0 f84 actionDecl 'ch.ivy.addon.portalkit.component.TaskItem.TaskItemData out;
' #txt
Ts0 f84 actionTable 'out=in;
' #txt
Ts0 f84 actionCode 'import ch.ivyteam.ivy.workflow.TaskState;

List<TaskState> states = [TaskState.RESUMED, TaskState.CREATED, TaskState.PARKED, TaskState.READY_FOR_JOIN, TaskState.FAILED];
in.IsValidStatesToReset = states.contains(in.selectedTask.getState());' #txt
Ts0 f84 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f84 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>check task state</name>
        <nameStyle>16
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f84 1134 468 36 24 20 -2 #rect
Ts0 f84 @|StepIcon #fIcon
Ts0 f85 expr out #txt
Ts0 f85 1152 426 1152 468 #arcP
Ts0 f82 expr out #txt
Ts0 f82 1152 492 1152 530 #arcP
Ts0 f86 actionDecl 'ch.ivy.addon.portalkit.component.TaskItem.TaskItemData out;
' #txt
Ts0 f86 actionTable 'out=in;
' #txt
Ts0 f86 actionCode 'import java.util.Arrays;
import ch.ivyteam.ivy.environment.Ivy;

String newResponsibleName;
String oldResponsibleName;

oldResponsibleName = in.selectedTask.activatorFullName;
if (in.#selectedUser != null) {
	newResponsibleName = in.#selectedUser.#displayName;
} else if (in.#selectedRole != null) {
	newResponsibleName = in.#selectedRole.#displayName;
}

List<Object> params = Arrays.asList(in.selectedTask.id, oldResponsibleName, newResponsibleName);
in.delegateComment = Ivy.cms().co("/ch.ivy.addon.portalkit.ui.jsf/taskDelegate/delegateComment", params);' #txt
Ts0 f86 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f86 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>set content for delegate comment</name>
        <nameStyle>32,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f86 1134 964 36 24 20 -2 #rect
Ts0 f86 @|StepIcon #fIcon
Ts0 f88 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f88 processCall MultiPortal/CaseService:createNote(ch.ivy.addon.portalkit.persistence.domain.Server,Long,String,String) #txt
Ts0 f88 doCall true #txt
Ts0 f88 requestActionDecl '<ch.ivy.addon.portalkit.persistence.domain.Server server,java.lang.Long caseId,java.lang.String username,java.lang.String content> param;
' #txt
Ts0 f88 requestMappingAction 'param.server=in.selectedTask.#applicationRegister.#server;
param.caseId=in.selectedTask.case.getId();
param.username=ivy.session.getSessionUserName();
param.content=in.delegateComment;
' #txt
Ts0 f88 responseActionDecl 'ch.ivy.addon.portalkit.component.TaskItem.TaskItemData out;
' #txt
Ts0 f88 responseMappingAction 'out=in;
' #txt
Ts0 f88 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>create note service</name>
        <nameStyle>19,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f88 1134 1060 36 24 20 -2 #rect
Ts0 f88 @|CallSubIcon #fIcon
Ts0 f89 actionDecl 'ch.ivy.addon.portalkit.component.TaskItem.TaskItemData out;
' #txt
Ts0 f89 actionTable 'out=in;
' #txt
Ts0 f89 actionCode 'import ch.ivy.ws.addon.WsException;
import javax.faces.application.FacesMessage;
import javax.faces.context.FacesContext;

if (!in.errors.isEmpty()) {
	for (WsException error : in.errors) {
		FacesContext.getCurrentInstance().addMessage("note-content", new FacesMessage(FacesMessage.SEVERITY_ERROR, error.userText, null));
	}
	FacesContext.getCurrentInstance().validationFailed();
}' #txt
Ts0 f89 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f89 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Show errors if any</name>
        <nameStyle>18,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f89 1134 1140 36 24 20 -2 #rect
Ts0 f89 @|StepIcon #fIcon
Ts0 f90 expr out #txt
Ts0 f90 1152 988 1152 1060 #arcP
Ts0 f91 expr out #txt
Ts0 f91 1152 1084 1152 1140 #arcP
Ts0 f93 expr in #txt
Ts0 f93 outCond in.canUserResumeTask #txt
Ts0 f93 .xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>YES</name>
        <nameStyle>3,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f93 1152 878 1152 964 #arcP
Ts0 f93 0 0.3630952380952381 18 0 #arcLabel
Ts0 f42 expr out #txt
Ts0 f42 1280 932 1170 976 #arcP
Ts0 f42 1 1280 976 #addKink
Ts0 f42 1 0.07754185619092568 0 0 #arcLabel
Ts0 f59 expr out #txt
Ts0 f59 1152 1164 1152 1246 #arcP
Ts0 f37 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f37 processCall 'Functional Processes/CalculateTaskDelegate:call(ch.ivyteam.wf.processes.SecurityMemberData,ch.ivyteam.ivy.security.ISecurityMember,ch.ivy.addon.portalkit.bo.RemoteTask)' #txt
Ts0 f37 doCall true #txt
Ts0 f37 requestActionDecl '<ch.ivyteam.wf.processes.SecurityMemberData possibleTaskDelegates,ch.ivyteam.ivy.security.ISecurityMember currentUser,ch.ivy.addon.portalkit.bo.RemoteTask task> param;
' #txt
Ts0 f37 requestMappingAction 'param.possibleTaskDelegates=in.securityMemberData;
param.currentUser=ivy.session.getSessionUser();
param.task=in.selectedTask;
' #txt
Ts0 f37 responseActionDecl 'ch.ivy.addon.portalkit.component.TaskItem.TaskItemData out;
' #txt
Ts0 f37 responseMappingAction 'out=in;
out.securityMemberData.ivyRoles=result.roles;
out.securityMemberData.ivyUsers=result.users;
' #txt
Ts0 f37 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Calculate task delegates</name>
        <nameStyle>24,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f37 878 596 36 24 20 -2 #rect
Ts0 f37 @|CallSubIcon #fIcon
Ts0 f38 expr out #txt
Ts0 f38 896 556 896 596 #arcP
Ts0 f44 actionDecl 'ch.ivy.addon.portalkit.component.TaskItem.TaskItemData out;
' #txt
Ts0 f44 actionTable 'out=in;
' #txt
Ts0 f44 actionCode 'in.canDelegateTask = !(in.securityMemberData.ivyRoles.isEmpty() && in.securityMemberData.ivyUsers.isEmpty());
if(in.canDelegateTask) {
	in.canDelegateTask = true;
	if(in.securityMemberData.ivyRoles.isEmpty()) {
		in.isUserDelegated = true;
	}
	if(in.securityMemberData.ivyUsers.isEmpty()) {
		in.isUserDelegated = false;
	}
}
' #txt
Ts0 f44 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f44 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Check if can delegate task</name>
        <nameStyle>26,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f44 878 660 36 24 20 -2 #rect
Ts0 f44 @|StepIcon #fIcon
Ts0 f53 expr out #txt
Ts0 f53 896 620 896 660 #arcP
Ts0 f54 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f54 processCall MultiPortal/TaskService:setAdditionalProperty(String,String,Long,ch.ivy.addon.portalkit.persistence.domain.Server) #txt
Ts0 f54 doCall true #txt
Ts0 f54 requestActionDecl '<java.lang.String name,java.lang.String value,java.lang.Long taskId,ch.ivy.addon.portalkit.persistence.domain.Server server> param;
' #txt
Ts0 f54 requestMappingAction 'param.name=ch.ivy.addon.portalkit.enums.AdditionalProperty.PORTAL_TASK_CALLBACK_URI.toString();
param.value=in.callbackUrl;
param.taskId=in.selectedTask.id;
param.server=in.selectedTask.#applicationRegister.#server;
' #txt
Ts0 f54 responseActionDecl 'ch.ivy.addon.portalkit.component.TaskItem.TaskItemData out;
' #txt
Ts0 f54 responseMappingAction 'out=in;
' #txt
Ts0 f54 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Set callbackUri to
additional property</name>
        <nameStyle>38
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f54 574 674 112 44 -50 -20 #rect
Ts0 f54 @|CallSubIcon #fIcon
Ts0 f56 actionDecl 'ch.ivy.addon.portalkit.component.TaskItem.TaskItemData out;
' #txt
Ts0 f56 actionTable 'out=in;
' #txt
Ts0 f56 actionCode 'import javax.faces.context.FacesContext;
import ch.ivyteam.ivy.server.ServerFactory;
import ch.ivyteam.ivy.request.RequestUriFactory;
import javax.servlet.http.HttpServletRequest;
import ch.ivy.addon.portalkit.support.UrlDetector;
import ch.ivyteam.ivy.workflow.IProcessStart;
import ch.ivy.addon.portalkit.service.ProcessStartCollector;

ProcessStartCollector collector = new ProcessStartCollector(ivy.wf.getApplication());
java.util.List<IProcessStart> processStarts = collector.findProcessStartRequestPathContainsKeyword("restorePortalTaskList.ivp");
UrlDetector urlDetector = new UrlDetector();
HttpServletRequest request = FacesContext.getCurrentInstance().getExternalContext().getRequest() as HttpServletRequest;
out.callbackUrl = urlDetector.getBaseURLWithoutContextPath(request) + RequestUriFactory.createProcessStartUri(ServerFactory.getServer().getApplicationConfigurationManager(), processStarts.get(0));' #txt
Ts0 f56 security system #txt
Ts0 f56 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f56 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Build callbackUrl</name>
        <nameStyle>17
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f56 574 586 112 44 -46 -8 #rect
Ts0 f56 @|StepIcon #fIcon
Ts0 f58 expr out #txt
Ts0 f58 630 427 630 468 #arcP
Ts0 f57 expr in #txt
Ts0 f57 outCond in.canUserResumeTask #txt
Ts0 f57 630 558 630 586 #arcP
Ts0 f55 expr out #txt
Ts0 f55 630 630 630 674 #arcP
Ts0 f60 expr out #txt
Ts0 f60 440 492 574 608 #arcP
Ts0 f60 1 440 608 #addKink
Ts0 f60 1 0.19313382575511498 0 0 #arcLabel
Ts0 f31 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f31 processCall MultiPortal/SideStepProcessStart:findSideStepsByCriteria(ch.ivy.addon.portalkit.persistence.domain.Server,ch.ivy.ws.addon.SideStepSearchCriteria) #txt
Ts0 f31 doCall true #txt
Ts0 f31 requestActionDecl '<ch.ivy.addon.portalkit.persistence.domain.Server server,ch.ivy.ws.addon.SideStepSearchCriteria sideStepSearchCriteria> param;
' #txt
Ts0 f31 requestMappingAction 'param.server=in.selectedTask.applicationRegister.server;
param.sideStepSearchCriteria=in.sideStepSearchCriteria;
' #txt
Ts0 f31 responseActionDecl 'ch.ivy.addon.portalkit.component.TaskItem.TaskItemData out;
' #txt
Ts0 f31 responseMappingAction 'out=in;
out.errors=result.errors;
out.sideSteps=result.sideSteps;
' #txt
Ts0 f31 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>sideStepProcessService</name>
        <nameStyle>22,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f31 430 210 36 24 20 -2 #rect
Ts0 f31 @|CallSubIcon #fIcon
Ts0 f32 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f32 435 273 26 26 0 12 #rect
Ts0 f32 @|RichDialogProcessEndIcon #fIcon
Ts0 f36 guid 15C771DC314798D2 #txt
Ts0 f36 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f36 method collectSideSteps(ch.ivy.addon.portalkit.bo.RemoteTask) #txt
Ts0 f36 disableUIEvents false #txt
Ts0 f36 inParameterDecl 'ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent methodEvent = event as ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent;
<ch.ivy.addon.portalkit.bo.RemoteTask task> param = methodEvent.getInputArguments();
' #txt
Ts0 f36 inParameterMapAction 'out.selectedTask=param.task;
' #txt
Ts0 f36 outParameterDecl '<java.util.List<ch.ivy.addon.portalkit.bo.RemoteSideStep> sideSteps> result;
' #txt
Ts0 f36 outParameterMapAction 'result.sideSteps=in.sideSteps;
' #txt
Ts0 f36 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>collectSideSteps(RemoteTask)</name>
        <nameStyle>28,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f36 435 49 26 26 7 10 #rect
Ts0 f36 @|RichDialogMethodStartIcon #fIcon
Ts0 f39 actionDecl 'ch.ivy.addon.portalkit.component.TaskItem.TaskItemData out;
' #txt
Ts0 f39 actionTable 'out=in;
' #txt
Ts0 f39 actionCode 'import ch.ivy.ws.addon.SideStepSearchCriteria;
in.sideStepSearchCriteria.setCaseId(in.selectedTask.getCase().getId());
in.sideStepSearchCriteria.setInvolvedUsername(ivy.session.getSessionUserName());
' #txt
Ts0 f39 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f39 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>init criteria</name>
        <nameStyle>13,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f39 392 136 112 44 -28 -8 #rect
Ts0 f39 @|StepIcon #fIcon
Ts0 f62 expr out #txt
Ts0 f62 448 180 448 210 #arcP
Ts0 f63 expr out #txt
Ts0 f63 448 75 448 136 #arcP
Ts0 f61 expr out #txt
Ts0 f61 448 234 448 273 #arcP
Ts0 f64 guid 15C80D2D06F5658C #txt
Ts0 f64 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f64 method navigateToSidestep(ch.ivy.addon.portalkit.bo.RemoteSideStep,ch.ivy.addon.portalkit.bo.RemoteTask) #txt
Ts0 f64 disableUIEvents false #txt
Ts0 f64 inParameterDecl 'ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent methodEvent = event as ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent;
<ch.ivy.addon.portalkit.bo.RemoteSideStep sidestep,ch.ivy.addon.portalkit.bo.RemoteTask task> param = methodEvent.getInputArguments();
' #txt
Ts0 f64 inActionCode 'import javax.faces.context.FacesContext;

String url = param.sidestep.getStartLink().getAbsoluteEncoded();
if(param.sidestep.isAdhoc) {
	url = url + "?originalTaskId=" + param.task.getId();
}
FacesContext.getCurrentInstance().getExternalContext().redirect(url);' #txt
Ts0 f64 outParameterDecl '<> result;
' #txt
Ts0 f64 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>navigateToSidestep(RemoteSideStep,RemoteTask)</name>
        <nameStyle>45,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f64 659 51 26 26 12 10 #rect
Ts0 f64 @|RichDialogMethodStartIcon #fIcon
Ts0 f67 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f67 659 275 26 26 0 12 #rect
Ts0 f67 @|RichDialogProcessEndIcon #fIcon
Ts0 f65 expr out #txt
Ts0 f65 672 77 672 275 #arcP
Ts0 f66 actionDecl 'ch.ivy.addon.portalkit.component.TaskItem.TaskItemData out;
' #txt
Ts0 f66 actionTable 'out=in;
' #txt
Ts0 f66 actionCode 'import ch.ivy.addon.portalkit.persistence.variable.GlobalVariable;
import ch.ivy.addon.portalkit.service.GlobalSettingService;
GlobalSettingService service = new GlobalSettingService();

String isShowTaskButtonLabels =  service.findGlobalSettingValue(GlobalVariable.SHOW_TASK_BUTTON_LABELS);

if(isShowTaskButtonLabels != null && !isShowTaskButtonLabels.isEmpty()){
	in.isShowTaskButtonLabels = Boolean.parseBoolean(isShowTaskButtonLabels);
} else{
	in.isShowTaskButtonLabels = false;	
}
' #txt
Ts0 f66 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f66 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Init show/hide
buttons</name>
        <nameStyle>22
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f66 49 150 36 24 20 -2 #rect
Ts0 f66 @|StepIcon #fIcon
Ts0 f2 expr out #txt
Ts0 f2 67 75 67 150 #arcP
Ts0 f68 expr out #txt
Ts0 f68 67 174 67 277 #arcP
Ts0 f76 guid 15F8F5A744248DE3 #txt
Ts0 f76 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f76 method autoCompleteForUserDelegate(String) #txt
Ts0 f76 disableUIEvents false #txt
Ts0 f76 inParameterDecl 'ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent methodEvent = event as ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent;
<java.lang.String query> param = methodEvent.getInputArguments();
' #txt
Ts0 f76 inParameterMapAction 'out.queryAutoComplete=param.query;
' #txt
Ts0 f76 outParameterDecl '<java.util.List<ch.ivy.ws.addon.IvyUser> usersToDelegate> result;
' #txt
Ts0 f76 outActionCode 'import ch.ivy.addon.portalkit.util.UserUtils;

result.usersToDelegate = UserUtils.filterIvyUsers(in.securityMemberData.ivyUsers, in.queryAutoComplete);
' #txt
Ts0 f76 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>autoCompleteForUserDelegate(String)</name>
        <nameStyle>35,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f76 1587 403 26 26 11 3 #rect
Ts0 f76 @|RichDialogMethodStartIcon #fIcon
Ts0 f94 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f94 1331 563 26 26 0 12 #rect
Ts0 f94 @|RichDialogProcessEndIcon #fIcon
Ts0 f96 guid 15F940442EBC4F26 #txt
Ts0 f96 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f96 method autoCompleteForRoleDelegate(String) #txt
Ts0 f96 disableUIEvents false #txt
Ts0 f96 inParameterDecl 'ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent methodEvent = event as ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent;
<java.lang.String query> param = methodEvent.getInputArguments();
' #txt
Ts0 f96 inParameterMapAction 'out.queryAutoComplete=param.query;
' #txt
Ts0 f96 outParameterDecl '<java.util.List<ch.ivy.ws.addon.IvyRole> rolesToDelegate> result;
' #txt
Ts0 f96 outActionCode 'import ch.ivy.addon.portalkit.util.RoleUtils;

result.rolesToDelegate = RoleUtils.filterIvyRoles(in.securityMemberData.ivyRoles, in.queryAutoComplete);' #txt
Ts0 f96 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>autoCompleteForRoleDelegate(String)</name>
        <nameStyle>35,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f96 1331 403 26 26 13 2 #rect
Ts0 f96 @|RichDialogMethodStartIcon #fIcon
Ts0 f19 expr out #txt
Ts0 f19 896 684 896 725 #arcP
Ts0 f69 expr out #txt
Ts0 f69 1344 429 1344 563 #arcP
Ts0 f69 0 0.61063400144005 0 0 #arcLabel
Ts0 f70 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f70 1587 563 26 26 0 12 #rect
Ts0 f70 @|RichDialogProcessEndIcon #fIcon
Ts0 f95 expr out #txt
Ts0 f95 1600 429 1600 563 #arcP
Ts0 f97 guid 1602EFA80B079E1D #txt
Ts0 f97 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f97 method validate(ch.ivy.addon.portalkit.bo.RemoteTask,ch.ivy.addon.portalkit.datamodel.TaskLazyDataModel) #txt
Ts0 f97 disableUIEvents false #txt
Ts0 f97 inParameterDecl 'ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent methodEvent = event as ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent;
<ch.ivy.addon.portalkit.bo.RemoteTask task,ch.ivy.addon.portalkit.datamodel.TaskLazyDataModel dataModel> param = methodEvent.getInputArguments();
' #txt
Ts0 f97 inParameterMapAction 'out.dataModel=param.dataModel;
out.selectedTask=param.task;
' #txt
Ts0 f97 outParameterDecl '<> result;
' #txt
Ts0 f97 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>validate(RemoteTask)</name>
        <nameStyle>20,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f97 1035 51 26 26 9 11 #rect
Ts0 f97 @|RichDialogMethodStartIcon #fIcon
Ts0 f98 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f98 1035 275 26 26 0 12 #rect
Ts0 f98 @|RichDialogProcessEndIcon #fIcon
Ts0 f100 actionDecl 'ch.ivy.addon.portalkit.component.TaskItem.TaskItemData out;
' #txt
Ts0 f100 actionTable 'out=in;
' #txt
Ts0 f100 actionCode 'import java.util.Arrays;
import ch.ivy.addon.portalkit.util.Dates;
import javax.faces.application.FacesMessage;
import javax.faces.context.FacesContext;
import org.primefaces.context.RequestContext;

if(!in.selectedTask.canResume) {
	String notification;
	if(!in.workerUserName.isEmpty()){
		notification = ivy.cms.co("/ch.ivy.addon.portalkit.ui.jsf/components/taskStart/cannotStartMessages/isAnotherUserWorking", Arrays.asList(in.selectedTask.name, in.selectedTask.id, in.workerUserName));
	} else {
		notification = ivy.cms.co("/ch.ivy.addon.portalkit.ui.jsf/components/taskStart/cannotStartMessages/noPermission", Arrays.asList(in.selectedTask.getName()));
	}
	RequestContext requesContext = RequestContext.getCurrentInstance();
      FacesContext facesContext = FacesContext.getCurrentInstance();
	facesContext.validationFailed();
      facesContext.addMessage(null, new FacesMessage(FacesMessage.SEVERITY_INFO, notification, null));
      requesContext.update("task-widget:cannot-start-task-notification");        
}
' #txt
Ts0 f100 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f100 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Validate</name>
        <nameStyle>8
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f100 992 186 112 44 -22 -8 #rect
Ts0 f100 @|StepIcon #fIcon
Ts0 f99 expr out #txt
Ts0 f99 1048 230 1048 275 #arcP
Ts0 f104 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f104 processCall MultiPortal/TaskService:canUserResumeTask(String,ch.ivy.addon.portalkit.persistence.domain.Server,Long) #txt
Ts0 f104 doCall true #txt
Ts0 f104 requestActionDecl '<java.lang.String userName,ch.ivy.addon.portalkit.persistence.domain.Server ivyServer,java.lang.Long taskId> param;
' #txt
Ts0 f104 requestMappingAction 'param.userName=ivy.session.getSessionUserName();
param.ivyServer=in.selectedTask.#applicationRegister.#server;
param.taskId=in.selectedTask.id;
' #txt
Ts0 f104 responseActionDecl 'ch.ivy.addon.portalkit.component.TaskItem.TaskItemData out;
' #txt
Ts0 f104 responseMappingAction 'out=in;
out.canUserResumeTask=result.canUserResumeTask;
out.errors=result.errors;
out.workerUserName=result.workerUserName;
' #txt
Ts0 f104 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>TaskService</name>
        <nameStyle>11,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f104 992 114 112 44 -33 -8 #rect
Ts0 f104 @|CallSubIcon #fIcon
Ts0 f105 expr out #txt
Ts0 f105 1048 77 1048 114 #arcP
Ts0 f101 expr out #txt
Ts0 f101 1048 158 1048 186 #arcP
Ts0 f106 actionDecl 'ch.ivy.addon.portalkit.component.TaskItem.TaskItemData out;
' #txt
Ts0 f106 actionTable 'out=in;
' #txt
Ts0 f106 actionCode 'import ch.ivy.addon.portalkit.dto.TaskEndInfo;
import ch.ivy.addon.portalkit.service.StickyTaskListService;
import javax.faces.context.FacesContext;
import ch.ivy.addon.portalkit.util.SecurityServiceUtils;
import java.util.Map;
import ch.ivy.addon.portalkit.enums.SessionAttribute;
import ch.ivy.addon.portalkit.util.SecurityServiceUtils;

TaskEndInfo taskEndInfo = new TaskEndInfo();
taskEndInfo.setDataModel(in.dataModel);
taskEndInfo.setIsFromPortalHome(in.dataModel.compactMode);
String taskDataModelSessionAttributeKey = StickyTaskListService.service().getTaskEndInfoSessionAttributeKey(in.selectedTask.getId());
SecurityServiceUtils.setSessionAttribute(taskDataModelSessionAttributeKey, taskEndInfo);' #txt
Ts0 f106 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f106 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Store task end info</name>
    </language>
</elementInfo>
' #txt
Ts0 f106 612 780 40 24 3 19 #rect
Ts0 f106 @|StepIcon #fIcon
Ts0 f107 expr out #txt
Ts0 f107 630 718 632 780 #arcP
Ts0 f49 expr out #txt
Ts0 f49 632 804 632 876 #arcP
Ts0 f108 guid 161932E544273665 #txt
Ts0 f108 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f108 method setSelectedTaskAndDataModel(ch.ivy.addon.portalkit.bo.RemoteTask,ch.ivy.addon.portalkit.datamodel.TaskLazyDataModel) #txt
Ts0 f108 disableUIEvents false #txt
Ts0 f108 inParameterDecl 'ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent methodEvent = event as ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent;
<ch.ivy.addon.portalkit.bo.RemoteTask selectedTask,ch.ivy.addon.portalkit.datamodel.TaskLazyDataModel dataModel> param = methodEvent.getInputArguments();
' #txt
Ts0 f108 inParameterMapAction 'out.dataModel=param.dataModel;
out.selectedTask=param.selectedTask;
' #txt
Ts0 f108 outParameterDecl '<> result;
' #txt
Ts0 f108 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>setSelectedTaskAndDataModel(RemoteTask,TaskLazyDataModel)</name>
        <nameStyle>57,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f108 1363 51 26 26 -174 -27 #rect
Ts0 f108 @|RichDialogMethodStartIcon #fIcon
Ts0 f109 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f109 1363 259 26 26 0 12 #rect
Ts0 f109 @|RichDialogProcessEndIcon #fIcon
Ts0 f110 expr out #txt
Ts0 f110 1376 77 1376 259 #arcP
>Proto Ts0 .type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
>Proto Ts0 .processKind HTML_DIALOG #txt
>Proto Ts0 -8 -8 16 16 16 26 #rect
>Proto Ts0 '' #fIcon
Ts0 f27 mainOut f34 tail #connect
Ts0 f34 head f29 mainIn #connect
Ts0 f29 mainOut f48 tail #connect
Ts0 f48 head f28 mainIn #connect
Ts0 f8 mainOut f11 tail #connect
Ts0 f11 head f23 mainIn #connect
Ts0 f12 mainOut f24 tail #connect
Ts0 f24 head f20 mainIn #connect
Ts0 f23 mainOut f25 tail #connect
Ts0 f25 head f7 mainIn #connect
Ts0 f7 mainOut f41 tail #connect
Ts0 f41 head f40 in #connect
Ts0 f43 head f26 mainIn #connect
Ts0 f20 mainOut f52 tail #connect
Ts0 f52 head f51 mainIn #connect
Ts0 f16 mainOut f9 tail #connect
Ts0 f9 head f6 mainIn #connect
Ts0 f6 mainOut f18 tail #connect
Ts0 f18 head f17 mainIn #connect
Ts0 f87 mainOut f103 tail #connect
Ts0 f103 head f102 mainIn #connect
Ts0 f47 mainOut f50 tail #connect
Ts0 f50 head f46 mainIn #connect
Ts0 f73 mainOut f78 tail #connect
Ts0 f78 head f77 in #connect
Ts0 f80 head f79 mainIn #connect
Ts0 f79 mainOut f81 tail #connect
Ts0 f81 head f46 mainIn #connect
Ts0 f21 mainOut f4 tail #connect
Ts0 f4 head f3 mainIn #connect
Ts0 f3 mainOut f5 tail #connect
Ts0 f5 head f22 mainIn #connect
Ts0 f30 mainOut f35 tail #connect
Ts0 f35 head f33 mainIn #connect
Ts0 f102 mainOut f71 tail #connect
Ts0 f71 head f92 mainIn #connect
Ts0 f72 mainOut f10 tail #connect
Ts0 f10 head f8 mainIn #connect
Ts0 f75 out f74 tail #connect
Ts0 f74 head f72 mainIn #connect
Ts0 f75 out f83 tail #connect
Ts0 f83 head f8 mainIn #connect
Ts0 f14 mainOut f85 tail #connect
Ts0 f85 head f84 mainIn #connect
Ts0 f84 mainOut f82 tail #connect
Ts0 f82 head f75 in #connect
Ts0 f86 mainOut f90 tail #connect
Ts0 f90 head f88 mainIn #connect
Ts0 f88 mainOut f91 tail #connect
Ts0 f91 head f89 mainIn #connect
Ts0 f40 out f93 tail #connect
Ts0 f93 head f86 mainIn #connect
Ts0 f40 out f43 tail #connect
Ts0 f26 mainOut f42 tail #connect
Ts0 f42 head f86 mainIn #connect
Ts0 f89 mainOut f59 tail #connect
Ts0 f59 head f15 mainIn #connect
Ts0 f51 mainOut f38 tail #connect
Ts0 f38 head f37 mainIn #connect
Ts0 f37 mainOut f53 tail #connect
Ts0 f53 head f44 mainIn #connect
Ts0 f45 mainOut f58 tail #connect
Ts0 f58 head f73 mainIn #connect
Ts0 f77 out f57 tail #connect
Ts0 f57 head f56 mainIn #connect
Ts0 f77 out f80 tail #connect
Ts0 f56 mainOut f55 tail #connect
Ts0 f55 head f54 mainIn #connect
Ts0 f33 mainOut f60 tail #connect
Ts0 f60 head f56 mainIn #connect
Ts0 f31 mainOut f61 tail #connect
Ts0 f61 head f32 mainIn #connect
Ts0 f36 mainOut f63 tail #connect
Ts0 f63 head f39 mainIn #connect
Ts0 f39 mainOut f62 tail #connect
Ts0 f62 head f31 mainIn #connect
Ts0 f64 mainOut f65 tail #connect
Ts0 f65 head f67 mainIn #connect
Ts0 f0 mainOut f2 tail #connect
Ts0 f2 head f66 mainIn #connect
Ts0 f66 mainOut f68 tail #connect
Ts0 f68 head f1 mainIn #connect
Ts0 f44 mainOut f19 tail #connect
Ts0 f19 head f13 mainIn #connect
Ts0 f96 mainOut f69 tail #connect
Ts0 f69 head f94 mainIn #connect
Ts0 f76 mainOut f95 tail #connect
Ts0 f95 head f70 mainIn #connect
Ts0 f100 mainOut f99 tail #connect
Ts0 f99 head f98 mainIn #connect
Ts0 f97 mainOut f105 tail #connect
Ts0 f105 head f104 mainIn #connect
Ts0 f104 mainOut f101 tail #connect
Ts0 f101 head f100 mainIn #connect
Ts0 f54 mainOut f107 tail #connect
Ts0 f107 head f106 mainIn #connect
Ts0 f106 mainOut f49 tail #connect
Ts0 f49 head f47 mainIn #connect
Ts0 f108 mainOut f110 tail #connect
Ts0 f110 head f109 mainIn #connect
