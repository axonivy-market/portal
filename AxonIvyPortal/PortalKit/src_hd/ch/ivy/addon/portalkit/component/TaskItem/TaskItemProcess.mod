[Ivy]
[>Created: Tue Jul 25 16:53:28 ICT 2017]
150CB86EFC2F2972 3.20 #module
>Proto >Proto Collection #zClass
Ts0 TaskItemProcess Big #zClass
Ts0 RD #cInfo
Ts0 #process
Ts0 @TextInP .ui2RdDataAction .ui2RdDataAction #zField
Ts0 @TextInP .rdData2UIAction .rdData2UIAction #zField
Ts0 @TextInP .resExport .resExport #zField
Ts0 @TextInP .type .type #zField
Ts0 @TextInP .processKind .processKind #zField
Ts0 @AnnotationInP-0n ai ai #zField
Ts0 @MessageFlowInP-0n messageIn messageIn #zField
Ts0 @MessageFlowOutP-0n messageOut messageOut #zField
Ts0 @TextInP .xml .xml #zField
Ts0 @TextInP .responsibility .responsibility #zField
Ts0 @RichDialogInitStart f0 '' #zField
Ts0 @RichDialogProcessEnd f1 '' #zField
Ts0 @CallSub f29 '' #zField
Ts0 @RichDialogMethodStart f27 '' #zField
Ts0 @RichDialogProcessEnd f28 '' #zField
Ts0 @PushWFArc f34 '' #zField
Ts0 @PushWFArc f48 '' #zField
Ts0 @GridStep f8 '' #zField
Ts0 @RichDialogProcessEnd f15 '' #zField
Ts0 @Alternative f40 '' #zField
Ts0 @GridStep f20 '' #zField
Ts0 @CallSub f23 '' #zField
Ts0 @RichDialogProcessEnd f13 '' #zField
Ts0 @CallSub f51 '' #zField
Ts0 @CallSub f7 '' #zField
Ts0 @RichDialogMethodStart f14 '' #zField
Ts0 @RichDialogMethodStart f12 '' #zField
Ts0 @GridStep f26 '' #zField
Ts0 @PushWFArc f11 '' #zField
Ts0 @PushWFArc f25 '' #zField
Ts0 @PushWFArc f41 '' #zField
Ts0 @PushWFArc f43 '' #zField
Ts0 @PushWFArc f24 '' #zField
Ts0 @PushWFArc f52 '' #zField
Ts0 @GridStep f6 '' #zField
Ts0 @RichDialogProcessStart f16 '' #zField
Ts0 @RichDialogProcessEnd f17 '' #zField
Ts0 @PushWFArc f9 '' #zField
Ts0 @PushWFArc f18 '' #zField
Ts0 @CallSub f102 '' #zField
Ts0 @RichDialogMethodStart f87 '' #zField
Ts0 @RichDialogProcessEnd f92 '' #zField
Ts0 @PushWFArc f103 '' #zField
Ts0 @GridStep f47 '' #zField
Ts0 @RichDialogMethodStart f45 '' #zField
Ts0 @Alternative f77 '' #zField
Ts0 @CallSub f73 '' #zField
Ts0 @RichDialogProcessEnd f46 '' #zField
Ts0 @GridStep f79 '' #zField
Ts0 @PushWFArc f50 '' #zField
Ts0 @PushWFArc f78 '' #zField
Ts0 @PushWFArc f80 '' #zField
Ts0 @PushWFArc f81 '' #zField
Ts0 @RichDialogProcessEnd f22 '' #zField
Ts0 @GridStep f3 '' #zField
Ts0 @RichDialogProcessStart f21 '' #zField
Ts0 @PushWFArc f4 '' #zField
Ts0 @PushWFArc f5 '' #zField
Ts0 @CallSub f33 '' #zField
Ts0 @RichDialogMethodStart f30 '' #zField
Ts0 @PushWFArc f35 '' #zField
Ts0 @PushWFArc f71 '' #zField
Ts0 @CallSub f72 '' #zField
Ts0 @PushWFArc f10 '' #zField
Ts0 @Alternative f75 '' #zField
Ts0 @PushWFArc f74 '' #zField
Ts0 @PushWFArc f83 '' #zField
Ts0 @GridStep f84 '' #zField
Ts0 @PushWFArc f85 '' #zField
Ts0 @PushWFArc f82 '' #zField
Ts0 @GridStep f86 '' #zField
Ts0 @CallSub f88 '' #zField
Ts0 @GridStep f89 '' #zField
Ts0 @PushWFArc f90 '' #zField
Ts0 @PushWFArc f91 '' #zField
Ts0 @PushWFArc f93 '' #zField
Ts0 @PushWFArc f42 '' #zField
Ts0 @PushWFArc f59 '' #zField
Ts0 @CallSub f37 '' #zField
Ts0 @PushWFArc f38 '' #zField
Ts0 @GridStep f44 '' #zField
Ts0 @PushWFArc f53 '' #zField
Ts0 @PushWFArc f19 '' #zField
Ts0 @CallSub f54 '' #zField
Ts0 @PushWFArc f49 '' #zField
Ts0 @GridStep f56 '' #zField
Ts0 @PushWFArc f58 '' #zField
Ts0 @PushWFArc f57 '' #zField
Ts0 @PushWFArc f55 '' #zField
Ts0 @PushWFArc f60 '' #zField
Ts0 @CallSub f31 '' #zField
Ts0 @RichDialogProcessEnd f32 '' #zField
Ts0 @RichDialogMethodStart f36 '' #zField
Ts0 @GridStep f39 '' #zField
Ts0 @PushWFArc f62 '' #zField
Ts0 @PushWFArc f63 '' #zField
Ts0 @PushWFArc f61 '' #zField
Ts0 @RichDialogMethodStart f64 '' #zField
Ts0 @RichDialogProcessEnd f67 '' #zField
Ts0 @PushWFArc f65 '' #zField
Ts0 @GridStep f66 '' #zField
Ts0 @PushWFArc f2 '' #zField
Ts0 @PushWFArc f68 '' #zField
>Proto Ts0 Ts0 TaskItemProcess #zField
Ts0 f0 guid 150CB86EFDA88218 #txt
Ts0 f0 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f0 method start() #txt
Ts0 f0 disableUIEvents true #txt
Ts0 f0 inParameterDecl 'ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent methodEvent = event as ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent;
<> param = methodEvent.getInputArguments();
' #txt
Ts0 f0 outParameterDecl '<> result;
' #txt
Ts0 f0 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>start()</name>
        <nameStyle>7,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f0 48 77 22 22 14 0 #rect
Ts0 f0 @|RichDialogInitStartIcon #fIcon
Ts0 f1 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f1 48 213 22 22 14 0 #rect
Ts0 f1 @|RichDialogProcessEndIcon #fIcon
Ts0 f29 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f29 processCall MultiPortal/TaskService:resetTask(ch.ivy.addon.portalkit.persistence.domain.Server,Long) #txt
Ts0 f29 doCall true #txt
Ts0 f29 requestActionDecl '<ch.ivy.addon.portalkit.persistence.domain.Server ivyServer,java.lang.Long taskId> param;
' #txt
Ts0 f29 requestMappingAction 'param.ivyServer=in.serverOfSelectedTask;
param.taskId=in.selectedTask.id;
' #txt
Ts0 f29 responseActionDecl 'ch.ivy.addon.portalkit.component.TaskItem.TaskItemData out;
' #txt
Ts0 f29 responseMappingAction 'out=in;
out.errors=result.errors;
out.selectedTask.canDelegate=result.task.canDelegate;
out.selectedTask.canPark=result.task.canPark;
out.selectedTask.canReset=result.task.canReset;
out.selectedTask.canResume=result.task.canResume;
out.selectedTask.state=result.task.getState();
' #txt
Ts0 f29 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>resetTask(Server,Long)</name>
        <nameStyle>22,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f29 54 380 36 24 20 -2 #rect
Ts0 f29 @|CallSubIcon #fIcon
Ts0 f27 guid 154B7A65A0D3F491 #txt
Ts0 f27 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f27 method resetTask(ch.ivy.addon.portalkit.bo.RemoteTask) #txt
Ts0 f27 disableUIEvents false #txt
Ts0 f27 inParameterDecl 'ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent methodEvent = event as ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent;
<ch.ivy.addon.portalkit.bo.RemoteTask task> param = methodEvent.getInputArguments();
' #txt
Ts0 f27 inParameterMapAction 'out.selectedTask=param.task;
out.serverOfSelectedTask=param.task.#applicationRegister.#server;
' #txt
Ts0 f27 outParameterDecl '<> result;
' #txt
Ts0 f27 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>resetTask(RemoteTask)</name>
        <nameStyle>21,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f27 61 317 22 22 14 0 #rect
Ts0 f27 @|RichDialogMethodStartIcon #fIcon
Ts0 f28 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f28 61 477 22 22 14 0 #rect
Ts0 f28 @|RichDialogProcessEndIcon #fIcon
Ts0 f34 expr out #txt
Ts0 f34 72 339 72 380 #arcP
Ts0 f48 expr out #txt
Ts0 f48 72 404 72 477 #arcP
Ts0 f8 actionDecl 'ch.ivy.addon.portalkit.component.TaskItem.TaskItemData out;
' #txt
Ts0 f8 actionTable 'out=in;
' #txt
Ts0 f8 actionCode 'import ch.ivy.ws.addon.IvySecurityMember;

if (in.#selectedUser is initialized) {
	in.ivySecurityMember.setMemberName("#" + in.selectedUser.memberName);
} else if (in.#selectedRole is initialized) {
	in.ivySecurityMember.setMemberName(in.selectedRole.memberName);
}' #txt
Ts0 f8 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f8 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>set security member</name>
        <nameStyle>19,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f8 526 564 36 24 20 -2 #rect
Ts0 f8 @|StepIcon #fIcon
Ts0 f15 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f15 534 1150 20 20 13 0 #rect
Ts0 f15 @|RichDialogProcessEndIcon #fIcon
Ts0 f40 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f40 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>can user resume task?</name>
        <nameStyle>21,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f40 530 754 28 28 11 -21 #rect
Ts0 f40 @|AlternativeIcon #fIcon
Ts0 f20 actionDecl 'ch.ivy.addon.portalkit.component.TaskItem.TaskItemData out;
' #txt
Ts0 f20 actionTable 'out=in;
' #txt
Ts0 f20 actionCode '
import ch.ivyteam.wf.processes.SecurityMemberData;

in.serverOfSelectedTask = in.selectedTask.#applicationRegister.#server;
in.disabledDelegateButton = true;
in.isUserDelegated = true;
in.selectedUser = null;
in.selectedRole = null;' #txt
Ts0 f20 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f20 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>init data</name>
        <nameStyle>9,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f20 302 372 36 24 20 -2 #rect
Ts0 f20 @|StepIcon #fIcon
Ts0 f23 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f23 processCall MultiPortal/TaskService:delegateTask(ch.ivy.ws.addon.IvySecurityMember,ch.ivy.addon.portalkit.persistence.domain.Server,Long) #txt
Ts0 f23 doCall true #txt
Ts0 f23 requestActionDecl '<ch.ivy.ws.addon.IvySecurityMember ivySecurityMember,ch.ivy.addon.portalkit.persistence.domain.Server ivyServer,java.lang.Long taskId> param;
' #txt
Ts0 f23 requestMappingAction 'param.ivySecurityMember=in.ivySecurityMember;
param.ivyServer=in.serverOfSelectedTask;
param.taskId=in.selectedTask.id;
' #txt
Ts0 f23 responseActionDecl 'ch.ivy.addon.portalkit.component.TaskItem.TaskItemData out;
' #txt
Ts0 f23 responseMappingAction 'out=in;
' #txt
Ts0 f23 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>delegateTask</name>
        <nameStyle>12,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f23 526 628 36 24 20 -2 #rect
Ts0 f23 @|CallSubIcon #fIcon
Ts0 f13 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f13 309 629 22 22 14 0 #rect
Ts0 f13 @|RichDialogProcessEndIcon #fIcon
Ts0 f51 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f51 processCall MultiPortal/SecurityService:findSecurityMembersToDelegateBy(Long,ch.ivy.addon.portalkit.persistence.domain.Server) #txt
Ts0 f51 doCall true #txt
Ts0 f51 requestActionDecl '<java.lang.Long taskId,ch.ivy.addon.portalkit.persistence.domain.Server server> param;
' #txt
Ts0 f51 requestMappingAction 'param.taskId=in.selectedTask.id;
param.server=in.serverOfSelectedTask;
' #txt
Ts0 f51 responseActionDecl 'ch.ivy.addon.portalkit.component.TaskItem.TaskItemData out;
' #txt
Ts0 f51 responseMappingAction 'out=in;
out.errors=result.errors;
out.securityMemberData=result.securityMemberData;
' #txt
Ts0 f51 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>SecurityService</name>
        <nameStyle>15,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f51 302 436 36 24 20 -2 #rect
Ts0 f51 @|CallSubIcon #fIcon
Ts0 f7 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f7 processCall MultiPortal/TaskService:canUserResumeTask(String,ch.ivy.addon.portalkit.persistence.domain.Server,Long) #txt
Ts0 f7 doCall true #txt
Ts0 f7 requestActionDecl '<java.lang.String userName,ch.ivy.addon.portalkit.persistence.domain.Server ivyServer,java.lang.Long taskId> param;
' #txt
Ts0 f7 requestMappingAction 'param.userName=ivy.session.getSessionUserName();
param.ivyServer=in.serverOfSelectedTask;
param.taskId=in.selectedTask.id;
' #txt
Ts0 f7 responseActionDecl 'ch.ivy.addon.portalkit.component.TaskItem.TaskItemData out;
' #txt
Ts0 f7 responseMappingAction 'out=in;
out.errors=result.errors;
' #txt
Ts0 f7 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>canUserResumeTask</name>
        <nameStyle>17,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f7 526 692 36 24 20 -2 #rect
Ts0 f7 @|CallSubIcon #fIcon
Ts0 f14 guid 154B7B2435DA5CE4 #txt
Ts0 f14 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f14 method delegateTask() #txt
Ts0 f14 disableUIEvents false #txt
Ts0 f14 inParameterDecl 'ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent methodEvent = event as ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent;
<> param = methodEvent.getInputArguments();
' #txt
Ts0 f14 outParameterDecl '<> result;
' #txt
Ts0 f14 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>delegateTask()</name>
        <nameStyle>14,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f14 534 310 20 20 13 0 #rect
Ts0 f14 @|RichDialogMethodStartIcon #fIcon
Ts0 f12 guid 154B7B243613D465 #txt
Ts0 f12 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f12 method initDataToDelegate(ch.ivy.addon.portalkit.bo.RemoteTask) #txt
Ts0 f12 disableUIEvents false #txt
Ts0 f12 inParameterDecl 'ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent methodEvent = event as ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent;
<ch.ivy.addon.portalkit.bo.RemoteTask task> param = methodEvent.getInputArguments();
' #txt
Ts0 f12 inParameterMapAction 'out.selectedTask=param.task;
' #txt
Ts0 f12 outParameterDecl '<> result;
' #txt
Ts0 f12 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>initDataToDelegate(RemoteTask)</name>
        <nameStyle>30,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f12 309 309 22 22 14 0 #rect
Ts0 f12 @|RichDialogMethodStartIcon #fIcon
Ts0 f26 actionDecl 'ch.ivy.addon.portalkit.component.TaskItem.TaskItemData out;
' #txt
Ts0 f26 actionTable 'out=in;
' #txt
Ts0 f26 actionCode 'in.expandedTask = null;' #txt
Ts0 f26 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f26 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>reset expanded task</name>
        <nameStyle>19,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f26 654 812 36 24 20 -11 #rect
Ts0 f26 @|StepIcon #fIcon
Ts0 f11 expr out #txt
Ts0 f11 544 588 544 628 #arcP
Ts0 f25 expr out #txt
Ts0 f25 544 652 544 692 #arcP
Ts0 f41 expr out #txt
Ts0 f41 544 716 544 754 #arcP
Ts0 f43 expr in #txt
Ts0 f43 .xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>NO</name>
        <nameStyle>2,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f43 558 768 672 812 #arcP
Ts0 f43 1 672 768 #addKink
Ts0 f43 1 0.3269230769230769 16 0 #arcLabel
Ts0 f24 expr out #txt
Ts0 f24 320 331 320 372 #arcP
Ts0 f52 expr out #txt
Ts0 f52 320 396 320 436 #arcP
Ts0 f6 actionDecl 'ch.ivy.addon.portalkit.component.TaskItem.TaskItemData out;
' #txt
Ts0 f6 actionTable 'out=in;
' #txt
Ts0 f6 actionCode 'if (in.#selectedRole is initialized || in.#selectedUser is initialized) {
	in.disabledDelegateButton = false;
} else {
	in.disabledDelegateButton = true;
}' #txt
Ts0 f6 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f6 734 380 36 24 20 -2 #rect
Ts0 f6 @|StepIcon #fIcon
Ts0 f16 guid 154B7BB692A1ABF4 #txt
Ts0 f16 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f16 actionDecl 'ch.ivy.addon.portalkit.component.TaskItem.TaskItemData out;
' #txt
Ts0 f16 actionTable 'out=in;
' #txt
Ts0 f16 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>checkValue</name>
        <nameStyle>10,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f16 742 318 20 20 13 0 #rect
Ts0 f16 @|RichDialogProcessStartIcon #fIcon
Ts0 f17 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f17 742 446 20 20 13 0 #rect
Ts0 f17 @|RichDialogProcessEndIcon #fIcon
Ts0 f9 expr out #txt
Ts0 f9 752 338 752 380 #arcP
Ts0 f18 expr out #txt
Ts0 f18 752 404 752 446 #arcP
Ts0 f102 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f102 processCall MultiPortal/TaskService:parkTask(String,ch.ivy.addon.portalkit.persistence.domain.Server,Long) #txt
Ts0 f102 doCall true #txt
Ts0 f102 requestActionDecl '<java.lang.String userName,ch.ivy.addon.portalkit.persistence.domain.Server server,java.lang.Long taskId> param;
' #txt
Ts0 f102 requestMappingAction 'param.userName=ivy.session.getSessionUserName();
param.server=in.serverOfSelectedTask;
param.taskId=in.selectedTask.id;
' #txt
Ts0 f102 responseActionDecl 'ch.ivy.addon.portalkit.component.TaskItem.TaskItemData out;
' #txt
Ts0 f102 responseMappingAction 'out=in;
out.errors=result.errors;
out.selectedTask.state=result.task.getState();
' #txt
Ts0 f102 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>TaskService</name>
        <nameStyle>11,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f102 894 412 36 24 20 -2 #rect
Ts0 f102 @|CallSubIcon #fIcon
Ts0 f87 guid 154B7C31D923E08E #txt
Ts0 f87 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f87 method parkTask(ch.ivy.addon.portalkit.bo.RemoteTask) #txt
Ts0 f87 disableUIEvents false #txt
Ts0 f87 inParameterDecl 'ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent methodEvent = event as ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent;
<ch.ivy.addon.portalkit.bo.RemoteTask task> param = methodEvent.getInputArguments();
' #txt
Ts0 f87 inParameterMapAction 'out.selectedTask=param.task;
out.serverOfSelectedTask=param.task.#applicationRegister.#server;
' #txt
Ts0 f87 outParameterDecl '<> result;
' #txt
Ts0 f87 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>parkTask(RemoteTask)</name>
        <nameStyle>20,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f87 901 317 22 22 14 0 #rect
Ts0 f87 @|RichDialogMethodStartIcon #fIcon
Ts0 f92 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f92 901 477 22 22 14 0 #rect
Ts0 f92 @|RichDialogProcessEndIcon #fIcon
Ts0 f103 expr out #txt
Ts0 f103 912 339 912 412 #arcP
Ts0 f47 actionDecl 'ch.ivy.addon.portalkit.component.TaskItem.TaskItemData out;
' #txt
Ts0 f47 actionTable 'out=in;
' #txt
Ts0 f47 actionCode 'import javax.faces.context.FacesContext;

FacesContext.getCurrentInstance().getExternalContext().redirect(in.selectedTask.fullRequestPath);' #txt
Ts0 f47 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f47 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>open task</name>
        <nameStyle>9,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f47 1260 692 36 24 20 -2 #rect
Ts0 f47 @|StepIcon #fIcon
Ts0 f45 guid 154B7C678FCFF10D #txt
Ts0 f45 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f45 method openTask(ch.ivy.addon.portalkit.bo.RemoteTask) #txt
Ts0 f45 disableUIEvents false #txt
Ts0 f45 inParameterDecl 'ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent methodEvent = event as ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent;
<ch.ivy.addon.portalkit.bo.RemoteTask task> param = methodEvent.getInputArguments();
' #txt
Ts0 f45 inParameterMapAction 'out.selectedTask=param.task;
' #txt
Ts0 f45 outParameterDecl '<> result;
' #txt
Ts0 f45 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>openTask(RemoteTask)</name>
        <nameStyle>20,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f45 1267 317 22 22 14 0 #rect
Ts0 f45 @|RichDialogMethodStartIcon #fIcon
Ts0 f77 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f77 1264 442 28 28 14 0 #rect
Ts0 f77 @|AlternativeIcon #fIcon
Ts0 f73 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f73 processCall MultiPortal/TaskService:canUserResumeTask(String,ch.ivy.addon.portalkit.persistence.domain.Server,Long) #txt
Ts0 f73 doCall true #txt
Ts0 f73 requestActionDecl '<java.lang.String userName,ch.ivy.addon.portalkit.persistence.domain.Server ivyServer,java.lang.Long taskId> param;
' #txt
Ts0 f73 requestMappingAction 'param.userName=ivy.session.getSessionUserName();
param.ivyServer=in.selectedTask.#applicationRegister.#server;
param.taskId=in.selectedTask.id;
' #txt
Ts0 f73 responseActionDecl 'ch.ivy.addon.portalkit.component.TaskItem.TaskItemData out;
' #txt
Ts0 f73 responseMappingAction 'out=in;
out.canUserResumeTask=result.canUserResumeTask;
out.errors=result.errors;
out.workerUserName=result.workerUserName;
' #txt
Ts0 f73 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>canUserResumeTask</name>
        <nameStyle>17,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f73 1260 380 36 24 20 -2 #rect
Ts0 f73 @|CallSubIcon #fIcon
Ts0 f46 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f46 1267 765 22 22 14 0 #rect
Ts0 f46 @|RichDialogProcessEndIcon #fIcon
Ts0 f79 actionDecl 'ch.ivy.addon.portalkit.component.TaskItem.TaskItemData out;
' #txt
Ts0 f79 actionTable 'out=in;
' #txt
Ts0 f79 actionCode 'import javax.faces.application.FacesMessage;
import java.util.Arrays;
import org.primefaces.context.RequestContext;

String isAnotherUserWorkingMessage = ivy.cms.co("/ch.ivy.addon.portalkit.ui.jsf/components/taskStart/isAnotherUserWorking", Arrays.asList(in.selectedTask.name, in.selectedTask.id, in.workerUserName));
String header = ivy.cms.co("/ch.ivy.addon.portalkit.ui.jsf/components/taskStart/errorStartTask");
FacesMessage facesMessage = new FacesMessage(FacesMessage.SEVERITY_ERROR, header, isAnotherUserWorkingMessage);
RequestContext.getCurrentInstance().showMessageInDialog(facesMessage);' #txt
Ts0 f79 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f79 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>display error</name>
        <nameStyle>13
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f79 1388 636 36 24 20 -2 #rect
Ts0 f79 @|StepIcon #fIcon
Ts0 f50 expr out #txt
Ts0 f50 1278 716 1278 765 #arcP
Ts0 f78 expr out #txt
Ts0 f78 1278 404 1278 442 #arcP
Ts0 f80 expr in #txt
Ts0 f80 1292 456 1406 636 #arcP
Ts0 f80 1 1406 456 #addKink
Ts0 f80 0 0.7790944249033374 0 0 #arcLabel
Ts0 f81 expr out #txt
Ts0 f81 1406 660 1289 776 #arcP
Ts0 f81 1 1406 776 #addKink
Ts0 f81 1 0.22090557509666262 0 0 #arcLabel
Ts0 f22 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f22 375 205 22 22 14 0 #rect
Ts0 f22 @|RichDialogProcessEndIcon #fIcon
Ts0 f3 actionDecl 'ch.ivy.addon.portalkit.component.TaskItem.TaskItemData out;
' #txt
Ts0 f3 actionTable 'out=in;
' #txt
Ts0 f3 actionCode 'if (in.isUserDelegated){
	out.selectedRole = null;
	if (out.#selectedUser == null) {
		out.disabledDelegateButton = true;
	}
} else {
	out.selectedUser = null;
	if (out.#selectedRole == null) {
		out.disabledDelegateButton = true;
	}
}' #txt
Ts0 f3 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f3 368 140 36 24 20 -2 #rect
Ts0 f3 @|StepIcon #fIcon
Ts0 f21 guid 154B7CE9789902D5 #txt
Ts0 f21 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f21 actionDecl 'ch.ivy.addon.portalkit.component.TaskItem.TaskItemData out;
' #txt
Ts0 f21 actionTable 'out=in;
' #txt
Ts0 f21 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>changeAssignType</name>
        <nameStyle>16,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f21 375 77 22 22 14 0 #rect
Ts0 f21 @|RichDialogProcessStartIcon #fIcon
Ts0 f4 expr out #txt
Ts0 f4 386 99 386 140 #arcP
Ts0 f5 expr out #txt
Ts0 f5 386 164 386 205 #arcP
Ts0 f33 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f33 processCall MultiPortal/TaskService:resetTask(ch.ivy.addon.portalkit.persistence.domain.Server,Long) #txt
Ts0 f33 doCall true #txt
Ts0 f33 requestActionDecl '<ch.ivy.addon.portalkit.persistence.domain.Server ivyServer,java.lang.Long taskId> param;
' #txt
Ts0 f33 requestMappingAction 'param.ivyServer=in.selectedTask.applicationRegister.server;
param.taskId=in.selectedTask.id;
' #txt
Ts0 f33 responseActionDecl 'ch.ivy.addon.portalkit.component.TaskItem.TaskItemData out;
' #txt
Ts0 f33 responseMappingAction 'out=in;
out.errors=result.errors;
out.selectedTask.state=ch.ivyteam.ivy.workflow.TaskState.SUSPENDED;
' #txt
Ts0 f33 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>resetTask(Server,Long)</name>
        <nameStyle>22,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f33 1070 380 36 24 20 -2 #rect
Ts0 f33 @|CallSubIcon #fIcon
Ts0 f30 guid 154B7F53C6183946 #txt
Ts0 f30 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f30 method resetAndOpenTask() #txt
Ts0 f30 disableUIEvents false #txt
Ts0 f30 inParameterDecl 'ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent methodEvent = event as ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent;
<> param = methodEvent.getInputArguments();
' #txt
Ts0 f30 outParameterDecl '<> result;
' #txt
Ts0 f30 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>resetAndOpenTask()</name>
        <nameStyle>18,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f30 1077 317 22 22 14 0 #rect
Ts0 f30 @|RichDialogMethodStartIcon #fIcon
Ts0 f35 expr out #txt
Ts0 f35 1088 339 1088 380 #arcP
Ts0 f71 expr out #txt
Ts0 f71 912 436 912 477 #arcP
Ts0 f72 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f72 processCall MultiPortal/TaskService:resetTask(ch.ivy.addon.portalkit.persistence.domain.Server,Long) #txt
Ts0 f72 doCall true #txt
Ts0 f72 requestActionDecl '<ch.ivy.addon.portalkit.persistence.domain.Server ivyServer,java.lang.Long taskId> param;
' #txt
Ts0 f72 requestMappingAction 'param.ivyServer=in.serverOfSelectedTask;
param.taskId=in.selectedTask.id;
' #txt
Ts0 f72 responseActionDecl 'ch.ivy.addon.portalkit.component.TaskItem.TaskItemData out;
' #txt
Ts0 f72 responseMappingAction 'out=in;
out.errors=result.errors;
' #txt
Ts0 f72 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>resetTask(Server,Long)</name>
        <nameStyle>22,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f72 526 500 36 24 20 -2 #rect
Ts0 f72 @|CallSubIcon #fIcon
Ts0 f10 expr out #txt
Ts0 f10 544 524 544 564 #arcP
Ts0 f75 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f75 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>valid states
to reset?</name>
        <nameStyle>22
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f75 530 434 28 28 14 0 #rect
Ts0 f75 @|AlternativeIcon #fIcon
Ts0 f74 expr in #txt
Ts0 f74 outCond in.IsValidStatesToReset #txt
Ts0 f74 544 462 544 500 #arcP
Ts0 f83 expr in #txt
Ts0 f83 530 448 526 576 #arcP
Ts0 f83 1 496 448 #addKink
Ts0 f83 2 496 576 #addKink
Ts0 f83 1 0.484375 0 0 #arcLabel
Ts0 f84 actionDecl 'ch.ivy.addon.portalkit.component.TaskItem.TaskItemData out;
' #txt
Ts0 f84 actionTable 'out=in;
' #txt
Ts0 f84 actionCode 'import ch.ivyteam.ivy.workflow.TaskState;

List<TaskState> states = [TaskState.RESUMED, TaskState.CREATED, TaskState.PARKED, TaskState.READY_FOR_JOIN, TaskState.FAILED];
in.IsValidStatesToReset = states.contains(in.selectedTask.getState());' #txt
Ts0 f84 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f84 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>check task state</name>
        <nameStyle>16
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f84 526 372 36 24 20 -2 #rect
Ts0 f84 @|StepIcon #fIcon
Ts0 f85 expr out #txt
Ts0 f85 544 330 544 372 #arcP
Ts0 f82 expr out #txt
Ts0 f82 544 396 544 434 #arcP
Ts0 f86 actionDecl 'ch.ivy.addon.portalkit.component.TaskItem.TaskItemData out;
' #txt
Ts0 f86 actionTable 'out=in;
' #txt
Ts0 f86 actionCode 'import java.util.Arrays;
import ch.ivyteam.ivy.environment.Ivy;

String newResponsibleName;
String oldResponsibleName;

oldResponsibleName = in.selectedTask.activatorFullName;
if (in.#selectedUser != null) {
	newResponsibleName = in.#selectedUser.#displayName;
} else if (in.#selectedRole != null) {
	newResponsibleName = in.#selectedRole.#displayName;
}

List<Object> params = Arrays.asList(in.selectedTask.id, oldResponsibleName, newResponsibleName);
in.delegateComment = Ivy.cms().co("/ch.ivy.addon.portalkit.ui.jsf/taskDelegate/delegateComment", params);' #txt
Ts0 f86 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f86 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>set content for delegate comment</name>
        <nameStyle>32,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f86 526 868 36 24 20 -2 #rect
Ts0 f86 @|StepIcon #fIcon
Ts0 f88 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f88 processCall MultiPortal/CaseService:createNote(ch.ivy.addon.portalkit.persistence.domain.Server,Long,String,String) #txt
Ts0 f88 doCall true #txt
Ts0 f88 requestActionDecl '<ch.ivy.addon.portalkit.persistence.domain.Server server,java.lang.Long caseId,java.lang.String username,java.lang.String content> param;
' #txt
Ts0 f88 requestMappingAction 'param.server=in.selectedTask.#applicationRegister.#server;
param.caseId=in.selectedTask.case.getId();
param.username=ivy.session.getSessionUserName();
param.content=in.delegateComment;
' #txt
Ts0 f88 responseActionDecl 'ch.ivy.addon.portalkit.component.TaskItem.TaskItemData out;
' #txt
Ts0 f88 responseMappingAction 'out=in;
' #txt
Ts0 f88 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>create note service</name>
        <nameStyle>19,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f88 526 964 36 24 20 -2 #rect
Ts0 f88 @|CallSubIcon #fIcon
Ts0 f89 actionDecl 'ch.ivy.addon.portalkit.component.TaskItem.TaskItemData out;
' #txt
Ts0 f89 actionTable 'out=in;
' #txt
Ts0 f89 actionCode 'import ch.ivy.ws.addon.WsException;
import javax.faces.application.FacesMessage;
import javax.faces.context.FacesContext;

if (!in.errors.isEmpty()) {
	for (WsException error : in.errors) {
		FacesContext.getCurrentInstance().addMessage("note-content", new FacesMessage(FacesMessage.SEVERITY_ERROR, error.userText, null));
	}
	FacesContext.getCurrentInstance().validationFailed();
}' #txt
Ts0 f89 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f89 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Show errors if any</name>
        <nameStyle>18,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f89 526 1044 36 24 20 -2 #rect
Ts0 f89 @|StepIcon #fIcon
Ts0 f90 expr out #txt
Ts0 f90 544 892 544 964 #arcP
Ts0 f91 expr out #txt
Ts0 f91 544 988 544 1044 #arcP
Ts0 f93 expr in #txt
Ts0 f93 outCond in.canUserResumeTask #txt
Ts0 f93 .xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>YES</name>
        <nameStyle>3,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f93 544 782 544 868 #arcP
Ts0 f93 0 0.3630952380952381 18 0 #arcLabel
Ts0 f42 expr out #txt
Ts0 f42 672 836 562 880 #arcP
Ts0 f42 1 672 880 #addKink
Ts0 f42 1 0.07754185619092568 0 0 #arcLabel
Ts0 f59 expr out #txt
Ts0 f59 544 1068 544 1150 #arcP
Ts0 f37 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f37 processCall 'Functional Processes/CalculateTaskDelegate:call(ch.ivyteam.wf.processes.SecurityMemberData,ch.ivyteam.ivy.security.ISecurityMember,ch.ivyteam.ivy.workflow.ITask)' #txt
Ts0 f37 doCall true #txt
Ts0 f37 requestActionDecl '<ch.ivyteam.wf.processes.SecurityMemberData possibleTaskDelegates,ch.ivyteam.ivy.security.ISecurityMember currentUser,ch.ivyteam.ivy.workflow.ITask task> param;
' #txt
Ts0 f37 requestMappingAction 'param.possibleTaskDelegates=in.securityMemberData;
param.currentUser=ivy.session.getSessionUser();
param.task=in.selectedTask;
' #txt
Ts0 f37 responseActionDecl 'ch.ivy.addon.portalkit.component.TaskItem.TaskItemData out;
' #txt
Ts0 f37 responseMappingAction 'out=in;
out.securityMemberData.ivyRoles=result.roles;
out.securityMemberData.ivyUsers=result.users;
' #txt
Ts0 f37 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Calculate task delegates</name>
        <nameStyle>24,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f37 302 500 36 24 20 -2 #rect
Ts0 f37 @|CallSubIcon #fIcon
Ts0 f38 expr out #txt
Ts0 f38 320 460 320 500 #arcP
Ts0 f44 actionDecl 'ch.ivy.addon.portalkit.component.TaskItem.TaskItemData out;
' #txt
Ts0 f44 actionTable 'out=in;
' #txt
Ts0 f44 actionCode 'in.canDelegateTask = !(in.securityMemberData.ivyRoles.isEmpty() && in.securityMemberData.ivyUsers.isEmpty());
if(in.canDelegateTask) {
	in.canDelegateTask = true;
	if(in.securityMemberData.ivyRoles.isEmpty()) {
		in.isUserDelegated = true;
	}
	if(in.securityMemberData.ivyUsers.isEmpty()) {
		in.isUserDelegated = false;
	}
}
' #txt
Ts0 f44 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f44 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Check if can delegate task</name>
        <nameStyle>26,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f44 302 564 36 24 20 -2 #rect
Ts0 f44 @|StepIcon #fIcon
Ts0 f53 expr out #txt
Ts0 f53 320 524 320 564 #arcP
Ts0 f19 expr out #txt
Ts0 f19 320 588 320 629 #arcP
Ts0 f54 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f54 processCall MultiPortal/TaskService:setAdditionalProperty(String,String,Long,ch.ivy.addon.portalkit.persistence.domain.Server) #txt
Ts0 f54 doCall true #txt
Ts0 f54 requestActionDecl '<java.lang.String name,java.lang.String value,java.lang.Long taskId,ch.ivy.addon.portalkit.persistence.domain.Server server> param;
' #txt
Ts0 f54 requestMappingAction 'param.name=ch.ivy.addon.portalkit.enums.AdditionalProperty.PORTAL_TASK_CALLBACK_URI.toString();
param.value=in.callbackUrl;
param.taskId=in.selectedTask.id;
param.server=in.selectedTask.#applicationRegister.#server;
' #txt
Ts0 f54 responseActionDecl 'ch.ivy.addon.portalkit.component.TaskItem.TaskItemData out;
' #txt
Ts0 f54 responseMappingAction 'out=in;
' #txt
Ts0 f54 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Set callbackUri to
additional property</name>
        <nameStyle>38
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f54 1222 586 112 44 -50 -20 #rect
Ts0 f54 @|CallSubIcon #fIcon
Ts0 f49 expr out #txt
Ts0 f49 1278 630 1278 692 #arcP
Ts0 f56 actionDecl 'ch.ivy.addon.portalkit.component.TaskItem.TaskItemData out;
' #txt
Ts0 f56 actionTable 'out=in;
' #txt
Ts0 f56 actionCode 'import javax.faces.context.FacesContext;
import ch.ivyteam.ivy.server.ServerFactory;
import ch.ivyteam.ivy.request.RequestUriFactory;
import javax.servlet.http.HttpServletRequest;
import ch.ivy.addon.portalkit.support.UrlDetector;
import ch.ivyteam.ivy.workflow.IProcessStart;
import ch.ivy.addon.portalkit.service.ProcessStartCollector;

ProcessStartCollector collector = new ProcessStartCollector(ivy.wf.getApplication());
java.util.List<IProcessStart> processStarts = collector.findProcessStartRequestPathContainsKeyword("restorePortalTaskList.ivp");
UrlDetector urlDetector = new UrlDetector();
HttpServletRequest request = FacesContext.getCurrentInstance().getExternalContext().getRequest() as HttpServletRequest;
out.callbackUrl = urlDetector.getBaseURLWithoutContextPath(request) + RequestUriFactory.createProcessStartUri(ServerFactory.getServer().getApplicationConfigurationManager(), processStarts.get(0));' #txt
Ts0 f56 security system #txt
Ts0 f56 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f56 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Build callbackUrl</name>
        <nameStyle>17
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f56 1222 498 112 44 -46 -8 #rect
Ts0 f56 @|StepIcon #fIcon
Ts0 f58 expr out #txt
Ts0 f58 1278 339 1278 380 #arcP
Ts0 f57 expr in #txt
Ts0 f57 outCond in.canUserResumeTask #txt
Ts0 f57 1278 470 1278 498 #arcP
Ts0 f55 expr out #txt
Ts0 f55 1278 542 1278 586 #arcP
Ts0 f60 expr out #txt
Ts0 f60 1106 404 1278 498 #arcP
Ts0 f31 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f31 processCall MultiPortal/SideStepProcessStart:findSideStepsByCriteria(ch.ivy.addon.portalkit.persistence.domain.Server,ch.ivy.ws.addon.SideStepSearchCriteria) #txt
Ts0 f31 doCall true #txt
Ts0 f31 requestActionDecl '<ch.ivy.addon.portalkit.persistence.domain.Server server,ch.ivy.ws.addon.SideStepSearchCriteria sideStepSearchCriteria> param;
' #txt
Ts0 f31 requestMappingAction 'param.server=in.selectedTask.applicationRegister.server;
param.sideStepSearchCriteria=in.sideStepSearchCriteria;
' #txt
Ts0 f31 responseActionDecl 'ch.ivy.addon.portalkit.component.TaskItem.TaskItemData out;
' #txt
Ts0 f31 responseMappingAction 'out=in;
out.errors=result.errors;
out.sideSteps=result.sideSteps;
' #txt
Ts0 f31 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>sideStepProcessService</name>
        <nameStyle>22,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f31 1606 506 36 24 20 -2 #rect
Ts0 f31 @|CallSubIcon #fIcon
Ts0 f32 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f32 1611 585 26 26 0 12 #rect
Ts0 f32 @|RichDialogProcessEndIcon #fIcon
Ts0 f36 guid 15C771DC314798D2 #txt
Ts0 f36 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f36 method collectSideSteps(ch.ivy.addon.portalkit.bo.RemoteTask) #txt
Ts0 f36 disableUIEvents false #txt
Ts0 f36 inParameterDecl 'ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent methodEvent = event as ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent;
<ch.ivy.addon.portalkit.bo.RemoteTask task> param = methodEvent.getInputArguments();
' #txt
Ts0 f36 inParameterMapAction 'out.selectedTask=param.task;
' #txt
Ts0 f36 outParameterDecl '<java.util.List<ch.ivy.addon.portalkit.bo.RemoteSideStep> sideSteps> result;
' #txt
Ts0 f36 outParameterMapAction 'result.sideSteps=in.sideSteps;
' #txt
Ts0 f36 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>collectSideSteps(RemoteTask)</name>
        <nameStyle>28,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f36 1611 313 26 26 -85 15 #rect
Ts0 f36 @|RichDialogMethodStartIcon #fIcon
Ts0 f39 actionDecl 'ch.ivy.addon.portalkit.component.TaskItem.TaskItemData out;
' #txt
Ts0 f39 actionTable 'out=in;
' #txt
Ts0 f39 actionCode 'import ch.ivy.ws.addon.SideStepSearchCriteria;
in.sideStepSearchCriteria.setCaseId(in.selectedTask.getCase().getId());
in.sideStepSearchCriteria.setInvolvedUsername(ivy.session.getSessionUserName());
' #txt
Ts0 f39 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f39 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>init criteria</name>
        <nameStyle>13,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f39 1568 400 112 44 -28 -8 #rect
Ts0 f39 @|StepIcon #fIcon
Ts0 f62 expr out #txt
Ts0 f62 1624 444 1624 506 #arcP
Ts0 f63 expr out #txt
Ts0 f63 1624 339 1624 400 #arcP
Ts0 f61 expr out #txt
Ts0 f61 1624 530 1624 585 #arcP
Ts0 f64 guid 15C80D2D06F5658C #txt
Ts0 f64 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f64 method navigateToSidestep(ch.ivy.addon.portalkit.bo.RemoteSideStep,ch.ivy.addon.portalkit.bo.RemoteTask) #txt
Ts0 f64 disableUIEvents false #txt
Ts0 f64 inParameterDecl 'ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent methodEvent = event as ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent;
<ch.ivy.addon.portalkit.bo.RemoteSideStep sidestep,ch.ivy.addon.portalkit.bo.RemoteTask task> param = methodEvent.getInputArguments();
' #txt
Ts0 f64 inActionCode 'import javax.faces.context.FacesContext;

String url = param.sidestep.getStartLink().getAbsoluteEncoded();
if(param.sidestep.isAdhoc) {
	url = url + "?originalTaskId=" + param.task.getId();
}
FacesContext.getCurrentInstance().getExternalContext().redirect(url);' #txt
Ts0 f64 outParameterDecl '<> result;
' #txt
Ts0 f64 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>navigateToSidestep(RemoteSideStep,RemoteTask)</name>
        <nameStyle>45,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f64 1843 307 26 26 -142 15 #rect
Ts0 f64 @|RichDialogMethodStartIcon #fIcon
Ts0 f67 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f67 1843 587 26 26 0 12 #rect
Ts0 f67 @|RichDialogProcessEndIcon #fIcon
Ts0 f65 expr out #txt
Ts0 f65 1856 333 1856 587 #arcP
Ts0 f66 actionDecl 'ch.ivy.addon.portalkit.component.TaskItem.TaskItemData out;
' #txt
Ts0 f66 actionTable 'out=in;
' #txt
Ts0 f66 actionCode 'import ch.ivy.addon.portalkit.persistence.variable.GlobalVariable;
import ch.ivy.addon.portalkit.service.GlobalSettingService;
GlobalSettingService service = new GlobalSettingService();

String isShowTaskButtonLabels =  service.findGlobalSettingValue(GlobalVariable.SHOW_TASK_BUTTON_LABELS);

if(isShowTaskButtonLabels != null && !isShowTaskButtonLabels.isEmpty()){
	in.isShowTaskButtonLabels = Boolean.parseBoolean(isShowTaskButtonLabels);
} else{
	in.isShowTaskButtonLabels = false;	
}
' #txt
Ts0 f66 type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
Ts0 f66 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Init show/hide
buttons</name>
        <nameStyle>22
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f66 41 142 36 24 20 -2 #rect
Ts0 f66 @|StepIcon #fIcon
Ts0 f2 expr out #txt
Ts0 f2 59 99 59 142 #arcP
Ts0 f68 expr out #txt
Ts0 f68 59 166 59 213 #arcP
>Proto Ts0 .type ch.ivy.addon.portalkit.component.TaskItem.TaskItemData #txt
>Proto Ts0 .processKind HTML_DIALOG #txt
>Proto Ts0 -8 -8 16 16 16 26 #rect
>Proto Ts0 '' #fIcon
Ts0 f27 mainOut f34 tail #connect
Ts0 f34 head f29 mainIn #connect
Ts0 f29 mainOut f48 tail #connect
Ts0 f48 head f28 mainIn #connect
Ts0 f8 mainOut f11 tail #connect
Ts0 f11 head f23 mainIn #connect
Ts0 f12 mainOut f24 tail #connect
Ts0 f24 head f20 mainIn #connect
Ts0 f23 mainOut f25 tail #connect
Ts0 f25 head f7 mainIn #connect
Ts0 f7 mainOut f41 tail #connect
Ts0 f41 head f40 in #connect
Ts0 f43 head f26 mainIn #connect
Ts0 f20 mainOut f52 tail #connect
Ts0 f52 head f51 mainIn #connect
Ts0 f16 mainOut f9 tail #connect
Ts0 f9 head f6 mainIn #connect
Ts0 f6 mainOut f18 tail #connect
Ts0 f18 head f17 mainIn #connect
Ts0 f87 mainOut f103 tail #connect
Ts0 f103 head f102 mainIn #connect
Ts0 f47 mainOut f50 tail #connect
Ts0 f50 head f46 mainIn #connect
Ts0 f73 mainOut f78 tail #connect
Ts0 f78 head f77 in #connect
Ts0 f80 head f79 mainIn #connect
Ts0 f79 mainOut f81 tail #connect
Ts0 f81 head f46 mainIn #connect
Ts0 f21 mainOut f4 tail #connect
Ts0 f4 head f3 mainIn #connect
Ts0 f3 mainOut f5 tail #connect
Ts0 f5 head f22 mainIn #connect
Ts0 f30 mainOut f35 tail #connect
Ts0 f35 head f33 mainIn #connect
Ts0 f102 mainOut f71 tail #connect
Ts0 f71 head f92 mainIn #connect
Ts0 f72 mainOut f10 tail #connect
Ts0 f10 head f8 mainIn #connect
Ts0 f75 out f74 tail #connect
Ts0 f74 head f72 mainIn #connect
Ts0 f75 out f83 tail #connect
Ts0 f83 head f8 mainIn #connect
Ts0 f14 mainOut f85 tail #connect
Ts0 f85 head f84 mainIn #connect
Ts0 f84 mainOut f82 tail #connect
Ts0 f82 head f75 in #connect
Ts0 f86 mainOut f90 tail #connect
Ts0 f90 head f88 mainIn #connect
Ts0 f88 mainOut f91 tail #connect
Ts0 f91 head f89 mainIn #connect
Ts0 f40 out f93 tail #connect
Ts0 f93 head f86 mainIn #connect
Ts0 f40 out f43 tail #connect
Ts0 f26 mainOut f42 tail #connect
Ts0 f42 head f86 mainIn #connect
Ts0 f89 mainOut f59 tail #connect
Ts0 f59 head f15 mainIn #connect
Ts0 f51 mainOut f38 tail #connect
Ts0 f38 head f37 mainIn #connect
Ts0 f37 mainOut f53 tail #connect
Ts0 f53 head f44 mainIn #connect
Ts0 f44 mainOut f19 tail #connect
Ts0 f19 head f13 mainIn #connect
Ts0 f54 mainOut f49 tail #connect
Ts0 f49 head f47 mainIn #connect
Ts0 f45 mainOut f58 tail #connect
Ts0 f58 head f73 mainIn #connect
Ts0 f77 out f57 tail #connect
Ts0 f57 head f56 mainIn #connect
Ts0 f77 out f80 tail #connect
Ts0 f56 mainOut f55 tail #connect
Ts0 f55 head f54 mainIn #connect
Ts0 f33 mainOut f60 tail #connect
Ts0 f60 head f56 mainIn #connect
Ts0 f31 mainOut f61 tail #connect
Ts0 f61 head f32 mainIn #connect
Ts0 f36 mainOut f63 tail #connect
Ts0 f63 head f39 mainIn #connect
Ts0 f39 mainOut f62 tail #connect
Ts0 f62 head f31 mainIn #connect
Ts0 f64 mainOut f65 tail #connect
Ts0 f65 head f67 mainIn #connect
Ts0 f0 mainOut f2 tail #connect
Ts0 f2 head f66 mainIn #connect
Ts0 f66 mainOut f68 tail #connect
Ts0 f68 head f1 mainIn #connect
