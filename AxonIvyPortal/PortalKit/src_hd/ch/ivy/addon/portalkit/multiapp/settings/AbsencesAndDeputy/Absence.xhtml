<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:f="http://xmlns.jcp.org/jsf/core" xmlns:h="http://xmlns.jcp.org/jsf/html"
  xmlns:ui="http://xmlns.jcp.org/jsf/facelets" xmlns:ic="http://ivyteam.ch/jsf/component"
  xmlns:p="http://primefaces.org/ui" xmlns:pe="http://primefaces.org/ui/extensions">

<ui:composition>
  <div id="absence-panel-grid" class="ui-fluid ui-g absence-panel-grid">
    <h:panelGroup layout="block" styleClass="ui-g-12" rendered="#{data.isSupervisor}">
      <div class="md-inputfield">
        <p:autoComplete scrollHeight="200" dropdown="true" id="username" 
          completeMethod="#{logic.autoCompleteForUser}"
          value="#{data.selectedUserDTO}"
          var="user" itemValue="#{user}" itemLabel="#{user.displayName}"
          converter="pojoConverter"
          disabled="#{uneditedUserName ne 'false'}" required="true"
          cache="true" maxResults="100"
          requiredMessage="#{ivy.cms.co('/ch.ivy.addon.portalkit.ui.jsf/AbsenceAndDeputy/Messages/userNameRequired')}"
          moreText="#{component.suggestions.size() - component.maxResults} #{ivy.cms.co('/ch.ivy.addon.portalkit.ui.jsf/common/more')}...">
          <f:event listener="#{logic.loadUsers}" type="preRenderComponent" />
          <p:ajax event="query" global="false" />
          <p:ajax event="itemSelect" listener="#{logic.userSelectInAbsence}"
            process="@this comment absence-start-date absence-end-date" update="#{updateComponent}" />
        </p:autoComplete>
        <p:outputLabel for="username" value="#{ivy.cms.co('/ch.ivy.addon.portalkit.ui.jsf/login/username')}" />
      </div>
    </h:panelGroup>
    
    <div class="ui-g-5 ui-sm-12">
      <div class="md-inputfield">
        <p:calendar id="absence-start-date" value="#{data.selectedAbsence.from}" locale="#{localeBean.locale}"
          showOn="button"
          converterMessage="#{ivy.cms.co('/ch.ivy.addon.portalkit.ui.jsf/common/wrongDateFormat')}"
          pattern="#{dateTimePatternBean.datePattern}" required="true"
          requiredMessage="#{ivy.cms.co('/ch.ivy.addon.portalkit.ui.jsf/common/dateRequired')}">
          <p:ajax event="dateSelect" listener="#{logic.dateChange}" process="@this username absence-start-date comment"
            update="#{updateComponent}" />
        </p:calendar>
        <h:outputLabel for="absence-start-date" value="#{ivy.cms.co('/ch.ivy.addon.portalkit.ui.jsf/AbsenceAndDeputy/from')}:" />
      </div>
    </div>
    <div class="ui-g-2 ui-sm-hidden" />
    <div class="ui-g-5 ui-sm-12">
      <div class="md-inputfield">
        <p:calendar id="absence-end-date" value="#{data.selectedAbsence.until}" showOn="button" locale="#{localeBean.locale}"
          converterMessage="#{ivy.cms.co('/ch.ivy.addon.portalkit.ui.jsf/common/wrongDateFormat')}"
          pattern="#{dateTimePatternBean.datePattern}" required="true"
          requiredMessage="#{ivy.cms.co('/ch.ivy.addon.portalkit.ui.jsf/common/dateRequired')}">
          <p:ajax event="dateSelect" listener="#{logic.dateChange}" process="@this username comment absence-start-date"
            update="#{updateComponent}" />
        </p:calendar>
        <h:outputLabel for="absence-end-date" value="#{ivy.cms.co('/ch.ivy.addon.portalkit.ui.jsf/AbsenceAndDeputy/till')}:" />
      </div>
    </div>

    <div class="ui-g-12">
      <div class="md-inputfield">
        <p:inputText value="#{data.selectedAbsence.comment}" maxlength="100" id="comment"
          styleClass="add-absences-dialog-input-comment" />
        <p:outputLabel for="comment" value="#{ivy.cms.co('/ch.ivy.addon.portalkit.ui.jsf/common/comment')}:" />
      </div>
    </div>
  </div>
</ui:composition>
</html>