<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:f="http://xmlns.jcp.org/jsf/core"
  xmlns:h="http://xmlns.jcp.org/jsf/html" xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
  xmlns:cc="http://xmlns.jcp.org/jsf/composite" xmlns:ic="http://ivyteam.ch/jsf/component"
  xmlns:p="http://primefaces.org/ui" xmlns:pe="http://primefaces.org/ui/extensions"
  xmlns:c="http://java.sun.com/jsp/jstl/core">

<cc:interface componentType="IvyComponent">
  <cc:attribute name="dialogName" shortDescription="Name of setting dialog's widget that contains this component" />
</cc:interface>

<cc:implementation>
  <f:event listener="#{logic.findUserLanguages()}" type="preRenderComponent" />

  <div id="#{cc.clientId}">
    <h:panelGroup id="setting-grid" layout="block">
      <p:messages id="errors-message" severity="error" showDetail="true" escape="false"
        closable="true" />
      <p:dataTable id="language-setting-table" value="#{data.languages}" var="ivyLanguage" styleClass="language-table" reflow="true">
        <p:column headerText="#{ivy.cms.co('/ch.ivy.addon.portalkit.ui.jsf/languageSetting/application')}">
          <p:outputLabel id="application-name" styleClass="TexAlLeft" value="#{ivyLanguage.appDisplayName}" />
        </p:column>

        <p:column headerText="#{ivy.cms.co('/ch.ivy.addon.portalkit.ui.jsf/languageSetting/language')}">
          <p:selectOneMenu id="langauges-selection" value="#{ivyLanguage.userLanguage}">
            <f:selectItems value="#{ivyLanguage.getLanguages()}" />
          </p:selectOneMenu>
        </p:column>
      </p:dataTable>
    </h:panelGroup>
    
    <h:panelGroup layout="block" styleClass="ui-dialog-footer u-dialog-footer">
      <p:commandButton id="save-settings" value="#{ivy.cms.co('/ch.ivy.addon.portalkit.ui.jsf/common/save')}"
        actionListener="#{logic.saveUserLanguages}" update="errors-message"
        oncomplete="if (args &amp;&amp; !args.validationFailed) { reloadMenuItem();}"/>
      <p:spacer width="5px" />
      <p:commandButton id="cancel-settings" value="#{ivy.cms.co('/ch.ivy.addon.portalkit.ui.jsf/common/cancel')}"
        onclick="PF('#{cc.attrs.dialogName}').hide()" type="button" styleClass="portal-cancel-button" />
    </h:panelGroup>
  </div>
</cc:implementation>

</html>
