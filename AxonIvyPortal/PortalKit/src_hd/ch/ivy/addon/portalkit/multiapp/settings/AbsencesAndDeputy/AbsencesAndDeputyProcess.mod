[Ivy]
[>Created: Wed Nov 02 17:15:10 ICT 2016]
14C30066460AD7AA 3.18 #module
>Proto >Proto Collection #zClass
As0 AbsencesAndDeputyProcess Big #zClass
As0 RD #cInfo
As0 #process
As0 @TextInP .ui2RdDataAction .ui2RdDataAction #zField
As0 @TextInP .rdData2UIAction .rdData2UIAction #zField
As0 @TextInP .resExport .resExport #zField
As0 @TextInP .type .type #zField
As0 @TextInP .processKind .processKind #zField
As0 @AnnotationInP-0n ai ai #zField
As0 @TextInP .xml .xml #zField
As0 @TextInP .responsibility .responsibility #zField
As0 @RichDialogProcessStart f5 '' #zField
As0 @RichDialogProcessEnd f6 '' #zField
As0 @GridStep f13 '' #zField
As0 @PushWFArc f14 '' #zField
As0 @PushWFArc f7 '' #zField
As0 @RichDialogMethodStart f30 '' #zField
As0 @RichDialogProcessEnd f31 '' #zField
As0 @RichDialogProcessStart f25 '' #zField
As0 @PushWFArc f23 '' #zField
As0 @RichDialogProcessStart f40 '' #zField
As0 @CallSub f28 '' #zField
As0 @CallSub f26 '' #zField
As0 @RichDialogInitStart f0 '' #zField
As0 @GridStep f4 '' #zField
As0 @PushWFArc f48 '' #zField
As0 @CallSub f49 '' #zField
As0 @PushWFArc f50 '' #zField
As0 @RichDialogProcessStart f44 '' #zField
As0 @RichDialogProcessEnd f55 '' #zField
As0 @RichDialogProcessStart f46 '' #zField
As0 @RichDialogProcessEnd f80 '' #zField
As0 @GridStep f82 '' #zField
As0 @PushWFArc f83 '' #zField
As0 @PushWFArc f47 '' #zField
As0 @RichDialogProcessEnd f1 '' #zField
As0 @GridStep f3 '' #zField
As0 @RichDialogProcessStart f79 '' #zField
As0 @GridStep f59 '' #zField
As0 @PushWFArc f62 '' #zField
As0 @RichDialogMethodStart f11 '' #zField
As0 @RichDialogProcessEnd f12 '' #zField
As0 @GridStep f36 '' #zField
As0 @PushWFArc f35 '' #zField
As0 @RichDialogProcessStart f38 '' #zField
As0 @RichDialogProcessEnd f39 '' #zField
As0 @GridStep f61 '' #zField
As0 @PushWFArc f63 '' #zField
As0 @PushWFArc f64 '' #zField
As0 @RichDialogProcessStart f87 '' #zField
As0 @RichDialogProcessEnd f88 '' #zField
As0 @GridStep f89 '' #zField
As0 @PushWFArc f90 '' #zField
As0 @PushWFArc f91 '' #zField
As0 @PushWFArc f37 '' #zField
As0 @RichDialogMethodStart f106 '' #zField
As0 @GridStep f97 '' #zField
As0 @CallSub f95 '' #zField
As0 @RichDialogProcessEnd f93 '' #zField
As0 @PushWFArc f98 '' #zField
As0 @PushWFArc f94 '' #zField
As0 @RichDialogMethodStart f104 '' #zField
As0 @Alternative f105 '' #zField
As0 @PushWFArc f96 '' #zField
As0 @CallSub f110 '' #zField
As0 @PushWFArc f19 '' #zField
As0 @RichDialogMethodStart f65 '' #zField
As0 @RichDialogProcessEnd f66 '' #zField
As0 @CallSub f24 '' #zField
As0 @RichDialogProcessStart f20 '' #zField
As0 @RichDialogProcessEnd f21 '' #zField
As0 @CallSub f45 '' #zField
As0 @PushWFArc f67 '' #zField
As0 @RichDialogProcessStart f68 '' #zField
As0 @CallSub f72 '' #zField
As0 @GridStep f71 '' #zField
As0 @PushWFArc f73 '' #zField
As0 @PushWFArc f51 '' #zField
As0 @PushWFArc f75 '' #zField
As0 @PushWFArc f107 '' #zField
As0 @PushWFArc f100 '' #zField
As0 @Alternative f99 '' #zField
As0 @PushWFArc f92 '' #zField
As0 @PushWFArc f101 '' #zField
As0 @GridStep f43 '' #zField
As0 @GridStep f76 '' #zField
As0 @PushWFArc f77 '' #zField
As0 @GridStep f54 '' #zField
As0 @PushWFArc f56 '' #zField
As0 @PushWFArc f57 '' #zField
As0 @Alternative f78 '' #zField
As0 @CallSub f85 '' #zField
As0 @PushWFArc f86 '' #zField
As0 @PushWFArc f2 '' #zField
As0 @GridStep f108 '' #zField
As0 @PushWFArc f109 '' #zField
As0 @PushWFArc f103 '' #zField
As0 @PushWFArc f15 '' #zField
As0 @GridStep f102 '' #zField
As0 @GridStep f34 '' #zField
As0 @PushWFArc f70 '' #zField
As0 @PushWFArc f74 '' #zField
As0 @GridStep f112 '' #zField
As0 @Alternative f114 '' #zField
As0 @PushWFArc f115 '' #zField
As0 @PushWFArc f111 '' #zField
As0 @CallSub f116 '' #zField
As0 @PushWFArc f117 '' #zField
As0 @Alternative f119 '' #zField
As0 @PushWFArc f120 '' #zField
As0 @PushWFArc f29 '' #zField
As0 @RichDialogProcessEnd f118 '' #zField
As0 @PushWFArc f121 '' #zField
As0 @PushWFArc f32 '' #zField
As0 @PushWFArc f33 '' #zField
As0 @RichDialogProcessStart f52 '' #zField
As0 @RichDialogProcessStart f84 '' #zField
As0 @Alternative f123 '' #zField
As0 @PushWFArc f124 '' #zField
As0 @PushWFArc f22 '' #zField
As0 @PushWFArc f125 '' #zField
As0 @Alternative f9 '' #zField
As0 @PushWFArc f10 '' #zField
As0 @PushWFArc f41 '' #zField
As0 @PushWFArc f42 '' #zField
As0 @Alternative f8 '' #zField
As0 @PushWFArc f58 '' #zField
As0 @PushWFArc f60 '' #zField
As0 @PushWFArc f81 '' #zField
As0 @PushWFArc f113 '' #zField
As0 @RichDialogMethodStart f69 '' #zField
As0 @RichDialogProcessEnd f126 '' #zField
As0 @PushWFArc f127 '' #zField
As0 @GridStep f128 '' #zField
As0 @PushWFArc f129 '' #zField
As0 @PushWFArc f53 '' #zField
As0 @RichDialogMethodStart f130 '' #zField
As0 @RichDialogProcessEnd f131 '' #zField
As0 @GridStep f133 '' #zField
As0 @PushWFArc f134 '' #zField
As0 @PushWFArc f132 '' #zField
As0 @GridStep f135 '' #zField
As0 @PushWFArc f136 '' #zField
As0 @PushWFArc f122 '' #zField
As0 @RichDialogMethodStart f137 '' #zField
As0 @RichDialogProcessEnd f138 '' #zField
As0 @PushWFArc f139 '' #zField
As0 @GridStep f140 '' #zField
As0 @PushWFArc f141 '' #zField
As0 @PushWFArc f27 '' #zField
>Proto As0 As0 AbsencesAndDeputyProcess #zField
As0 f5 guid 14BD99040C72C9E8 #txt
As0 f5 type ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData #txt
As0 f5 actionDecl 'ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData out;
' #txt
As0 f5 actionTable 'out=in;
out.isLoadDeputy=false;
' #txt
As0 f5 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>add</name>
        <nameStyle>3,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
As0 f5 254 54 20 20 -8 -31 #rect
As0 f5 @|RichDialogProcessStartIcon #fIcon
As0 f6 type ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData #txt
As0 f6 254 182 20 20 13 0 #rect
As0 f6 @|RichDialogProcessEndIcon #fIcon
As0 f13 actionDecl 'ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData out;
' #txt
As0 f13 actionTable 'out=in;
' #txt
As0 f13 actionCode 'import ch.ivy.addon.portalkit.bo.RemoteUser;
import ch.ivyteam.ivy.security.IUser;
import ch.ivy.addon.portalkit.bo.RemoteAbsence;

in.selectedAbsence = new RemoteAbsence();
in.selectedAbsence.startDateInclusive = new Date();
in.selectedAbsence.stopDateInclusive = new Date();
in.selectedUser = new RemoteUser();

in.userName = ivy.session.getSessionUserName();
in.validationError = false;' #txt
As0 f13 type ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData #txt
As0 f13 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>init</name>
        <nameStyle>4,7
</nameStyle>
    </language>
</elementInfo>
' #txt
As0 f13 246 116 36 24 20 -2 #rect
As0 f13 @|StepIcon #fIcon
As0 f14 expr out #txt
As0 f14 264 74 264 116 #arcP
As0 f7 expr out #txt
As0 f7 264 140 264 182 #arcP
As0 f30 guid 14BDEFA2A2FEF1A7 #txt
As0 f30 type ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData #txt
As0 f30 method preDelete(ch.ivy.addon.portalkit.bo.RemoteAbsence) #txt
As0 f30 disableUIEvents false #txt
As0 f30 inParameterDecl 'ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent methodEvent = event as ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent;
<ch.ivy.addon.portalkit.bo.RemoteAbsence selectedAbsence> param = methodEvent.getInputArguments();
' #txt
As0 f30 inParameterMapAction 'out.selectedAbsence=param.selectedAbsence;
out.userName=param.selectedAbsence.userName;
' #txt
As0 f30 outParameterDecl '<> result;
' #txt
As0 f30 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>preDelete(RemoteAbsence)</name>
        <nameStyle>24,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
As0 f30 2078 54 20 20 -67 -29 #rect
As0 f30 @|RichDialogMethodStartIcon #fIcon
As0 f31 type ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData #txt
As0 f31 2078 182 20 20 13 0 #rect
As0 f31 @|RichDialogProcessEndIcon #fIcon
As0 f25 guid 14BDEFE07C0AC3B2 #txt
As0 f25 type ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData #txt
As0 f25 actionDecl 'ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData out;
' #txt
As0 f25 actionTable 'out=in;
' #txt
As0 f25 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>deleteAbsence</name>
        <nameStyle>13,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
As0 f25 1190 54 20 20 -31 -30 #rect
As0 f25 @|RichDialogProcessStartIcon #fIcon
As0 f23 expr out #txt
As0 f23 2088 74 2088 182 #arcP
As0 f40 guid 14BE2BD81E88ABD8 #txt
As0 f40 type ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData #txt
As0 f40 actionDecl 'ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData out;
' #txt
As0 f40 actionTable 'out=in;
' #txt
As0 f40 actionCode 'import ch.ivy.addon.portalkit.util.Dates;

in.selectedAbsence.userName = in.userName;
java.util.Date endOfDate = Dates.toEndOfDate(in.selectedAbsence.getStopDateInclusive());
in.selectedAbsence.setStopDateInclusive(endOfDate);
in.absences.add(in.selectedAbsence);' #txt
As0 f40 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>saveNewAbsence</name>
        <nameStyle>14,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
As0 f40 1606 54 20 20 -38 -32 #rect
As0 f40 @|RichDialogProcessStartIcon #fIcon
As0 f28 type ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData #txt
As0 f28 processCall MultiPortal/AbsenceService:setAbsence(List<ch.ivy.addon.portalkit.bo.RemoteAbsence>,String) #txt
As0 f28 doCall true #txt
As0 f28 requestActionDecl '<List<ch.ivy.addon.portalkit.bo.RemoteAbsence> absences,java.lang.String user> param;
' #txt
As0 f28 requestMappingAction 'param.absences=in.absencesToUpdate;
param.user=in.userName;
' #txt
As0 f28 responseActionDecl 'ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData out;
' #txt
As0 f28 responseMappingAction 'out=in;
' #txt
As0 f28 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>set
Absence
</name>
        <nameStyle>12,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
As0 f28 1598 132 36 24 -69 -18 #rect
As0 f28 @|CallSubIcon #fIcon
As0 f26 type ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData #txt
As0 f26 processCall MultiPortal/AbsenceService:getAbsences(String) #txt
As0 f26 doCall true #txt
As0 f26 requestActionDecl '<java.lang.String user> param;
' #txt
As0 f26 requestMappingAction 'param.user=in.userName;
' #txt
As0 f26 responseActionDecl 'ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData out;
' #txt
As0 f26 responseMappingAction 'out=in;
out.absences=result.remoteAbsences;
out.absencesApplications=result.serverApplications;
out.errors=result.errors;
' #txt
As0 f26 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>getAbsences(String)</name>
        <nameStyle>19,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
As0 f26 1702 372 36 24 31 -9 #rect
As0 f26 @|CallSubIcon #fIcon
As0 f0 guid 14BCA2A676E3FE98 #txt
As0 f0 type ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData #txt
As0 f0 method start() #txt
As0 f0 disableUIEvents true #txt
As0 f0 inParameterDecl 'ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent methodEvent = event as ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent;
<> param = methodEvent.getInputArguments();
' #txt
As0 f0 outParameterDecl '<> result;
' #txt
As0 f0 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>start()</name>
        <nameStyle>7,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
As0 f0 86 54 20 20 -16 -30 #rect
As0 f0 @|RichDialogInitStartIcon #fIcon
As0 f4 actionDecl 'ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData out;
' #txt
As0 f4 actionTable 'out=in;
' #txt
As0 f4 actionCode 'import ch.ivy.addon.portalkit.util.AbsenceAndSubstituteUtils;
in.substitutes = AbsenceAndSubstituteUtils.convertToSubstitueList(in.substituteRoot);' #txt
As0 f4 type ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData #txt
As0 f4 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Convert
Subtitues</name>
        <nameStyle>17,7
</nameStyle>
    </language>
</elementInfo>
' #txt
As0 f4 1598 180 36 24 -71 -15 #rect
As0 f4 @|StepIcon #fIcon
As0 f48 expr out #txt
As0 f48 1616 156 1616 180 #arcP
As0 f49 type ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData #txt
As0 f49 processCall MultiPortal/SubstituteService:setSubstitutes(List<ch.ivy.addon.portalkit.bo.RemoteSubstitute>,String) #txt
As0 f49 doCall true #txt
As0 f49 requestActionDecl '<List<ch.ivy.addon.portalkit.bo.RemoteSubstitute> substitutes,java.lang.String user> param;
' #txt
As0 f49 requestMappingAction 'param.substitutes=in.substitutes;
param.user=in.userName;
' #txt
As0 f49 responseActionDecl 'ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData out;
' #txt
As0 f49 responseMappingAction 'out=in;
' #txt
As0 f49 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>setSubstitutes</name>
        <nameStyle>14,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
As0 f49 1598 220 36 24 20 -2 #rect
As0 f49 @|CallSubIcon #fIcon
As0 f50 expr out #txt
As0 f50 1616 204 1616 220 #arcP
As0 f44 guid 14BE93810075AD3E #txt
As0 f44 type ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData #txt
As0 f44 actionDecl 'ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData out;
' #txt
As0 f44 actionTable 'out=in;
' #txt
As0 f44 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>fromChange</name>
        <nameStyle>10,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
As0 f44 350 54 20 20 -32 -31 #rect
As0 f44 @|RichDialogProcessStartIcon #fIcon
As0 f55 type ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData #txt
As0 f55 462 182 20 20 13 0 #rect
As0 f55 @|RichDialogProcessEndIcon #fIcon
As0 f46 guid 14BE9654229ECCAB #txt
As0 f46 type ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData #txt
As0 f46 actionDecl 'ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData out;
' #txt
As0 f46 actionTable 'out=in;
' #txt
As0 f46 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>tillChange</name>
        <nameStyle>10,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
As0 f46 462 54 20 20 -24 -30 #rect
As0 f46 @|RichDialogProcessStartIcon #fIcon
As0 f80 type ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData #txt
As0 f80 86 183 20 18 13 0 #rect
As0 f80 @|RichDialogProcessEndIcon #fIcon
As0 f82 actionDecl 'ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData out;
' #txt
As0 f82 actionTable 'out=in;
' #txt
As0 f82 actionCode 'import ch.ivy.addon.portalkit.service.PermissionCheckerService;
import ch.ivyteam.ivy.security.IPermission;
import ch.ivyteam.ivy.security.ISecurityDescriptor;
import ch.ivyteam.ivy.security.IRole;
import org.primefaces.model.DefaultTreeNode;

in.substituteRoot = new DefaultTreeNode();
in.userName = ivy.session.getSessionUserName();
in.userFullName = ivy.session.getSessionUser().getFullName();

PermissionCheckerService permissionChecker = new PermissionCheckerService();
in.isSupervisor = permissionChecker.hasAllPermissions(IPermission.USER_CREATE_ABSENCE, IPermission.USER_READ_ABSENCES, IPermission.USER_DELETE_ABSENCE);' #txt
As0 f82 type ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData #txt
As0 f82 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Init</name>
        <nameStyle>4,7
</nameStyle>
    </language>
</elementInfo>
' #txt
As0 f82 78 116 36 25 20 -2 #rect
As0 f82 @|StepIcon #fIcon
As0 f83 expr out #txt
As0 f83 96 74 96 115 #arcP
As0 f83 0 0.6482391981034313 0 0 #arcLabel
As0 f47 expr out #txt
As0 f47 1616 531 1616 558 #arcP
As0 f1 type ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData #txt
As0 f1 1606 558 20 20 13 0 #rect
As0 f1 @|RichDialogProcessEndIcon #fIcon
As0 f3 actionDecl 'ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData out;
' #txt
As0 f3 actionTable 'out=in;
' #txt
As0 f3 actionCode 'import javax.faces.application.FacesMessage;
import javax.faces.context.FacesContext;
import ch.ivy.addon.portalkit.util.AbsenceAndSubstituteUtils;
import ch.ivy.addon.portalkit.bo.RemoteAbsence;

//absences:
List<RemoteAbsence> mergedAbsences = AbsenceAndSubstituteUtils.mergeRemoteAbsenceListInApplications(in.absences);
AbsenceAndSubstituteUtils.checkSameAbsencesInApplications(in.absencesApplications, in.absences, mergedAbsences);
in.absences = mergedAbsences;

//Create error message
if(in.errors.size()>0){
	in.errorLink = ivy.cms.co("/ch.ivy.addon.portalkit.ui.jsf/common/found") + in.errors.size() + ivy.cms.co("/ch.ivy.addon.portalkit.ui.jsf/common/clickToShowDetail");
	FacesContext.getCurrentInstance().addMessage(null, new FacesMessage(FacesMessage.SEVERITY_ERROR, ivy.cms.co("/ch.ivy.addon.portalkit.ui.jsf/common/errorNotification"), "<span style=\"cursor:pointer\"><a onclick=\"PF(''errorDialogSubstitue'').show(); hideGrowl()\">"+in.errorLink+"</a></span>"));
	FacesContext.getCurrentInstance().validationFailed();
}' #txt
As0 f3 type ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData #txt
As0 f3 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>process data 
And build tree</name>
        <nameStyle>13,7
15,7
</nameStyle>
    </language>
</elementInfo>
' #txt
As0 f3 1598 509 36 22 -103 -19 #rect
As0 f3 @|StepIcon #fIcon
As0 f79 guid 14BED2D7A7D359D6 #txt
As0 f79 type ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData #txt
As0 f79 actionDecl 'ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData out;
' #txt
As0 f79 actionTable 'out=in;
' #txt
As0 f79 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>openAbsence</name>
        <nameStyle>11,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
As0 f79 1447 55 19 18 -35 -31 #rect
As0 f79 @|RichDialogProcessStartIcon #fIcon
As0 f59 actionDecl 'ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData out;
' #txt
As0 f59 actionTable 'out=in;
' #txt
As0 f59 actionCode 'import javax.faces.application.FacesMessage;
import javax.faces.context.FacesContext;

//Create error message
if(in.errors.size()>0){
		FacesContext.getCurrentInstance().addMessage(null, new FacesMessage(FacesMessage.SEVERITY_INFO, ivy.cms.co("/ch.ivy.addon.portalkit.ui.jsf/common/note"), ivy.cms.co("/ch.ivy.addon.portalkit.ui.jsf/AbsenceAndDeputy/Messages/errorAbsenceSavingWS")));
	  FacesContext.getCurrentInstance().validationFailed();
}' #txt
As0 f59 type ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData #txt
As0 f59 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Set message</name>
        <nameStyle>11,7
</nameStyle>
    </language>
</elementInfo>
' #txt
As0 f59 1598 260 36 24 20 -2 #rect
As0 f59 @|StepIcon #fIcon
As0 f62 expr out #txt
As0 f62 1616 244 1616 260 #arcP
As0 f11 guid 14BFE0B2A28FD6B2 #txt
As0 f11 type ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData #txt
As0 f11 method editAbsence(ch.ivy.addon.portalkit.bo.RemoteAbsence) #txt
As0 f11 disableUIEvents false #txt
As0 f11 inParameterDecl 'ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent methodEvent = event as ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent;
<ch.ivy.addon.portalkit.bo.RemoteAbsence selectedAbsence> param = methodEvent.getInputArguments();
' #txt
As0 f11 inParameterMapAction 'out.isLoadDeputy=false;
out.selectedAbsence=param.selectedAbsence;
' #txt
As0 f11 outParameterDecl '<> result;
' #txt
As0 f11 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>editAbsence(RemoteAbsence)</name>
        <nameStyle>26,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
As0 f11 2246 54 20 20 -69 -28 #rect
As0 f11 @|RichDialogMethodStartIcon #fIcon
As0 f12 type ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData #txt
As0 f12 2246 182 20 20 13 0 #rect
As0 f12 @|RichDialogProcessEndIcon #fIcon
As0 f36 actionDecl 'ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData out;
' #txt
As0 f36 actionTable 'out=in;
' #txt
As0 f36 actionCode 'in.userName = in.selectedAbsence.userName;
in.userFullName = in.selectedAbsence.userFullName;
in.validationError = false;
// set backup object
in.backupAbsence.setAppName(in.selectedAbsence.getAppName());
in.backupAbsence.setDescription(in.selectedAbsence.getDescription());
in.backupAbsence.setStartDateInclusive(in.selectedAbsence.getStartDateInclusive());
in.backupAbsence.setStopDateInclusive(in.selectedAbsence.getStopDateInclusive());
in.backupAbsence.setUserName(in.selectedAbsence.getUserName());
' #txt
As0 f36 type ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData #txt
As0 f36 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>preparing data</name>
        <nameStyle>14,7
</nameStyle>
    </language>
</elementInfo>
' #txt
As0 f36 2238 124 36 24 20 -2 #rect
As0 f36 @|StepIcon #fIcon
As0 f35 expr out #txt
As0 f35 2256 148 2256 182 #arcP
As0 f38 guid 14C9C21073258313 #txt
As0 f38 type ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData #txt
As0 f38 actionDecl 'ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData out;
' #txt
As0 f38 actionTable 'out=in;
' #txt
As0 f38 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>cancel</name>
        <nameStyle>6,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
As0 f38 886 54 21 20 -21 -31 #rect
As0 f38 @|RichDialogProcessStartIcon #fIcon
As0 f39 type ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData #txt
As0 f39 886 182 20 20 13 0 #rect
As0 f39 @|RichDialogProcessEndIcon #fIcon
As0 f61 actionDecl 'ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData out;
' #txt
As0 f61 actionTable 'out=in;
' #txt
As0 f61 actionCode '//restore backup
in.selectedAbsence.setAppName(in.backupAbsence.getAppName());
in.selectedAbsence.setDescription(in.backupAbsence.getDescription());
in.selectedAbsence.setStartDateInclusive(in.backupAbsence.getStartDateInclusive());
in.selectedAbsence.setStopDateInclusive(in.backupAbsence.getStopDateInclusive());
' #txt
As0 f61 type ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData #txt
As0 f61 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>reset</name>
        <nameStyle>5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
As0 f61 878 116 36 24 20 -2 #rect
As0 f61 @|StepIcon #fIcon
As0 f63 expr out #txt
As0 f63 895 73 896 116 #arcP
As0 f64 expr out #txt
As0 f64 896 140 896 182 #arcP
As0 f87 guid 14D51452D7C1F78A #txt
As0 f87 type ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData #txt
As0 f87 actionDecl 'ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData out;
' #txt
As0 f87 actionTable 'out=in;
' #txt
As0 f87 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>updateGrowlAbsence</name>
        <nameStyle>18,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
As0 f87 718 54 20 20 -55 -31 #rect
As0 f87 @|RichDialogProcessStartIcon #fIcon
As0 f88 type ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData #txt
As0 f88 718 182 20 20 13 0 #rect
As0 f88 @|RichDialogProcessEndIcon #fIcon
As0 f89 actionDecl 'ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData out;
' #txt
As0 f89 actionTable 'out=in;
' #txt
As0 f89 actionCode 'import javax.faces.application.FacesMessage;
import javax.faces.context.FacesContext;

FacesContext.getCurrentInstance().addMessage(null,new FacesMessage(FacesMessage.SEVERITY_INFO,ivy.cms.co("/ch.ivy.addon.portalkit.ui.jsf/common/information") , ivy.cms.co("/ch.ivy.addon.portalkit.ui.jsf/common/saveSuccessfully")));' #txt
As0 f89 type ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData #txt
As0 f89 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>add msg</name>
        <nameStyle>7,7
</nameStyle>
    </language>
</elementInfo>
' #txt
As0 f89 710 116 36 24 20 -2 #rect
As0 f89 @|StepIcon #fIcon
As0 f90 expr out #txt
As0 f90 728 74 728 116 #arcP
As0 f91 expr out #txt
As0 f91 728 140 728 182 #arcP
As0 f37 expr out #txt
As0 f37 2256 74 2256 124 #arcP
As0 f106 guid 14EFC26E0BD3B10E #txt
As0 f106 type ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData #txt
As0 f106 method loadDeputy() #txt
As0 f106 disableUIEvents false #txt
As0 f106 inParameterDecl 'ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent methodEvent = event as ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent;
<> param = methodEvent.getInputArguments();
' #txt
As0 f106 inParameterMapAction 'out.isLoadDeputy=true;
out.validationError=false;
' #txt
As0 f106 outParameterDecl '<> result;
' #txt
As0 f106 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>loadDeputy()</name>
        <nameStyle>12,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
As0 f106 3030 54 20 20 -19 -31 #rect
As0 f106 @|RichDialogMethodStartIcon #fIcon
As0 f97 actionDecl 'ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData out;
' #txt
As0 f97 actionTable 'out=in;
' #txt
As0 f97 actionCode 'import ch.ivy.addon.portalkit.util.UserUtils;
import ch.ivy.addon.portalkit.util.AbsenceAndSubstituteUtils;

in.ivyUsers = UserUtils.sortApplicationUsers(in.ivyUsers);
in.substituteRoot = AbsenceAndSubstituteUtils.buildSustitute(in.substitutes, in.ivyUsers);' #txt
As0 f97 type ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData #txt
As0 f97 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>process data 
And build tree</name>
        <nameStyle>13,7
15,7
</nameStyle>
    </language>
</elementInfo>
' #txt
As0 f97 3022 397 36 22 30 -7 #rect
As0 f97 @|StepIcon #fIcon
As0 f95 type ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData #txt
As0 f95 processCall MultiPortal/SubstituteService:getSubstitutes(String) #txt
As0 f95 doCall true #txt
As0 f95 requestActionDecl '<java.lang.String user> param;
' #txt
As0 f95 requestMappingAction 'param.user=in.userName;
' #txt
As0 f95 responseActionDecl 'ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData out;
' #txt
As0 f95 responseMappingAction 'out=in;
out.errors=result.errors;
out.ivyUsers=result.remoteApplicationUsers;
out.substitutes=result.remoteSubstitutes;
' #txt
As0 f95 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>getSubstitutes(String)</name>
        <nameStyle>22,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
As0 f95 3022 324 36 24 29 -8 #rect
As0 f95 @|CallSubIcon #fIcon
As0 f93 type ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData #txt
As0 f93 3030 454 20 20 13 0 #rect
As0 f93 @|RichDialogProcessEndIcon #fIcon
As0 f98 expr out #txt
As0 f98 3040 348 3040 397 #arcP
As0 f94 expr out #txt
As0 f94 3040 419 3040 454 #arcP
As0 f104 guid 14EFC283CAFFF24F #txt
As0 f104 type ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData #txt
As0 f104 method editDeputy() #txt
As0 f104 disableUIEvents false #txt
As0 f104 inParameterDecl 'ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent methodEvent = event as ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent;
<> param = methodEvent.getInputArguments();
' #txt
As0 f104 inParameterMapAction 'out.isLoadDeputy=false;
out.userName=ivy.session.getSessionUserName();
' #txt
As0 f104 inActionCode 'import ch.ivy.addon.portalkit.bo.RemoteUser;
for(RemoteUser user: out.remoteUsers) {
	if(user.username.equals(ivy.session.getSessionUserName())){
		out.selectedUser = user;
		break;
	}
}' #txt
As0 f104 outParameterDecl '<> result;
' #txt
As0 f104 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>editDeputy</name>
        <nameStyle>10,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
As0 f104 3134 54 20 20 -22 -31 #rect
As0 f104 @|RichDialogMethodStartIcon #fIcon
As0 f105 type ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData #txt
As0 f105 3026 258 28 28 14 0 #rect
As0 f105 @|AlternativeIcon #fIcon
As0 f96 expr in #txt
As0 f96 3040 286 3040 324 #arcP
As0 f110 type ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData #txt
As0 f110 processCall MultiPortal/AbsenceService:setAbsence(List<ch.ivy.addon.portalkit.bo.RemoteAbsence>,String) #txt
As0 f110 doCall true #txt
As0 f110 requestActionDecl '<List<ch.ivy.addon.portalkit.bo.RemoteAbsence> absences,java.lang.String user> param;
' #txt
As0 f110 requestMappingAction 'param.absences=in.absencesToUpdate;
param.user=in.userName;
' #txt
As0 f110 responseActionDecl 'ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData out;
' #txt
As0 f110 responseMappingAction 'out=in;
' #txt
As0 f110 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>set
Absences
</name>
        <nameStyle>13,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
As0 f110 1182 196 36 24 24 -12 #rect
As0 f110 @|CallSubIcon #fIcon
As0 f19 expr out #txt
As0 f19 96 140 96 183 #arcP
As0 f65 guid 14EFD4B924E8A574 #txt
As0 f65 type ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData #txt
As0 f65 method loadAllUsers() #txt
As0 f65 disableUIEvents false #txt
As0 f65 inParameterDecl 'ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent methodEvent = event as ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent;
<> param = methodEvent.getInputArguments();
' #txt
As0 f65 inActionCode 'import ch.ivy.addon.portalkit.bo.RemoteUser;
if(out.selectedUser.name.isEmpty()) {
	for(RemoteUser user: out.remoteUsers) {
	if(user.username.equals(ivy.session.getSessionUserName())){
		out.selectedUser = user;	
		break;
		}
	}
}' #txt
As0 f65 outParameterDecl '<> result;
' #txt
As0 f65 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>loadAllUsers()</name>
        <nameStyle>14,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
As0 f65 2614 54 20 20 -36 -30 #rect
As0 f65 @|RichDialogMethodStartIcon #fIcon
As0 f66 type ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData #txt
As0 f66 2614 358 20 20 13 0 #rect
As0 f66 @|RichDialogProcessEndIcon #fIcon
As0 f24 type ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData #txt
As0 f24 processCall MultiPortal/SecurityService:findAllUsers() #txt
As0 f24 doCall true #txt
As0 f24 requestActionDecl '<> param;
' #txt
As0 f24 responseActionDecl 'ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData out;
' #txt
As0 f24 responseMappingAction 'out=in;
out.errors=result.errors;
out.remoteUsers=result.users;
' #txt
As0 f24 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>findAllUsers()</name>
        <nameStyle>14,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
As0 f24 2606 188 36 24 20 -2 #rect
As0 f24 @|CallSubIcon #fIcon
As0 f20 guid 14EFD73A39235CAE #txt
As0 f20 type ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData #txt
As0 f20 actionDecl 'ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData out;
' #txt
As0 f20 actionTable 'out=in;
' #txt
As0 f20 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>saveModifiedSubstitute</name>
        <nameStyle>22,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
As0 f20 998 54 20 20 -49 -30 #rect
As0 f20 @|RichDialogProcessStartIcon #fIcon
As0 f21 type ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData #txt
As0 f21 998 254 20 20 13 0 #rect
As0 f21 @|RichDialogProcessEndIcon #fIcon
As0 f45 type ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData #txt
As0 f45 processCall MultiPortal/SubstituteService:setSubstitutes(List<ch.ivy.addon.portalkit.bo.RemoteSubstitute>,String) #txt
As0 f45 doCall true #txt
As0 f45 requestActionDecl '<List<ch.ivy.addon.portalkit.bo.RemoteSubstitute> substitutes,java.lang.String user> param;
' #txt
As0 f45 requestMappingAction 'param.substitutes=in.substitutes;
param.user=in.userName;
' #txt
As0 f45 responseActionDecl 'ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData out;
' #txt
As0 f45 responseMappingAction 'out=in;
' #txt
As0 f45 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>setSubstitutes</name>
        <nameStyle>14,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
As0 f45 990 172 36 24 20 -2 #rect
As0 f45 @|CallSubIcon #fIcon
As0 f67 expr out #txt
As0 f67 1008 196 1008 254 #arcP
As0 f68 guid 14EFD7A92E3DB36D #txt
As0 f68 type ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData #txt
As0 f68 actionDecl 'ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData out;
' #txt
As0 f68 actionTable 'out=in;
' #txt
As0 f68 actionCode 'import ch.ivy.addon.portalkit.util.Dates;

java.util.Date endOfDate = Dates.toEndOfDate(in.selectedAbsence.getStopDateInclusive());
in.selectedAbsence.setStopDateInclusive(endOfDate);' #txt
As0 f68 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>saveModifiedAbsence</name>
        <nameStyle>19,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
As0 f68 1790 54 20 20 -48 -30 #rect
As0 f68 @|RichDialogProcessStartIcon #fIcon
As0 f72 type ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData #txt
As0 f72 processCall MultiPortal/AbsenceService:setAbsence(List<ch.ivy.addon.portalkit.bo.RemoteAbsence>,String) #txt
As0 f72 doCall true #txt
As0 f72 requestActionDecl '<List<ch.ivy.addon.portalkit.bo.RemoteAbsence> absences,java.lang.String user> param;
' #txt
As0 f72 requestMappingAction 'param.absences=in.absencesToUpdate;
param.user=in.userName;
' #txt
As0 f72 responseActionDecl 'ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData out;
' #txt
As0 f72 responseMappingAction 'out=in;
' #txt
As0 f72 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>set Absences
</name>
        <nameStyle>13,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
As0 f72 1782 236 36 24 19 -13 #rect
As0 f72 @|CallSubIcon #fIcon
As0 f71 actionDecl 'ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData out;
' #txt
As0 f71 actionTable 'out=in;
' #txt
As0 f71 actionCode 'import ch.ivy.addon.portalkit.util.AbsenceAndSubstituteUtils;
in.substitutes = AbsenceAndSubstituteUtils.convertToSubstitueList(in.substituteRoot);' #txt
As0 f71 type ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData #txt
As0 f71 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Convert
Subtitues</name>
        <nameStyle>17,7
</nameStyle>
    </language>
</elementInfo>
' #txt
As0 f71 990 108 36 24 24 -16 #rect
As0 f71 @|StepIcon #fIcon
As0 f73 expr out #txt
As0 f73 1008 74 1008 108 #arcP
As0 f51 expr out #txt
As0 f51 1008 132 1008 172 #arcP
As0 f75 expr out #txt
As0 f75 3144 74 3054 272 #arcP
As0 f75 1 3144 272 #addKink
As0 f75 0 0.7413941886931402 0 0 #arcLabel
As0 f107 expr in #txt
As0 f107 outCond !in.validationError #txt
As0 f107 .xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Yes</name>
        <nameStyle>3,7
</nameStyle>
    </language>
</elementInfo>
' #txt
As0 f107 3040 214 3040 258 #arcP
As0 f107 0 0.18181818181818182 10 0 #arcLabel
As0 f100 expr in #txt
As0 f100 .xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>No</name>
        <nameStyle>2,7
</nameStyle>
    </language>
</elementInfo>
' #txt
As0 f100 3026 200 3030 464 #arcP
As0 f100 1 2976 200 #addKink
As0 f100 2 2976 464 #addKink
As0 f100 0 0.3780487804878049 0 -9 #arcLabel
As0 f99 type ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData #txt
As0 f99 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>No errror?</name>
        <nameStyle>10,7
</nameStyle>
    </language>
</elementInfo>
' #txt
As0 f99 3026 186 28 28 -68 10 #rect
As0 f99 @|AlternativeIcon #fIcon
As0 f92 expr out #txt
As0 f92 3040 74 3040 116 #arcP
As0 f101 expr out #txt
As0 f101 3040 140 3040 186 #arcP
As0 f43 actionDecl 'ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData out;
' #txt
As0 f43 actionTable 'out=in;
' #txt
As0 f43 actionCode 'import javax.faces.application.FacesMessage;
import javax.faces.context.FacesContext;
import ch.ivy.addon.portalkit.util.AbsenceAndSubstituteUtils;

in.validationError = false;
boolean fromBiggerThanTill = AbsenceAndSubstituteUtils.checkFromBiggerThanTill(in.selectedAbsence);
in.selectedAbsence.userName = in.userName;

if(fromBiggerThanTill)
{
	 in.validationError = true;
	 FacesContext.getCurrentInstance().validationFailed();
	 in.isLoadDeputy = false;
}

boolean doesNewAbsenceOverlap = AbsenceAndSubstituteUtils.doesNewAbsenceOverlap(in.absences,in.selectedAbsence);
if(doesNewAbsenceOverlap){
	in.validationError = true;
	FacesContext.getCurrentInstance().addMessage(null, 
		new FacesMessage(FacesMessage.SEVERITY_ERROR,ivy.cms.co("/ch.ivy.addon.portalkit.ui.jsf/AbsenceAndDeputy/Messages/overlappingAbsence"),
		""));
	in.isLoadDeputy = false;
}' #txt
As0 f43 type ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData #txt
As0 f43 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>validation</name>
        <nameStyle>10,7
</nameStyle>
    </language>
</elementInfo>
' #txt
As0 f43 3022 116 36 24 22 -5 #rect
As0 f43 @|StepIcon #fIcon
As0 f76 actionDecl 'ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData out;
' #txt
As0 f76 actionTable 'out=in;
' #txt
As0 f76 actionCode 'import ch.ivy.addon.portalkit.bo.RemoteUser;
in.userNames.clear();
for (RemoteUser user : in.remoteUsers) {
		in.userNames.add(user.username);
}

for(RemoteUser user: out.remoteUsers) {
	if(user.username.equals(ivy.session.getSessionUserName())){
		out.selectedUser = user;	
	}
}

' #txt
As0 f76 type ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData #txt
As0 f76 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>add all user name
to list userNames</name>
        <nameStyle>35,7
</nameStyle>
    </language>
</elementInfo>
' #txt
As0 f76 2606 228 36 24 20 -2 #rect
As0 f76 @|StepIcon #fIcon
As0 f77 expr out #txt
As0 f77 2624 212 2624 228 #arcP
As0 f54 actionDecl 'ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData out;
' #txt
As0 f54 actionTable 'out=in;
' #txt
As0 f54 actionCode 'import javax.faces.application.FacesMessage;
import javax.faces.context.FacesContext;
import ch.ivy.addon.portalkit.util.AbsenceAndSubstituteUtils;

in.validationError = false;
boolean fromBiggerThanTill = AbsenceAndSubstituteUtils.checkFromBiggerThanTill(in.selectedAbsence);
in.selectedAbsence.userName = in.userName;

if(fromBiggerThanTill)
{
	 in.validationError = true;
	 FacesContext.getCurrentInstance().validationFailed();
}


boolean doesNewAbsenceOverlap = AbsenceAndSubstituteUtils.doesNewAbsenceOverlap(in.absences,in.selectedAbsence);
if(doesNewAbsenceOverlap){
	in.validationError = true;
	FacesContext.getCurrentInstance().addMessage(null, 
		new FacesMessage(FacesMessage.SEVERITY_ERROR,ivy.cms.co("/ch.ivy.addon.portalkit.ui.jsf/AbsenceAndDeputy/Messages/overlappingAbsence"), ""));
}
' #txt
As0 f54 type ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData #txt
As0 f54 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>validation</name>
        <nameStyle>10,7
</nameStyle>
    </language>
</elementInfo>
' #txt
As0 f54 454 116 36 24 22 -5 #rect
As0 f54 @|StepIcon #fIcon
As0 f56 expr out #txt
As0 f56 472 74 472 116 #arcP
As0 f57 expr out #txt
As0 f57 472 140 472 182 #arcP
As0 f78 type ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData #txt
As0 f78 1602 338 28 28 14 0 #rect
As0 f78 @|AlternativeIcon #fIcon
As0 f85 type ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData #txt
As0 f85 processCall MultiPortal/AbsenceService:getAbsencesOfAllUsers() #txt
As0 f85 doCall true #txt
As0 f85 requestActionDecl '<> param;
' #txt
As0 f85 responseActionDecl 'ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData out;
' #txt
As0 f85 responseMappingAction 'out=in;
out.absences=result.remoteAbsences;
' #txt
As0 f85 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>getAbsencesOfAllUsers()</name>
        <nameStyle>23,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
As0 f85 1502 372 36 24 20 -2 #rect
As0 f85 @|CallSubIcon #fIcon
As0 f86 expr in #txt
As0 f86 outCond in.isSupervisor #txt
As0 f86 1602 352 1520 372 #arcP
As0 f86 1 1520 352 #addKink
As0 f86 0 0.8409693526413281 0 0 #arcLabel
As0 f2 expr in #txt
As0 f2 1630 352 1720 372 #arcP
As0 f2 1 1720 352 #addKink
As0 f2 0 0.775990530620688 0 0 #arcLabel
As0 f108 actionDecl 'ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData out;
' #txt
As0 f108 actionTable 'out=in;
' #txt
As0 f108 actionCode 'import ch.ivy.addon.portalkit.bo.RemoteAbsence;
for (RemoteAbsence absence : in.absences) {
	absence.userName = in.userName;
	absence.userFullName = in.userFullName;
}' #txt
As0 f108 type ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData #txt
As0 f108 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>set user name for absence(s)</name>
        <nameStyle>28,7
</nameStyle>
    </language>
</elementInfo>
' #txt
As0 f108 1702 428 36 24 20 -2 #rect
As0 f108 @|StepIcon #fIcon
As0 f109 expr out #txt
As0 f109 1720 396 1720 428 #arcP
As0 f109 0 0.7083274448213572 0 0 #arcLabel
As0 f103 expr out #txt
As0 f103 1616 74 1616 92 #arcP
As0 f15 expr out #txt
As0 f15 1616 116 1616 132 #arcP
As0 f102 actionDecl 'ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData out;
' #txt
As0 f102 actionTable 'out=in;
' #txt
As0 f102 actionCode 'import ch.ivy.addon.portalkit.bo.RemoteAbsence;

in.absencesToUpdate = new List();

for (RemoteAbsence absence : in.absences) {
	if (absence.getUserName().equalsIgnoreCase(in.userName)) {
		in.absencesToUpdate.add(absence);
	}
}' #txt
As0 f102 type ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData #txt
As0 f102 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>prepare absence(s) to update</name>
        <nameStyle>28,7
</nameStyle>
    </language>
</elementInfo>
' #txt
As0 f102 1598 92 36 24 20 -2 #rect
As0 f102 @|StepIcon #fIcon
As0 f34 actionDecl 'ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData out;
' #txt
As0 f34 actionTable 'out=in;
' #txt
As0 f34 actionCode 'import ch.ivy.addon.portalkit.bo.RemoteAbsence;
in.absencesToUpdate = new List();

for (RemoteAbsence absence : in.absences) {
	if (absence.getUserName().equalsIgnoreCase(in.userName)) {
		in.absencesToUpdate.add(absence);
	}
}' #txt
As0 f34 type ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData #txt
As0 f34 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>prepare absence(s) to update</name>
        <nameStyle>28,7
</nameStyle>
    </language>
</elementInfo>
' #txt
As0 f34 1782 132 36 24 20 -2 #rect
As0 f34 @|StepIcon #fIcon
As0 f70 expr out #txt
As0 f70 1800 74 1800 132 #arcP
As0 f74 expr out #txt
As0 f74 1800 156 1800 236 #arcP
As0 f112 actionDecl 'ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData out;
' #txt
As0 f112 actionTable 'out=in;
' #txt
As0 f112 actionCode 'import ch.ivy.addon.portalkit.bo.RemoteAbsence;

in.absences.remove(in.selectedAbsence);

in.absencesToUpdate = new List();

for (RemoteAbsence absence : in.absences) {
	if (absence.getUserName().equalsIgnoreCase(in.userName)) {
		in.absencesToUpdate.add(absence);
	}
}' #txt
As0 f112 type ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData #txt
As0 f112 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>prepare absence(s) to update</name>
        <nameStyle>28,7
</nameStyle>
    </language>
</elementInfo>
' #txt
As0 f112 1182 100 36 24 21 -7 #rect
As0 f112 @|StepIcon #fIcon
As0 f114 type ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData #txt
As0 f114 1186 146 28 28 14 0 #rect
As0 f114 @|AlternativeIcon #fIcon
As0 f115 expr out #txt
As0 f115 1200 124 1200 146 #arcP
As0 f111 expr in #txt
As0 f111 outCond 'in.absencesToUpdate.size() > 0' #txt
As0 f111 1200 174 1200 196 #arcP
As0 f116 type ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData #txt
As0 f116 processCall MultiPortal/AbsenceService:deleteAbsence(List<ch.ivy.addon.portalkit.bo.ServerApplication>,String) #txt
As0 f116 doCall true #txt
As0 f116 requestActionDecl '<java.util.List<ch.ivy.addon.portalkit.bo.ServerApplication> applications,java.lang.String user> param;
' #txt
As0 f116 requestMappingAction 'param.applications=in.absencesApplications;
param.user=in.userName;
' #txt
As0 f116 responseActionDecl 'ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData out;
' #txt
As0 f116 responseMappingAction 'out=in;
' #txt
As0 f116 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>deleteAbsence(List&lt;ServerApplication&gt;,String)</name>
    </language>
</elementInfo>
' #txt
As0 f116 1254 148 36 24 -91 -33 #rect
As0 f116 @|CallSubIcon #fIcon
As0 f117 expr in #txt
As0 f117 1214 160 1254 160 #arcP
As0 f119 type ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData #txt
As0 f119 1186 266 28 28 14 0 #rect
As0 f119 @|AlternativeIcon #fIcon
As0 f120 expr out #txt
As0 f120 1200 220 1200 266 #arcP
As0 f29 expr out #txt
As0 f29 1272 172 1214 280 #arcP
As0 f29 1 1272 280 #addKink
As0 f29 1 0.3019129255469263 0 0 #arcLabel
As0 f118 type ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData #txt
As0 f118 1190 342 20 20 13 0 #rect
As0 f118 @|RichDialogProcessEndIcon #fIcon
As0 f121 expr in #txt
As0 f121 1200 294 1200 342 #arcP
As0 f32 expr out #txt
As0 f32 1200 74 1200 100 #arcP
As0 f33 expr out #txt
As0 f33 360 74 454 128 #arcP
As0 f33 1 360 128 #addKink
As0 f33 1 0.17802668190592436 0 0 #arcLabel
As0 f52 guid 151239B85BCCB668 #txt
As0 f52 type ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData #txt
As0 f52 actionDecl 'ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData out;
' #txt
As0 f52 actionTable 'out=in;
' #txt
As0 f52 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>userSelect</name>
        <nameStyle>10,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
As0 f52 581 53 22 22 -25 -30 #rect
As0 f52 @|RichDialogProcessStartIcon #fIcon
As0 f84 guid 151F7B91577D721F #txt
As0 f84 type ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData #txt
As0 f84 actionDecl 'ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData out;
' #txt
As0 f84 actionTable 'out=in;
' #txt
As0 f84 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>changeUserSubstitute</name>
        <nameStyle>20,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
As0 f84 3245 53 22 22 -46 -31 #rect
As0 f84 @|RichDialogProcessStartIcon #fIcon
As0 f123 type ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData #txt
As0 f123 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>users loaded?</name>
        <nameStyle>13,7
</nameStyle>
    </language>
</elementInfo>
' #txt
As0 f123 2610 114 28 28 18 -10 #rect
As0 f123 @|AlternativeIcon #fIcon
As0 f124 expr out #txt
As0 f124 2624 74 2624 114 #arcP
As0 f22 expr in #txt
As0 f22 outCond in.userNames.isEmpty() #txt
As0 f22 .xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>No</name>
        <nameStyle>2,7
</nameStyle>
    </language>
</elementInfo>
' #txt
As0 f22 2624 142 2624 188 #arcP
As0 f22 0 0.43478260869565216 13 -1 #arcLabel
As0 f125 expr in #txt
As0 f125 .xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Yes</name>
        <nameStyle>3,7
</nameStyle>
    </language>
</elementInfo>
' #txt
As0 f125 2610 128 2614 368 #arcP
As0 f125 1 2560 128 #addKink
As0 f125 2 2560 368 #addKink
As0 f125 1 0.4895833333333333 -17 0 #arcLabel
As0 f9 type ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData #txt
As0 f9 1602 450 28 28 14 0 #rect
As0 f9 @|AlternativeIcon #fIcon
As0 f10 expr out #txt
As0 f10 1520 396 1602 464 #arcP
As0 f10 1 1520 464 #addKink
As0 f10 0 0.8265856139901239 0 0 #arcLabel
As0 f41 expr out #txt
As0 f41 1720 452 1630 464 #arcP
As0 f41 1 1720 464 #addKink
As0 f41 1 0.06299211285886751 0 0 #arcLabel
As0 f42 expr in #txt
As0 f42 1616 478 1616 509 #arcP
As0 f8 type ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData #txt
As0 f8 1602 298 28 28 14 0 #rect
As0 f8 @|AlternativeIcon #fIcon
As0 f58 expr out #txt
As0 f58 1455 73 1602 312 #arcP
As0 f58 1 1455 312 #addKink
As0 f58 1 0.0567860245732053 0 0 #arcLabel
As0 f60 expr in #txt
As0 f60 1616 326 1616 338 #arcP
As0 f81 expr out #txt
As0 f81 1616 284 1616 298 #arcP
As0 f81 0 0.9443627398037826 0 0 #arcLabel
As0 f113 expr out #txt
As0 f113 1800 260 1630 312 #arcP
As0 f113 1 1800 312 #addKink
As0 f113 1 0.30900712554331783 0 0 #arcLabel
As0 f69 guid 1521530FF67FB912 #txt
As0 f69 type ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData #txt
As0 f69 method autoCompleteForUser(String) #txt
As0 f69 disableUIEvents false #txt
As0 f69 inParameterDecl 'ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent methodEvent = event as ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent;
<java.lang.String query> param = methodEvent.getInputArguments();
' #txt
As0 f69 inParameterMapAction 'out.queryAutoComplete=param.query;
' #txt
As0 f69 outParameterDecl '<List<ch.ivy.addon.portalkit.bo.RemoteUser> listUsers> result;
' #txt
As0 f69 outActionCode 'import ch.ivy.addon.portalkit.util.UserUtils;
import ch.ivy.addon.portalkit.bo.RemoteUser;
result.listUsers = UserUtils.filterUsers(in.remoteUsers,in.queryAutoComplete);
' #txt
As0 f69 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>autoCompleteForUser(String)</name>
        <nameStyle>27,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
As0 f69 2805 53 22 22 -75 -32 #rect
As0 f69 @|RichDialogMethodStartIcon #fIcon
As0 f126 type ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData #txt
As0 f126 2805 117 22 22 14 0 #rect
As0 f126 @|RichDialogProcessEndIcon #fIcon
As0 f127 expr out #txt
As0 f127 2816 75 2816 117 #arcP
As0 f128 actionDecl 'ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData out;
' #txt
As0 f128 actionTable 'out=in;
' #txt
As0 f128 actionCode 'in.userName = in.selectedUser.username;' #txt
As0 f128 type ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData #txt
As0 f128 574 116 36 24 20 -2 #rect
As0 f128 @|StepIcon #fIcon
As0 f129 expr out #txt
As0 f129 592 75 592 116 #arcP
As0 f53 expr out #txt
As0 f53 574 128 490 128 #arcP
As0 f130 guid 1521F5896DB6164C #txt
As0 f130 type ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData #txt
As0 f130 method filterDisplayedAbsences() #txt
As0 f130 disableUIEvents false #txt
As0 f130 inParameterDecl 'ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent methodEvent = event as ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent;
<> param = methodEvent.getInputArguments();
' #txt
As0 f130 outParameterDecl '<> result;
' #txt
As0 f130 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>getDisplayedAbsences()</name>
        <nameStyle>22,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
As0 f130 2421 53 22 22 -61 -30 #rect
As0 f130 @|RichDialogMethodStartIcon #fIcon
As0 f131 type ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData #txt
As0 f131 2421 181 22 22 14 0 #rect
As0 f131 @|RichDialogProcessEndIcon #fIcon
As0 f133 actionDecl 'ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData out;
' #txt
As0 f133 actionTable 'out=in;
' #txt
As0 f133 actionCode 'import ch.ivy.addon.portalkit.util.AbsenceAndSubstituteUtils;
import ch.ivy.addon.portalkit.bo.RemoteAbsence;
in.displayedAbsences = new List();
for (RemoteAbsence absence : in.absences) {
		if (in.absenceInThePastShown || !AbsenceAndSubstituteUtils.isInThePast(absence)) {
			in.displayedAbsences.add(absence);
		}
}' #txt
As0 f133 type ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData #txt
As0 f133 2414 116 36 24 20 -2 #rect
As0 f133 @|StepIcon #fIcon
As0 f134 expr out #txt
As0 f134 2432 75 2432 116 #arcP
As0 f132 expr out #txt
As0 f132 2432 140 2432 181 #arcP
As0 f135 actionDecl 'ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData out;
' #txt
As0 f135 actionTable 'out=in;
' #txt
As0 f135 actionCode 'in.userName = in.selectedUser.username;' #txt
As0 f135 type ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData #txt
As0 f135 3238 116 36 24 20 -2 #rect
As0 f135 @|StepIcon #fIcon
As0 f136 expr out #txt
As0 f136 3256 75 3256 116 #arcP
As0 f136 0 0.019027730256182096 0 0 #arcLabel
As0 f122 expr out #txt
As0 f122 3256 140 3054 272 #arcP
As0 f122 1 3256 272 #addKink
As0 f122 1 0.019027730256182096 0 0 #arcLabel
As0 f137 guid 1522052855161F8A #txt
As0 f137 type ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData #txt
As0 f137 method updateSubstitute(ch.ivy.addon.portalkit.bo.SubstituteNode) #txt
As0 f137 disableUIEvents false #txt
As0 f137 inParameterDecl 'ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent methodEvent = event as ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent;
<ch.ivy.addon.portalkit.bo.SubstituteNode substituteToUpdate> param = methodEvent.getInputArguments();
' #txt
As0 f137 inActionCode 'param.substituteToUpdate.remoteSubstitute.mySubstitute = param.substituteToUpdate.substituteUser.memberName;' #txt
As0 f137 outParameterDecl '<> result;
' #txt
As0 f137 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>updateSubstitute(SubstituteNode)</name>
        <nameStyle>32,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
As0 f137 3413 53 22 22 14 0 #rect
As0 f137 @|RichDialogMethodStartIcon #fIcon
As0 f138 type ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData #txt
As0 f138 3413 213 22 22 14 0 #rect
As0 f138 @|RichDialogProcessEndIcon #fIcon
As0 f139 expr out #txt
As0 f139 3424 75 3424 213 #arcP
As0 f140 actionDecl 'ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData out;
' #txt
As0 f140 actionTable 'out=in;
' #txt
As0 f140 actionCode 'import ch.ivy.addon.portalkit.bo.RemoteUser;
import java.util.HashMap;
import java.util.Map;
Map nameToRemoteUser = new HashMap();
for (RemoteUser user: in.remoteUsers) {
	nameToRemoteUser.put(user.username, user);
}

in.remoteUsers = new List();
in.remoteUsers.addAll(nameToRemoteUser.values());
' #txt
As0 f140 type ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData #txt
As0 f140 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>merge users</name>
        <nameStyle>11,7
</nameStyle>
    </language>
</elementInfo>
' #txt
As0 f140 2606 292 36 24 25 -10 #rect
As0 f140 @|StepIcon #fIcon
As0 f141 expr out #txt
As0 f141 2624 252 2624 292 #arcP
As0 f27 expr out #txt
As0 f27 2624 316 2624 358 #arcP
>Proto As0 .type ch.ivy.addon.portalkit.multiapp.settings.AbsencesAndDeputy.AbsencesAndDeputyData #txt
>Proto As0 .processKind HTML_DIALOG #txt
>Proto As0 .xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <swimlaneLabel>Start</swimlaneLabel>
        <swimlaneLabel>Event</swimlaneLabel>
        <swimlaneLabel>Methods</swimlaneLabel>
        <swimlaneLabel></swimlaneLabel>
    </language>
    <swimlaneSize>200</swimlaneSize>
    <swimlaneSize>1792</swimlaneSize>
    <swimlaneSize>1720</swimlaneSize>
    <swimlaneColor>-3342388</swimlaneColor>
    <swimlaneColor>-154</swimlaneColor>
    <swimlaneColor>-26215</swimlaneColor>
</elementInfo>
' #txt
>Proto As0 -8 -8 16 16 16 26 #rect
>Proto As0 '' #fIcon
As0 f5 mainOut f14 tail #connect
As0 f14 head f13 mainIn #connect
As0 f13 mainOut f7 tail #connect
As0 f7 head f6 mainIn #connect
As0 f30 mainOut f23 tail #connect
As0 f23 head f31 mainIn #connect
As0 f3 mainOut f47 tail #connect
As0 f47 head f1 mainIn #connect
As0 f28 mainOut f48 tail #connect
As0 f48 head f4 mainIn #connect
As0 f4 mainOut f50 tail #connect
As0 f50 head f49 mainIn #connect
As0 f0 mainOut f83 tail #connect
As0 f83 head f82 mainIn #connect
As0 f49 mainOut f62 tail #connect
As0 f62 head f59 mainIn #connect
As0 f36 mainOut f35 tail #connect
As0 f35 head f12 mainIn #connect
As0 f38 mainOut f63 tail #connect
As0 f63 head f61 mainIn #connect
As0 f61 mainOut f64 tail #connect
As0 f64 head f39 mainIn #connect
As0 f87 mainOut f90 tail #connect
As0 f90 head f89 mainIn #connect
As0 f89 mainOut f91 tail #connect
As0 f91 head f88 mainIn #connect
As0 f11 mainOut f37 tail #connect
As0 f37 head f36 mainIn #connect
As0 f95 mainOut f98 tail #connect
As0 f98 head f97 mainIn #connect
As0 f97 mainOut f94 tail #connect
As0 f94 head f93 mainIn #connect
As0 f43 mainOut f101 tail #connect
As0 f101 head f99 in #connect
As0 f106 mainOut f92 tail #connect
As0 f92 head f43 mainIn #connect
As0 f100 head f93 mainIn #connect
As0 f105 out f96 tail #connect
As0 f96 head f95 mainIn #connect
As0 f99 out f107 tail #connect
As0 f107 head f105 in #connect
As0 f99 out f100 tail #connect
As0 f82 mainOut f19 tail #connect
As0 f19 head f80 mainIn #connect
As0 f45 mainOut f67 tail #connect
As0 f67 head f21 mainIn #connect
As0 f20 mainOut f73 tail #connect
As0 f73 head f71 mainIn #connect
As0 f71 mainOut f51 tail #connect
As0 f51 head f45 mainIn #connect
As0 f104 mainOut f75 tail #connect
As0 f75 head f105 in #connect
As0 f24 mainOut f77 tail #connect
As0 f77 head f76 mainIn #connect
As0 f46 mainOut f56 tail #connect
As0 f56 head f54 mainIn #connect
As0 f54 mainOut f57 tail #connect
As0 f57 head f55 mainIn #connect
As0 f78 out f86 tail #connect
As0 f86 head f85 mainIn #connect
As0 f78 out f2 tail #connect
As0 f2 head f26 mainIn #connect
As0 f40 mainOut f103 tail #connect
As0 f103 head f102 mainIn #connect
As0 f102 mainOut f15 tail #connect
As0 f15 head f28 mainIn #connect
As0 f26 mainOut f109 tail #connect
As0 f109 head f108 mainIn #connect
As0 f68 mainOut f70 tail #connect
As0 f70 head f34 mainIn #connect
As0 f34 mainOut f74 tail #connect
As0 f74 head f72 mainIn #connect
As0 f112 mainOut f115 tail #connect
As0 f115 head f114 in #connect
As0 f114 out f111 tail #connect
As0 f111 head f110 mainIn #connect
As0 f114 out f117 tail #connect
As0 f117 head f116 mainIn #connect
As0 f110 mainOut f120 tail #connect
As0 f120 head f119 in #connect
As0 f116 mainOut f29 tail #connect
As0 f29 head f119 in #connect
As0 f119 out f121 tail #connect
As0 f121 head f118 mainIn #connect
As0 f25 mainOut f32 tail #connect
As0 f32 head f112 mainIn #connect
As0 f44 mainOut f33 tail #connect
As0 f33 head f54 mainIn #connect
As0 f65 mainOut f124 tail #connect
As0 f124 head f123 in #connect
As0 f123 out f22 tail #connect
As0 f22 head f24 mainIn #connect
As0 f123 out f125 tail #connect
As0 f125 head f66 mainIn #connect
As0 f85 mainOut f10 tail #connect
As0 f10 head f9 in #connect
As0 f108 mainOut f41 tail #connect
As0 f41 head f9 in #connect
As0 f9 out f42 tail #connect
As0 f42 head f3 mainIn #connect
As0 f79 mainOut f58 tail #connect
As0 f58 head f8 in #connect
As0 f8 out f60 tail #connect
As0 f60 head f78 in #connect
As0 f59 mainOut f81 tail #connect
As0 f81 head f8 in #connect
As0 f72 mainOut f113 tail #connect
As0 f113 head f8 in #connect
As0 f69 mainOut f127 tail #connect
As0 f127 head f126 mainIn #connect
As0 f52 mainOut f129 tail #connect
As0 f129 head f128 mainIn #connect
As0 f128 mainOut f53 tail #connect
As0 f53 head f54 mainIn #connect
As0 f130 mainOut f134 tail #connect
As0 f134 head f133 mainIn #connect
As0 f133 mainOut f132 tail #connect
As0 f132 head f131 mainIn #connect
As0 f84 mainOut f136 tail #connect
As0 f136 head f135 mainIn #connect
As0 f135 mainOut f122 tail #connect
As0 f122 head f105 in #connect
As0 f137 mainOut f139 tail #connect
As0 f139 head f138 mainIn #connect
As0 f76 mainOut f141 tail #connect
As0 f141 head f140 mainIn #connect
As0 f140 mainOut f27 tail #connect
As0 f27 head f66 mainIn #connect
