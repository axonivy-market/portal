[Ivy]
[>Created: Tue Mar 22 18:25:48 ICT 2016]
146C8E81DE07F973 3.18 #module
>Proto >Proto Collection #zClass
Te0 TaskService Big #zClass
Te0 B #cInfo
Te0 #process
Te0 @TextInP .resExport .resExport #zField
Te0 @TextInP .type .type #zField
Te0 @TextInP .processKind .processKind #zField
Te0 @AnnotationInP-0n ai ai #zField
Te0 @TextInP .xml .xml #zField
Te0 @TextInP .responsibility .responsibility #zField
Te0 @EndSub f3 '' #zField
Te0 @GridStep f5 '' #zField
Te0 @Alternative f27 '' #zField
Te0 @Alternative f31 '' #zField
Te0 @GridStep f32 '' #zField
Te0 @StartSub f36 '' #zField
Te0 @GridStep f38 '' #zField
Te0 @PushWFArc f44 '' #zField
Te0 @PushWFArc f47 '' #zField
Te0 @PushWFArc f48 '' #zField
Te0 @PushWFArc f49 '' #zField
Te0 @Alternative f0 '' #zField
Te0 @PushWFArc f1 '' #zField
Te0 @PushWFArc f4 '' #zField
Te0 @CallSub f8 '' #zField
Te0 @PushWFArc f9 '' #zField
Te0 @PushWFArc f2 '' #zField
Te0 @StartSub f10 '' #zField
Te0 @Alternative f16 '' #zField
Te0 @GridStep f19 '' #zField
Te0 @PushWFArc f20 '' #zField
Te0 @CallSub f22 '' #zField
Te0 @PushWFArc f29 '' #zField
Te0 @GridStep f18 '' #zField
Te0 @PushWFArc f24 '' #zField
Te0 @PushWFArc f23 '' #zField
Te0 @GridStep f25 '' #zField
Te0 @PushWFArc f26 '' #zField
Te0 @PushWFArc f30 '' #zField
Te0 @CallSub f77 '' #zField
Te0 @GridStep f79 '' #zField
Te0 @PushWFArc f34 '' #zField
Te0 @PushWFArc f35 '' #zField
Te0 @PushWFArc f37 '' #zField
Te0 @CallSub f6 '' #zField
Te0 @PushWFArc f7 '' #zField
Te0 @PushWFArc f13 '' #zField
Te0 @Alternative f14 '' #zField
Te0 @GridStep f15 '' #zField
Te0 @StartSub f17 '' #zField
Te0 @GridStep f28 '' #zField
Te0 @CallSub f33 '' #zField
Te0 @CallSub f39 '' #zField
Te0 @PushWFArc f41 '' #zField
Te0 @PushWFArc f43 '' #zField
Te0 @PushWFArc f45 '' #zField
Te0 @PushWFArc f46 '' #zField
Te0 @PushWFArc f50 '' #zField
Te0 @PushWFArc f51 '' #zField
Te0 @StartSub f62 '' #zField
Te0 @GridStep f56 '' #zField
Te0 @PushWFArc f73 '' #zField
Te0 @GridStep f81 '' #zField
Te0 @CallSub f82 '' #zField
Te0 @GridStep f83 '' #zField
Te0 @StartSub f84 '' #zField
Te0 @CallSub f85 '' #zField
Te0 @Alternative f86 '' #zField
Te0 @PushWFArc f87 '' #zField
Te0 @PushWFArc f89 '' #zField
Te0 @PushWFArc f90 '' #zField
Te0 @PushWFArc f91 '' #zField
Te0 @PushWFArc f92 '' #zField
Te0 @PushWFArc f93 '' #zField
Te0 @StartSub f96 '' #zField
Te0 @CallSub f97 '' #zField
Te0 @PushWFArc f98 '' #zField
Te0 @Alternative f99 '' #zField
Te0 @PushWFArc f100 '' #zField
Te0 @GridStep f101 '' #zField
Te0 @PushWFArc f102 '' #zField
Te0 @CallSub f103 '' #zField
Te0 @PushWFArc f104 '' #zField
Te0 @GridStep f105 '' #zField
Te0 @PushWFArc f109 '' #zField
Te0 @StartSub f114 '' #zField
Te0 @Alternative f117 '' #zField
Te0 @GridStep f118 '' #zField
Te0 @GridStep f119 '' #zField
Te0 @CallSub f120 '' #zField
Te0 @Alternative f121 '' #zField
Te0 @GridStep f122 '' #zField
Te0 @Alternative f123 '' #zField
Te0 @CallSub f125 '' #zField
Te0 @GridStep f126 '' #zField
Te0 @GridStep f127 '' #zField
Te0 @PushWFArc f129 '' #zField
Te0 @PushWFArc f130 '' #zField
Te0 @PushWFArc f131 '' #zField
Te0 @PushWFArc f132 '' #zField
Te0 @PushWFArc f133 '' #zField
Te0 @PushWFArc f134 '' #zField
Te0 @PushWFArc f135 '' #zField
Te0 @PushWFArc f136 '' #zField
Te0 @PushWFArc f137 '' #zField
Te0 @PushWFArc f138 '' #zField
Te0 @PushWFArc f139 '' #zField
Te0 @PushWFArc f140 '' #zField
Te0 @PushWFArc f141 '' #zField
Te0 @CallSub f144 '' #zField
Te0 @PushWFArc f40 '' #zField
Te0 @Alternative f148 '' #zField
Te0 @PushWFArc f149 '' #zField
Te0 @PushWFArc f145 '' #zField
Te0 @PushWFArc f21 '' #zField
Te0 @PushWFArc f64 '' #zField
Te0 @PushWFArc f88 '' #zField
Te0 @PushWFArc f107 '' #zField
Te0 @PushWFArc f11 '' #zField
Te0 @StartSub f12 '' #zField
Te0 @CallSub f59 '' #zField
Te0 @GridStep f80 '' #zField
Te0 @Alternative f106 '' #zField
Te0 @CallSub f110 '' #zField
Te0 @GridStep f111 '' #zField
Te0 @PushWFArc f112 '' #zField
Te0 @PushWFArc f113 '' #zField
Te0 @PushWFArc f115 '' #zField
Te0 @PushWFArc f124 '' #zField
Te0 @PushWFArc f128 '' #zField
Te0 @PushWFArc f142 '' #zField
Te0 @PushWFArc f108 '' #zField
Te0 @GridStep f143 '' #zField
Te0 @PushWFArc f146 '' #zField
Te0 @PushWFArc f116 '' #zField
Te0 @CallSub f147 '' #zField
Te0 @GridStep f150 '' #zField
Te0 @StartSub f151 '' #zField
Te0 @GridStep f152 '' #zField
Te0 @Alternative f153 '' #zField
Te0 @GridStep f154 '' #zField
Te0 @GridStep f155 '' #zField
Te0 @GridStep f156 '' #zField
Te0 @GridStep f157 '' #zField
Te0 @Alternative f158 '' #zField
Te0 @CallSub f159 '' #zField
Te0 @Alternative f160 '' #zField
Te0 @PushWFArc f161 '' #zField
Te0 @PushWFArc f162 '' #zField
Te0 @PushWFArc f163 '' #zField
Te0 @PushWFArc f164 '' #zField
Te0 @PushWFArc f165 '' #zField
Te0 @PushWFArc f166 '' #zField
Te0 @PushWFArc f167 '' #zField
Te0 @PushWFArc f168 '' #zField
Te0 @PushWFArc f169 '' #zField
Te0 @PushWFArc f170 '' #zField
Te0 @PushWFArc f171 '' #zField
Te0 @PushWFArc f172 '' #zField
Te0 @PushWFArc f173 '' #zField
Te0 @PushWFArc f174 '' #zField
Te0 @PushWFArc f175 '' #zField
Te0 @CallSub f176 '' #zField
Te0 @PushWFArc f177 '' #zField
Te0 @PushWFArc f74 '' #zField
>Proto Te0 Te0 TaskService #zField
Te0 f3 type ch.ivyteam.wf.processes.TaskServiceData #txt
Te0 f3 771 811 26 26 14 0 #rect
Te0 f3 @|EndSubIcon #fIcon
Te0 f5 actionDecl 'ch.ivyteam.wf.processes.TaskServiceData out;
' #txt
Te0 f5 actionTable 'out=in;
' #txt
Te0 f5 actionCode 'import ch.ivy.addon.portalkit.persistence.domain.Application;
import ch.ivy.addon.portalkit.service.PortalConnectorDetector;
import ch.ivyteam.ivy.server.ServerFactory;
import ch.ivy.addon.portalkit.service.ApplicationService;
import ch.ivy.ws.addon.IvyApplication;
import ch.ivy.addon.portalkit.service.UserService;
import ch.ivy.addon.portalkit.enums.WebServiceEndPoint;


in.apps.clear();

UserService userService = new UserService();
java.util.List<String> apps = userService.findApplicationNamesUserCanWorkOn(in.userName, in.server.id);	
for(String appName: apps) {
	for (Application application : in.server.getApplications()) {
		if(appName.equals(application.name) && application.isVisible && !in.apps.contains(appName)){
			in.apps.add(appName);
		}
	}
}
if (in.apps.isEmpty()) {
	ApplicationService applicationService = new ApplicationService();
	in.apps = applicationService.getApplicationNames(in.applications);
}

PortalConnectorDetector detector = new PortalConnectorDetector();
in.endpoint = detector.getPortalConnectorURLOf(in.server) + WebServiceEndPoint.TASK.toString();
' #txt
Te0 f5 type ch.ivyteam.wf.processes.TaskServiceData #txt
Te0 f5 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>get Allive Apps
ws endpoint</name>
        <nameStyle>27,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Te0 f5 70 420 36 24 21 -18 #rect
Te0 f5 @|StepIcon #fIcon
Te0 f27 type ch.ivyteam.wf.processes.TaskServiceData #txt
Te0 f27 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>server alive</name>
        <nameStyle>12,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Te0 f27 74 362 28 28 11 -29 #rect
Te0 f27 @|AlternativeIcon #fIcon
Te0 f31 type ch.ivyteam.wf.processes.TaskServiceData #txt
Te0 f31 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>next server</name>
        <nameStyle>11,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Te0 f31 74 170 28 28 22 -21 #rect
Te0 f31 @|AlternativeIcon #fIcon
Te0 f32 actionDecl 'ch.ivyteam.wf.processes.TaskServiceData out;
' #txt
Te0 f32 actionTable 'out=in;
' #txt
Te0 f32 actionCode 'import ch.ivy.addon.portalkit.persistence.domain.Application;
import ch.ivy.addon.portalkit.enums.WebServiceEndPoint;

import ch.ivy.addon.portalkit.bo.RemoteTask;
import ch.ivy.addon.portalkit.mapper.RemoteTaskMapper;

String address = in.server.path + WebServiceEndPoint.CASE.toString();

List<RemoteTask> remoteTasks = RemoteTaskMapper.mapTasks(in.ivyTasks);
	for(RemoteTask remoteTask : remoteTasks){
		//set server address
		remoteTask.getCase().setAdditionalProperty(ivy.cms.co("/ch.ivy.addon.portalkit/variables/portalkit_serveradress"), address);
		//set appRegister
		for(Application app : in.server.getApplications()){
			if(remoteTask.application.getName().equals(app.name)){
				app.setServer(in.server);
				remoteTask.setApplicationRegister(app);
				break;
			}
		}
	}
in.tasks.addAll(remoteTasks);
' #txt
Te0 f32 type ch.ivyteam.wf.processes.TaskServiceData #txt
Te0 f32 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>add tasks</name>
        <nameStyle>9,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Te0 f32 70 652 36 24 20 -2 #rect
Te0 f32 @|StepIcon #fIcon
Te0 f36 inParamDecl '<java.lang.String user> param;' #txt
Te0 f36 inParamTable 'out.userName=param.user;
' #txt
Te0 f36 outParamDecl '<List<ch.ivy.ws.addon.WsException> errors,List<ch.ivy.addon.portalkit.bo.RemoteTask> tasks> result;
' #txt
Te0 f36 outParamTable 'result.errors=in.errors;
result.tasks=in.tasks;
' #txt
Te0 f36 actionDecl 'ch.ivyteam.wf.processes.TaskServiceData out;
' #txt
Te0 f36 callSignature findActiveTasks(String) #txt
Te0 f36 type ch.ivyteam.wf.processes.TaskServiceData #txt
Te0 f36 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>findActiveTasks
(String)</name>
        <nameStyle>24,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Te0 f36 76 52 24 24 14 0 #rect
Te0 f36 @|StartSubIcon #fIcon
Te0 f38 actionDecl 'ch.ivyteam.wf.processes.TaskServiceData out;
' #txt
Te0 f38 actionTable 'out=in;
' #txt
Te0 f38 actionCode 'import ch.ivy.ws.addon.WsException;
for(int i = 0 ; i < in.tempErrors.size() ; i++){
	WsException w = in.tempErrors.get(i) as WsException;
	w.server = in.server.name;
	in.tempErrors.set(i,w);
	}
in.errors.addAll(in.tempErrors);

in.apps.clear();' #txt
Te0 f38 type ch.ivyteam.wf.processes.TaskServiceData #txt
Te0 f38 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>utils</name>
        <nameStyle>5,7
</nameStyle>
        <desc>add server name for exceptions

clear apps list</desc>
    </language>
</elementInfo>
' #txt
Te0 f38 278 204 36 24 20 -2 #rect
Te0 f38 @|StepIcon #fIcon
Te0 f44 expr in #txt
Te0 f44 outCond in.isServerAlive #txt
Te0 f44 88 390 88 420 #arcP
Te0 f47 expr out #txt
Te0 f47 106 664 296 228 #arcP
Te0 f47 1 296 664 #addKink
Te0 f47 1 0.4321413036724042 0 0 #arcLabel
Te0 f48 expr in #txt
Te0 f48 102 376 296 228 #arcP
Te0 f48 1 296 376 #addKink
Te0 f48 1 0.5115178601655154 0 0 #arcLabel
Te0 f49 expr out #txt
Te0 f49 296 204 102 184 #arcP
Te0 f49 1 296 184 #addKink
Te0 f49 1 0.31135433052386374 0 0 #arcLabel
Te0 f0 type ch.ivyteam.wf.processes.TaskServiceData #txt
Te0 f0 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>has apps?</name>
        <nameStyle>9,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Te0 f0 74 498 28 28 14 0 #rect
Te0 f0 @|AlternativeIcon #fIcon
Te0 f1 expr out #txt
Te0 f1 88 444 88 498 #arcP
Te0 f4 expr in #txt
Te0 f4 102 512 296 228 #arcP
Te0 f4 1 296 512 #addKink
Te0 f4 0 0.9540356379241759 0 0 #arcLabel
Te0 f8 type ch.ivyteam.wf.processes.TaskServiceData #txt
Te0 f8 processCall ServiceIntegrators/TaskServiceIntegrator:findActiveTasksByFilter(String,String,List<String>,ch.ivy.addon.portalkit.persistence.domain.Server) #txt
Te0 f8 doCall true #txt
Te0 f8 requestActionDecl '<java.lang.String endpoint,java.lang.String userName,List<java.lang.String> applicationNames,ch.ivy.addon.portalkit.persistence.domain.Server server> param;
' #txt
Te0 f8 requestMappingAction 'param.endpoint=in.endpoint;
param.userName=in.userName;
param.applicationNames=in.apps;
param.server=in.server;
' #txt
Te0 f8 responseActionDecl 'ch.ivyteam.wf.processes.TaskServiceData out;
' #txt
Te0 f8 responseMappingAction 'out=in;
out.ivyTasks=result.tasks;
out.tempErrors=result.errors;
' #txt
Te0 f8 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>findActiveTasksByFilter
(String,String,List&lt;String&gt;,Server)</name>
        <nameStyle>59,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Te0 f8 70 580 36 24 20 -2 #rect
Te0 f8 @|CallSubIcon #fIcon
Te0 f9 expr in #txt
Te0 f9 outCond 'in.apps.size() > 0' #txt
Te0 f9 88 526 88 580 #arcP
Te0 f2 expr out #txt
Te0 f2 88 604 88 652 #arcP
Te0 f10 inParamDecl '<ch.ivy.addon.portalkit.persistence.domain.Server ivyServer,java.lang.Long taskId> param;' #txt
Te0 f10 inParamTable 'out.server=param.ivyServer;
out.taskId=param.taskId;
' #txt
Te0 f10 outParamDecl '<List<ch.ivy.ws.addon.WsException> errors,ch.ivy.ws.addon.IvyTask ivyTask> result;
' #txt
Te0 f10 outParamTable 'result.errors=in.errors;
result.ivyTask=in.ivyTask;
' #txt
Te0 f10 actionDecl 'ch.ivyteam.wf.processes.TaskServiceData out;
' #txt
Te0 f10 callSignature resetTask(ch.ivy.addon.portalkit.persistence.domain.Server,Long) #txt
Te0 f10 type ch.ivyteam.wf.processes.TaskServiceData #txt
Te0 f10 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>resetTask
(Server,Long)</name>
        <nameStyle>23,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Te0 f10 771 51 26 26 14 0 #rect
Te0 f10 @|StartSubIcon #fIcon
Te0 f16 type ch.ivyteam.wf.processes.TaskServiceData #txt
Te0 f16 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>server alive</name>
        <nameStyle>12,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Te0 f16 770 162 28 28 8 -27 #rect
Te0 f16 @|AlternativeIcon #fIcon
Te0 f19 actionDecl 'ch.ivyteam.wf.processes.TaskServiceData out;
' #txt
Te0 f19 actionTable 'out=in;
' #txt
Te0 f19 actionCode 'import ch.ivy.ws.addon.WsException;
for(WsException error : in.errors){
	error.server = in.server.name;
}' #txt
Te0 f19 type ch.ivyteam.wf.processes.TaskServiceData #txt
Te0 f19 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>utils</name>
        <nameStyle>5,7
</nameStyle>
        <desc>add server name for exceptions</desc>
    </language>
</elementInfo>
' #txt
Te0 f19 766 356 36 24 20 -2 #rect
Te0 f19 @|StepIcon #fIcon
Te0 f20 expr in #txt
Te0 f20 770 176 766 368 #arcP
Te0 f20 1 736 176 #addKink
Te0 f20 2 736 368 #addKink
Te0 f20 0 0.9217931257916813 0 0 #arcLabel
Te0 f22 type ch.ivyteam.wf.processes.TaskServiceData #txt
Te0 f22 processCall ServiceIntegrators/TaskServiceIntegrator:resetTask(String,ch.ivy.addon.portalkit.persistence.domain.Server,Long) #txt
Te0 f22 doCall true #txt
Te0 f22 requestActionDecl '<java.lang.String endpoint,ch.ivy.addon.portalkit.persistence.domain.Server server,java.lang.Long taskId> param;
' #txt
Te0 f22 requestMappingAction 'param.endpoint=in.endpoint;
param.server=in.server;
param.taskId=in.taskId;
' #txt
Te0 f22 responseActionDecl 'ch.ivyteam.wf.processes.TaskServiceData out;
' #txt
Te0 f22 responseMappingAction 'out=in;
out.errors=result.errors;
out.ivyTask=result.task;
' #txt
Te0 f22 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>resetTask
(String,Server,Long)</name>
        <nameStyle>30,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Te0 f22 766 292 36 24 20 -2 #rect
Te0 f22 @|CallSubIcon #fIcon
Te0 f29 expr out #txt
Te0 f29 784 316 784 356 #arcP
Te0 f18 actionDecl 'ch.ivyteam.wf.processes.TaskServiceData out;
' #txt
Te0 f18 actionTable 'out=in;
' #txt
Te0 f18 actionCode 'import ch.ivy.addon.portalkit.service.PortalConnectorDetector;
import ch.ivy.addon.portalkit.enums.WebServiceEndPoint;

PortalConnectorDetector detector = new PortalConnectorDetector();
in.endpoint = detector.getPortalConnectorURLOf(in.server) + WebServiceEndPoint.TASK.toString();' #txt
Te0 f18 type ch.ivyteam.wf.processes.TaskServiceData #txt
Te0 f18 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>get actual endpoint</name>
        <nameStyle>19,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Te0 f18 766 228 36 24 20 -2 #rect
Te0 f18 @|StepIcon #fIcon
Te0 f24 expr in #txt
Te0 f24 outCond in.isServerAlive #txt
Te0 f24 784 190 784 228 #arcP
Te0 f23 expr out #txt
Te0 f23 784 252 784 292 #arcP
Te0 f25 actionDecl 'ch.ivyteam.wf.processes.TaskServiceData out;
' #txt
Te0 f25 actionTable 'out=in;
' #txt
Te0 f25 actionCode 'import ch.ivy.addon.portalkit.service.ServerService;

ServerService serverService = new ServerService();
in.listIterator = serverService.findActiveServers().listIterator();' #txt
Te0 f25 type ch.ivyteam.wf.processes.TaskServiceData #txt
Te0 f25 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>get all servers</name>
        <nameStyle>15,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Te0 f25 70 116 36 24 20 -2 #rect
Te0 f25 @|StepIcon #fIcon
Te0 f26 expr out #txt
Te0 f26 88 76 88 116 #arcP
Te0 f30 expr out #txt
Te0 f30 88 140 88 170 #arcP
Te0 f77 type ch.ivyteam.wf.processes.TaskServiceData #txt
Te0 f77 processCall MultiPortal/IsAliveService:getApplicationList(ch.ivy.addon.portalkit.persistence.domain.Server) #txt
Te0 f77 doCall true #txt
Te0 f77 requestActionDecl '<ch.ivy.addon.portalkit.persistence.domain.Server server> param;
' #txt
Te0 f77 requestMappingAction 'param.server=in.server;
' #txt
Te0 f77 responseActionDecl 'ch.ivyteam.wf.processes.TaskServiceData out;
' #txt
Te0 f77 responseMappingAction 'out=in;
out.applications=result.apps;
out.isServerAlive=result.isServerAlive;
out.tempErrors=result.errors;
' #txt
Te0 f77 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>IsAliveService</name>
        <nameStyle>14,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Te0 f77 70 292 36 24 20 -2 #rect
Te0 f77 @|CallSubIcon #fIcon
Te0 f79 actionDecl 'ch.ivyteam.wf.processes.TaskServiceData out;
' #txt
Te0 f79 actionTable 'out=in;
' #txt
Te0 f79 actionCode 'import ch.ivy.addon.portalkit.persistence.domain.Server;


in.server = in.listIterator.next() as Server;' #txt
Te0 f79 type ch.ivyteam.wf.processes.TaskServiceData #txt
Te0 f79 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>get server</name>
        <nameStyle>10,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Te0 f79 70 228 36 24 20 -2 #rect
Te0 f79 @|StepIcon #fIcon
Te0 f34 expr out #txt
Te0 f34 88 252 88 292 #arcP
Te0 f35 expr in #txt
Te0 f35 outCond in.listIterator.hasNext() #txt
Te0 f35 88 198 88 228 #arcP
Te0 f37 expr out #txt
Te0 f37 88 316 88 362 #arcP
Te0 f6 type ch.ivyteam.wf.processes.TaskServiceData #txt
Te0 f6 processCall MultiPortal/IsAliveService:getApplicationList(ch.ivy.addon.portalkit.persistence.domain.Server) #txt
Te0 f6 doCall true #txt
Te0 f6 requestActionDecl '<ch.ivy.addon.portalkit.persistence.domain.Server server> param;
' #txt
Te0 f6 requestMappingAction 'param.server=in.server;
' #txt
Te0 f6 responseActionDecl 'ch.ivyteam.wf.processes.TaskServiceData out;
' #txt
Te0 f6 responseMappingAction 'out=in;
out.applications=result.apps;
out.errors=result.errors;
out.isServerAlive=result.isServerAlive;
' #txt
Te0 f6 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>IsAliveService</name>
        <nameStyle>14,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Te0 f6 766 108 36 24 20 -2 #rect
Te0 f6 @|CallSubIcon #fIcon
Te0 f7 expr out #txt
Te0 f7 784 77 784 108 #arcP
Te0 f13 expr out #txt
Te0 f13 784 132 784 162 #arcP
Te0 f14 type ch.ivyteam.wf.processes.TaskServiceData #txt
Te0 f14 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>server alive</name>
        <nameStyle>12,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Te0 f14 978 170 28 28 8 -27 #rect
Te0 f14 @|AlternativeIcon #fIcon
Te0 f15 actionDecl 'ch.ivyteam.wf.processes.TaskServiceData out;
' #txt
Te0 f15 actionTable 'out=in;
' #txt
Te0 f15 actionCode 'import ch.ivy.ws.addon.WsException;
for(WsException error : in.errors){
	error.server = in.server.name;
}' #txt
Te0 f15 type ch.ivyteam.wf.processes.TaskServiceData #txt
Te0 f15 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>utils</name>
        <nameStyle>5,7
</nameStyle>
        <desc>add server name for exceptions</desc>
    </language>
</elementInfo>
' #txt
Te0 f15 974 364 36 24 20 -2 #rect
Te0 f15 @|StepIcon #fIcon
Te0 f17 inParamDecl '<ch.ivy.ws.addon.IvySecurityMember ivySecurityMember,ch.ivy.addon.portalkit.persistence.domain.Server ivyServer,java.lang.Long taskId> param;' #txt
Te0 f17 inParamTable 'out.ivySecurityMember=param.ivySecurityMember;
out.server=param.ivyServer;
out.taskId=param.taskId;
' #txt
Te0 f17 outParamDecl '<List<ch.ivy.ws.addon.WsException> errors,ch.ivy.ws.addon.IvyTask ivyTask> result;
' #txt
Te0 f17 outParamTable 'result.errors=in.errors;
result.ivyTask=in.ivyTask;
' #txt
Te0 f17 actionDecl 'ch.ivyteam.wf.processes.TaskServiceData out;
' #txt
Te0 f17 callSignature delegateTask(ch.ivy.ws.addon.IvySecurityMember,ch.ivy.addon.portalkit.persistence.domain.Server,Long) #txt
Te0 f17 type ch.ivyteam.wf.processes.TaskServiceData #txt
Te0 f17 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>delegateTask
(IvySecurityMember,Server,Long)</name>
        <nameStyle>44,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Te0 f17 979 51 26 26 14 0 #rect
Te0 f17 @|StartSubIcon #fIcon
Te0 f28 actionDecl 'ch.ivyteam.wf.processes.TaskServiceData out;
' #txt
Te0 f28 actionTable 'out=in;
' #txt
Te0 f28 actionCode 'import ch.ivy.addon.portalkit.service.PortalConnectorDetector;
import ch.ivy.addon.portalkit.enums.WebServiceEndPoint;

PortalConnectorDetector detector = new PortalConnectorDetector();
in.endpoint = detector.getPortalConnectorURLOf(in.server) + WebServiceEndPoint.TASK.toString();' #txt
Te0 f28 type ch.ivyteam.wf.processes.TaskServiceData #txt
Te0 f28 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>get actual endpoint</name>
        <nameStyle>19,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Te0 f28 974 236 36 24 20 -2 #rect
Te0 f28 @|StepIcon #fIcon
Te0 f33 type ch.ivyteam.wf.processes.TaskServiceData #txt
Te0 f33 processCall ServiceIntegrators/TaskServiceIntegrator:delegateTask(ch.ivy.ws.addon.IvySecurityMember,String,ch.ivy.addon.portalkit.persistence.domain.Server,Long) #txt
Te0 f33 doCall true #txt
Te0 f33 requestActionDecl '<ch.ivy.ws.addon.IvySecurityMember ivySecurityMember,java.lang.String endpoint,ch.ivy.addon.portalkit.persistence.domain.Server server,java.lang.Long taskId> param;
' #txt
Te0 f33 requestMappingAction 'param.ivySecurityMember=in.ivySecurityMember;
param.endpoint=in.endpoint;
param.server=in.server;
param.taskId=in.taskId;
' #txt
Te0 f33 responseActionDecl 'ch.ivyteam.wf.processes.TaskServiceData out;
' #txt
Te0 f33 responseMappingAction 'out=in;
out.errors=result.errors;
out.ivyTask=result.task;
' #txt
Te0 f33 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>delegateTask</name>
        <nameStyle>12,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Te0 f33 974 300 36 24 20 -2 #rect
Te0 f33 @|CallSubIcon #fIcon
Te0 f39 type ch.ivyteam.wf.processes.TaskServiceData #txt
Te0 f39 processCall MultiPortal/IsAliveService:getApplicationList(ch.ivy.addon.portalkit.persistence.domain.Server) #txt
Te0 f39 doCall true #txt
Te0 f39 requestActionDecl '<ch.ivy.addon.portalkit.persistence.domain.Server server> param;
' #txt
Te0 f39 requestMappingAction 'param.server=in.server;
' #txt
Te0 f39 responseActionDecl 'ch.ivyteam.wf.processes.TaskServiceData out;
' #txt
Te0 f39 responseMappingAction 'out=in;
out.applications=result.apps;
out.isServerAlive=result.isServerAlive;
out.tempErrors=result.errors;
' #txt
Te0 f39 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>IsAliveService</name>
        <nameStyle>14,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Te0 f39 974 108 36 24 20 -2 #rect
Te0 f39 @|CallSubIcon #fIcon
Te0 f41 expr in #txt
Te0 f41 1006 184 1010 376 #arcP
Te0 f41 1 1128 184 #addKink
Te0 f41 2 1128 376 #addKink
Te0 f41 0 0.9217931257916813 0 0 #arcLabel
Te0 f43 expr out #txt
Te0 f43 992 324 992 364 #arcP
Te0 f45 expr in #txt
Te0 f45 outCond in.isServerAlive #txt
Te0 f45 992 198 992 236 #arcP
Te0 f46 expr out #txt
Te0 f46 992 260 992 300 #arcP
Te0 f50 expr out #txt
Te0 f50 992 77 992 108 #arcP
Te0 f51 expr out #txt
Te0 f51 992 132 992 170 #arcP
Te0 f62 inParamDecl '<ch.ivy.ws.addon.TaskSearchCriteria taskSearchCriteria> param;' #txt
Te0 f62 inParamTable 'out.taskSearchCriteria=param.taskSearchCriteria;
' #txt
Te0 f62 outParamDecl '<List<ch.ivy.ws.addon.WsException> errors,List<ch.ivy.addon.portalkit.bo.RemoteTask> tasks> result;
' #txt
Te0 f62 outParamTable 'result.errors=in.errors;
result.tasks=in.tasks;
' #txt
Te0 f62 actionDecl 'ch.ivyteam.wf.processes.TaskServiceData out;
' #txt
Te0 f62 callSignature findTasksByCriteria(ch.ivy.ws.addon.TaskSearchCriteria) #txt
Te0 f62 type ch.ivyteam.wf.processes.TaskServiceData #txt
Te0 f62 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>findTasksByCriteria
(TaskSearchCriteria)</name>
        <nameStyle>40,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Te0 f62 1251 51 26 26 14 0 #rect
Te0 f62 @|StartSubIcon #fIcon
Te0 f56 actionDecl 'ch.ivyteam.wf.processes.TaskServiceData out;
' #txt
Te0 f56 actionTable 'out=in;
' #txt
Te0 f56 actionCode 'import ch.ivy.addon.portalkit.service.ServerService;

ServerService serverService = new ServerService();
in.servers = serverService.findActiveServers();' #txt
Te0 f56 type ch.ivyteam.wf.processes.TaskServiceData #txt
Te0 f56 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>get all servers</name>
        <nameStyle>15,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Te0 f56 1246 116 36 24 20 -2 #rect
Te0 f56 @|StepIcon #fIcon
Te0 f73 expr out #txt
Te0 f73 1264 77 1264 116 #arcP
Te0 f81 actionDecl 'ch.ivyteam.wf.processes.TaskServiceData out;
' #txt
Te0 f81 actionTable 'out=in;
' #txt
Te0 f81 actionCode 'import ch.ivy.ws.addon.WsException;
for(WsException error : in.errors){
	error.server = in.server.name;
}' #txt
Te0 f81 type ch.ivyteam.wf.processes.TaskServiceData #txt
Te0 f81 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>utils</name>
        <nameStyle>5,7
</nameStyle>
        <desc>add server name for exceptions</desc>
    </language>
</elementInfo>
' #txt
Te0 f81 1686 372 36 24 20 -2 #rect
Te0 f81 @|StepIcon #fIcon
Te0 f82 type ch.ivyteam.wf.processes.TaskServiceData #txt
Te0 f82 processCall MultiPortal/IsAliveService:getApplicationList(ch.ivy.addon.portalkit.persistence.domain.Server) #txt
Te0 f82 doCall true #txt
Te0 f82 requestActionDecl '<ch.ivy.addon.portalkit.persistence.domain.Server server> param;
' #txt
Te0 f82 requestMappingAction 'param.server=in.server;
' #txt
Te0 f82 responseActionDecl 'ch.ivyteam.wf.processes.TaskServiceData out;
' #txt
Te0 f82 responseMappingAction 'out=in;
out.applications=result.apps;
out.errors=result.errors;
out.isServerAlive=result.isServerAlive;
' #txt
Te0 f82 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>IsAliveService</name>
        <nameStyle>14,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Te0 f82 1686 116 36 24 20 -2 #rect
Te0 f82 @|CallSubIcon #fIcon
Te0 f83 actionDecl 'ch.ivyteam.wf.processes.TaskServiceData out;
' #txt
Te0 f83 actionTable 'out=in;
' #txt
Te0 f83 actionCode 'import ch.ivy.addon.portalkit.service.PortalConnectorDetector;
import ch.ivy.addon.portalkit.enums.WebServiceEndPoint;

PortalConnectorDetector detector = new PortalConnectorDetector();
in.endpoint = detector.getPortalConnectorURLOf(in.server) + WebServiceEndPoint.TASK.toString();' #txt
Te0 f83 type ch.ivyteam.wf.processes.TaskServiceData #txt
Te0 f83 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>get actual endpoint</name>
        <nameStyle>19,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Te0 f83 1686 244 36 24 20 -2 #rect
Te0 f83 @|StepIcon #fIcon
Te0 f84 inParamDecl '<java.lang.String userName,ch.ivy.addon.portalkit.persistence.domain.Server ivyServer,java.lang.Long taskId> param;' #txt
Te0 f84 inParamTable 'out.server=param.ivyServer;
out.taskId=param.taskId;
out.userName=param.userName;
' #txt
Te0 f84 outParamDecl '<java.lang.String workerUserName,List<ch.ivy.ws.addon.WsException> errors,java.lang.Boolean canUserResumeTask> result;
' #txt
Te0 f84 outParamTable 'result.workerUserName=in.workerUserName;
result.errors=in.errors;
result.canUserResumeTask=in.canUserResumeTask;
' #txt
Te0 f84 actionDecl 'ch.ivyteam.wf.processes.TaskServiceData out;
' #txt
Te0 f84 callSignature canUserResumeTask(String,ch.ivy.addon.portalkit.persistence.domain.Server,Long) #txt
Te0 f84 type ch.ivyteam.wf.processes.TaskServiceData #txt
Te0 f84 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>canUserResumeTask
(String,Server,Long)</name>
        <nameStyle>38,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Te0 f84 1691 51 26 26 14 0 #rect
Te0 f84 @|StartSubIcon #fIcon
Te0 f85 type ch.ivyteam.wf.processes.TaskServiceData #txt
Te0 f85 processCall ServiceIntegrators/TaskServiceIntegrator:canUserResumeTask(ch.ivy.addon.portalkit.persistence.domain.Server,String,String,Long) #txt
Te0 f85 doCall true #txt
Te0 f85 requestActionDecl '<ch.ivy.addon.portalkit.persistence.domain.Server server,java.lang.String userName,java.lang.String endpoint,java.lang.Long taskId> param;
' #txt
Te0 f85 requestMappingAction 'param.server=in.server;
param.userName=in.userName;
param.endpoint=in.endpoint;
param.taskId=in.taskId;
' #txt
Te0 f85 responseActionDecl 'ch.ivyteam.wf.processes.TaskServiceData out;
' #txt
Te0 f85 responseMappingAction 'out=in;
out.canUserResumeTask=result.canUserResumeTask;
out.errors=result.errors;
out.workerUserName=result.workerUserName;
' #txt
Te0 f85 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>TaskServiceIntegrator</name>
        <nameStyle>21,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Te0 f85 1686 308 36 24 20 -2 #rect
Te0 f85 @|CallSubIcon #fIcon
Te0 f86 type ch.ivyteam.wf.processes.TaskServiceData #txt
Te0 f86 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>server alive</name>
        <nameStyle>12,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Te0 f86 1690 178 28 28 8 -27 #rect
Te0 f86 @|AlternativeIcon #fIcon
Te0 f87 expr in #txt
Te0 f87 1718 192 1722 384 #arcP
Te0 f87 1 1850 192 #addKink
Te0 f87 2 1850 384 #addKink
Te0 f87 0 0.9217931257916813 0 0 #arcLabel
Te0 f89 expr out #txt
Te0 f89 1704 332 1704 372 #arcP
Te0 f90 expr in #txt
Te0 f90 outCond in.isServerAlive #txt
Te0 f90 1704 206 1704 244 #arcP
Te0 f91 expr out #txt
Te0 f91 1704 268 1704 308 #arcP
Te0 f92 expr out #txt
Te0 f92 1704 77 1704 116 #arcP
Te0 f93 expr out #txt
Te0 f93 1704 140 1704 178 #arcP
Te0 f96 inParamDecl '<java.lang.String noteContent,java.lang.String username,ch.ivy.addon.portalkit.persistence.domain.Server server,java.lang.Long taskId> param;' #txt
Te0 f96 inParamTable 'out.noteContent=param.noteContent;
out.server=param.server;
out.taskId=param.taskId;
out.userName=param.username;
' #txt
Te0 f96 outParamDecl '<ch.ivy.ws.addon.IvyNote note,List<ch.ivy.ws.addon.WsException> errors> result;
' #txt
Te0 f96 outParamTable 'result.note=in.note;
result.errors=in.errors;
' #txt
Te0 f96 actionDecl 'ch.ivyteam.wf.processes.TaskServiceData out;
' #txt
Te0 f96 callSignature createNote(String,String,ch.ivy.addon.portalkit.persistence.domain.Server,Long) #txt
Te0 f96 type ch.ivyteam.wf.processes.TaskServiceData #txt
Te0 f96 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>createNote
(String,String,Server,Long)</name>
        <nameStyle>38,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Te0 f96 1899 51 26 26 14 0 #rect
Te0 f96 @|StartSubIcon #fIcon
Te0 f97 type ch.ivyteam.wf.processes.TaskServiceData #txt
Te0 f97 processCall MultiPortal/IsAliveService:getApplicationList(ch.ivy.addon.portalkit.persistence.domain.Server) #txt
Te0 f97 doCall true #txt
Te0 f97 requestActionDecl '<ch.ivy.addon.portalkit.persistence.domain.Server server> param;
' #txt
Te0 f97 requestMappingAction 'param.server=in.server;
' #txt
Te0 f97 responseActionDecl 'ch.ivyteam.wf.processes.TaskServiceData out;
' #txt
Te0 f97 responseMappingAction 'out=in;
out.applications=result.apps;
out.errors=result.errors;
out.isServerAlive=result.isServerAlive;
' #txt
Te0 f97 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>IsAliveService</name>
        <nameStyle>14,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Te0 f97 1894 116 36 24 20 -2 #rect
Te0 f97 @|CallSubIcon #fIcon
Te0 f98 expr out #txt
Te0 f98 1912 77 1912 116 #arcP
Te0 f99 type ch.ivyteam.wf.processes.TaskServiceData #txt
Te0 f99 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>server alive?</name>
        <nameStyle>13,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Te0 f99 1898 178 28 28 16 -24 #rect
Te0 f99 @|AlternativeIcon #fIcon
Te0 f100 expr out #txt
Te0 f100 1912 140 1912 178 #arcP
Te0 f101 actionDecl 'ch.ivyteam.wf.processes.TaskServiceData out;
' #txt
Te0 f101 actionTable 'out=in;
' #txt
Te0 f101 actionCode 'import ch.ivy.addon.portalkit.service.PortalConnectorDetector;
import ch.ivy.addon.portalkit.enums.WebServiceEndPoint;

PortalConnectorDetector detector = new PortalConnectorDetector();
in.endpoint = detector.getPortalConnectorURLOf(in.server) + WebServiceEndPoint.TASK.toString();' #txt
Te0 f101 type ch.ivyteam.wf.processes.TaskServiceData #txt
Te0 f101 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>get actual endpoint</name>
        <nameStyle>19,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Te0 f101 1894 244 36 24 20 -2 #rect
Te0 f101 @|StepIcon #fIcon
Te0 f102 expr in #txt
Te0 f102 outCond in.isServerAlive #txt
Te0 f102 .xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>yes</name>
        <nameStyle>3,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Te0 f102 1912 206 1912 244 #arcP
Te0 f102 0 0.3157894736842105 -12 -1 #arcLabel
Te0 f103 type ch.ivyteam.wf.processes.TaskServiceData #txt
Te0 f103 processCall ServiceIntegrators/TaskServiceIntegrator:createNote(String,String,ch.ivy.addon.portalkit.persistence.domain.Server,String,Long) #txt
Te0 f103 doCall true #txt
Te0 f103 requestActionDecl '<java.lang.String endpoint,java.lang.String username,ch.ivy.addon.portalkit.persistence.domain.Server server,java.lang.String noteContent,java.lang.Long taskId> param;
' #txt
Te0 f103 requestMappingAction 'param.endpoint=in.endpoint;
param.username=in.userName;
param.server=in.server;
param.noteContent=in.noteContent;
param.taskId=in.taskId;
' #txt
Te0 f103 responseActionDecl 'ch.ivyteam.wf.processes.TaskServiceData out;
' #txt
Te0 f103 responseMappingAction 'out=in;
out.errors=result.errors;
out.note=result.note;
' #txt
Te0 f103 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>CreateNoteServiceIntegrator</name>
        <nameStyle>27,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Te0 f103 1894 308 36 24 20 -2 #rect
Te0 f103 @|CallSubIcon #fIcon
Te0 f104 expr out #txt
Te0 f104 1912 268 1912 308 #arcP
Te0 f105 actionDecl 'ch.ivyteam.wf.processes.TaskServiceData out;
' #txt
Te0 f105 actionTable 'out=in;
' #txt
Te0 f105 actionCode 'import ch.ivy.ws.addon.WsException;
for(WsException error : in.errors){
	error.server = in.server.name;
}' #txt
Te0 f105 type ch.ivyteam.wf.processes.TaskServiceData #txt
Te0 f105 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>utils</name>
        <nameStyle>5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Te0 f105 1894 372 36 24 14 9 #rect
Te0 f105 @|StepIcon #fIcon
Te0 f109 expr in #txt
Te0 f109 .xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>no</name>
        <nameStyle>2,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Te0 f109 1926 192 1930 384 #arcP
Te0 f109 1 2098 192 #addKink
Te0 f109 2 2098 384 #addKink
Te0 f109 1 0.16145833333333334 -9 0 #arcLabel
Te0 f114 inParamDecl '<java.lang.String user> param;' #txt
Te0 f114 inParamTable 'out.userName=param.user;
' #txt
Te0 f114 outParamDecl '<List<ch.ivy.addon.portalkit.bo.RemoteTask> allTasks,List<ch.ivy.ws.addon.WsException> errors,List<ch.ivy.addon.portalkit.bo.RemoteTask> personalTasks> result;
' #txt
Te0 f114 outParamTable 'result.allTasks=in.allTasks;
result.errors=in.errors;
result.personalTasks=in.tasks;
' #txt
Te0 f114 actionDecl 'ch.ivyteam.wf.processes.TaskServiceData out;
' #txt
Te0 f114 callSignature findAllRunningTasks(String) #txt
Te0 f114 type ch.ivyteam.wf.processes.TaskServiceData #txt
Te0 f114 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>findAllRunningTasks
(String)</name>
        <nameStyle>28,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Te0 f114 412 52 24 24 14 0 #rect
Te0 f114 @|StartSubIcon #fIcon
Te0 f117 type ch.ivyteam.wf.processes.TaskServiceData #txt
Te0 f117 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>next server</name>
        <nameStyle>11,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Te0 f117 410 170 28 28 22 -21 #rect
Te0 f117 @|AlternativeIcon #fIcon
Te0 f118 actionDecl 'ch.ivyteam.wf.processes.TaskServiceData out;
' #txt
Te0 f118 actionTable 'out=in;
' #txt
Te0 f118 actionCode 'import ch.ivy.addon.portalkit.persistence.domain.Server;


in.server = in.listIterator.next() as Server;' #txt
Te0 f118 type ch.ivyteam.wf.processes.TaskServiceData #txt
Te0 f118 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>get server</name>
        <nameStyle>10,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Te0 f118 406 228 36 24 20 -2 #rect
Te0 f118 @|StepIcon #fIcon
Te0 f119 actionDecl 'ch.ivyteam.wf.processes.TaskServiceData out;
' #txt
Te0 f119 actionTable 'out=in;
' #txt
Te0 f119 actionCode 'import ch.ivy.addon.portalkit.persistence.domain.Application;
import ch.ivy.addon.portalkit.enums.WebServiceEndPoint;

import ch.ivy.addon.portalkit.bo.RemoteTask;
import ch.ivy.addon.portalkit.mapper.RemoteTaskMapper;

String address = in.server.path + WebServiceEndPoint.CASE.toString();
String portalKitAddress = ivy.cms.co("/ch.ivy.addon.portalkit/variables/portalkit_serveradress");

List<RemoteTask> remotePersonalTasks = RemoteTaskMapper.mapTasks(in.ivyTasks);
for(RemoteTask remotePersonalTask : remotePersonalTasks){
	//set server address
	remotePersonalTask.getCase().setAdditionalProperty(portalKitAddress, address);
	//set appRegister
	for(Application app : in.server.getApplications()){
		if(remotePersonalTask.application.getName().equals(app.name)){
			app.setServer(in.server);
			remotePersonalTask.setApplicationRegister(app);
			break;
		}
	}
}
in.tasks.addAll(remotePersonalTasks);

List<RemoteTask> remoteAllTasks = RemoteTaskMapper.mapTasks(in.allIvyTasks);
for(RemoteTask remoteTask : remoteAllTasks){
	//set server address
	remoteTask.getCase().setAdditionalProperty(portalKitAddress, address);
	//set appRegister
	for(Application app : in.server.getApplications()){
		if(remoteTask.application.getName().equals(app.name)){
			app.setServer(in.server);
			remoteTask.setApplicationRegister(app);
			break;
		}
	}
}
in.allTasks.addAll(remoteAllTasks);' #txt
Te0 f119 type ch.ivyteam.wf.processes.TaskServiceData #txt
Te0 f119 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>add tasks</name>
        <nameStyle>9,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Te0 f119 406 652 36 24 20 -2 #rect
Te0 f119 @|StepIcon #fIcon
Te0 f120 type ch.ivyteam.wf.processes.TaskServiceData #txt
Te0 f120 processCall MultiPortal/IsAliveService:getApplicationList(ch.ivy.addon.portalkit.persistence.domain.Server) #txt
Te0 f120 doCall true #txt
Te0 f120 requestActionDecl '<ch.ivy.addon.portalkit.persistence.domain.Server server> param;
' #txt
Te0 f120 requestMappingAction 'param.server=in.server;
' #txt
Te0 f120 responseActionDecl 'ch.ivyteam.wf.processes.TaskServiceData out;
' #txt
Te0 f120 responseMappingAction 'out=in;
out.applications=result.apps;
out.isServerAlive=result.isServerAlive;
out.tempErrors=result.errors;
' #txt
Te0 f120 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>IsAliveService</name>
        <nameStyle>14,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Te0 f120 406 292 36 24 20 -2 #rect
Te0 f120 @|CallSubIcon #fIcon
Te0 f121 type ch.ivyteam.wf.processes.TaskServiceData #txt
Te0 f121 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>server alive</name>
        <nameStyle>12,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Te0 f121 410 362 28 28 11 -29 #rect
Te0 f121 @|AlternativeIcon #fIcon
Te0 f122 actionDecl 'ch.ivyteam.wf.processes.TaskServiceData out;
' #txt
Te0 f122 actionTable 'out=in;
' #txt
Te0 f122 actionCode 'import ch.ivy.ws.addon.WsException;
for(int i = 0 ; i < in.tempErrors.size() ; i++){
	WsException w = in.tempErrors.get(i) as WsException;
	w.server = in.server.name;
	in.tempErrors.set(i,w);
	}
in.errors.addAll(in.tempErrors);

in.apps.clear();' #txt
Te0 f122 type ch.ivyteam.wf.processes.TaskServiceData #txt
Te0 f122 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>utils</name>
        <nameStyle>5,7
</nameStyle>
        <desc>add server name for exceptions

clear apps list</desc>
    </language>
</elementInfo>
' #txt
Te0 f122 542 204 36 24 20 -2 #rect
Te0 f122 @|StepIcon #fIcon
Te0 f123 type ch.ivyteam.wf.processes.TaskServiceData #txt
Te0 f123 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>has apps?</name>
        <nameStyle>9,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Te0 f123 410 498 28 28 14 0 #rect
Te0 f123 @|AlternativeIcon #fIcon
Te0 f125 type ch.ivyteam.wf.processes.TaskServiceData #txt
Te0 f125 processCall ServiceIntegrators/TaskServiceIntegrator:findAllRunningTasks(String,String,List<String>,ch.ivy.addon.portalkit.persistence.domain.Server) #txt
Te0 f125 doCall true #txt
Te0 f125 requestActionDecl '<java.lang.String endpoint,java.lang.String userName,List<java.lang.String> applicationNames,ch.ivy.addon.portalkit.persistence.domain.Server server> param;
' #txt
Te0 f125 requestMappingAction 'param.endpoint=in.endpoint;
param.userName=in.userName;
param.applicationNames=in.apps;
param.server=in.server;
' #txt
Te0 f125 responseActionDecl 'ch.ivyteam.wf.processes.TaskServiceData out;
' #txt
Te0 f125 responseMappingAction 'out=in;
out.allIvyTasks=result.allTasks;
out.ivyTasks=result.personalTasks;
out.tempErrors=result.errors;
' #txt
Te0 f125 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>findAllRunningTasks</name>
        <nameStyle>19,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Te0 f125 406 580 36 24 20 -2 #rect
Te0 f125 @|CallSubIcon #fIcon
Te0 f126 actionDecl 'ch.ivyteam.wf.processes.TaskServiceData out;
' #txt
Te0 f126 actionTable 'out=in;
' #txt
Te0 f126 actionCode 'import ch.ivy.addon.portalkit.service.ServerService;

ServerService serverService = new ServerService();
in.listIterator = serverService.findActiveServers().listIterator();' #txt
Te0 f126 type ch.ivyteam.wf.processes.TaskServiceData #txt
Te0 f126 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>get all servers</name>
        <nameStyle>15,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Te0 f126 406 116 36 24 20 -2 #rect
Te0 f126 @|StepIcon #fIcon
Te0 f127 actionDecl 'ch.ivyteam.wf.processes.TaskServiceData out;
' #txt
Te0 f127 actionTable 'out=in;
' #txt
Te0 f127 actionCode 'import ch.ivy.addon.portalkit.persistence.domain.Application;
import ch.ivy.addon.portalkit.service.PortalConnectorDetector;
import ch.ivyteam.ivy.server.ServerFactory;
import ch.ivy.addon.portalkit.service.ApplicationService;
import ch.ivy.ws.addon.IvyApplication;
import ch.ivy.addon.portalkit.service.UserService;
import ch.ivy.addon.portalkit.enums.WebServiceEndPoint;


in.apps.clear();

UserService userService = new UserService();
java.util.List<String> apps = userService.findApplicationNamesUserCanWorkOn(in.userName, in.server.id);	
for(String appName: apps) {
	for (Application application : in.server.getApplications()) {
		if(appName.equals(application.name) && application.isVisible && !in.apps.contains(appName)){
			in.apps.add(appName);
		}
	}
}
if (in.apps.isEmpty()) {
	ApplicationService applicationService = new ApplicationService();
	in.apps = applicationService.getApplicationNames(in.applications);
}

PortalConnectorDetector detector = new PortalConnectorDetector();
in.endpoint = detector.getPortalConnectorURLOf(in.server) + WebServiceEndPoint.TASK.toString();
' #txt
Te0 f127 type ch.ivyteam.wf.processes.TaskServiceData #txt
Te0 f127 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>get Allive Apps
ws endpoint</name>
        <nameStyle>27,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Te0 f127 406 420 36 24 21 -18 #rect
Te0 f127 @|StepIcon #fIcon
Te0 f129 expr in #txt
Te0 f129 outCond in.isServerAlive #txt
Te0 f129 424 390 424 420 #arcP
Te0 f130 expr out #txt
Te0 f130 442 664 560 228 #arcP
Te0 f130 1 560 664 #addKink
Te0 f130 1 0.4321413036724042 0 0 #arcLabel
Te0 f131 expr in #txt
Te0 f131 438 376 560 228 #arcP
Te0 f131 1 560 376 #addKink
Te0 f131 1 0.5115178601655154 0 0 #arcLabel
Te0 f132 expr out #txt
Te0 f132 560 204 438 184 #arcP
Te0 f132 1 560 184 #addKink
Te0 f132 1 0.31135433052386374 0 0 #arcLabel
Te0 f133 expr out #txt
Te0 f133 424 444 424 498 #arcP
Te0 f134 expr in #txt
Te0 f134 438 512 560 228 #arcP
Te0 f134 1 560 512 #addKink
Te0 f134 0 0.9540356379241759 0 0 #arcLabel
Te0 f135 expr in #txt
Te0 f135 outCond 'in.apps.size() > 0' #txt
Te0 f135 424 526 424 580 #arcP
Te0 f136 expr out #txt
Te0 f136 424 604 424 652 #arcP
Te0 f137 expr out #txt
Te0 f137 424 76 424 116 #arcP
Te0 f138 expr out #txt
Te0 f138 424 140 424 170 #arcP
Te0 f139 expr out #txt
Te0 f139 424 252 424 292 #arcP
Te0 f140 expr in #txt
Te0 f140 outCond in.listIterator.hasNext() #txt
Te0 f140 424 198 424 228 #arcP
Te0 f141 expr out #txt
Te0 f141 424 316 424 362 #arcP
Te0 f144 type ch.ivyteam.wf.processes.TaskServiceData #txt
Te0 f144 processCall 'Functional Processes/ErrorHandler:handle(List<ch.ivy.ws.addon.WsException>)' #txt
Te0 f144 doCall true #txt
Te0 f144 requestActionDecl '<java.util.List<ch.ivy.ws.addon.WsException> exceptions> param;
' #txt
Te0 f144 requestMappingAction 'param.exceptions=in.errors;
' #txt
Te0 f144 responseActionDecl 'ch.ivyteam.wf.processes.TaskServiceData out;
' #txt
Te0 f144 responseMappingAction 'out=in;
' #txt
Te0 f144 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>handle errors if any</name>
        <nameStyle>20,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Te0 f144 766 764 36 24 20 -2 #rect
Te0 f144 @|CallSubIcon #fIcon
Te0 f40 expr out #txt
Te0 f40 784 788 784 811 #arcP
Te0 f148 type ch.ivyteam.wf.processes.TaskServiceData #txt
Te0 f148 770 722 28 28 14 0 #rect
Te0 f148 @|AlternativeIcon #fIcon
Te0 f149 expr in #txt
Te0 f149 410 184 771 735 #arcP
Te0 f149 1 344 184 #addKink
Te0 f149 2 344 712 #addKink
Te0 f149 1 0.638262288682535 0 0 #arcLabel
Te0 f145 expr out #txt
Te0 f145 784 380 784 722 #arcP
Te0 f21 expr out #txt
Te0 f21 992 388 795 733 #arcP
Te0 f21 1 992 688 #addKink
Te0 f21 0 0.8445206008999235 0 0 #arcLabel
Te0 f64 expr out #txt
Te0 f64 1704 396 797 735 #arcP
Te0 f64 1 1704 688 #addKink
Te0 f64 1 0.2885922078745302 0 0 #arcLabel
Te0 f88 expr out #txt
Te0 f88 1912 396 798 736 #arcP
Te0 f88 1 1912 704 #addKink
Te0 f88 1 0.325354739952554 0 0 #arcLabel
Te0 f107 expr in #txt
Te0 f107 784 750 784 764 #arcP
Te0 f11 expr in #txt
Te0 f11 74 184 770 736 #arcP
Te0 f11 1 40 184 #addKink
Te0 f11 2 40 736 #addKink
Te0 f11 2 0.33672122528164045 0 0 #arcLabel
Te0 f12 inParamDecl '<java.lang.String userName,ch.ivy.addon.portalkit.persistence.domain.Server server,java.lang.Long caseId> param;' #txt
Te0 f12 inParamTable 'out.caseId=param.caseId;
out.server=param.server;
out.userName=param.userName;
' #txt
Te0 f12 outParamDecl '<List<ch.ivy.ws.addon.WsException> errors,List<ch.ivy.addon.portalkit.bo.RemoteTask> tasks> result;
' #txt
Te0 f12 outParamTable 'result.errors=in.errors;
result.tasks=in.tasks;
' #txt
Te0 f12 actionDecl 'ch.ivyteam.wf.processes.TaskServiceData out;
' #txt
Te0 f12 callSignature findTasksOfCase(String,ch.ivy.addon.portalkit.persistence.domain.Server,Long) #txt
Te0 f12 type ch.ivyteam.wf.processes.TaskServiceData #txt
Te0 f12 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>findTasksOfCase(String,Server,Long)</name>
        <nameStyle>35,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Te0 f12 2179 51 26 26 14 0 #rect
Te0 f12 @|StartSubIcon #fIcon
Te0 f59 type ch.ivyteam.wf.processes.TaskServiceData #txt
Te0 f59 processCall MultiPortal/IsAliveService:getApplicationList(ch.ivy.addon.portalkit.persistence.domain.Server) #txt
Te0 f59 doCall true #txt
Te0 f59 requestActionDecl '<ch.ivy.addon.portalkit.persistence.domain.Server server> param;
' #txt
Te0 f59 requestMappingAction 'param.server=in.server;
' #txt
Te0 f59 responseActionDecl 'ch.ivyteam.wf.processes.TaskServiceData out;
' #txt
Te0 f59 responseMappingAction 'out=in;
out.applications=result.apps;
out.errors=result.errors;
out.isServerAlive=result.isServerAlive;
' #txt
Te0 f59 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>IsAliveService</name>
        <nameStyle>14,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Te0 f59 2174 116 36 24 20 -2 #rect
Te0 f59 @|CallSubIcon #fIcon
Te0 f80 actionDecl 'ch.ivyteam.wf.processes.TaskServiceData out;
' #txt
Te0 f80 actionTable 'out=in;
' #txt
Te0 f80 actionCode 'import ch.ivy.addon.portalkit.service.PortalConnectorDetector;
import ch.ivy.addon.portalkit.enums.WebServiceEndPoint;

PortalConnectorDetector detector = new PortalConnectorDetector();
in.endpoint = detector.getPortalConnectorURLOf(in.server) + WebServiceEndPoint.TASK.toString();' #txt
Te0 f80 type ch.ivyteam.wf.processes.TaskServiceData #txt
Te0 f80 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>get actual endpoint</name>
        <nameStyle>19,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Te0 f80 2174 244 36 24 20 -2 #rect
Te0 f80 @|StepIcon #fIcon
Te0 f106 type ch.ivyteam.wf.processes.TaskServiceData #txt
Te0 f106 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>server alive?</name>
        <nameStyle>13,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Te0 f106 2178 178 28 28 16 -24 #rect
Te0 f106 @|AlternativeIcon #fIcon
Te0 f110 type ch.ivyteam.wf.processes.TaskServiceData #txt
Te0 f110 processCall ServiceIntegrators/TaskServiceIntegrator:findTasksOfCase(String,String,ch.ivy.addon.portalkit.persistence.domain.Server,Long) #txt
Te0 f110 doCall true #txt
Te0 f110 requestActionDecl '<java.lang.String userName,java.lang.String endpoint,ch.ivy.addon.portalkit.persistence.domain.Server server,java.lang.Long caseId> param;
' #txt
Te0 f110 requestMappingAction 'param.userName=in.userName;
param.endpoint=in.endpoint;
param.server=in.server;
param.caseId=in.caseId;
' #txt
Te0 f110 responseActionDecl 'ch.ivyteam.wf.processes.TaskServiceData out;
' #txt
Te0 f110 responseMappingAction 'out=in;
out.errors=result.errors;
out.ivyTasks=result.tasks;
' #txt
Te0 f110 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>TaskServiceIntegrator</name>
        <nameStyle>21,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Te0 f110 2174 308 36 24 20 -2 #rect
Te0 f110 @|CallSubIcon #fIcon
Te0 f111 actionDecl 'ch.ivyteam.wf.processes.TaskServiceData out;
' #txt
Te0 f111 actionTable 'out=in;
' #txt
Te0 f111 actionCode 'import ch.ivy.ws.addon.WsException;
for(WsException error : in.errors){
	error.server = in.server.name;
}' #txt
Te0 f111 type ch.ivyteam.wf.processes.TaskServiceData #txt
Te0 f111 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>utils</name>
        <nameStyle>5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Te0 f111 2174 468 36 24 14 9 #rect
Te0 f111 @|StepIcon #fIcon
Te0 f112 expr out #txt
Te0 f112 2192 140 2192 178 #arcP
Te0 f113 expr in #txt
Te0 f113 outCond in.isServerAlive #txt
Te0 f113 .xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>yes</name>
        <nameStyle>3,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Te0 f113 2192 206 2192 244 #arcP
Te0 f113 0 0.3157894736842105 -12 -1 #arcLabel
Te0 f115 expr out #txt
Te0 f115 2192 268 2192 308 #arcP
Te0 f124 expr in #txt
Te0 f124 .xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>no</name>
        <nameStyle>2,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Te0 f124 2206 192 2210 480 #arcP
Te0 f124 1 2404 192 #addKink
Te0 f124 2 2404 480 #addKink
Te0 f124 1 0.16145833333333334 -9 0 #arcLabel
Te0 f128 expr out #txt
Te0 f128 2192 77 2192 116 #arcP
Te0 f142 expr out #txt
Te0 f142 2192 492 798 736 #arcP
Te0 f142 1 2192 712 #addKink
Te0 f142 0 0.7590874101950051 0 0 #arcLabel
Te0 f108 expr out #txt
Te0 f108 1912 332 1912 372 #arcP
Te0 f143 actionDecl 'ch.ivyteam.wf.processes.TaskServiceData out;
' #txt
Te0 f143 actionTable 'out=in;
' #txt
Te0 f143 actionCode 'import ch.ivy.addon.portalkit.persistence.domain.Application;
import ch.ivy.addon.portalkit.bo.RemoteTask;
import ch.ivy.addon.portalkit.mapper.RemoteTaskMapper;

List<RemoteTask> remoteTasks = RemoteTaskMapper.mapTasks(in.ivyTasks);
	for(RemoteTask remoteTask : remoteTasks){
		for(Application app : in.server.getApplications()){
			if(remoteTask.application.getName().equals(app.name)){
				app.setServer(in.server);
				remoteTask.setApplicationRegister(app);
				break;
			}
		}
	}
in.tasks.addAll(remoteTasks);
' #txt
Te0 f143 type ch.ivyteam.wf.processes.TaskServiceData #txt
Te0 f143 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>add tasks</name>
        <nameStyle>9,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Te0 f143 2174 380 36 24 20 -2 #rect
Te0 f143 @|StepIcon #fIcon
Te0 f146 expr out #txt
Te0 f146 2192 332 2192 380 #arcP
Te0 f116 expr out #txt
Te0 f116 2192 404 2192 468 #arcP
Te0 f147 type ch.ivyteam.wf.processes.TaskServiceData #txt
Te0 f147 processCall MultiPortal/IsAliveService:getApplicationList(ch.ivy.addon.portalkit.persistence.domain.Server) #txt
Te0 f147 doCall true #txt
Te0 f147 requestActionDecl '<ch.ivy.addon.portalkit.persistence.domain.Server server> param;
' #txt
Te0 f147 requestMappingAction 'param.server=in.server;
' #txt
Te0 f147 responseActionDecl 'ch.ivyteam.wf.processes.TaskServiceData out;
' #txt
Te0 f147 responseMappingAction 'out=in;
out.applications=result.apps;
out.isServerAlive=result.isServerAlive;
out.tempErrors=result.errors;
' #txt
Te0 f147 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>IsAliveService</name>
        <nameStyle>14,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Te0 f147 1446 292 36 24 20 -2 #rect
Te0 f147 @|CallSubIcon #fIcon
Te0 f150 actionDecl 'ch.ivyteam.wf.processes.TaskServiceData out;
' #txt
Te0 f150 actionTable 'out=in;
' #txt
Te0 f150 actionCode 'import ch.ivy.addon.portalkit.service.ServerService;

in.listIterator = in.servers.listIterator();' #txt
Te0 f150 type ch.ivyteam.wf.processes.TaskServiceData #txt
Te0 f150 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>init iterate servers</name>
        <nameStyle>20,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Te0 f150 1446 116 36 24 20 -2 #rect
Te0 f150 @|StepIcon #fIcon
Te0 f151 inParamDecl '<java.util.List<ch.ivy.addon.portalkit.persistence.domain.Server> servers,ch.ivy.ws.addon.TaskSearchCriteria taskSearchCriteria> param;' #txt
Te0 f151 inParamTable 'out.servers=param.servers;
out.taskSearchCriteria=param.taskSearchCriteria;
' #txt
Te0 f151 outParamDecl '<List<ch.ivy.ws.addon.WsException> errors,List<ch.ivy.addon.portalkit.bo.RemoteTask> tasks> result;
' #txt
Te0 f151 outParamTable 'result.errors=in.errors;
result.tasks=in.tasks;
' #txt
Te0 f151 actionDecl 'ch.ivyteam.wf.processes.TaskServiceData out;
' #txt
Te0 f151 callSignature findTasksByCriteriaAndServers(List<ch.ivy.addon.portalkit.persistence.domain.Server>,ch.ivy.ws.addon.TaskSearchCriteria) #txt
Te0 f151 type ch.ivyteam.wf.processes.TaskServiceData #txt
Te0 f151 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>findTasksByCriteriaAndServers
(TaskSearchCriteria, servers)</name>
        <nameStyle>59,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Te0 f151 1451 51 26 26 14 0 #rect
Te0 f151 @|StartSubIcon #fIcon
Te0 f152 actionDecl 'ch.ivyteam.wf.processes.TaskServiceData out;
' #txt
Te0 f152 actionTable 'out=in;
' #txt
Te0 f152 actionCode 'import ch.ivy.ws.addon.WsException;
for(int i = 0 ; i < in.tempErrors.size() ; i++){
	WsException w = in.tempErrors.get(i) as WsException;
	w.server = in.server.name;
	in.tempErrors.set(i,w);
	}
in.errors.addAll(in.tempErrors);

in.apps.clear();' #txt
Te0 f152 type ch.ivyteam.wf.processes.TaskServiceData #txt
Te0 f152 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>utils</name>
        <nameStyle>5,7
</nameStyle>
        <desc>add server name for exceptions

clear apps list</desc>
    </language>
</elementInfo>
' #txt
Te0 f152 1550 228 36 24 20 -2 #rect
Te0 f152 @|StepIcon #fIcon
Te0 f153 type ch.ivyteam.wf.processes.TaskServiceData #txt
Te0 f153 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>has apps?</name>
        <nameStyle>9,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Te0 f153 1450 498 28 28 14 0 #rect
Te0 f153 @|AlternativeIcon #fIcon
Te0 f154 actionDecl 'ch.ivyteam.wf.processes.TaskServiceData out;
' #txt
Te0 f154 actionTable 'out=in;
' #txt
Te0 f154 actionCode 'import ch.ivy.addon.portalkit.comparator.TaskNameComparator;

if (in.tasks.size() > 1){
	in.tasks.sort(new TaskNameComparator());
}
' #txt
Te0 f154 type ch.ivyteam.wf.processes.TaskServiceData #txt
Te0 f154 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>sort tasks by name</name>
        <nameStyle>18
</nameStyle>
    </language>
</elementInfo>
' #txt
Te0 f154 1382 580 36 24 -47 26 #rect
Te0 f154 @|StepIcon #fIcon
Te0 f155 actionDecl 'ch.ivyteam.wf.processes.TaskServiceData out;
' #txt
Te0 f155 actionTable 'out=in;
' #txt
Te0 f155 actionCode 'import ch.ivy.addon.portalkit.persistence.domain.Application;
import ch.ivy.addon.portalkit.service.PortalConnectorDetector;
import ch.ivy.addon.portalkit.service.ApplicationService;
import ch.ivy.ws.addon.IvyApplication;
import ch.ivy.addon.portalkit.service.UserService;
import ch.ivy.addon.portalkit.enums.WebServiceEndPoint;

in.apps.clear();

UserService userService = new UserService();
java.util.List<String> apps = userService.findApplicationNamesUserCanWorkOn(in.userName, in.server.id);
for(String appName: apps) {
	for (Application application : in.server.getApplications()) {
		if(appName.equals(application.name) && application.isVisible && !in.apps.contains(appName)){
			in.apps.add(appName);					
		}
	}
}
if (in.apps.isEmpty()) {
	ApplicationService applicationService = new ApplicationService();
	in.apps = applicationService.getApplicationNames(in.applications);
}

PortalConnectorDetector detector = new PortalConnectorDetector();
in.endpoint = detector.getPortalConnectorURLOf(in.server) + WebServiceEndPoint.TASK.toString();
' #txt
Te0 f155 type ch.ivyteam.wf.processes.TaskServiceData #txt
Te0 f155 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>get Allive Apps
ws endpoint</name>
        <nameStyle>27,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Te0 f155 1446 420 36 24 21 -18 #rect
Te0 f155 @|StepIcon #fIcon
Te0 f156 actionDecl 'ch.ivyteam.wf.processes.TaskServiceData out;
' #txt
Te0 f156 actionTable 'out=in;
' #txt
Te0 f156 actionCode 'import ch.ivy.addon.portalkit.persistence.domain.Application;
import ch.ivy.addon.portalkit.bo.RemoteTask;
import ch.ivy.addon.portalkit.mapper.RemoteTaskMapper;

List<RemoteTask> remoteTasks = RemoteTaskMapper.mapTasks(in.ivyTasks);
for (RemoteTask remoteTask : remoteTasks) {
	Application app = new Application();
	app.setServerId(in.server.id);
	app.setServer(in.server);
	remoteTask.setApplicationRegister(app);
}
in.tasks.addAll(remoteTasks);
' #txt
Te0 f156 type ch.ivyteam.wf.processes.TaskServiceData #txt
Te0 f156 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>add tasks</name>
        <nameStyle>9,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Te0 f156 1446 652 36 24 20 -2 #rect
Te0 f156 @|StepIcon #fIcon
Te0 f157 actionDecl 'ch.ivyteam.wf.processes.TaskServiceData out;
' #txt
Te0 f157 actionTable 'out=in;
' #txt
Te0 f157 actionCode 'import ch.ivy.addon.portalkit.persistence.domain.Server;

in.server = in.listIterator.next() as Server;' #txt
Te0 f157 type ch.ivyteam.wf.processes.TaskServiceData #txt
Te0 f157 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>get server</name>
        <nameStyle>10,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Te0 f157 1446 228 36 24 20 -2 #rect
Te0 f157 @|StepIcon #fIcon
Te0 f158 type ch.ivyteam.wf.processes.TaskServiceData #txt
Te0 f158 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>server alive</name>
        <nameStyle>12,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Te0 f158 1450 362 28 28 11 -29 #rect
Te0 f158 @|AlternativeIcon #fIcon
Te0 f159 type ch.ivyteam.wf.processes.TaskServiceData #txt
Te0 f159 processCall ServiceIntegrators/TaskServiceIntegrator:findTasksByCriteria(ch.ivy.ws.addon.TaskSearchCriteria,String,ch.ivy.addon.portalkit.persistence.domain.Server) #txt
Te0 f159 doCall true #txt
Te0 f159 requestActionDecl '<ch.ivy.ws.addon.TaskSearchCriteria taskSearchCriteria,java.lang.String endpoint,ch.ivy.addon.portalkit.persistence.domain.Server server> param;
' #txt
Te0 f159 requestMappingAction 'param.taskSearchCriteria=in.taskSearchCriteria;
param.taskSearchCriteria.involvedApplications=in.apps;
param.endpoint=in.endpoint;
param.server=in.server;
' #txt
Te0 f159 responseActionDecl 'ch.ivyteam.wf.processes.TaskServiceData out;
' #txt
Te0 f159 responseMappingAction 'out=in;
out.ivyTasks=result.tasks;
out.tempErrors=result.errors;
' #txt
Te0 f159 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>SearchTasks</name>
        <nameStyle>11,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Te0 f159 1446 580 36 24 20 -2 #rect
Te0 f159 @|CallSubIcon #fIcon
Te0 f160 type ch.ivyteam.wf.processes.TaskServiceData #txt
Te0 f160 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>next server</name>
        <nameStyle>11,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Te0 f160 1450 170 28 28 22 -21 #rect
Te0 f160 @|AlternativeIcon #fIcon
Te0 f161 expr in #txt
Te0 f161 outCond in.isServerAlive #txt
Te0 f161 1464 390 1464 420 #arcP
Te0 f162 expr out #txt
Te0 f162 1482 664 1568 252 #arcP
Te0 f162 1 1568 664 #addKink
Te0 f162 1 0.41082947714321383 0 0 #arcLabel
Te0 f163 expr in #txt
Te0 f163 1478 376 1568 252 #arcP
Te0 f163 1 1568 376 #addKink
Te0 f163 1 0.4925127356669446 0 0 #arcLabel
Te0 f164 expr out #txt
Te0 f164 1568 228 1478 184 #arcP
Te0 f164 1 1568 184 #addKink
Te0 f164 1 0.251489130890622 0 0 #arcLabel
Te0 f165 expr out #txt
Te0 f165 1464 444 1464 498 #arcP
Te0 f166 expr in #txt
Te0 f166 1478 512 1568 252 #arcP
Te0 f166 1 1568 512 #addKink
Te0 f166 0 0.8799989356997663 0 0 #arcLabel
Te0 f167 expr in #txt
Te0 f167 outCond 'in.apps.size() > 0' #txt
Te0 f167 1464 526 1464 580 #arcP
Te0 f168 expr out #txt
Te0 f168 1464 604 1464 652 #arcP
Te0 f169 expr out #txt
Te0 f169 1464 77 1464 116 #arcP
Te0 f170 expr out #txt
Te0 f170 1464 140 1464 170 #arcP
Te0 f171 expr out #txt
Te0 f171 1464 252 1464 292 #arcP
Te0 f172 expr in #txt
Te0 f172 outCond in.listIterator.hasNext() #txt
Te0 f172 1464 198 1464 228 #arcP
Te0 f173 expr out #txt
Te0 f173 1464 316 1464 362 #arcP
Te0 f174 expr in #txt
Te0 f174 1450 184 1400 580 #arcP
Te0 f174 1 1400 184 #addKink
Te0 f174 1 0.4697017091790999 0 0 #arcLabel
Te0 f175 expr out #txt
Te0 f175 1400 604 797 735 #arcP
Te0 f175 1 1400 672 #addKink
Te0 f175 1 0.4373989621861044 0 0 #arcLabel
Te0 f176 type ch.ivyteam.wf.processes.TaskServiceData #txt
Te0 f176 processCall MultiPortal/TaskService:findTasksByCriteriaAndServers(List<ch.ivy.addon.portalkit.persistence.domain.Server>,ch.ivy.ws.addon.TaskSearchCriteria) #txt
Te0 f176 doCall true #txt
Te0 f176 requestActionDecl '<java.util.List<ch.ivy.addon.portalkit.persistence.domain.Server> servers,ch.ivy.ws.addon.TaskSearchCriteria taskSearchCriteria> param;
' #txt
Te0 f176 requestMappingAction 'param.servers=in.servers;
param.taskSearchCriteria=in.taskSearchCriteria;
' #txt
Te0 f176 responseActionDecl 'ch.ivyteam.wf.processes.TaskServiceData out;
' #txt
Te0 f176 responseMappingAction 'out=in;
out.errors=result.errors;
out.tasks=result.tasks;
' #txt
Te0 f176 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>TaskService</name>
        <nameStyle>11,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Te0 f176 1246 380 36 24 20 -2 #rect
Te0 f176 @|CallSubIcon #fIcon
Te0 f177 expr out #txt
Te0 f177 1264 140 1264 380 #arcP
Te0 f74 expr out #txt
Te0 f74 1264 404 796 734 #arcP
Te0 f74 1 1264 656 #addKink
Te0 f74 1 0.14309408299440282 0 0 #arcLabel
>Proto Te0 .type ch.ivyteam.wf.processes.TaskServiceData #txt
>Proto Te0 .processKind CALLABLE_SUB #txt
>Proto Te0 .xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <swimlaneLabel>FIND ALL ACTIVE TASKS</swimlaneLabel>
        <swimlaneLabel>RESET TASK</swimlaneLabel>
        <swimlaneLabel>DELEGATE TASK</swimlaneLabel>
        <swimlaneLabel>SEARCH TASKS</swimlaneLabel>
        <swimlaneLabel>CAN USER RESUME TASK</swimlaneLabel>
        <swimlaneLabel>CREATE NOTE</swimlaneLabel>
        <swimlaneLabel>FIND RELATED TASKS OF CASE</swimlaneLabel>
        <swimlaneLabel></swimlaneLabel>
    </language>
    <swimlaneSize>720</swimlaneSize>
    <swimlaneSize>200</swimlaneSize>
    <swimlaneSize>272</swimlaneSize>
    <swimlaneSize>472</swimlaneSize>
    <swimlaneSize>200</swimlaneSize>
    <swimlaneSize>256</swimlaneSize>
    <swimlaneSize>192</swimlaneSize>
    <swimlaneColor gradient="true">-1</swimlaneColor>
    <swimlaneColor gradient="true">-1</swimlaneColor>
    <swimlaneColor gradient="true">-1</swimlaneColor>
    <swimlaneColor gradient="true">-1</swimlaneColor>
    <swimlaneColor gradient="true">-1</swimlaneColor>
    <swimlaneColor gradient="true">-1</swimlaneColor>
    <swimlaneColor gradient="true">-1</swimlaneColor>
    <swimlaneType>LANE</swimlaneType>
    <swimlaneType>LANE</swimlaneType>
    <swimlaneType>LANE</swimlaneType>
    <swimlaneType>LANE</swimlaneType>
    <swimlaneType>LANE</swimlaneType>
    <swimlaneType>LANE</swimlaneType>
    <swimlaneType>LANE</swimlaneType>
    <swimlaneSpaceBefore>0</swimlaneSpaceBefore>
    <swimlaneSpaceBefore>0</swimlaneSpaceBefore>
    <swimlaneSpaceBefore>0</swimlaneSpaceBefore>
    <swimlaneSpaceBefore>0</swimlaneSpaceBefore>
    <swimlaneSpaceBefore>0</swimlaneSpaceBefore>
    <swimlaneSpaceBefore>0</swimlaneSpaceBefore>
    <swimlaneSpaceBefore>0</swimlaneSpaceBefore>
</elementInfo>
' #txt
>Proto Te0 0 0 32 24 18 0 #rect
>Proto Te0 @|BIcon #fIcon
Te0 f27 out f44 tail #connect
Te0 f44 head f5 mainIn #connect
Te0 f32 mainOut f47 tail #connect
Te0 f47 head f38 mainIn #connect
Te0 f27 out f48 tail #connect
Te0 f48 head f38 mainIn #connect
Te0 f38 mainOut f49 tail #connect
Te0 f49 head f31 in #connect
Te0 f5 mainOut f1 tail #connect
Te0 f1 head f0 in #connect
Te0 f4 head f38 mainIn #connect
Te0 f0 out f9 tail #connect
Te0 f9 head f8 mainIn #connect
Te0 f0 out f4 tail #connect
Te0 f8 mainOut f2 tail #connect
Te0 f2 head f32 mainIn #connect
Te0 f20 head f19 mainIn #connect
Te0 f22 mainOut f29 tail #connect
Te0 f29 head f19 mainIn #connect
Te0 f16 out f24 tail #connect
Te0 f24 head f18 mainIn #connect
Te0 f16 out f20 tail #connect
Te0 f18 mainOut f23 tail #connect
Te0 f23 head f22 mainIn #connect
Te0 f36 mainOut f26 tail #connect
Te0 f26 head f25 mainIn #connect
Te0 f25 mainOut f30 tail #connect
Te0 f30 head f31 in #connect
Te0 f79 mainOut f34 tail #connect
Te0 f34 head f77 mainIn #connect
Te0 f31 out f35 tail #connect
Te0 f35 head f79 mainIn #connect
Te0 f77 mainOut f37 tail #connect
Te0 f37 head f27 in #connect
Te0 f10 mainOut f7 tail #connect
Te0 f7 head f6 mainIn #connect
Te0 f6 mainOut f13 tail #connect
Te0 f13 head f16 in #connect
Te0 f41 head f15 mainIn #connect
Te0 f33 mainOut f43 tail #connect
Te0 f43 head f15 mainIn #connect
Te0 f14 out f45 tail #connect
Te0 f45 head f28 mainIn #connect
Te0 f14 out f41 tail #connect
Te0 f28 mainOut f46 tail #connect
Te0 f46 head f33 mainIn #connect
Te0 f17 mainOut f50 tail #connect
Te0 f50 head f39 mainIn #connect
Te0 f39 mainOut f51 tail #connect
Te0 f51 head f14 in #connect
Te0 f62 mainOut f73 tail #connect
Te0 f73 head f56 mainIn #connect
Te0 f87 head f81 mainIn #connect
Te0 f85 mainOut f89 tail #connect
Te0 f89 head f81 mainIn #connect
Te0 f86 out f90 tail #connect
Te0 f90 head f83 mainIn #connect
Te0 f86 out f87 tail #connect
Te0 f83 mainOut f91 tail #connect
Te0 f91 head f85 mainIn #connect
Te0 f84 mainOut f92 tail #connect
Te0 f92 head f82 mainIn #connect
Te0 f82 mainOut f93 tail #connect
Te0 f93 head f86 in #connect
Te0 f96 mainOut f98 tail #connect
Te0 f98 head f97 mainIn #connect
Te0 f97 mainOut f100 tail #connect
Te0 f100 head f99 in #connect
Te0 f99 out f102 tail #connect
Te0 f102 head f101 mainIn #connect
Te0 f101 mainOut f104 tail #connect
Te0 f104 head f103 mainIn #connect
Te0 f103 mainOut f108 tail #connect
Te0 f108 head f105 mainIn #connect
Te0 f99 out f109 tail #connect
Te0 f109 head f105 mainIn #connect
Te0 f121 out f129 tail #connect
Te0 f129 head f127 mainIn #connect
Te0 f119 mainOut f130 tail #connect
Te0 f130 head f122 mainIn #connect
Te0 f121 out f131 tail #connect
Te0 f131 head f122 mainIn #connect
Te0 f122 mainOut f132 tail #connect
Te0 f132 head f117 in #connect
Te0 f127 mainOut f133 tail #connect
Te0 f133 head f123 in #connect
Te0 f134 head f122 mainIn #connect
Te0 f123 out f135 tail #connect
Te0 f135 head f125 mainIn #connect
Te0 f123 out f134 tail #connect
Te0 f125 mainOut f136 tail #connect
Te0 f136 head f119 mainIn #connect
Te0 f114 mainOut f137 tail #connect
Te0 f137 head f126 mainIn #connect
Te0 f126 mainOut f138 tail #connect
Te0 f138 head f117 in #connect
Te0 f118 mainOut f139 tail #connect
Te0 f139 head f120 mainIn #connect
Te0 f117 out f140 tail #connect
Te0 f140 head f118 mainIn #connect
Te0 f120 mainOut f141 tail #connect
Te0 f141 head f121 in #connect
Te0 f144 mainOut f40 tail #connect
Te0 f40 head f3 mainIn #connect
Te0 f117 out f149 tail #connect
Te0 f149 head f148 in #connect
Te0 f19 mainOut f145 tail #connect
Te0 f145 head f148 in #connect
Te0 f15 mainOut f21 tail #connect
Te0 f21 head f148 in #connect
Te0 f81 mainOut f64 tail #connect
Te0 f64 head f148 in #connect
Te0 f105 mainOut f88 tail #connect
Te0 f88 head f148 in #connect
Te0 f148 out f107 tail #connect
Te0 f107 head f144 mainIn #connect
Te0 f31 out f11 tail #connect
Te0 f11 head f148 in #connect
Te0 f59 mainOut f112 tail #connect
Te0 f112 head f106 in #connect
Te0 f106 out f113 tail #connect
Te0 f113 head f80 mainIn #connect
Te0 f80 mainOut f115 tail #connect
Te0 f115 head f110 mainIn #connect
Te0 f106 out f124 tail #connect
Te0 f124 head f111 mainIn #connect
Te0 f12 mainOut f128 tail #connect
Te0 f128 head f59 mainIn #connect
Te0 f111 mainOut f142 tail #connect
Te0 f142 head f148 in #connect
Te0 f110 mainOut f146 tail #connect
Te0 f146 head f143 mainIn #connect
Te0 f143 mainOut f116 tail #connect
Te0 f116 head f111 mainIn #connect
Te0 f158 out f161 tail #connect
Te0 f161 head f155 mainIn #connect
Te0 f156 mainOut f162 tail #connect
Te0 f162 head f152 mainIn #connect
Te0 f158 out f163 tail #connect
Te0 f163 head f152 mainIn #connect
Te0 f152 mainOut f164 tail #connect
Te0 f164 head f160 in #connect
Te0 f155 mainOut f165 tail #connect
Te0 f165 head f153 in #connect
Te0 f166 head f152 mainIn #connect
Te0 f153 out f167 tail #connect
Te0 f167 head f159 mainIn #connect
Te0 f153 out f166 tail #connect
Te0 f159 mainOut f168 tail #connect
Te0 f168 head f156 mainIn #connect
Te0 f151 mainOut f169 tail #connect
Te0 f169 head f150 mainIn #connect
Te0 f150 mainOut f170 tail #connect
Te0 f170 head f160 in #connect
Te0 f157 mainOut f171 tail #connect
Te0 f171 head f147 mainIn #connect
Te0 f160 out f172 tail #connect
Te0 f172 head f157 mainIn #connect
Te0 f147 mainOut f173 tail #connect
Te0 f173 head f158 in #connect
Te0 f160 out f174 tail #connect
Te0 f174 head f154 mainIn #connect
Te0 f154 mainOut f175 tail #connect
Te0 f175 head f148 in #connect
Te0 f56 mainOut f177 tail #connect
Te0 f177 head f176 mainIn #connect
Te0 f176 mainOut f74 tail #connect
Te0 f74 head f148 in #connect
